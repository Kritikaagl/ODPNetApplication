using JSOTest;
using JSOTest.Utils;
using Oracle.DataAccess.Client;
using Oracle.DataAccess.Types;
using System;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Text;
using System.Web.Script.Serialization;
using System.Web.Services;

public partial class JCOService : System.Web.UI.Page
{
    OracleConnection OBJ = null;
    OracleCommand CMD = null;
    DBHelper dbHelper = new DBHelper();
    protected void Page_Load(object sender, EventArgs e)
    {
        #region ..[Switch Case]....
        string fname = Convert.ToString(Request.QueryString["Func"]);
        switch (fname)
        {

            case ("GetSuggestedPromiseDate"):
                {
                    //Start added input parmeter created Date 18-FEB-2021
                    string PN_BILLABLE_TYPE = !string.IsNullOrEmpty(Request.QueryString["BILLABLE_TYPE"]) ? Convert.ToString(Request.QueryString["BILLABLE_TYPE"]) : "",
                    PN_MI_NMI = !string.IsNullOrEmpty(Request.QueryString["MI_NMI"]) ? Convert.ToString(Request.QueryString["MI_NMI"]) : "",
                    PN_PANEL = !string.IsNullOrEmpty(Request.QueryString["PANEL"]) ? Convert.ToString(Request.QueryString["PANEL"]) : "",
                    PN_CUTTING_WELDING_YN = !string.IsNullOrEmpty(Request.QueryString["CUTTING_WELDING_YN"]) ? Convert.ToString(Request.QueryString["CUTTING_WELDING_YN"]) : "",
                    PN_PART_REPLACE_YN = !string.IsNullOrEmpty(Request.QueryString["PART_REPLACE_YN"]) ? Convert.ToString(Request.QueryString["PART_REPLACE_YN"]) : "",
                    PN_ENGINE_TRANSMISSION_YN = !string.IsNullOrEmpty(Request.QueryString["ENG_TRANS_YN"]) ? Convert.ToString(Request.QueryString["ENG_TRANS_YN"]) : "",
                    PN_FOR_CD = !string.IsNullOrEmpty(Request.QueryString["FOR_CD"]) ? Convert.ToString(Request.QueryString["FOR_CD"]) : "";
                    //End added input parmeter created Date 18-FEB-2021

                    if (!string.IsNullOrEmpty(PN_BILLABLE_TYPE))
                    {
                        Response.Write(GetSuggestedPromiseDate(PN_BILLABLE_TYPE, PN_MI_NMI, PN_PANEL, PN_CUTTING_WELDING_YN, PN_PART_REPLACE_YN, PN_ENGINE_TRANSMISSION_YN, PN_FOR_CD));
                    }
                    else
                    {
                        Response.Write("NULL PN_BILLABLE_TYPE");
                    }
                    break;
                }

            case ("GetCounterMeasureDtl"):
                {
                    //Create Date 14-JAN-2021
                    //http://220.226.210.28/MarutiServiceDev/JCOService.aspx?func=GetCounterMeasureDtl&pn_vin=MA3BNC52SKK193562
                    string vin = Convert.ToString(Request.QueryString["pn_vin"]);
                    if (!string.IsNullOrEmpty(vin))
                    {
                        Response.Write(GetCounterMeasureDtl(vin));
                    }
                    else
                    {
                        Response.Write("NULL Vin");
                    }
                    break;
                }
            case ("JCDmdWeaValidate"):
                {
                    //Create Date 09-AUG-2019
                    string pmc = Convert.ToString(Request.QueryString["pn_pmc"]),
                         vin = Convert.ToString(Request.QueryString["pn_vin"]),
                          //Changes 06 SEPT 2022 BY GAGAN
                          rodate = Helper.ConvertdateFormat(Convert.ToString(Request.QueryString["pn_ro_date"])),
                        omr = Convert.ToString(Request.QueryString["pn_omr"]),
                        demand = Convert.ToString(Request.QueryString["pn_demand"]);

                    if (!string.IsNullOrEmpty(pmc))
                    {
                        Response.Write(JCDmdWeaValidate(pmc, vin, rodate, omr, demand));
                    }
                    else
                    {
                        Response.Write(JCDmdWeaValidate("1", vin, rodate, omr, demand));
                    }
                    break;
                }
            case ("JCPartValidate"):
                {
                    string pmc = Convert.ToString(Request.QueryString["pn_pmc"]),
                         vin = Convert.ToString(Request.QueryString["pn_vin"]),
                         srvtype = Convert.ToString(Request.QueryString["pn_srvtype"]),
                        partno = Convert.ToString(Request.QueryString["pn_partno"]);
                    if (!string.IsNullOrEmpty(pmc))
                    {
                        Response.Write(JCPartValidate(pmc, vin, srvtype, partno));
                    }
                    else
                    {
                        Response.Write(JCPartValidate("1", vin, srvtype, partno));
                    }
                    break;
                }

            case ("LaborAutoFlow"):
                {
                    string userId = Convert.ToString(Request.QueryString["userid"]),
                           vin = Convert.ToString(Request.QueryString["vin"]),
                           srvtype = Convert.ToString(Request.QueryString["srvtype"]);

                    if (userId != null)
                    {
                        Response.Write(LabourAutoFlow(userId, vin, srvtype));
                    }
                    else
                    {
                        Response.Write("NULL USERID");
                    }
                    break;
                }
            case ("WashTypes"):
                Response.Write(WashTypes());
                break;
            case ("EW"):
                {
                    string vin = Convert.ToString(Request.QueryString["vin"]);

                    Response.Write(EW(vin));
                    break;
                }
            case ("MCP"):
                string parentGroup = Convert.ToString(Request.QueryString["parentGroup"]),
                       dealerCd = Convert.ToString(Request.QueryString["dealerCd"]),
                       loccd = Convert.ToString(Request.QueryString["locCd"]),
                       regNum = Convert.ToString(Request.QueryString["regnum"]),
                       milage = Convert.ToString(Request.QueryString["milage"]);

                Response.Write(MCP(parentGroup, dealerCd, loccd, regNum, milage));
                break;
            case ("BarcodeGenerator"):
                string data12 = Convert.ToString(Request.QueryString["JCno"]);

                Response.ContentType = "image/Png";
                Response.Clear();
                object dd = CreateBarcode(data12);
                byte[] bytes = (byte[])dd;
                TypeConverter tc = TypeDescriptor.GetConverter(typeof(Bitmap));
                Bitmap bC = (Bitmap)tc.ConvertFrom(bytes);
                //string path = Server.MapPath("images");
                //bC.Save(path + "/" + data12 + ".Png", System.Drawing.Imaging.ImageFormat.Png);
                bC.Save(Response.OutputStream, System.Drawing.Imaging.ImageFormat.Gif);
                Response.End();
                break;

            case ("UserAuth"):
                string UserID1 = Convert.ToString(Request.QueryString["UserID"]);
                string UserPass = Convert.ToString(Request.QueryString["pass"]);
                //added two new parameters imei and version by gst on 29 apr 2015
                //string Imei = "1234";
                //Convert.ToString(Request.QueryString["imei"]);
                //string Version ="1"; 
                //Convert.ToString(Request.QueryString["version"]);
                //Response.Write("userid="+ UserID1+ "password="+ UserPass +"Imei="+Imei);
                //Response.Write("version="+Version);
                if (UserID1 != null)
                {
                    //string Result1 = UserAuth(UserID1, UserPass,Imei,Version);
                    string Result1 = UserAuth(UserID1, UserPass);
                    Response.Write(Result1);
                }
                break;
            //------------------------------------------testing new pocedures---------------------------------------------------------------------------------

            case ("NewServiceCategoryValidate"):
                /*
                got result 
                http://localhost/MarutiServiceDev/JCOService.aspx?func=NewServiceCategoryValidate&UserID=test.tab1&Vin=1234&srv_Type_Cd=5&Omr=23456
                */
                string UserIDgst = Convert.ToString(Request.QueryString["userid"]);
                string Vin = Convert.ToString(Request.QueryString["vin"]);
                string ServiceTypeCode = Convert.ToString(Request.QueryString["srv_type_cd"]);
                Int32 OMR1 = Convert.ToInt32(Request.QueryString["omr"]);
                //added new parameter as on 19 jun 2015 by gst 
                string ronum = Convert.ToString(Request.QueryString["ronum"]);

                // Response.Write("UserID1="+UserIDgst+"Vin="+Vin+"ServiceTypeCode="+ServiceTypeCode+"OMR="+OMR1+"ronum="+ronum);
                if (UserIDgst != null)
                {
                    string Result_NSCV = NewServiceCategoryValidate(UserIDgst, Vin, ServiceTypeCode, OMR1, ronum);
                    Response.Write(Result_NSCV);
                }
                else
                {
                    Response.Write("null userid");
                }
                break;
            case ("ApprovalStatus"):
                /*
                got result 
                http://localhost/MarutiServiceDev/JCOService.aspx?func=NewServiceCategoryValidate&UserID=test.tab1&Vin=1234&srv_Type_Cd=5&Omr=23456
                */
                UserIDgst = Convert.ToString(Request.QueryString["userid"]);


                // Response.Write("UserID1="+UserIDgst+"Vin="+Vin+"ServiceTypeCode="+ServiceTypeCode+"OMR="+OMR1+"ronum="+ronum);
                if (UserIDgst != null)
                {
                    string Result_NSCV = ApprovalStatusCodes(UserIDgst);
                    Response.Write(Result_NSCV);
                }
                else
                {
                    Response.Write("null userid");
                }
                break;
            //-----------------------------got  result -------------------
            case ("GetVehicleModelDetail"):
                string UserIDgst1 = Convert.ToString(Request.QueryString["userid"]);
                //Response.Write(UserIDgst1);
                if (UserIDgst1 != null)
                {
                    string Result_GVMD = GetVehicleModelDetail(UserIDgst1);
                    Response.Write(Result_GVMD);
                }
                break;

            //-----------------------------got  result-------------------
            case ("GetVehicleSystemDetail"):
                string UserIDgst2 = Convert.ToString(Request.QueryString["userid"]);
                //Response.Write(UserIDgst);
                if (UserIDgst2 != null)
                {
                    string Result_GVSD = GetVehicleSystemDetail(UserIDgst2);
                    Response.Write(Result_GVSD);
                }
                break;
            //---------------------------------got error result-----------------
            case ("GetVehicleSubSystemDetail"):
                /*  
                pkg_jco_1.sp_get_veh_sub_sys_dtl
                http://localhost/MarutiServiceDev/JCOService.aspx?func=GetVehicleSubSystemDetail&userid=test.tab1
                {"S":"1","M":"ORA-06550: line 1, column 7: PLS-00306: wrong number or types of arguments in call to 'SP_GET_VEH_SUB_SYS_DTL' ORA-06550: line 1, column 7: PL/SQL: Statement ignored"}
                */
                string UserIDgst3 = Convert.ToString(Request.QueryString["userid"]);
                string veh_sys_cd3 = Convert.ToString(Request.QueryString["veh_sys_cd"]);

                //Response.Write(UserIDgst);
                if (UserIDgst3 != null)
                {//Response.Write("userid="+UserIDgst3);
                    string Result_GVSSD = GetVehicleSubSystemDetail(UserIDgst3, veh_sys_cd3);
                    Response.Write(Result_GVSSD);
                }
                break;
            //--------------------------- got result-----------
            case ("LaborCodeValidtate"):
                /**
                http://localhost/MarutiServiceDev/JCOService.aspx?func=LaborCodeValidtate&userid=mul.mssd.sa1&opr_cd=ZE12L0&svar_cd=AZI413D&srv_cat_cd=PMS
		   
                */
                string UserIDgst4 = Convert.ToString(Request.QueryString["userid"]);
                string Opr_cd = Convert.ToString(Request.QueryString["opr_cd"]);
                string Svar_cd = Convert.ToString(Request.QueryString["svar_cd"]);
                string Srv_cat_cd = Convert.ToString(Request.QueryString["srv_cat_cd"]);
                //Response.Write("UserID1="+UserIDgst4+"Opr_cd="+Opr_cd+"Svar_cd="+Svar_cd+"Srv_cat_cd="+Srv_cat_cd);
                if (UserIDgst4 != null)
                {
                    string Result_LCV = LaborCodeValidtate(UserIDgst4, Opr_cd, Svar_cd, Srv_cat_cd);
                    Response.Write(Result_LCV);
                }
                else
                {
                    Response.Write("null ");
                }
                break;

            //-----------------------got output-----------------------	  
            case ("DemandCodeValidate"):


                string UserIDgst5 = Convert.ToString(Request.QueryString["userid"]);
                string Demand_cd = Convert.ToString(Request.QueryString["demand_cd"]);
                string Srv_cat_cd1 = Convert.ToString(Request.QueryString["srv_cat_cd"]);
                // Response.Write("UserIDgst5="+UserIDgst5+"Demand_cd="+Demand_cd+"Srv_cat_cd="+Srv_cat_cd1);
                if (UserIDgst5 != null)
                {
                    string Result_DCV = DemandCodeValidate(UserIDgst5, Demand_cd, Srv_cat_cd1);
                    Response.Write(Result_DCV);
                }
                else
                {
                    Response.Write("null ");
                }
                break;

            //-------------------------------------gotresult as tested on 8 may 2015 
            /**
            http://localhost/MarutiServiceDev/JCOService.aspx?func=GetUnApprovedFitment&userid=test.tab1
			
            pkg_jco_1.sp_jco_get_unapprv_fitment
            */
            case ("GetUnApprovedFitment"):
                string UserIDgst6 = Convert.ToString(Request.QueryString["userid"]);
                //Response.Write(UserIDgst);
                if (UserIDgst6 != null)
                {//Response.Write("userid="+UserIDgst6);
                    string Result_GUAF = GetUnApprovedFitment(UserIDgst6);
                    Response.Write(Result_GUAF);
                }
                break;
            //-----------------------------written some cases on 6 may 2015 by gst ---------------------------
            case ("NewOmrValidate"):
                /* got result as tested on  11 may 2015
                http://localhost/MarutiServiceDev/JCOService.aspx?func=NewOmrValidate&UserID=mul.mssd.sa7&Omr=25000&last_Omr=20186&Vin=MA3FJEB1S00372868&srv_type=PMS
				 
                */
                string UserIDgst9 = Convert.ToString(Request.QueryString["UserID"]);
                double gstOMR = Convert.ToDouble(Request.QueryString["omr"]);
                //Response.Write("gstomr="+gstOMR);
                Int64 lastOMR = Convert.ToInt64(Request.QueryString["last_omr"]);
                string gstvin = Convert.ToString(Request.QueryString["vin"]);
                string gstsrv_type = Convert.ToString(Request.QueryString["srv_type"]);
                if (UserIDgst9 != null)
                {
                    string Result13 = NewOmrValidate(UserIDgst9, gstOMR, lastOMR, gstvin, gstsrv_type);
                    Response.Write(Result13);
                }
                else
                {
                    Response.Write("Null");
                }

                break;
            //----got result as tested on 8 may 2015
            case ("NewUserCustomerVehicleDetails"):
                string UserID2new = Convert.ToString(Request.QueryString["UserID"]);
                //string RegNumnew = Convert.ToString(Request.QueryString["RegNum"]);
                string RegNumnew = !string.IsNullOrEmpty(Request.QueryString["RegNum"]) ? Convert.ToString(Request.QueryString["RegNum"]) : string.Empty;
                string VinNew = !string.IsNullOrEmpty(Request.QueryString["Vin"]) ? Convert.ToString(Request.QueryString["Vin"]) : string.Empty;
                string FindId = !string.IsNullOrEmpty(Request.QueryString["FindId"]) ? Convert.ToString(Request.QueryString["FindId"]) : string.Empty;

                if (UserID2new != null)
                {
                    string Result3new = NewUserCustomerVehicleDetails(RegNumnew, VinNew, UserID2new, FindId);
                    Response.Write(Result3new);
                }
                break;

            case ("NewModifyCustDetails"):

                string CustID = Convert.ToString(Request.QueryString["CustID"]);
                string UserNamenew = Convert.ToString(Request.QueryString["UserName"]);
                string CustModFlag = Convert.ToString(Request.QueryString["CustModFlag"]);
                string CustNamenew = Convert.ToString(Request.QueryString["CustName"]);
                string CustAdd1new = Convert.ToString(Request.QueryString["CustAdd1"]);
                string CustAdd2new = Convert.ToString(Request.QueryString["CustAdd2"]);
                string CustAdd3new = Convert.ToString(Request.QueryString["CustAdd3"]);
                string cityCodenew = Convert.ToString(Request.QueryString["cityCode"]);
                string Citydescnew = Convert.ToString(Request.QueryString["Citydesc"]);
                string Emailnew = Convert.ToString(Request.QueryString["Email"]);
                //Response.Write("email="+Emailnew);
                string Email1new = Convert.ToString(Request.QueryString["Email1"]);
                string phonenew = Convert.ToString(Request.QueryString["phone"]);
                string workingPhonenew = Convert.ToString(Request.QueryString["workingPhone"]);
                string mobilenew = Convert.ToString(Request.QueryString["mobile"]);
                string dobnew = Convert.ToString(Request.QueryString["dob"]);
                string doanew = Convert.ToString(Request.QueryString["doa"]);

                if (UserNamenew != null)
                {
                    string Result16new = NewModifyCustDetails(CustID, UserNamenew, CustModFlag, CustNamenew, CustAdd1new, CustAdd2new,
                                                           CustAdd3new, cityCodenew, Citydescnew, Emailnew, Email1new, phonenew,
                                                           workingPhonenew, mobilenew, dobnew, doanew);
                    Response.Write(Result16new);
                }
                else
                {
                    Response.Write("Null");
                }

                break;


            case ("NewGetPickupDetails"):
                //mmsnum cursor returns blank while testing as on 8 may 2015
                string UserID12new = Convert.ToString(Request.QueryString["UserID"]);
                if (UserID12new != null)
                {
                    string Result15new = NewGetPickupDetails(UserID12new);
                    Response.Write(Result15new);
                }
                else
                {
                    Response.Write("Null");
                }

                break;

            case ("NewGetPartDetails"):
                /* got result as tested on 8 may 2015
                http://localhost/MarutiServiceDev/JCOService.aspx?func=NewGetPartDetails&UserID=test.tab1&PartNum=123456
                {"S":"1","M":"Part Details are not fetched"}
			  
                */
                string UserID6new = Convert.ToString(Request.QueryString["UserID"]);
                string PartNum6new = Convert.ToString(Request.QueryString["PartNum"]);
                if (UserID6new != null)
                {
                    string Result10new = NewGetPartDetails(UserID6new, PartNum6new);
                    Response.Write(Result10new);
                }
                else
                {
                    Response.Write("Null UserName");
                }

                break;
            //----- written on 21st Dec 2017 by ravi ------------------------------
            case ("GetCustVehRFIDDetail"):
                string rfIdNo = Convert.ToString(Request.QueryString["rf_Id"]);
                string dealerMapCd = Convert.ToString(Request.QueryString["dealer_cd"]);
                string locCd = Convert.ToString(Request.QueryString["loc_cd"]);
                if (rfIdNo != null)
                {
                    string Result1new = GetCustVehRFIDDetail(rfIdNo, dealerMapCd, locCd);

                    Response.Write(Result1new);
                }
                break;
            //---------------------written some cases on 7 may 2015 by gst ----------------------------
            case ("NewUserAuth"):
                string UserID1new = Convert.ToString(Request.QueryString["UserID"]);
                string UserPassnew = Convert.ToString(Request.QueryString["pass"]);
                string Imei = Convert.ToString(Request.QueryString["imei"]);
                string Version = Convert.ToString(Request.QueryString["version"]);
                string vUpdate = string.Empty;

                try
                {
                    vUpdate = !string.IsNullOrEmpty(Request.QueryString["vUpdate"]) ? Convert.ToString(Request.QueryString["vUpdate"]) : "";
                }
                catch (Exception ex)
                {

                }

                if (UserID1new != null)
                {
                    string Result1new = NewUserAuth(UserID1new, UserPassnew, Imei, Version, vUpdate);

                    Response.Write(Result1new);
                }
                break;
            //---------------- got result as tested on 8 may 2015
            case ("GetNewMenuDetails"):
                /*
                pkg_jco_1.sp_jco_get_menu_dtl
			
                */
                string UserID4 = Convert.ToString(Request.QueryString["UserID"]);
                string svar_cd = Convert.ToString(Request.QueryString["svar_cd"]);

                if (UserID4 != null)
                {
                    string Result7 = GetNewMenuDetails(UserID4, svar_cd);

                    Response.Write(Result7);
                }
                else
                {
                    Response.Write("Null UserName");
                }

                break;
            //----------------------------- got result as tested on 8 may 2015
            case ("GetNewLaborDetails"):
                /*
                pkg_jco_1.sp_jco_get_labor_dtl
                //tested after giving inputs on 8 may 2015
                //get these error if labor amt params in cursor is ignored
                http://localhost/MarutiServiceDev/JCOService.aspx?func=GetNewLaborDetails&UserID=mul.mssd.sa7&svar_cd=AZI413D&veh_sys_cd=A&veh_sub_sys_cd=AE
                {"S":"1","M":"Invalid column index specified"}
                */
                string UserIDgst7 = Convert.ToString(Request.QueryString["UserID"]);
                string Svar_cd7 = Convert.ToString(Request.QueryString["svar_cd"]);
                string Veh_sys_cd7 = Convert.ToString(Request.QueryString["veh_sys_cd"]);
                string Veh_sub_sys_cd7 = Convert.ToString(Request.QueryString["veh_sub_sys_cd"]);

                if (UserIDgst7 != null)
                {
                    string Result_newLDTL = GetNewLaborDetails(UserIDgst7, Svar_cd7, Veh_sys_cd7, Veh_sub_sys_cd7);
                    Response.Write(Result_newLDTL);
                }
                else
                {
                    Response.Write("Null UserName");
                }

                break;
            //------	 got result as tedted on 8 may 2015
            case ("GetTechDetails"):
                /*
                pkg_jco_1.sp_jco_get_tech_dtl
                http://localhost/MarutiServiceDev/JCOService.aspx?func=GetTechDetails&UserID=mul.mssd.sa7&group_cd=A1
                */
                string UserIDgst8 = Convert.ToString(Request.QueryString["UserID"]);
                string Group_cd = Convert.ToString(Request.QueryString["group_cd"]);


                if (UserIDgst8 != null)
                {
                    string Result_GTCH_DTL = GetTechDetails(UserIDgst8, Group_cd);
                    Response.Write(Result_GTCH_DTL);
                }
                else
                {
                    Response.Write("Null UserName");
                }

                break;
            //-----------------------------got error as tested on 8 may 2015
            case ("GetMenuCodeDetails"):
                /*
                http://localhost/MarutiServiceDev/JCOService.aspx?func=GetMenuCodeDetails&UserID=test.tab1&regnum=mh4544&menu_cd=dd44srv_cat_cd=4f5f5f&pl_mod_flag=N
                {"S":"1","M":"Please enter Service Type"}
                as tested on 8 may 2015
                http://localhost/MarutiServiceDev/JCOService.aspx?func=GetMenuCodeDetails&UserID=mul.mssd.sa7&regnum=HR26CA9946&menu_cd=RS-M-30&srv_cat_cd=PMS&pl_mod_flag=N
                got blank screen as o/p
                */
                string UserIDgst10 = Convert.ToString(Request.QueryString["UserID"]);
                string Regisnum = Convert.ToString(Request.QueryString["regnum"]);
                string menu_cd = Convert.ToString(Request.QueryString["menu_cd"]);
                string srv_cat_cd = Convert.ToString(Request.QueryString["srv_cat_cd"]);
                string pl_mod_flag = Convert.ToString(Request.QueryString["pl_mod_flag"]);


                if (UserIDgst10 != null)
                {
                    string Result_GMCDTL = GetMenuCodeDetails(UserIDgst10, Regisnum, menu_cd, srv_cat_cd, pl_mod_flag);
                    Response.Write(Result_GMCDTL);
                }
                else
                {
                    Response.Write("Null UserName");
                }
                break;
            //----------------------got result
            case ("NewGetInventoryDetails"):
                string UserIDgst11 = Convert.ToString(Request.QueryString["userid"]);
                if (UserIDgst11 != null)
                {
                    string Result_GIDTLS = NewGetInventoryDetails(UserIDgst11);
                    Response.Write(Result_GIDTLS);
                }
                break;
            //******************************* got result as tested on 14 july 2015

            case ("GetSaletype"):
                /*
                pkg_jco_1.sp_jco_get_sale_type
                http://localhost/MarutiServiceDev/JCOService.aspx?func=GetSaletype&UserID=mul.mssd.sa7
                */
                string UserIDgst12 = Convert.ToString(Request.QueryString["UserID"]);
                if (UserIDgst12 != null)
                {
                    string Result_GSTYPE = GetSaletype(UserIDgst12);
                    Response.Write(Result_GSTYPE);
                }
                break;


            case ("GetEstimationType"):
                /*
                pkg_jco_1.sp_jco_get_estim_type
                http://localhost/MarutiServiceDev/JCOService.aspx?func=GetEstimationType&UserID=mul.mssd.sa7
                got result as tested on 14 july 2015
		  
                */
                string UserIDgst13 = Convert.ToString(Request.QueryString["UserID"]);
                if (UserIDgst13 != null)
                {
                    string Result_GEstType = GetEstimationType(UserIDgst13);
                    Response.Write(Result_GEstType);
                }
                break;
            //******

            case ("GetSrvEstimationHdr1"):
                /*
			 
               http://localhost/MarutiServiceDev/JCOService.aspx?func=GetSrvEstimationHdr1&UserID=mssd.sa4&EstNum=ES16000037
                pkg_jco_1.sp_jco_get_srv_estim_hdr
                got result as tested on 14 july 2015
                */
                string UserIDgst14_1 = Convert.ToString(Request.QueryString["UserID"]);
                //string Regisnumgst_1 = Convert.ToString(Request.QueryString["RegNum"]);
                string EstmNo_new_1 = Convert.ToString(Request.QueryString["EstNum"]);
                if (UserIDgst14_1 != null)
                {
                    string Result_GSEH1 = GetSrvEstimationHdr1(UserIDgst14_1, EstmNo_new_1);
                    Response.Write(Result_GSEH1);
                }
                break;

            case ("GetSrvEstimationHdr"):
                /*
                http://localhost/MarutiServiceDev/JCOService.aspx?func=GetSrvEstimationHdr&UserID=test.tab1&RegNum=555
				
                pkg_jco_1.sp_jco_get_srv_estim_hdr
                got result as tested on 14 july 2015
                */
                string UserIDgst14 = Convert.ToString(Request.QueryString["UserID"]);
                string Regisnumgst = Convert.ToString(Request.QueryString["RegNum"]);
                //string EstmNo_new = Convert.ToString(Request.QueryString["EstNum"]);
                if (UserIDgst14 != null)
                {
                    string Result_GSEH = GetSrvEstimationHdr(UserIDgst14, Regisnumgst);
                    Response.Write(Result_GSEH);
                }
                break;
            //*******************	got error

            case ("GetSrvEstmDetails"):
                /*
                pkg_jco_1.sp_jco_get_SRV_ESTIM_DTL
			   
                http://localhost/MarutiServiceDev/JCOService.aspx?func=GetSrvEstmDetails&UserID=test.tab1&RegNum=555&EstmNum=ES10000019
                got result as tested on 14 july 2015
                */
                string UserIDgst15 = Convert.ToString(Request.QueryString["UserID"]);
                string Regisnum15 = Convert.ToString(Request.QueryString["RegNum"]);
                string Estmno = Convert.ToString(Request.QueryString["EstmNum"]);
                if (UserIDgst15 != null)
                {
                    string Result_GSESTMDTL = GetSrvEstmDetails(UserIDgst15, Regisnum15, Estmno);
                    Response.Write(Result_GSESTMDTL);
                }
                else
                {
                    Response.Write("Null UserName");
                }

                break;
            //***************************************************** written some cases on 8 may 2015*********************
            case ("GetExistingJC"):
                string UserIDgst24 = Convert.ToString(Request.QueryString["UserID"]);
                if (UserIDgst24 != null)
                {
                    string Result_ExJC = GetExistingJC(UserIDgst24);
                    Response.Write(Result_ExJC);
                }
                break;
            //************************************written some cases on 11 may 2015*******************************8

            case ("GetServiceCategory"):
                /*
                got result as tested on 11 may 2015
                http://localhost/MarutiServiceDev/JCOService.aspx?func=GetServiceCategory&UserID=test.tab1
                */
                string UserIDgst18 = Convert.ToString(Request.QueryString["UserID"]);
                if (UserIDgst18 != null)
                {
                    string Result_GSRVCAT = GetServiceCategory(UserIDgst18);
                    Response.Write(Result_GSRVCAT);
                }
                break;

            case ("NewUserAuthMSG"):
                /*---got error need to test  again
                //--------------------------pkg_jco_1.check_insurance
                */
                string RegNo_new = Convert.ToString(Request.QueryString["RegNo"]);

                if (RegNo_new != null)
                {
                    string Result213_new = NewUserAuthMSG(RegNo_new);
                    Response.Write(Result213_new);
                }
                break;
            //------------------got result as tested on 11 may 2015	 
            case ("GetSaAdv"):
                /*
                http://localhost/MarutiServiceDev/JCOService.aspx?func=GetSaAdv&UserID=test.tab1
                */
                string UserIDgst19 = Convert.ToString(Request.QueryString["UserID"]);
                if (UserIDgst19 != null)
                {
                    string Result_GSaAdv = GetSaAdv(UserIDgst19);
                    Response.Write(Result_GSaAdv);
                }
                break;
            //----------------------------got result as tested on 11 may 2015 but getting pop_yn  cursor param blank value----------
            case ("NewGetDemandCodeDetails"):
                /*
                pkg_jco_1.sp_jco_get_demand_cd_dtl
                http://localhost/MarutiServiceDev/JCOService.aspx?func=NewGetDemandCodeDetails&UserID=test.tab1
                */
                string UserIDgst26 = Convert.ToString(Request.QueryString["UserID"]);

                if (UserIDgst26 != null)
                {
                    string Result_DCdTL = NewGetDemandCodeDetails(UserIDgst26);
                    Response.Write(Result_DCdTL);
                }
                else
                {
                    Response.Write("Null UserName");
                }
                break;

            case ("GetHistoryHDR"):
                /*
                pkg_jco_1.sp_jco_get_histroy_hdr
                got result as tested on 11 may 2015
                http://localhost/MarutiServiceDev/JCOService.aspx?func=GetHistoryHDR&RegNum=fvfvf&UserID=test.tab1
                */
                string RegNum23 = Convert.ToString(Request.QueryString["RegNum"]);
                string UserIDgst23 = Convert.ToString(Request.QueryString["UserID"]);
                if (UserIDgst23 != null)
                {
                    string Result_HistHDR = GetHistoryHDR(RegNum23, UserIDgst23);
                    Response.Write(Result_HistHDR);
                }
                break;
            //*******************	pkg_jco_1.sp_jco_get_histroy_dtl--------------

            case ("GetHistoryDetails"):
                string jcnum28 = Convert.ToString(Request.QueryString["jcnum"]);//JC14000045
                string UserIDgst28 = Convert.ToString(Request.QueryString["UserID"]);//test.tab1
                string RegNum28 = Convert.ToString(Request.QueryString["RegNum"]);//HR26CB0842


                if (UserIDgst28 != null)
                {
                    string Result_Hstry_dTL = GetHistoryDetails(jcnum28, UserIDgst28, RegNum28);
                    Response.Write(Result_Hstry_dTL);
                }
                else
                {
                    Response.Write("Null UserName");
                }

                break;


            case ("NewVtsValidation"):
                /*got result as tested on 11 may 2015*/
                string UserID801_new = Convert.ToString(Request.QueryString["UserID"]);
                Int32 Vts_Num_new = Convert.ToInt32(Request.QueryString["VtsNum"]);
                if (UserID801_new != null)
                {
                    string Result103_new = NewVtsValidation(UserID801_new, Vts_Num_new);
                    Response.Write(Result103_new);
                }
                else
                {
                    Response.Write("Null");
                }

                break;

            //----------------got result as tested on 12 may 2015
            case ("GetCityDetails"):
                string UserIDgst31 = Convert.ToString(Request.QueryString["UserID"]);

                if (UserIDgst31 != null)
                {
                    string Result_Gcdtl = GetCityDetails(UserIDgst31);
                    Response.Write(Result_Gcdtl);
                }
                break;
            //------------------------------got result as tested on 12 may 2015
            case ("GetMenuCardDetails"):
                string UserIDgst27 = Convert.ToString(Request.QueryString["UserID"]);
                string RegNum27 = Convert.ToString(Request.QueryString["RegNum"]);
                string srv_type_cd27 = Convert.ToString(Request.QueryString["srv_type_cd"]);
                string sub_srv_type_cd27 = Convert.ToString(Request.QueryString["sub_srv_type_cd"]);

                if (UserIDgst27 != null)
                {
                    string Result_MCard_dTL = GetMenuCardDetails(UserIDgst27, RegNum27, srv_type_cd27, sub_srv_type_cd27);
                    Response.Write(Result_MCard_dTL);
                }
                else
                {
                    Response.Write("Null UserName");
                }

                break;

            //------------written new procedure to get date : 19 Dec 2015 
            /*
            http://localhost//MarutiServiceDev/JCOService.aspx?func=GetGroupPartDetails&UserID=vinod.okf&group_cd=ZP008&part_num=16510M68K00
            */
            case ("GetGroupPartDetails"):
                string UserIDgst101 = Convert.ToString(Request.QueryString["UserID"]);
                string Group_cd101 = Convert.ToString(Request.QueryString["group_cd"]);
                string part_num101 = Convert.ToString(Request.QueryString["part_num"]);


                if (UserIDgst101 != null)
                {
                    string Result_Grppart_dTL = GetGroupPartDetails(UserIDgst101, Group_cd101, part_num101);
                    Response.Write(Result_Grppart_dTL);
                }
                else
                {
                    Response.Write("Null UserName");
                }

                break;


            //-------------------written some cases on 12 may 2015--------------------------------------------------------------


            case ("GetTechAdv"):
                /*
                got result as tested on 12 may 2015
                http://localhost/MarutiServiceDev/JCOService.aspx?func=GetTechAdv&UserID=test.tab1
                //---------------------------pkg_jco_1.sp_jco_get_tech_adv---------------------
                */
                string UserIDgst20 = Convert.ToString(Request.QueryString["UserID"]);
                if (UserIDgst20 != null)
                {
                    string Result_GTechAdv = GetTechAdv(UserIDgst20);
                    Response.Write(Result_GTechAdv);
                }
                break;
            //*******************				
            //--------------------------------------------got result as tested on 12 may 2015-----------------------------------

            case ("GetBayDetails"):
                /*
                pkg_jco_1.sp_jco_get_bay_dtl
                http://localhost/MarutiServiceDev/JCOService.aspx?func=GetBayDetails&UserID=test.tab1
                */
                string UserIDgst22 = Convert.ToString(Request.QueryString["UserID"]);
                if (UserIDgst22 != null)
                {
                    string Result_BayDtl = GetBayDetails(UserIDgst22);
                    Response.Write(Result_BayDtl);
                }
                break;
            //*******************				

            //-------------------------------------------------got result as tested on 12 may 2015------------------
            case ("GetGroupDetails"):
                /*
                pkg_jco_1.sp_jco_get_group_dtl
                http://localhost/MarutiServiceDev/JCOService.aspx?func=GetGroupDetails&UserID=test.tab1
                */
                string UserIDgst21 = Convert.ToString(Request.QueryString["UserID"]);
                if (UserIDgst21 != null)
                {
                    string Result_GrpDtl = GetGroupDetails(UserIDgst21);
                    Response.Write(Result_GrpDtl);
                }
                break;
            //*******************				

            case ("NewModifyVehicleDetails"):
                /*
                got result as tested on 12 may 2015
                {"S":"0","UN":"abcdef","M":"Vehicle Changes Are Saved Successfully"}
                http://localhost/MarutiServiceDev/JCOService.aspx?func=NewModifyVehicleDetails&UserID=test.tab1&Regno=12345&VehUserName=abcdef
     
                 //11-Oct-2017 : Added four new inputs - Vectoform
                 * Email, phone, workingPhone, mobile
                 * http://localhost:1043/JCOService.aspx?func=NewModifyVehicleDetails&UserID=sa.repale&Regno=HR99RPT8178&VehUserName=JAIMAL&Email=tiger%40gmail%2Ecom&phone=965555542333&workingPhone=965888888888&mobile=9416059663
                */
                string UserID10_new = Convert.ToString(Request.QueryString["UserID"]);
                string RegNum_new = Convert.ToString(Request.QueryString["Regno"]);
                string VehUserName10_new = Convert.ToString(Request.QueryString["VehUserName"]);

                string Email10_new = Convert.ToString(Request.QueryString["Email"]);
                //string phone10_new = Convert.ToString(Request.QueryString["phone"]);
                //string workingPhone10_new = Convert.ToString(Request.QueryString["workingPhone"]);
                //string mobile10_new = Convert.ToString(Request.QueryString["mobile"]);
                string flag = Convert.ToString(Request.QueryString["flag"]);

                if (UserID10_new != null)
                {
                    string Result14_new = NewModifyVehicleDetails(UserID10_new, RegNum_new, VehUserName10_new, flag);  //Email10_new, phone10_new, workingPhone10_new, mobile10_new,
                    Response.Write(Result14_new);
                }
                else
                {
                    Response.Write("Null");
                }

                break;

            //-------------new case written on 14 may 2015-----------------

            //-----------------------------------------------got result as on 14 may 2015-----------------------------
            case ("GetMcardRejReason"):
                /*
                http://localhost/MarutiServiceDev/JCOService.aspx?func=GetMcardRejReason&UserID=test.tab1
                pkg_jco_1.sp_jco_get_mcardrejreason
                */
                string UserIDgst25 = Convert.ToString(Request.QueryString["UserID"]);
                if (UserIDgst25 != null)
                {
                    string Result_Gmcardrjctrsn = GetMcardRejReason(UserIDgst25);
                    Response.Write(Result_Gmcardrjctrsn);
                }
                break;
            //*******************				

            //------------------------------------------written some cases on 15 may 2015-----------------

            //----------------------------------------pkg_jco_1.sp_jco_insert_dtl-------------------------------------------------------

            case ("NewInsertAllDetails"):

                // Response.Write(Convert.ToString(Request.QueryString)+"\n");
                string RegNum101_new = Convert.ToString(Request.QueryString["RegNum"]);
                //Response.Write("Reg no="+RegNum101_new+"<br/>");
                string UserID101_new = Convert.ToString(Request.QueryString["UserID"]);
                //Response.Write("userID="+UserID101_new+"<br/>");
                string srv_cat_cd_new = Convert.ToString(Request.QueryString["srv_cat_cd"]);
                //Response.Write("srv_cat_cd="+srv_cat_cd_new+"<br/>");
                string sub_srv_type_cd = Convert.ToString(Request.QueryString["sub_srv_type_cd"]);
                //Response.Write("sub_srv_type_cd="+sub_srv_type_cd+"<br/>");
                Int32 OMR11_new = Convert.ToInt32(Request.QueryString["omr"]);
                //Response.Write("omr="+OMR11_new+"<br/>");
                //Changes 06 SEPT 2022 BY GAGAN
                string promised_date = Helper.ConvertdateFormat(Convert.ToString(Request.QueryString["promised_date"]));
                //Response.Write("promised_date="+promised_date+"<br/>" + "after converting to datetime="+Convert.ToDateTime(promised_date)+"<br/>" );
                string checkin_date = Helper.ConvertdateFormat(Convert.ToString(Request.QueryString["checkin_date"]));
                //Response.Write("checkin_date="+checkin_date+"<br/>"+ "after converting to datetime="+Convert.ToDateTime(checkin_date));   //Convert.ToDateTime
                string sa_adv = Convert.ToString(Request.QueryString["sa_adv"]);
                //Response.Write("sa_adv="+sa_adv+"<br/>");
                string tech_adv = Convert.ToString(Request.QueryString["tech_adv"]);
                //Response.Write("tech_adv="+tech_adv+"<br/>");
                string bay_cd = Convert.ToString(Request.QueryString["bay_cd"]);
                //Response.Write("bay_cd="+bay_cd+"<br/>");
                string group_cd = Convert.ToString(Request.QueryString["group_cd"]);
                //Response.Write("group_cd="+group_cd+"<br/>");
                string omr_change = Convert.ToString(Request.QueryString["omr_change"]);
                //Response.Write("omr_change="+omr_change+"<br/>");
                Int32 vts_card_num = Convert.ToInt32(Request.QueryString["vts_card_num"]);
                //Response.Write("vts_card_num="+vts_card_num+"<br/>");
                string tech_cd = Convert.ToString(Request.QueryString["tech_cd"]);
                //Response.Write("tech_cd="+tech_cd+"<br/>");

                //get values of following cursor seperated by $ symbol

                string menu_ins_refcur = Convert.ToString(Request.QueryString["menu_ins_refcur"]);
                //Response.Write("menu_ins_refcur="+menu_ins_refcur+"<br/>");
                string demand_ins_refcur = Convert.ToString(Request.QueryString["demand_ins_refcur"]);
                //Response.Write("demand_ins_refcur="+demand_ins_refcur+"<br/>");
                string part_ins_refcur = Convert.ToString(Request.QueryString["part_ins_refcur"]);
                //Response.Write("part_ins_refcur="+part_ins_refcur+"<br/>");
                string labor_ins_refcur = Convert.ToString(Request.QueryString["labor_ins_refcur"]);
                //Response.Write("labor_ins_refcur="+labor_ins_refcur+"<br/>");
                string inv_ins_refcur = Convert.ToString(Request.QueryString["inv_ins_refcur"]);
                //Response.Write("inv_ins_refcur="+inv_ins_refcur+"<br/>");
                string mcard_ins_refcur = Convert.ToString(Request.QueryString["mcard_ins_refcur"]);
                //Response.Write("mcard_ins_refcur="+mcard_ins_refcur+"<br/>");
                string unapprv_fitment_refcur = Convert.ToString(Request.QueryString["unapprv_fitment_refcur"]);
                //Response.Write("unapprv_fitment_refcur="+unapprv_fitment_refcur+"<br/>");

                string estm_str_refcur = Convert.ToString(Request.QueryString["estm_refcur"]);
                //Response.Write("estm_str_refcur="+estm_str_refcur+"<br/>");


                string Pick_Typ_new = Convert.ToString(Request.QueryString["Pick_Typ"]);
                //Response.Write("Pick_Typ="+Pick_Typ_new+"<br/>");
                string Pick_Dat_new = Helper.ConvertdateFormat(Convert.ToString(Request.QueryString["Pick_Dat"]));
                //Response.Write("Pick_Dat="+Pick_Dat_new+"<br/>");
                string Pick_Flag_new = Convert.ToString(Request.QueryString["Pick_Flag"]);
                //Response.Write("Pick_Flag="+Pick_Flag_new+"<br/>");
                string Pick_Loc_new = Convert.ToString(Request.QueryString["Pick_Loc"]);
                //Response.Write("Pick_Loc="+Pick_Loc_new+"<br/>");
                string Pick_Drv_new = Convert.ToString(Request.QueryString["Pick_Drv"]);
                //Response.Write("Pick_Drv="+Pick_Drv_new+"<br/>");
                string Pick_Rem_new = Convert.ToString(Request.QueryString["Pick_Rem"]);
                //Response.Write("Pick_Rem="+Pick_Rem_new+"<br/>");
                string mms_num_new = Convert.ToString(Request.QueryString["mms_num"]);
                //Response.Write("mms_num="+mms_num_new+"<br/>");

                string Emailid_new = Convert.ToString(Request.QueryString["emailid"]);
                //Response.Write("Emailid="+Emailid_new);
                //added these new param on 27 nov 2015
                string Prob_str_new = Convert.ToString(Request.QueryString["prob_str"]);
                //Response.Write("Prob_str_new="+Prob_str_new);

                //two new parameter added on 05 apr 2015

                Double pn_part_est_amt;
                Double pn_opr_est_amt;

                //Response.Write("a1="+Request.QueryString["pn_part_est_amt"]+"a2==="+Request.QueryString["pn_opr_est_amt"]);
                if (Request.QueryString["pn_part_est_amt"] != "")
                {
                    pn_part_est_amt = Convert.ToDouble(Request.QueryString["pn_part_est_amt"]);
                    //Response.Write("pn_part_est_amtkk="+pn_part_est_amt);
                }
                else
                {
                    pn_part_est_amt = Convert.ToDouble(0.0);
                    //Response.Write("got some empty value1="+Convert.ToDouble(pn_part_est_amt));
                }

                if (Request.QueryString["pn_opr_est_amt"] != "")
                {
                    pn_opr_est_amt = Convert.ToDouble(Request.QueryString["pn_opr_est_amt"]);
                    //Response.Write("pn_opr_est_amtkk="+pn_opr_est_amt);
                }
                else
                {
                    pn_opr_est_amt = Convert.ToDouble(0.0);
                    //Response.Write("got some empty value2="+pn_opr_est_amt);
                }

                string rf_tag_num = Convert.ToString(Request.QueryString["rf_tag_num"]),
                       fcs_num = !string.IsNullOrEmpty(Request.QueryString["fcs_num"]) ? Convert.ToString(Request.QueryString["fcs_num"]) : "";
                string qr_code = !string.IsNullOrEmpty(Request.QueryString["qr_code"]) ? Convert.ToString(Request.QueryString["qr_code"]) : "";

                string custRemarks = Convert.ToString(Request.QueryString["cust_Remarks"]);
                string dlrRemarks = Convert.ToString(Request.QueryString["dlr_Remarks"]);
                string approvalStatus = Convert.ToString(Request.QueryString["approval_Status"]),
                       ew_Flag = !string.IsNullOrEmpty(Request.QueryString["ew_Flag"]) ? Convert.ToString(Request.QueryString["ew_Flag"]) : "",
                       ew_Type = !string.IsNullOrEmpty(Request.QueryString["ew_Type"]) ? Convert.ToString(Request.QueryString["ew_Type"]) : "",
                       mcp_Flag = !string.IsNullOrEmpty(Request.QueryString["mcp_Flag"]) ? Convert.ToString(Request.QueryString["mcp_Flag"]) : "",
                       mcp_Pckg = !string.IsNullOrEmpty(Request.QueryString["mcp_Pckg"]) ? Convert.ToString(Request.QueryString["mcp_Pckg"]) : "",
                       wash_Type = !string.IsNullOrEmpty(Request.QueryString["wash_Type"]) ? Convert.ToString(Request.QueryString["wash_Type"]) : "";

                string mms_Address = !string.IsNullOrEmpty(Request.QueryString["mms_Address"]) ? Convert.ToString(Request.QueryString["mms_Address"]) : "";
                string mms_City = !string.IsNullOrEmpty(Request.QueryString["mms_City"]) ? Convert.ToString(Request.QueryString["mms_City"]) : "";
                string mms_District = !string.IsNullOrEmpty(Request.QueryString["mms_District"]) ? Convert.ToString(Request.QueryString["mms_District"]) : "";
                string mms_State = !string.IsNullOrEmpty(Request.QueryString["mms_State"]) ? Convert.ToString(Request.QueryString["mms_State"]) : "";
                string mms_Pin = !string.IsNullOrEmpty(Request.QueryString["mms_Pin"]) ? Convert.ToString(Request.QueryString["mms_Pin"]) : "";
                int audioCnt = !string.IsNullOrEmpty(Request.QueryString["audio_Cnt"]) ? Convert.ToInt16(Request.QueryString["audio_Cnt"]) : 0;
                string jc_scan_type = !string.IsNullOrEmpty(Request.QueryString["scan_type"]) ? Convert.ToString(Request.QueryString["scan_type"]) : "";
                int ocas_cnt = !string.IsNullOrEmpty(Request.QueryString["ocas_cnt"]) ? Convert.ToInt32(Request.QueryString["ocas_cnt"]) : 0;
                int save_cnt = !string.IsNullOrEmpty(Request.QueryString["save_cnt"]) ? Convert.ToInt32(Request.QueryString["save_cnt"]) : 0;
                int sent_cnt = !string.IsNullOrEmpty(Request.QueryString["sent_cnt"]) ? Convert.ToInt32(Request.QueryString["sent_cnt"]) : 0;
                string final_Inspection = !string.IsNullOrEmpty(Request.QueryString["final_Ins"]) ? Convert.ToString(Request.QueryString["final_Ins"]) : "";
                string c_measure_refcur = !string.IsNullOrEmpty(Request.QueryString["c_measure_refcur"]) ? Convert.ToString(Request.QueryString["c_measure_refcur"]) : "";

                //Start new input parameter created Date 18-FEB-2021
                string BILLABLE_TYPE = !string.IsNullOrEmpty(Request.QueryString["BILLABLE_TYPE"]) ? Convert.ToString(Request.QueryString["BILLABLE_TYPE"]) : "",
                MI_NMI = !string.IsNullOrEmpty(Request.QueryString["MI_NMI"]) ? Convert.ToString(Request.QueryString["MI_NMI"]) : "",
                PANEL = !string.IsNullOrEmpty(Request.QueryString["PANEL"]) ? Convert.ToString(Request.QueryString["PANEL"]) : "",
                CUTTING_WELDING_YN = !string.IsNullOrEmpty(Request.QueryString["CUTTING_WELDING_YN"]) ? Convert.ToString(Request.QueryString["CUTTING_WELDING_YN"]) : "",
                PART_REPLACE_YN = !string.IsNullOrEmpty(Request.QueryString["PART_REPLACE_YN"]) ? Convert.ToString(Request.QueryString["PART_REPLACE_YN"]) : "",
                ENGINE_TRANSMISSION_YN = !string.IsNullOrEmpty(Request.QueryString["ENG_TRANS_YN"]) ? Convert.ToString(Request.QueryString["ENG_TRANS_YN"]) : "",
                FOR_CD = !string.IsNullOrEmpty(Request.QueryString["FOR_CD"]) ? Convert.ToString(Request.QueryString["FOR_CD"]) : "",
                SUGGESTED_PROMISE_DATE = !string.IsNullOrEmpty(Request.QueryString["SUGGESTED_PROMISE_DATE"]) ? Convert.ToString(Request.QueryString["SUGGESTED_PROMISE_DATE"]) : "";
                //End new input parameter created Date 18-FEB-2021

                //Start new inputs parameter created Date 01-April-2021
                string Tyres_Depth = !string.IsNullOrEmpty(Request.QueryString["Tyres_Depth"]) ? Convert.ToString(Request.QueryString["Tyres_Depth"]) : "";
                string Battery_Condition = !string.IsNullOrEmpty(Request.QueryString["Battery_Condition"]) ? Convert.ToString(Request.QueryString["Battery_Condition"]) : "";
                //End new inputs parameter created Date 01-April-2021

                //Start new inputs parameter created Date 01-JUNE-2021
                string Find_Id = !string.IsNullOrEmpty(Request.QueryString["Find_Id"]) ? Convert.ToString(Request.QueryString["Find_Id"]) : "";
                //Added new input parameter by GAGAn SHARMA 30MARCH2022
                string Recall_Type = !string.IsNullOrEmpty(Request.QueryString["Recall_Type"]) ? Convert.ToString(Request.QueryString["Recall_Type"]) : "";

                //Added pn_ccp_yn pn_ccp_num by gagan sharma 6MAY2022
                string pn_ccp_yn = !string.IsNullOrEmpty(Request.QueryString["pn_ccp_yn"]) ? Convert.ToString(Request.QueryString["pn_ccp_yn"]) : "";
                string pn_ccp_num = !string.IsNullOrEmpty(Request.QueryString["pn_ccp_num"]) ? Convert.ToString(Request.QueryString["pn_ccp_num"]) : "";
                string pn_holdup_reasn_cd = !string.IsNullOrEmpty(Request.QueryString["pn_holdup_reasn_cd"]) ? Convert.ToString(Request.QueryString["pn_holdup_reasn_cd"]) : "";
                //Added PN_CNG_TESTING_DUE ,PN_CNG_TESTING_DATE by gagan sharma 4JAN2023
                string CNG_TESTING_DUE = !string.IsNullOrEmpty(Request.QueryString["PN_CNG_TESTING_DUE"]) ? Convert.ToString(Request.QueryString["PN_CNG_TESTING_DUE"]) : "";
                string CNG_TESTING_DATE = !string.IsNullOrEmpty(Request.QueryString["PN_CNG_TESTING_DATE"]) ? Convert.ToString(Request.QueryString["PN_CNG_TESTING_DATE"]) : "";




                if (UserID101_new != null)
                {
                    string Result22_new = NewInsertAllDetails(RegNum101_new, UserID101_new, srv_cat_cd_new, sub_srv_type_cd, OMR11_new,
                                                              promised_date, checkin_date, sa_adv, tech_adv, bay_cd,
                                                              group_cd, omr_change, vts_card_num, tech_cd,
                                                              menu_ins_refcur, demand_ins_refcur, part_ins_refcur, labor_ins_refcur, inv_ins_refcur, mcard_ins_refcur, unapprv_fitment_refcur,
                                                              estm_str_refcur, Pick_Typ_new, Pick_Dat_new, Pick_Flag_new, Pick_Loc_new, Pick_Drv_new, Pick_Rem_new, mms_num_new, Emailid_new, Prob_str_new,
                                                              pn_part_est_amt, pn_opr_est_amt, rf_tag_num, fcs_num, qr_code, custRemarks, dlrRemarks, approvalStatus,
                                                              ew_Flag, ew_Type, mcp_Flag, mcp_Pckg, wash_Type, mms_Address, mms_City, mms_District, mms_State, mms_Pin, audioCnt, jc_scan_type, ocas_cnt,
                                                              save_cnt, sent_cnt, final_Inspection, c_measure_refcur, BILLABLE_TYPE, MI_NMI, PANEL, CUTTING_WELDING_YN, PART_REPLACE_YN,
                                                              ENGINE_TRANSMISSION_YN, FOR_CD, SUGGESTED_PROMISE_DATE, Tyres_Depth, Battery_Condition, Find_Id, Recall_Type, pn_ccp_yn, pn_ccp_num, CNG_TESTING_DUE, CNG_TESTING_DATE);
                    Response.Write(Result22_new);
                }
                else
                {
                    Response.Write("Null");
                }

                break;
            //----------------------------------------

            //-------------------------------written some cases on 22 may 2015-------------------------------

            case ("NewBillPrint"):
                string UserIDgstbill = Convert.ToString(Request.QueryString["UserID"]);
                string JobCardnobill = Convert.ToString(Request.QueryString["JCNumber"]);
                if (UserIDgstbill != null && JobCardnobill != null)
                {
                    string Result_new_bill = NewBillPrint(UserIDgstbill, JobCardnobill);
                    Response.Write(Result_new_bill);
                }
                else
                {
                    Response.Write("Null");
                }

                break;

            //----------------written some cases on 12 june 2015--------------------------------


            case ("UpdateJCDetails"):

                string Jcnum_up = Convert.ToString(Request.QueryString["jcnum"]);
                string UserIDGst_up = Convert.ToString(Request.QueryString["UserID"]);
                string srv_cat_cd_up = Convert.ToString(Request.QueryString["srv_cat_cd"]);
                string sub_srv_type_cd_up = Convert.ToString(Request.QueryString["sub_srv_type_cd"]);
                //CHANGES 06 SEPT 2022 BY GAGAN
                string promised_date_up = Helper.ConvertdateFormat(Convert.ToString(Request.QueryString["promised_date"]));
                string sa_adv_up = Convert.ToString(Request.QueryString["sa_adv"]);
                string tech_adv_up = Convert.ToString(Request.QueryString["tech_adv"]);
                string bay_cd_up = Convert.ToString(Request.QueryString["bay_cd"]);
                string group_cd_up = Convert.ToString(Request.QueryString["group_cd"]);
                string tech_cd_up = Convert.ToString(Request.QueryString["tech_cd"]);

                //get values of following cursor seperated by $, symbol

                string demand_ins_str_up = Convert.ToString(Request.QueryString["demand_ins_str"]);
                string part_ins_str_up = Convert.ToString(Request.QueryString["part_ins_str"]);
                string labor_ins_str_up = Convert.ToString(Request.QueryString["labor_ins_str"]);
                string unapprv_fit_str = Convert.ToString(Request.QueryString["unapprv_fit_str"]);

                string Pick_Typ_up = Convert.ToString(Request.QueryString["Pick_Typ"]);
                string Pick_Dat_up = Helper.ConvertdateFormat(Convert.ToString(Request.QueryString["Pick_Dat"]));
                string Pick_Flag_up = Convert.ToString(Request.QueryString["Pick_Flag"]);
                string Pick_Loc_up = Convert.ToString(Request.QueryString["Pick_Loc"]);
                string Pick_Drv_up = Convert.ToString(Request.QueryString["Pick_Drv"]);
                string Pick_Rem_up = Convert.ToString(Request.QueryString["Pick_Rem"]);
                string mms_num_up = Convert.ToString(Request.QueryString["mms_num"]);
                string prob_str_up = Convert.ToString(Request.QueryString["prob_str"]);

                string cust_Remarks = Convert.ToString(Request.QueryString["cust_Remarks"]);
                string dlr_Remarks = Convert.ToString(Request.QueryString["dlr_Remarks"]);
                string approval_Status = Convert.ToString(Request.QueryString["approval_Status"]);
                Double pn_part_est_amt1 = Convert.ToDouble(0.0);
                Double pn_opr_est_amt1 = Convert.ToDouble(0.0);
                string rejectedPartsOrLabourDetails = Convert.ToString(Request.QueryString["rpl_Dtls"]);

                if (Request.QueryString["pn_part_est_amt"] != "")
                {
                    pn_part_est_amt1 = Convert.ToDouble(Request.QueryString["pn_part_est_amt"]);
                }

                if (Request.QueryString["pn_opr_est_amt"] != "")
                {
                    pn_opr_est_amt1 = Convert.ToDouble(Request.QueryString["pn_opr_est_amt"]);
                }

                wash_Type = !string.IsNullOrEmpty(Request.QueryString["wash_Type"]) ? Convert.ToString(Request.QueryString["wash_Type"]) : "";

                ocas_cnt = !string.IsNullOrEmpty(Request.QueryString["ocas_cnt"]) ? Convert.ToInt32(Request.QueryString["ocas_cnt"]) : 0;
                save_cnt = !string.IsNullOrEmpty(Request.QueryString["save_cnt"]) ? Convert.ToInt32(Request.QueryString["save_cnt"]) : 0;
                sent_cnt = !string.IsNullOrEmpty(Request.QueryString["sent_cnt"]) ? Convert.ToInt32(Request.QueryString["sent_cnt"]) : 0;

                final_Inspection = !string.IsNullOrEmpty(Request.QueryString["final_Ins"]) ? Convert.ToString(Request.QueryString["final_Ins"]) : "";
                string addChk = !string.IsNullOrEmpty(Request.QueryString["addChk"]) ? Convert.ToString(Request.QueryString["addChk"]) : "";

                ////Added pn_ccp_yn pn_ccp_num by gagan sharma 6MAY2022
                string pn_ccp = !string.IsNullOrEmpty(Request.QueryString["pn_ccp_yn"]) ? Convert.ToString(Request.QueryString["pn_ccp_yn"]) : "";
                string ccp_Num = !string.IsNullOrEmpty(Request.QueryString["pn_ccp_num"]) ? Convert.ToString(Request.QueryString["pn_ccp_num"]) : "";
                string holdup_reasn_cd = !string.IsNullOrEmpty(Request.QueryString["pn_holdup_reasn_cd"]) ? Convert.ToString(Request.QueryString["pn_holdup_reasn_cd"]) : "";

                if (UserIDGst_up != null)
                {
                    string Result22_updt = UpdateJCDetails(Jcnum_up, UserIDGst_up, srv_cat_cd_up, sub_srv_type_cd_up,
                                                           promised_date_up, sa_adv_up, tech_adv_up, bay_cd_up, group_cd_up, tech_cd_up,
                                                           demand_ins_str_up, part_ins_str_up, labor_ins_str_up, unapprv_fit_str,
                                                           Pick_Typ_up, Pick_Dat_up, Pick_Flag_up, Pick_Loc_up, Pick_Drv_up, Pick_Rem_up, mms_num_up, prob_str_up,
                                                           cust_Remarks, dlr_Remarks, approval_Status, pn_part_est_amt1, pn_opr_est_amt1, rejectedPartsOrLabourDetails,
                                                           wash_Type, ocas_cnt, save_cnt, sent_cnt, final_Inspection, addChk, pn_ccp, ccp_Num, holdup_reasn_cd);
                    Response.Write(Result22_updt);
                }


                else
                {
                    Response.Write("Null");
                }

                break;
            //------------------------------------------------


            /*
            http://localhost/MarutiServiceDev/JCOService.aspx?func=GetJCOpenDetails&jc_module=O&UserID=test.tab1&parent_group=99999&dealer_map_cd=99999&loc_cd=999&comp_fa=999&jcno=JC15000045
            {"S":"1","M":"ORA-06550: line 1, column 7: PLS-00306: wrong number or types of arguments in call to 'SP_JCO_GET_JC_OPEN_DTL' ORA-06550: line 1, column 7: PL/SQL: Statement ignored"}
            */
            case ("GetJCOpenDetails"):
                string Jcmodule = Convert.ToString(Request.QueryString["jc_module"]);//O for opening screen, B for closing/Billing screen
                string UserIDgst29 = Convert.ToString(Request.QueryString["UserID"]);
                string Parent_group = Convert.ToString(Request.QueryString["parent_group"]);
                Int32 Dealer_map_cd = !(string.IsNullOrEmpty(Request.QueryString["dealer_map_cd"])) ? Convert.ToInt32(Request.QueryString["dealer_map_cd"]) : 0;// Convert.ToInt32(Request.QueryString["dealer_map_cd"]);
                string Loc_Cd = Convert.ToString(Request.QueryString["loc_cd"]);
                string Comp_fa = Convert.ToString(Request.QueryString["comp_fa"]);
                string Jcno = Convert.ToString(Request.QueryString["jcno"]);
                if (UserIDgst29 != null && Jcmodule != null && Parent_group != null && Dealer_map_cd != null && Loc_Cd != null && Comp_fa != null && Jcno != null)
                {
                    //Response.Write("UserIDgst29="+UserIDgst29+"<br/>"+"Jcmodule="+Jcmodule+"<br/>"+"Parent_group="+Parent_group+"<br/>"
                    //+"Dealer_map_cd="+Dealer_map_cd+"<br/>"+"Loc_Cd="+Loc_Cd+"<br/>"+"Comp_fa="+Comp_fa+"<br/>"+"Jcno="+Jcno);

                    string ResultGJCODTL = GetJCOpenDetails(Jcmodule, UserIDgst29, Parent_group, Dealer_map_cd, Loc_Cd, Comp_fa, Jcno);
                    //string ResultGJCODTL = dbHelper.GetJCOpenDetails(Jcmodule, UserIDgst29, Parent_group, Dealer_map_cd, Loc_Cd, Comp_fa, Jcno);
                    Response.Write(ResultGJCODTL);
                }
                else
                {
                    Response.Write("Null");
                }

                break;

            //----------------------------------------------------workshop fns written on 26/06/2015-------------------------------

            case ("GetWStoreDetails"):
                /*
                http://localhost/MarutiServiceDev/JCOService.aspx?func=GetWStoreDetails&UserID=test.tab1&parent_grp=99999&dealer_map_cd=99999&loc_cd=999&comp_fa=999
                got result as tested on 26 jun 2015
                */
                string UserIDgstW1 = Convert.ToString(Request.QueryString["UserID"]);
                string parent_grpW = Convert.ToString(Request.QueryString["parent_grp"]);
                Int32 dealer_map_cdW = Convert.ToInt32(Request.QueryString["dealer_map_cd"]);
                string loc_cdW = Convert.ToString(Request.QueryString["loc_cd"]);
                string Comp_fa_store = Convert.ToString(Request.QueryString["comp_fa"]);
                if (UserIDgstW1 != null)
                {
                    string Result_GSTRDTL = GetWStoreDetails(UserIDgstW1, parent_grpW, dealer_map_cdW, loc_cdW, Comp_fa_store);
                    Response.Write(Result_GSTRDTL);
                }
                break;
            //*******************************				 

            case ("GetBillableType"):
                /*
                http://localhost/MarutiServiceDev/JCOService.aspx?func=GetBillableType&UserID=test.tab1&parent_grp=99999&dealer_map_cd=99999&loc_cd=999&comp_fa=999
                got result as tested on 26 jun 2015
                */
                string UserIDgstW8 = Convert.ToString(Request.QueryString["UserID"]);
                string parent_grpW8 = Convert.ToString(Request.QueryString["parent_grp"]);
                Int32 dealer_map_cdW8 = Convert.ToInt32(Request.QueryString["dealer_map_cd"]);
                string loc_cdW8 = Convert.ToString(Request.QueryString["loc_cd"]);
                string Comp_fa4 = Convert.ToString(Request.QueryString["comp_fa"]);
                if (UserIDgstW8 != null)
                {
                    string Result_GBTYPE = GetBillableType(UserIDgstW8, parent_grpW8, dealer_map_cdW8, loc_cdW8, Comp_fa4);
                    Response.Write(Result_GBTYPE);
                }
                break;
            //*******************************		
            //----------------------------workshop fns written on 29 jun 2015-----------------------------


            case ("GetReqHdrW"):
                /*
                http://localhost/MarutiServiceDev/JCOService.aspx?func=GetReqHdrW&UserID=test.tab1&parent_grp=99999&dealer_map_cd=99999&loc_cd=999&comp_fa=999&jcnum=JC15000050
                got result as tested on 29 jun 2015
                */
                string UserIDgstW11 = Convert.ToString(Request.QueryString["UserID"]);
                string parent_grpW11 = Convert.ToString(Request.QueryString["parent_grp"]);
                Int32 dealer_map_cdW11 = Convert.ToInt32(Request.QueryString["dealer_map_cd"]);
                string loc_cdW11 = Convert.ToString(Request.QueryString["loc_cd"]);
                string Comp_fa11 = Convert.ToString(Request.QueryString["comp_fa"]);
                string Jcno2 = Convert.ToString(Request.QueryString["jcnum"]);

                if (UserIDgstW11 != null)
                {
                    string Result_GRHDR = GetReqHdrW(UserIDgstW11, parent_grpW11, dealer_map_cdW11, loc_cdW11, Comp_fa11, Jcno2);
                    Response.Write(Result_GRHDR);
                }
                else
                {
                    Response.Write("Null UserName");
                }

                break;

            //--*****************************************

            case ("GetReqDetailsW"):
                /*
                http://localhost/MarutiServiceDev/JCOService.aspx?func=GetReqDetailsW&UserID=test.tab1&parent_grp=99999&dealer_map_cd=99999&loc_cd=999&comp_fa=999&req_no=WR15000015&store_cd=122
                got error as tested on 29 jun 2015
                {"S":"1","M":"ORA-08103: object no longer exists"}
                */

                string UserIDgstW4 = Convert.ToString(Request.QueryString["UserID"]);
                string parent_grpW3 = Convert.ToString(Request.QueryString["parent_grp"]);
                Int32 dealer_map_cdW3 = Convert.ToInt32(Request.QueryString["dealer_map_cd"]);
                string loc_cdW3 = Convert.ToString(Request.QueryString["loc_cd"]);
                string Comp_fa1 = Convert.ToString(Request.QueryString["comp_fa"]);
                string Reqno = Convert.ToString(Request.QueryString["req_no"]);
                string store_cdW = Convert.ToString(Request.QueryString["store_cd"]);


                if (UserIDgstW4 != null)
                {
                    string Result_GRDTLW = GetReqDetailsW(UserIDgstW4, parent_grpW3, dealer_map_cdW3, loc_cdW3, Comp_fa1, Reqno, store_cdW);
                    Response.Write(Result_GRDTLW);
                }
                else
                {
                    Response.Write("Null UserName");
                }

                break;

            //--*****************************************
            case ("GetAltPartW"):
                /*
                http://localhost/MarutiServiceDev/JCOService.aspx?func=GetAltPartW&UserID=test.tab1&parent_grp=99999&dealer_map_cd=99999&loc_cd=999&comp_fa=999&part_no=1234
                */
                string UserIDgstW6 = Convert.ToString(Request.QueryString["UserID"]);
                string parent_grpW6 = Convert.ToString(Request.QueryString["parent_grp"]);
                Int32 dealer_map_cdW6 = Convert.ToInt32(Request.QueryString["dealer_map_cd"]);
                string loc_cdW6 = Convert.ToString(Request.QueryString["loc_cd"]);
                string Comp_fa2 = Convert.ToString(Request.QueryString["comp_fa"]);
                string Partno = Convert.ToString(Request.QueryString["part_no"]);

                if (UserIDgstW6 != null)
                {
                    string Result_GAPRT = GetAltPartW(UserIDgstW6, parent_grpW6, dealer_map_cdW6, loc_cdW6, Comp_fa2, Partno);
                    Response.Write(Result_GAPRT);
                }
                else
                {
                    Response.Write("Null UserName");
                }

                break;

            //--*****************************************
            case ("GetPartBinStockW"):

                /*
                http://localhost/MarutiServiceDev/JCOService.aspx?func=GetPartBinStockW&UserID=test.tab1&parent_grp=99999&dealer_map_cd=99999&loc_cd=999&comp_fa=999&store_cd=122&part_no=99000M24120-00N 
                {"S":"0","GPBS":[]}
	
                */
                string UserIDgstW7 = Convert.ToString(Request.QueryString["UserID"]);
                string parent_grpW7 = Convert.ToString(Request.QueryString["parent_grp"]);
                Int32 dealer_map_cdW7 = Convert.ToInt32(Request.QueryString["dealer_map_cd"]);
                string loc_cdW7 = Convert.ToString(Request.QueryString["loc_cd"]);
                string Comp_fa3 = Convert.ToString(Request.QueryString["comp_fa"]);
                string Store_cd = Convert.ToString(Request.QueryString["store_cd"]);
                string Partno1 = Convert.ToString(Request.QueryString["part_no"]);

                if (UserIDgstW7 != null)
                {
                    string Result_GPBS = GetPartBinStockW(UserIDgstW7, parent_grpW7, dealer_map_cdW7, loc_cdW7, Comp_fa3, Store_cd, Partno1);
                    Response.Write(Result_GPBS);
                }
                else
                {
                    Response.Write("Null UserName");
                }

                break;

            //--*****************************************
            case ("ValidtateBillTypeW"):
                /*
          http://localhost/MarutiServiceDev/JCOService.aspx?func=ValidtateBillTypeW&UserID=test.tab1&parent_grp=99999&dealer_map_cd=99999&loc_cd=999&comp_fa=999&jcnum=JC15000015&partno=99000M24120-00N&bill_type_cd=CUS
                {"S":"1","M":"Job Card Number Not Found||Part Not Found||Bill Type Not Found"}
                got result as tested on 29 jun 2015. need actual input values.
                */
                string UserIDgstW9 = Convert.ToString(Request.QueryString["UserID"]);
                string parent_grpW9 = Convert.ToString(Request.QueryString["parent_grp"]);
                Int32 dealer_map_cdW9 = Convert.ToInt32(Request.QueryString["dealer_map_cd"]);
                string loc_cdW9 = Convert.ToString(Request.QueryString["loc_cd"]);
                string Comp_fa5 = Convert.ToString(Request.QueryString["comp_fa"]);
                string Jcno12 = Convert.ToString(Request.QueryString["jcnum"]);
                string Partno2 = Convert.ToString(Request.QueryString["partno"]);
                string BillTypecd = Convert.ToString(Request.QueryString["bill_type_cd"]);

                if (UserIDgstW9 != null)
                {
                    string Result_VBT = ValidtateBillTypeW(UserIDgstW9, parent_grpW9, dealer_map_cdW9, loc_cdW9, Comp_fa5, Jcno12, Partno2, BillTypecd);
                    Response.Write(Result_VBT);
                }
                else
                {
                    Response.Write("null ");
                }
                break;
            //**********************************			
            //written as on 21 july 2015

            case ("InsertIssueDetailsW"):
                /*
                http://localhost/MarutiServiceDev/JCOService.aspx?func=InsertIssueDetailsW&UserID=mul.mssd.sa7&parent_group=9999&dealer_map_cd=444&loc_cd=ddd&comp_fa=c1c1&jc_num=1544254&store_Cd=122&req_ins_str_refcur=154$111$;
                */
                string UserIDGst_W = Convert.ToString(Request.QueryString["UserID"]);
                string parent_grp_w = Convert.ToString(Request.QueryString["parent_group"]);
                Int32 dealer_map_cd_W = Convert.ToInt32(Request.QueryString["dealer_map_cd"]);
                string loc_Cd_W = Convert.ToString(Request.QueryString["loc_cd"]);
                string comp_fa_W = Convert.ToString(Request.QueryString["comp_fa"]);
                string jc_num_W = Convert.ToString(Request.QueryString["jc_num"]);
                string store_Cd_W = Convert.ToString(Request.QueryString["store_cd"]);

                //get cursor variable as  input seperated by $ symbol

                string req_ins_str_W = Convert.ToString(Request.QueryString["req_ins_str_refcur"]);

                /*Response.Write("UserIDGst_W="+UserIDGst_W+"<br/>"+"parent_grp_w="+parent_grp_w+"<br/>"+
                "dealer_map_cd_W="+dealer_map_cd_W+"<br/>"+"loc_Cd_W="+loc_Cd_W+"<br/>"+"comp_fa_W="+comp_fa_W+"<br/>"+"jc_num_W="+jc_num_W+"<br/>"+
                "store_Cd_W="+store_Cd_W+"<br/>"+"req_ins_str_W="+req_ins_str_W+"<br/><br/>");*/

                if (UserIDGst_W != null)
                {
                    string Result22_ins_iss_W = InsertIssueDetailsW(UserIDGst_W, parent_grp_w, dealer_map_cd_W,
                                                             loc_Cd_W, comp_fa_W, jc_num_W, store_Cd_W, req_ins_str_W);

                    Response.Write(Result22_ins_iss_W);
                }
                else
                {
                    Response.Write("Null");
                }

                break;
            //------------------------------------------------
            //new fn added by gst on 2 aug 2016

            case ("GetWhissDetailsW"):

                string UserIDgst32 = Convert.ToString(Request.QueryString["UserID"]);
                string Parent_group32 = Convert.ToString(Request.QueryString["Parent_group"]);
                Int32 Dealer_map_cd32 = Convert.ToInt32(Request.QueryString["Dealer_map_cd"]);
                string Loc_Cd32 = Convert.ToString(Request.QueryString["Loc_Cd"]);
                string Comp_fa32 = Convert.ToString(Request.QueryString["Comp_fa"]);
                string issno32 = Convert.ToString(Request.QueryString["issno"]);
                if (UserIDgst32 != null && Parent_group32 != null && Dealer_map_cd32 != null && Loc_Cd32 != null && Comp_fa32 != null && issno32 != null)
                {
                    //Response.Write("UserIDgst32="+UserIDgst32+"<br/>"+"Jcmodule="+Jcmodule+"<br/>"+"Parent_group32="+Parent_group32+"<br/>"
                    //+"Dealer_map_cd32="+Dealer_map_cd32+"<br/>"+"Loc_Cd32="+Loc_Cd32+"<br/>"+"Comp_fa32="+Comp_fa32+"<br/>"+"issno32="+issno32);
                    string ResultGWSIDTL32 = GetWhissDetailsW(UserIDgst32, Parent_group32, Dealer_map_cd32, Loc_Cd32, Comp_fa32, issno32);
                    Response.Write(ResultGWSIDTL32);
                }
                else
                {
                    Response.Write("Null");
                }

                break;

            //-------------------------------------------------------------------------------------------------------------------------------------



            //-----------------end of workshop module cases---------------------

            case ("InsertEstmDetails"):

                string UserIDGst_estm = Convert.ToString(Request.QueryString["UserID"]);
                string Est_type_cd = Convert.ToString(Request.QueryString["est_type_cd"]);
                string Srv_type_cd_estm = Convert.ToString(Request.QueryString["srv_type_cd"]);
                string Sale_type_cd = Convert.ToString(Request.QueryString["sale_type_cd"]);
                string Regnum_estm = Convert.ToString(Request.QueryString["RegNum"]);
                string omr_estm = Convert.ToString(Request.QueryString["omr"]);
                string Remarks_estm = Convert.ToString(Request.QueryString["remarks"]);
                string Estm_days = Convert.ToString(Request.QueryString["estm_days"]);
                string Estm_hrs = Convert.ToString(Request.QueryString["estm_hrs"]);
                string Part_disc_estm = Convert.ToString(Request.QueryString["part_disc"]);
                string Labor_disc_estm = Convert.ToString(Request.QueryString["labor_disc"]);

                //get values of following cursor seperated by $ symbol

                string Part_refcur_estm = Convert.ToString(Request.QueryString["part_ins_str"]);
                string Labor_refcur_estm = Convert.ToString(Request.QueryString["labor_ins_str"]);
                //-----------------
                string pn_insr_name_estm = Convert.ToString(Request.QueryString["pn_insr_name"]);
                string pn_insr_branch_estm = Convert.ToString(Request.QueryString["pn_insr_branch"]);
                string pn_insr_add1_estm = Convert.ToString(Request.QueryString["pn_insr_add1"]);
                string pn_insr_add2_estm = Convert.ToString(Request.QueryString["pn_insr_add2"]);
                string pn_insr_add3_estm = Convert.ToString(Request.QueryString["pn_insr_add3"]);
                string pn_driver_name_estm = Convert.ToString(Request.QueryString["pn_driver_name"]);
                string pn_dl_num_estm = Convert.ToString(Request.QueryString["pn_dl_num"]);
                string pn_dl_exp_date_estm = Convert.ToString(Request.QueryString["pn_dl_exp_date"]);

                string pn_policy_num_estm = Convert.ToString(Request.QueryString["pn_policy_num"]);
                string policy_exp_date_estm = Convert.ToString(Request.QueryString["pn_policy_exp_date"]);
                string surveyor_name_estm = Convert.ToString(Request.QueryString["pn_surveyor_name"]);
                string surv_int_date_estm = Convert.ToString(Request.QueryString["pn_surv_int_date"]);
                string accident_place_estm = Convert.ToString(Request.QueryString["pn_accident_place"]);
                string accident_date_estm = Convert.ToString(Request.QueryString["pn_accident_date"]);
                string pn_fir_num_estm = Convert.ToString(Request.QueryString["pn_fir_num"]);
                string pn_fir_date_estm = Convert.ToString(Request.QueryString["pn_fir_date"]);


                if (UserIDGst_estm != null)
                {
                    string Result22_estm = InsertEstmDetails(UserIDGst_estm, Est_type_cd, Srv_type_cd_estm, Sale_type_cd,
                                                             Regnum_estm, omr_estm, Remarks_estm, Estm_days, Estm_hrs,
                                                             Part_disc_estm, Labor_disc_estm, Part_refcur_estm, Labor_refcur_estm,
                                                             pn_insr_name_estm, pn_insr_branch_estm, pn_insr_add1_estm, pn_insr_add2_estm,
                                                             pn_insr_add3_estm, pn_driver_name_estm, pn_dl_num_estm, pn_dl_exp_date_estm,
                                                             pn_policy_num_estm, policy_exp_date_estm, surveyor_name_estm, surv_int_date_estm,
                                                             accident_place_estm, accident_date_estm, pn_fir_num_estm, pn_fir_date_estm);
                    Response.Write(Result22_estm);
                }
                else
                {
                    Response.Write("Null");
                }

                break;
            //------------------------------------------------
            //------------------------------------written some cases on 1 july 2015--------------
            //-----written some new cases on 1 aug 2015------
            case ("GetJCOpenEstmDetails"):
                /*
			  
                http://localhost/MarutiServiceDev/JCOService.aspx?func=GetJCOpenEstmDetails&UserID=mssd.sa4&EstType=R&EstNum=ES16000005&SuppNo=0
                */
                string UserIDgstestm = Convert.ToString(Request.QueryString["UserID"]);
                string pn_estm_type = Convert.ToString(Request.QueryString["EstType"]);
                string pn_estm_no = Convert.ToString(Request.QueryString["EstNum"]);
                Int32 pn_estm_suppno = Convert.ToInt32(Request.QueryString["SuppNo"]);



                if (UserIDgstestm != null && pn_estm_no != null)
                {
                    //Response.Write("UserIDgstestm="+UserIDgstestm+"<br/>"+"pn_estm_type="+pn_estm_type+"<br/>"+"pn_estm_no="+pn_estm_no+"<br/>"
                    //+"pn_estm_suppno="+pn_estm_suppno+"<br/>");

                    string ResultEstmDtl = GetJCOpenEstmDetails(UserIDgstestm, pn_estm_type, pn_estm_no, pn_estm_suppno);
                    Response.Write(ResultEstmDtl);
                }
                else
                {
                    Response.Write("Null");
                }

                break;
            //-------------------------***************************************--------
            case ("CalculateEstmCharges"):
                /*
                http://localhost/MarutiServiceDev/JCOService.aspx?func=CalculateEstmCharges&UserID=binay.0909&estm_type_cd=E&srv_Type_cd=PMS&sale_type_cd=Y&reg_num=HR26CG0368&part_disc=0&labor_disc=0&part_ins_str=16510-61A21$,FILTER%20ASSY,%20OIL$,1$,$,$,$,$;16510-61A31$,FILTER%20ASSY,OIL$,1$,$,$,P$,10$;16510M55K00$,FILTER%20ASSY,OIL$,1$,$,$,A$,50$;16510M86J20$,OIL%20FILTER$,1$,$,$,$,&labor_ins_str=ZA02L1$,FUEL%20TANK%20CLEANING$,100$,$,$;ZA44L0$,GENERAL%20CHECK-UP$,100$,$,$;ZE12L0$,PAID%20SERVICE%20-%2030K/50K/70K/90K/110K$,100$,$,$;ZE13L0$,PAID%20SERVICE%20-%2020K/60K/100K$,100$,$,
                */

                string UserIDgstestm1 = Convert.ToString(Request.QueryString["UserID"]);
                string estm_type_cd = Convert.ToString(Request.QueryString["estm_type_cd"]);
                string srv_Type_cd_E = Convert.ToString(Request.QueryString["srv_Type_cd"]);
                string sale_type_cd_estm = Convert.ToString(Request.QueryString["sale_type_cd"]);
                string reg_num_estm = Convert.ToString(Request.QueryString["reg_num"]);
                Int32 part_disc = Convert.ToInt32(Request.QueryString["part_disc"]);
                Int32 labor_disc = Convert.ToInt32(Request.QueryString["labor_disc"]);
                string part_ins_str = Convert.ToString(Request.QueryString["part_ins_str"]);
                string labor_ins_str = Convert.ToString(Request.QueryString["labor_ins_str"]);


                if (UserIDgstestm1 != null && estm_type_cd != null && srv_Type_cd_E != null && sale_type_cd_estm != null)
                {
                    /*Response.Write("UserIDgstestm="+UserIDgstestm1+"<br/>"+"estm_type_cd="+estm_type_cd+"<br/>"+"srv_Type_cd_E="+srv_Type_cd_E+"<br/>"
                    +"sale_type_cd_estm="+sale_type_cd_estm+"<br/>"+"reg_num_estm="+reg_num_estm+"<br/>"+"part_disc="+part_disc+"<br/>"
                    +"labor_disc="+labor_disc+"<br/>"+"part_ins_str="+part_ins_str+"<br/>"+"labor_ins_str="+labor_ins_str+"<br/>");*/

                    string ResultEstmchr = CalculateEstmCharges(UserIDgstestm1, estm_type_cd, srv_Type_cd_E, sale_type_cd_estm,
                                                                reg_num_estm, part_disc, labor_disc, part_ins_str, labor_ins_str);
                    Response.Write(ResultEstmchr);
                }
                else
                {
                    Response.Write("Null");
                }

                break;
            //-------------------------***************************************--------
            //-----jco_close cases starts here as on 4 aug 2015-----------

            case ("GetDelayReasonJC"):
                /*
  http://localhost/MarutiServiceDev/JCOService.aspx?func=GetDelayReasonJC&UserID=test.tab1&parent_grp=99999&dealer_map_cd=99999&loc_cd=999&comp_fa=999
			   
                */
                string UserIDgstjc = Convert.ToString(Request.QueryString["UserID"]);
                string parent_grpjc = Convert.ToString(Request.QueryString["parent_grp"]);
                Int32 dealer_map_cdjc = Convert.ToInt32(Request.QueryString["dealer_map_cd"]);
                string loc_cdjc = Convert.ToString(Request.QueryString["loc_cd"]);
                string Comp_fa_jc = Convert.ToString(Request.QueryString["comp_fa"]);
                if (UserIDgstjc != null)
                {
                    string Result_GDR = GetDelayReasonJC(UserIDgstjc, parent_grpjc, dealer_map_cdjc, loc_cdjc, Comp_fa_jc);
                    Response.Write(Result_GDR);
                }
                break;
            //*******************************
            case ("GetCsiReasonJC"):
                /*
 http://localhost/MarutiServiceDev/JCOService.aspx?func=GetCsiReasonJC&UserID=test.tab1&parent_grp=99999&dealer_map_cd=99999&loc_cd=999&comp_fa=999
                got result as tested on 04 aug 2015
                */
                string UserIDgstjc1 = Convert.ToString(Request.QueryString["UserID"]);
                string parent_grpjc1 = Convert.ToString(Request.QueryString["parent_grp"]);
                Int32 dealer_map_cdjc1 = Convert.ToInt32(Request.QueryString["dealer_map_cd"]);
                string loc_cdjc1 = Convert.ToString(Request.QueryString["loc_cd"]);
                string Comp_fa_jc1 = Convert.ToString(Request.QueryString["comp_fa"]);
                if (UserIDgstjc1 != null)
                {
                    string Result_GCSIR = GetCsiReasonJC(UserIDgstjc1, parent_grpjc1, dealer_map_cdjc1, loc_cdjc1, Comp_fa_jc1);
                    Response.Write(Result_GCSIR);
                }
                break;
            //*******************************	
            case ("GetDiscAuthJC"):
                /*
                got result as tested on 04 aug 2015
                http://localhost/MarutiServiceDev/JCOService.aspx?func=GetDiscAuthJC&UserID=test.tab1&parent_grp=99999&dealer_map_cd=99999&loc_cd=999&comp_fa=999
		
                */
                string UserIDgstjc2 = Convert.ToString(Request.QueryString["UserID"]);
                string parent_grpjc2 = Convert.ToString(Request.QueryString["parent_grp"]);
                Int32 dealer_map_cdjc2 = Convert.ToInt32(Request.QueryString["dealer_map_cd"]);
                string loc_cdjc2 = Convert.ToString(Request.QueryString["loc_cd"]);
                string Comp_fa_jc2 = Convert.ToString(Request.QueryString["comp_fa"]);
                if (UserIDgstjc2 != null)
                {
                    string Result_GDAB = GetDiscAuthJC(UserIDgstjc2, parent_grpjc2, dealer_map_cdjc2, loc_cdjc2, Comp_fa_jc2);
                    Response.Write(Result_GDAB);
                }
                break;
            //*******************************	
            case ("GetDemandLovJC"):
                /*
                http://localhost/MarutiServiceDev/JCOService.aspx?func=GetDemandLovJC&UserID=test.tab1&parent_grp=99999&dealer_map_cd=99999&loc_cd=999&comp_fa=999&jcno=
			   
                */
                string UserIDgstjc3 = Convert.ToString(Request.QueryString["UserID"]);
                string parent_grpjc3 = Convert.ToString(Request.QueryString["parent_grp"]);
                Int32 dealer_map_cdjc3 = Convert.ToInt32(Request.QueryString["dealer_map_cd"]);
                string loc_cdjc3 = Convert.ToString(Request.QueryString["loc_cd"]);
                string Comp_fa_jc3 = Convert.ToString(Request.QueryString["comp_fa"]);
                string jcno3 = Convert.ToString(Request.QueryString["jcno"]);
                if (UserIDgstjc3 != null)
                {
                    string Result_Gdmlov = GetDemandLovJC(UserIDgstjc3, parent_grpjc3, dealer_map_cdjc3, loc_cdjc3, Comp_fa_jc3, jcno3);
                    Response.Write(Result_Gdmlov);
                }
                break;
            //*******************************	
            case ("GetProblemLovJC"):
                /*
 got result as tested on 4 aug 2015			   
 http://localhost/MarutiServiceDev/JCOService.aspx?func=GetProblemLovJC&UserID=test.tab1&parent_grp=99999&dealer_map_cd=99999&loc_cd=999&comp_fa=999
			   
                */
                string UserIDgstjc4 = Convert.ToString(Request.QueryString["UserID"]);
                string parent_grpjc4 = Convert.ToString(Request.QueryString["parent_grp"]);
                Int32 dealer_map_cdjc4 = Convert.ToInt32(Request.QueryString["dealer_map_cd"]);
                string loc_cdjc4 = Convert.ToString(Request.QueryString["loc_cd"]);
                string Comp_fa_jc4 = Convert.ToString(Request.QueryString["comp_fa"]);

                if (UserIDgstjc4 != null)
                {
                    string Result_Gproblov = GetProblemLovJC(UserIDgstjc4, parent_grpjc4, dealer_map_cdjc4, loc_cdjc4, Comp_fa_jc4);
                    Response.Write(Result_Gproblov);
                }
                break;
            //*******************************				 
            case ("GetFaultLovJC"):
                /*	
            got result as tested on 4 aug 2015	
             http://localhost/MarutiServiceDev/JCOService.aspx?func=GetFaultLovJC&UserID=test.tab1&parent_grp=99999&dealer_map_cd=99999&loc_cd=999&comp_fa=999&problem_cd=SP0
                    */
                string UserIDgstjc5 = Convert.ToString(Request.QueryString["UserID"]);
                string parent_grpjc5 = Convert.ToString(Request.QueryString["parent_grp"]);
                Int32 dealer_map_cdjc5 = Convert.ToInt32(Request.QueryString["dealer_map_cd"]);
                string loc_cdjc5 = Convert.ToString(Request.QueryString["loc_cd"]);
                string Comp_fa_jc5 = Convert.ToString(Request.QueryString["comp_fa"]);
                string prob_cd_jc5 = Convert.ToString(Request.QueryString["problem_cd"]);
                if (UserIDgstjc5 != null)
                {
                    string Result_Gfaltlov = GetFaultLovJC(UserIDgstjc5, parent_grpjc5, dealer_map_cdjc5, loc_cdjc5, Comp_fa_jc5, prob_cd_jc5);
                    Response.Write(Result_Gfaltlov);
                }
                break;
            //*******************************				 

            case ("GetActionLovJC"):
                /*
  http://localhost/MarutiServiceDev/JCOService.aspx?func=GetActionLovJC&UserID=vinod.okf&parent_grp=MARSM&dealer_map_cd=10744&loc_cd=OKF&comp_fa=MSM&problem_cd=SN2&fault_cd=D1
			   
                */
                string UserIDgstjc6 = Convert.ToString(Request.QueryString["UserID"]);
                string parent_grpjc6 = Convert.ToString(Request.QueryString["parent_grp"]);
                Int32 dealer_map_cdjc6 = Convert.ToInt32(Request.QueryString["dealer_map_cd"]);
                string loc_cdjc6 = Convert.ToString(Request.QueryString["loc_cd"]);
                string Comp_fa_jc6 = Convert.ToString(Request.QueryString["comp_fa"]);
                string prob_cd_jc6 = Convert.ToString(Request.QueryString["problem_cd"]);
                string fault_cd_jc6 = Convert.ToString(Request.QueryString["fault_cd"]);

                if (UserIDgstjc6 != null)
                {
                    string Result_Gactionlov = GetActionLovJC(UserIDgstjc6, parent_grpjc6, dealer_map_cdjc6, loc_cdjc6, Comp_fa_jc6, prob_cd_jc6, fault_cd_jc6);
                    Response.Write(Result_Gactionlov);
                }
                break;
            //*******************************				 
            // these fn added on 11 aug 2015
            case ("GetDiscIndJC"):
                /* on 11 aug 2015			   
 http://localhost/MarutiServiceDev/JCOService.aspx?func=GetDiscIndJC 
 */
                string Result_Gdiscind = GetDiscIndJC();
                Response.Write(Result_Gdiscind);

                break;
            //*******************************
            //added these fn on 17 aug	
            case ("GetTechCampRsJC"):
                /*
 http://localhost/MarutiServiceDev/JCOService.aspx?func=GetTechCampRsJC&UserID=vinod.okf&parent_grp=MARSM&dealer_map_cd=10744&loc_cd=OKF&comp_fa=MSM&jcno=JC15016196&mul_ref_num=D-15/2015

                */
                string UserIDgstjc7 = Convert.ToString(Request.QueryString["UserID"]);
                string parent_grpjc7 = Convert.ToString(Request.QueryString["parent_grp"]);
                Int32 dealer_map_cdjc7 = Convert.ToInt32(Request.QueryString["dealer_map_cd"]);
                string loc_cdjc7 = Convert.ToString(Request.QueryString["loc_cd"]);
                string Comp_fa_jc7 = Convert.ToString(Request.QueryString["comp_fa"]);
                string jcnum_jc7 = Convert.ToString(Request.QueryString["jcno"]);
                string mul_ref_num_jc7 = Convert.ToString(Request.QueryString["mul_ref_num"]);

                if (UserIDgstjc7 != null)
                {
                    string Result_Gtcmprs = GetTechCampRsJC(UserIDgstjc7, parent_grpjc7, dealer_map_cdjc7, loc_cdjc7, Comp_fa_jc7, jcnum_jc7, mul_ref_num_jc7);
                    Response.Write(Result_Gtcmprs);
                }
                break;
            //*******************************				 
            case ("ValidateBillTypeLabourJC"):
                /*
              http://localhost/MarutiServiceDev/JCOService.aspx?func=ValidateBillTypeLabourJC&UserID=vinod.okf&parent_grp=MARSM&dealer_map_cd=10744&loc_cd=OKF&comp_fa=MSM&jcno=JC15016196&labor_cd=ZE12L0&bill_type_cd=CUS
                  {"S":"0","M":""}	   
               */
                string UserIDgstjc8 = Convert.ToString(Request.QueryString["UserID"]);
                string parent_grpjc8 = Convert.ToString(Request.QueryString["parent_grp"]);
                Int32 dealer_map_cdjc8 = Convert.ToInt32(Request.QueryString["dealer_map_cd"]);
                string loc_cdjc8 = Convert.ToString(Request.QueryString["loc_cd"]);
                string Comp_fa_jc8 = Convert.ToString(Request.QueryString["comp_fa"]);
                string jcnum_jc8 = Convert.ToString(Request.QueryString["jcno"]);
                string labor_cdjc8 = Convert.ToString(Request.QueryString["labor_cd"]);
                string bill_type_cdjc8 = Convert.ToString(Request.QueryString["bill_type_cd"]);

                if (UserIDgstjc8 != null)
                {
                    string Result_VBTL = ValidateBillTypeLabourJC(UserIDgstjc8, parent_grpjc8, dealer_map_cdjc8, loc_cdjc8, Comp_fa_jc8, jcnum_jc8, labor_cdjc8, bill_type_cdjc8);
                    Response.Write(Result_VBTL);
                }
                else
                {
                    Response.Write("null ");
                }
                break;
            //*****************************

            case ("GetSplitRatioJC"):
                /*
 http://localhost/MarutiServiceDev/JCOService.aspx?func=GetSplitRatioJC&UserID=vinod.okf&parent_grp=MARSM&dealer_map_cd=10744&loc_cd=OKF&comp_fa=MSM&bill_type_cd=CUS&source=p			   
                */
                string UserIDgstjc9 = Convert.ToString(Request.QueryString["UserID"]);
                string parent_grpjc9 = Convert.ToString(Request.QueryString["parent_grp"]);
                Int32 dealer_map_cdjc9 = Convert.ToInt32(Request.QueryString["dealer_map_cd"]);
                string loc_cdjc9 = Convert.ToString(Request.QueryString["loc_cd"]);
                string Comp_fa_jc9 = Convert.ToString(Request.QueryString["comp_fa"]);
                string bill_type_cdjc9 = Convert.ToString(Request.QueryString["bill_type_cd"]);
                string source_jc9 = Convert.ToString(Request.QueryString["source"]);


                if (UserIDgstjc9 != null)
                {
                    string Result_GSRT = GetSplitRatioJC(UserIDgstjc9, parent_grpjc9, dealer_map_cdjc9, loc_cdjc9, Comp_fa_jc9, bill_type_cdjc9, source_jc9);
                    Response.Write(Result_GSRT);
                }
                else
                {
                    Response.Write("null ");
                }
                break;
            //*****************************

            //added following case on 19 aug 2015
            case ("GetTechLabourJC"):
                /*
  http://localhost/MarutiServiceDev/JCOService.aspx?func=GetTechLabourJC&UserID=test.tab1&parent_grp=99999&dealer_map_cd=99999&loc_cd=999&comp_fa=999
			   
                */
                string UserIDgstjc10 = Convert.ToString(Request.QueryString["UserID"]);
                string parent_grpjc10 = Convert.ToString(Request.QueryString["parent_grp"]);
                Int32 dealer_map_cdjc10 = Convert.ToInt32(Request.QueryString["dealer_map_cd"]);
                string loc_cdjc10 = Convert.ToString(Request.QueryString["loc_cd"]);
                string Comp_fa_jc10 = Convert.ToString(Request.QueryString["comp_fa"]);

                if (UserIDgstjc10 != null)
                {
                    string Result_Gtchlab = GetTechLabourJC(UserIDgstjc10, parent_grpjc10, dealer_map_cdjc10, loc_cdjc10, Comp_fa_jc10);
                    Response.Write(Result_Gtchlab);
                }
                break;
            //*******************************
            case ("ValidateTchCmpRsJC"):
                /*
              http://localhost/MarutiServiceDev/JCOService.aspx?func=ValidateTchCmpRsJC&UserID=vinod.okf&parent_grp=MARSM&dealer_map_cd=10744&loc_cd=OKF&comp_fa=MSM&jcno=JC15016196&mul_ref_num=&reason_cd=D-15/2015
			   
               */
                string UserIDgstjc11 = Convert.ToString(Request.QueryString["UserID"]);
                string parent_grpjc11 = Convert.ToString(Request.QueryString["parent_grp"]);
                Int32 dealer_map_cdjc11 = Convert.ToInt32(Request.QueryString["dealer_map_cd"]);
                string loc_cdjc11 = Convert.ToString(Request.QueryString["loc_cd"]);
                string Comp_fa_jc11 = Convert.ToString(Request.QueryString["comp_fa"]);
                string jcnum_jc11 = Convert.ToString(Request.QueryString["jcno"]);
                string mul_ref_num_jc11 = Convert.ToString(Request.QueryString["mul_ref_num"]);
                string reason_cd_jc11 = Convert.ToString(Request.QueryString["reason_cd"]);

                if (UserIDgstjc11 != null)
                {
                    string Result_Vltcr = ValidateTchCmpRsJC(UserIDgstjc11, parent_grpjc11, dealer_map_cdjc11, loc_cdjc11, Comp_fa_jc11, jcnum_jc11, mul_ref_num_jc11, reason_cd_jc11);
                    Response.Write(Result_Vltcr);
                }
                else
                {
                    Response.Write("null ");
                }
                break;
            //*****************************

            case ("GetTchCampLbrJC"):
                /*
			   
        http://localhost/MarutiServiceDev/JCOService.aspx?func=GetTchCampLbrJC&UserID=test.tab1&parent_grp=99999&dealer_map_cd=99999&loc_cd=999&comp_fa=999&jcno=
			   
                */
                string UserIDgstjc12 = Convert.ToString(Request.QueryString["UserID"]);
                string parent_grpjc12 = Convert.ToString(Request.QueryString["parent_grp"]);
                Int32 dealer_map_cdjc12 = Convert.ToInt32(Request.QueryString["dealer_map_cd"]);
                string loc_cdjc12 = Convert.ToString(Request.QueryString["loc_cd"]);
                string Comp_fa_jc12 = Convert.ToString(Request.QueryString["comp_fa"]);
                string jcno_jc12 = Convert.ToString(Request.QueryString["jcno"]);

                if (UserIDgstjc12 != null)
                {
                    string Result_GTCL = GetTchCampLbrJC(UserIDgstjc12, parent_grpjc12, dealer_map_cdjc12, loc_cdjc12, Comp_fa_jc12, jcno_jc12);
                    Response.Write(Result_GTCL);
                }
                else
                {
                    Response.Write("null ");
                }
                break;
            //-------*****************************

            case ("UpdateJobCardClose"):
                /*
                http://localhost/MarutiServiceDev/JCOService.aspx?func=UpdateJobCardClose&&UserID=vinod.okf&parent_grp=MARSM&dealer_map_cd=10744&loc_cd=OKF&comp_fa=MSM&jcno=JC15016432&srv_cat_cd=PMS&sub_srv_type_cd_jc=PMS2&sa_adv=&tech_adv=&bay_cd=&group_cd=&tech_cd=&demand_ins_str=&repair_ins_str=&part_ins_str=&labor_ins_str=&mcard_ins_str=&tcamp_ins_str=&pickup_type=&pickup_date=&free_pikcup_flag=&pickup_loc_cd=&pickup_driver=&pikcup_remarks=&mms_num=&rtest_startime=&rtest_startkm=&rtest_endtime=&rtest_endkm=
                */
                string UserIDgstjc14 = Convert.ToString(Request.QueryString["UserID"]);
                string parent_grpjc14 = Convert.ToString(Request.QueryString["parent_grp"]);
                Int32 dealer_map_cdjc14 = Convert.ToInt32(Request.QueryString["dealer_map_cd"]);
                string loc_cdjc14 = Convert.ToString(Request.QueryString["loc_cd"]);
                string Comp_fa_jc14 = Convert.ToString(Request.QueryString["comp_fa"]);
                string jcnum_jc14 = Convert.ToString(Request.QueryString["jcno"]);

                string srv_cat_cd_jc14 = Convert.ToString(Request.QueryString["srv_cat_cd"]);
                string sub_srv_type_cd_jc14 = Convert.ToString(Request.QueryString["sub_srv_type_cd_jc"]);
                string sa_adv_jc14 = Convert.ToString(Request.QueryString["sa_adv"]);
                string tech_adv_jc14 = Convert.ToString(Request.QueryString["tech_adv"]);
                string bay_cd_jc14 = Convert.ToString(Request.QueryString["bay_cd"]);
                string group_cd_jc14 = Convert.ToString(Request.QueryString["group_cd"]);
                string tech_cd_jc14 = Convert.ToString(Request.QueryString["tech_cd"]);

                //cursor input started here seperated by $
                string demand_ins_strjc14 = Convert.ToString(Request.QueryString["demand_ins_str"]);
                string repair_ins_strjc14 = Convert.ToString(Request.QueryString["repair_ins_str"]);
                string part_ins_strjc14 = Convert.ToString(Request.QueryString["part_ins_str"]);
                string labor_ins_strjc14 = Convert.ToString(Request.QueryString["labor_ins_str"]);
                string mcard_ins_strjc14 = Convert.ToString(Request.QueryString["mcard_ins_str"]);
                string tcamp_ins_strjc14 = Convert.ToString(Request.QueryString["tcamp_ins_str"]);
                //-----------
                string pickup_typejc14 = Convert.ToString(Request.QueryString["pickup_type"]);
                string pickup_datejc14 = Convert.ToString(Request.QueryString["pickup_date"]);
                string free_pikcup_flagjc14 = Convert.ToString(Request.QueryString["free_pikcup_flag"]);
                string pickup_loc_cdjc14 = Convert.ToString(Request.QueryString["pickup_loc_cd"]);
                string pickup_driverjc14 = Convert.ToString(Request.QueryString["pickup_driver"]);
                string pikcup_remarksjc14 = Convert.ToString(Request.QueryString["pikcup_remarks"]);
                string mms_numjc14 = Convert.ToString(Request.QueryString["mms_num"]);

                Double rtest_startimejc14 = Convert.ToDouble(Request.QueryString["rtest_startime"]);
                Double rtest_startkmjc14 = Convert.ToDouble(Request.QueryString["rtest_startkm"]);
                Double rtest_endtimejc14 = Convert.ToDouble(Request.QueryString["rtest_endtime"]);
                Double rtest_endkmjc14 = Convert.ToDouble(Request.QueryString["rtest_endkm"]);


                if (UserIDgstjc14 != null)
                {
                    string Result_Gjcloseupdt = UpdateJobCardClose(UserIDgstjc14, parent_grpjc14, dealer_map_cdjc14, loc_cdjc14, Comp_fa_jc14, jcnum_jc14,
                                                    srv_cat_cd_jc14, sub_srv_type_cd_jc14, sa_adv_jc14, tech_adv_jc14, bay_cd_jc14, group_cd_jc14, tech_cd_jc14,
                                                    demand_ins_strjc14, repair_ins_strjc14, part_ins_strjc14, labor_ins_strjc14, mcard_ins_strjc14, tcamp_ins_strjc14,
                                                    pickup_typejc14, pickup_datejc14, free_pikcup_flagjc14, pickup_loc_cdjc14, pickup_driverjc14, pikcup_remarksjc14, mms_numjc14,
                                                    rtest_startimejc14, rtest_startkmjc14, rtest_endtimejc14, rtest_endkmjc14);

                    Response.Write(Result_Gjcloseupdt);
                }
                else
                {
                    Response.Write("null ");
                }
                break;
            //-------*****************************			


            case ("GetJobCardClose"):
                /*

              http://localhost/MarutiServiceDev/JCOService.aspx?func=GetJobCardClose&&UserID=vinod.okf&parent_grp=MARSM&dealer_map_cd=10744&loc_cd=OKF&comp_fa=MSM&jcno=JC15016432&srv_cat_cd=PMS&sub_srv_type_cd_jc=PMS2&sa_adv=0911&tech_adv=0911&bay_cd=S1&group_cd=B&tech_cd=0911&demand_ins_str=&repair_ins_str=&part_ins_str=&labor_ins_str=&mcard_ins_str=&tcamp_ins_str=&pickup_type=&pickup_date=&free_pikcup_flag=&pickup_loc_cd=&pickup_driver=&pikcup_remarks=&mms_num=&rtest_startime=&rtest_startkm=&rtest_endtime=&rtest_endkm=0&delay_reas_cd=&delay_reas_rem=&csi_reas_cd=01&csi_reas_rem= 			   
               */
                string UserIDgstjc13 = Convert.ToString(Request.QueryString["UserID"]);
                string parent_grpjc13 = Convert.ToString(Request.QueryString["parent_grp"]);
                Int32 dealer_map_cdjc13 = Convert.ToInt32(Request.QueryString["dealer_map_cd"]);
                string loc_cdjc13 = Convert.ToString(Request.QueryString["loc_cd"]);
                string Comp_fa_jc13 = Convert.ToString(Request.QueryString["comp_fa"]);
                string jcnum_jc13 = Convert.ToString(Request.QueryString["jcno"]);

                string srv_cat_cd_jc13 = Convert.ToString(Request.QueryString["srv_cat_cd"]);
                string sub_srv_type_cd_jc13 = Convert.ToString(Request.QueryString["sub_srv_type_cd_jc"]);
                string sa_adv_jc13 = Convert.ToString(Request.QueryString["sa_adv"]);
                string tech_adv_jc13 = Convert.ToString(Request.QueryString["tech_adv"]);
                string bay_cd_jc13 = Convert.ToString(Request.QueryString["bay_cd"]);
                string group_cd_jc13 = Convert.ToString(Request.QueryString["group_cd"]);
                string tech_cd_jc13 = Convert.ToString(Request.QueryString["tech_cd"]);

                //cursor input started here seperated by $
                string demand_ins_strjc13 = Convert.ToString(Request.QueryString["demand_ins_str"]);
                string repair_ins_strjc13 = Convert.ToString(Request.QueryString["repair_ins_str"]);
                string part_ins_strjc13 = Convert.ToString(Request.QueryString["part_ins_str"]);
                string labor_ins_strjc13 = Convert.ToString(Request.QueryString["labor_ins_str"]);
                string mcard_ins_strjc13 = Convert.ToString(Request.QueryString["mcard_ins_str"]);
                string tcamp_ins_strjc13 = Convert.ToString(Request.QueryString["tcamp_ins_str"]);
                //-----------
                string pickup_typejc13 = Convert.ToString(Request.QueryString["pickup_type"]);
                string pickup_datejc13 = Convert.ToString(Request.QueryString["pickup_date"]);
                string free_pikcup_flagjc13 = Convert.ToString(Request.QueryString["free_pikcup_flag"]);
                string pickup_loc_cdjc13 = Convert.ToString(Request.QueryString["pickup_loc_cd"]);
                string pickup_driverjc13 = Convert.ToString(Request.QueryString["pickup_driver"]);
                string pikcup_remarksjc13 = Convert.ToString(Request.QueryString["pikcup_remarks"]);
                string mms_numjc13 = Convert.ToString(Request.QueryString["mms_num"]);

                Double rtest_startimejc13 = Convert.ToDouble(Request.QueryString["rtest_startime"]);
                Double rtest_startkmjc13 = Convert.ToDouble(Request.QueryString["rtest_startkm"]);
                Double rtest_endtimejc13 = Convert.ToDouble(Request.QueryString["rtest_endtime"]);
                Double rtest_endkmjc13 = Convert.ToDouble(Request.QueryString["rtest_endkm"]);

                string delay_reas_cdjc13 = Convert.ToString(Request.QueryString["delay_reas_cd"]);
                string delay_reas_remjc13 = Convert.ToString(Request.QueryString["delay_reas_rem"]);
                string csi_reas_cdjc13 = Convert.ToString(Request.QueryString["csi_reas_cd"]);
                string csi_reas_remjc13 = Convert.ToString(Request.QueryString["csi_reas_rem"]);


                if (UserIDgstjc13 != null)
                {
                    string Result_Gjclose = GetJobCardClose(UserIDgstjc13, parent_grpjc13, dealer_map_cdjc13, loc_cdjc13, Comp_fa_jc13, jcnum_jc13,
                                                    srv_cat_cd_jc13, sub_srv_type_cd_jc13, sa_adv_jc13, tech_adv_jc13, bay_cd_jc13, group_cd_jc13, tech_cd_jc13,
                                                    demand_ins_strjc13, repair_ins_strjc13, part_ins_strjc13, labor_ins_strjc13, mcard_ins_strjc13, tcamp_ins_strjc13,
                                                    pickup_typejc13, pickup_datejc13, free_pikcup_flagjc13, pickup_loc_cdjc13, pickup_driverjc13, pikcup_remarksjc13, mms_numjc13,
                                                    rtest_startimejc13, rtest_startkmjc13, rtest_endtimejc13, rtest_endkmjc13,
                                                    delay_reas_cdjc13, delay_reas_remjc13, csi_reas_cdjc13, csi_reas_remjc13);

                    Response.Write(Result_Gjclose);
                }
                else
                {
                    Response.Write("null ");
                }
                break;
            //-------*****************************
            //added the following case on 2 sep 2015


            case ("GetPreinVoiceDetails"):
                /*
 http://localhost/MarutiServiceDev/JCOService.aspx?func=GetPreinVoiceDetails&UserID=test.tab1&jcno=JC15000068&parent_group=99999&dealer_map_cd=99999&loc_cd=999&comp_fa=999
                */
                string UserIDgst_pi = Convert.ToString(Request.QueryString["UserID"]);
                string Jcno_pi = Convert.ToString(Request.QueryString["jcno"]);
                string Parent_group_pi = Convert.ToString(Request.QueryString["parent_group"]);
                Int32 Dealer_map_cd_pi = Convert.ToInt32(Request.QueryString["dealer_map_cd"]);
                string Loc_cd_pi = Convert.ToString(Request.QueryString["loc_cd"]);
                string comp_fa_pi = Convert.ToString(Request.QueryString["comp_fa"]);

                if (UserIDgst_pi != null && Parent_group_pi != null && Dealer_map_cd_pi != null && Loc_cd_pi != null && comp_fa_pi != null && Jcno_pi != null)
                {
                    //Response.Write("UserIDgst_pi="+UserIDgst_pi+"<br/>"+"Jcmodule="+Jcmodule+"<br/>"+"Parent_group="+Parent_group+"<br/>"
                    //+"Dealer_map_cd_pi="+Dealer_map_cd_pi+"<br/>"+"Loc_cd_pi="+Loc_cd_pi+"<br/>"+"comp_fa_pi="+comp_fa_pi+"<br/>"+"Jcno="+Jcno_pi);

                    string Result_preinvoice = GetPreinVoiceDetails(UserIDgst_pi, Jcno_pi, Parent_group_pi, Dealer_map_cd_pi, Loc_cd_pi, comp_fa_pi);
                    Response.Write(Result_preinvoice);
                }
                else
                {
                    Response.Write("Null");
                }

                break;
            //--********************			

            //---------------------------------------------------------------jco_close ended here--------------------------------------------------

            //-------------------------------------------------------jco_billing started here on 31 aug 2015 ---------------------

            case ("GetVehDelDtlJB"):
                /*
                pkg_jcb_1.sp_jco_get_veh_delivery_dtl
            http://localhost/MarutiServiceDev/JCOService.aspx?func=GetVehDelDtlJB&UserID=test.tab1&parent_grp=99999&dealer_map_cd=99999&loc_cd=999&comp_fa=999
                */
                string UserIDgstjb = Convert.ToString(Request.QueryString["UserID"]);
                string parent_grpjb = Convert.ToString(Request.QueryString["parent_grp"]);
                Int32 dealer_map_cdjb = Convert.ToInt32(Request.QueryString["dealer_map_cd"]);
                string loc_cdjb = Convert.ToString(Request.QueryString["loc_cd"]);
                string Comp_fa_jb = Convert.ToString(Request.QueryString["comp_fa"]);
                if (UserIDgstjb != null)
                {
                    string Result_GVDLDTL = GetVehDelDtlJB(UserIDgstjb, parent_grpjb, dealer_map_cdjb, loc_cdjb, Comp_fa_jb);
                    Response.Write(Result_GVDLDTL);
                }
                break;
            //*******************************
            case ("GetCashcreditJB"):
                /* 
 pkg_jcb_1.SP_JCB_GET_CASH_CREDIT			   
 http://localhost/MarutiServiceDev/JCOService.aspx?func=GetCashcreditJB 
 */
                string Result_GCashCredit = GetCashcreditJB();
                Response.Write(Result_GCashCredit);

                break;
            //*******************************
            case ("GetEstVarRsnJB"):
                /*
                pkg_jcb_1.SP_JCB_GET_EST_VAR_REASON
            http://localhost/MarutiServiceDev/JCOService.aspx?func=GetEstVarRsnJB&UserID=test.tab1&parent_grp=99999&dealer_map_cd=99999&loc_cd=999&comp_fa=999
                */
                string UserIDgstjb1 = Convert.ToString(Request.QueryString["UserID"]);
                string parent_grpjb1 = Convert.ToString(Request.QueryString["parent_grp"]);
                Int32 dealer_map_cdjb1 = Convert.ToInt32(Request.QueryString["dealer_map_cd"]);
                string loc_cdjb1 = Convert.ToString(Request.QueryString["loc_cd"]);
                string Comp_fa_jb1 = Convert.ToString(Request.QueryString["comp_fa"]);
                if (UserIDgstjb1 != null)
                {
                    string Result_GVDLDTL = GetEstVarRsnJB(UserIDgstjb1, parent_grpjb1, dealer_map_cdjb1, loc_cdjb1, Comp_fa_jb1);
                    Response.Write(Result_GVDLDTL);
                }
                break;
            //*******************************

            case ("GetBillDlyRsJB"):
                /*
                pkg_jcb_1.SP_JCB_GET_BILL_DELAY_REASON
            http://localhost/MarutiServiceDev/JCOService.aspx?func=GetBillDlyRsJB&UserID=test.tab1&parent_grp=99999&dealer_map_cd=99999&loc_cd=999&comp_fa=999
                */
                string UserIDgstjb2 = Convert.ToString(Request.QueryString["UserID"]);
                string parent_grpjb2 = Convert.ToString(Request.QueryString["parent_grp"]);
                Int32 dealer_map_cdjb2 = Convert.ToInt32(Request.QueryString["dealer_map_cd"]);
                string loc_cdjb2 = Convert.ToString(Request.QueryString["loc_cd"]);
                string Comp_fa_jb2 = Convert.ToString(Request.QueryString["comp_fa"]);
                if (UserIDgstjb2 != null)
                {
                    string Result_GBDRS = GetBillDlyRsJB(UserIDgstjb2, parent_grpjb2, dealer_map_cdjb2, loc_cdjb2, Comp_fa_jb2);
                    Response.Write(Result_GBDRS);
                }
                break;
            //*******************************
            case ("GetSaleTypeJB"):
                /*
                pkg_jco_1.sp_jco_get_saletype
            http://localhost/MarutiServiceDev/JCOService.aspx?func=GetSaleTypeJB&UserID=test.tab1&parent_grp=99999&dealer_map_cd=99999&loc_cd=999&comp_fa=999
                */
                string UserIDgstjb3 = Convert.ToString(Request.QueryString["UserID"]);
                string parent_grpjb3 = Convert.ToString(Request.QueryString["parent_grp"]);
                Int32 dealer_map_cdjb3 = Convert.ToInt32(Request.QueryString["dealer_map_cd"]);
                string loc_cdjb3 = Convert.ToString(Request.QueryString["loc_cd"]);
                string Comp_fa_jb3 = Convert.ToString(Request.QueryString["comp_fa"]);
                if (UserIDgstjb3 != null)
                {
                    string Result_GSTYPE = GetSaleTypeJB(UserIDgstjb3, parent_grpjb3, dealer_map_cdjb3, loc_cdjb3, Comp_fa_jb3);
                    Response.Write(Result_GSTYPE);
                }
                break;
            //*******************************
            //added these cases on 2 sep 2015
            case ("GetJcBillDtlJB"):
                /*
                pkg_jcb_1.SP_JCB_GET_JC_BILL_DTL
 http://localhost/MarutiServiceDev/JCOService.aspx?func=GetJcBillDtlJB&UserID=vinod.okf&parent_group=MARSM&dealer_map_cd=10744&loc_cd=OKF&comp_fa=MSM&jcno=JC15016460
                */
                string UserIDgstjb6 = Convert.ToString(Request.QueryString["UserID"]);
                string Parent_groupjb6 = Convert.ToString(Request.QueryString["parent_group"]);
                Int32 Dealer_map_cdjb6 = Convert.ToInt32(Request.QueryString["dealer_map_cd"]);
                string Loc_Cdjb6 = Convert.ToString(Request.QueryString["loc_cd"]);
                string Comp_fajb6 = Convert.ToString(Request.QueryString["comp_fa"]);
                string Jcnojb6 = Convert.ToString(Request.QueryString["jcno"]);


                if (UserIDgstjb6 != null && Parent_groupjb6 != null && Dealer_map_cdjb6 != null && Loc_Cdjb6 != null && Comp_fajb6 != null && Jcnojb6 != null)
                {
                    //Response.Write("UserIDgst="+UserIDgstjb6+"<br/>"+"Parent_group="+Parent_groupjb6+"<br/>"
                    //+"Dealer_map_cd="+Dealer_map_cdjb6+"<br/>"+"Loc_Cd="+Loc_Cdjb6+"<br/>"+"Comp_fa="+Comp_fajb6+"<br/>"+"Jcno="+Jcnojb6);

                    string Result_getbilldtl = GetJcBillDtlJB(UserIDgstjb6, Parent_groupjb6, Dealer_map_cdjb6, Loc_Cdjb6, Comp_fajb6, Jcnojb6);

                    Response.Write(Result_getbilldtl);
                }
                else
                {
                    Response.Write("Null");
                }

                break;
            //**********************************************************
            case ("CalculateBillJB"):
                /*
                pkg_jcb_1.SP_JCB_CALCULATE_BILL
 http://localhost/MarutiServiceDev/JCOService.aspx?func=CalculateBillJB&UserID=vinod.okf&parent_group=MARSM&dealer_map_cd=10744&loc_cd=OKF&comp_fa=MSM&jcno=JC15016460&cashcr=C&saletyp=&inv_cust_cd=&ins_name=&ins_party_cd=&cus_part_disc=&cus_lab_disc=&credit_card=&credit_card_num=&disc_auth_by=&part_ins_str=&labor_ins_str=
                */
                string UserIDgstjb4 = Convert.ToString(Request.QueryString["UserID"]);
                string Parent_groupjb4 = Convert.ToString(Request.QueryString["parent_group"]);
                Int32 Dealer_map_cdjb4 = Convert.ToInt32(Request.QueryString["dealer_map_cd"]);
                string Loc_Cdjb4 = Convert.ToString(Request.QueryString["loc_cd"]);
                string Comp_fajb4 = Convert.ToString(Request.QueryString["comp_fa"]);
                string Jcnojb4 = Convert.ToString(Request.QueryString["jcno"]);
                string cashcrjb4 = Convert.ToString(Request.QueryString["cashcr"]);
                string saletypjb4 = Convert.ToString(Request.QueryString["saletyp"]);
                string inv_cust_cdjb4 = Convert.ToString(Request.QueryString["inv_cust_cd"]);
                string ins_namejb4 = Convert.ToString(Request.QueryString["ins_name"]);
                string ins_party_cdjb4 = Convert.ToString(Request.QueryString["ins_party_cd"]);
                Int32 cus_part_discjb4 = Convert.ToInt32(Request.QueryString["cus_part_disc"]);
                Int32 cus_lab_discjb4 = Convert.ToInt32(Request.QueryString["cus_lab_disc"]);
                string credit_cardjb4 = Convert.ToString(Request.QueryString["credit_card"]);
                string credit_card_numjb4 = Convert.ToString(Request.QueryString["credit_card_num"]);
                string disc_auth_byjb4 = Convert.ToString(Request.QueryString["disc_auth_by"]);
                string part_ins_strjb4 = Convert.ToString(Request.QueryString["part_ins_str"]);
                string labor_ins_strjb4 = Convert.ToString(Request.QueryString["labor_ins_str"]);


                if (UserIDgstjb4 != null && Parent_groupjb4 != null && Dealer_map_cdjb4 != null && Loc_Cdjb4 != null && Comp_fajb4 != null && Jcnojb4 != null)
                {
                    //Response.Write("UserIDgst="+UserIDgstjb4+"<br/>"+"Parent_group="+Parent_groupjb4+"<br/>"
                    //+"Dealer_map_cd="+Dealer_map_cdjb4+"<br/>"+"Loc_Cd="+Loc_Cdjb4+"<br/>"+"Comp_fa="+Comp_fajb4+"<br/>"+"Jcno="+Jcnojb4);

                    string Result_calbill = CalculateBillJB(UserIDgstjb4, Parent_groupjb4, Dealer_map_cdjb4, Loc_Cdjb4, Comp_fajb4, Jcnojb4,
                                                            cashcrjb4, saletypjb4, inv_cust_cdjb4, ins_namejb4, ins_party_cdjb4, cus_part_discjb4,
                                                            cus_lab_discjb4, credit_cardjb4, credit_card_numjb4, disc_auth_byjb4, part_ins_strjb4,
                                                            labor_ins_strjb4);

                    Response.Write(Result_calbill);
                }
                else
                {
                    Response.Write("Null");
                }

                break;
            //---**********************************************************

            //added these fn on 4 sep 2015
            case ("GenerateBillJB"):
                /*
                pkg_jcb_1.SP_JCB_GENERATE_BILL
  http://localhost/MarutiServiceDev/JCOService.aspx?func=GenerateBillJB&UserID=vinod.okf&parent_group=MARSM&dealer_map_cd=10744&loc_cd=OKF&comp_fa=MSM&jcno=JC15000068&cashcr=C&saletyp=&inv_cust_cd=&ins_name=&ins_party_cd=&cus_part_disc=0&cus_lab_disc=0&credit_card=&credit_card_num=&disc_auth_by=&pickup_type=&pickup_date=&veh_delvd_by=&est_var_reas_cd=&bill_delay_reas_cd=&bill_delay_remarks=&pn_bill_remarks=&part_ins_str=&labor_ins_str=
                */
                string UserIDgstjb5 = Convert.ToString(Request.QueryString["UserID"]);
                string Parent_groupjb5 = Convert.ToString(Request.QueryString["parent_group"]);
                Int32 Dealer_map_cdjb5 = Convert.ToInt32(Request.QueryString["dealer_map_cd"]);
                string Loc_Cdjb5 = Convert.ToString(Request.QueryString["loc_cd"]);
                string Comp_fajb5 = Convert.ToString(Request.QueryString["comp_fa"]);
                string Jcnojb5 = Convert.ToString(Request.QueryString["jcno"]);
                string cashcrjb5 = Convert.ToString(Request.QueryString["cashcr"]);
                string saletypjb5 = Convert.ToString(Request.QueryString["saletyp"]);
                string inv_cust_cdjb5 = Convert.ToString(Request.QueryString["inv_cust_cd"]);
                string ins_namejb5 = Convert.ToString(Request.QueryString["ins_name"]);
                string ins_party_cdjb5 = Convert.ToString(Request.QueryString["ins_party_cd"]);
                Int32 cus_part_discjb5 = Convert.ToInt32(Request.QueryString["cus_part_disc"]);
                Int32 cus_lab_discjb5 = Convert.ToInt32(Request.QueryString["cus_lab_disc"]);
                string credit_cardjb5 = Convert.ToString(Request.QueryString["credit_card"]);
                string credit_card_numjb5 = Convert.ToString(Request.QueryString["credit_card_num"]);
                string disc_auth_byjb5 = Convert.ToString(Request.QueryString["disc_auth_by"]);

                string pickup_typejb5 = Convert.ToString(Request.QueryString["pickup_type"]);
                string pickup_datejb5 = Convert.ToString(Request.QueryString["pickup_date"]);
                string veh_delvd_byjb5 = Convert.ToString(Request.QueryString["veh_delvd_by"]);
                string est_var_reas_cdjb5 = Convert.ToString(Request.QueryString["est_var_reas_cd"]);
                string bill_delay_reas_cdjb5 = Convert.ToString(Request.QueryString["bill_delay_reas_cd"]);
                string bill_delay_remarksjb5 = Convert.ToString(Request.QueryString["bill_delay_remarks"]);
                string bill_remarksjb5 = Convert.ToString(Request.QueryString["pn_bill_remarks"]);
                string part_ins_strjb5 = Convert.ToString(Request.QueryString["part_ins_str"]);
                string labor_ins_strjb5 = Convert.ToString(Request.QueryString["labor_ins_str"]);


                if (UserIDgstjb5 != null && Parent_groupjb5 != null && Dealer_map_cdjb5 != null && Loc_Cdjb5 != null && Comp_fajb5 != null && Jcnojb5 != null)
                {
                    //Response.Write("UserIDgst="+UserIDgstjb4+"<br/>"+"Parent_group="+Parent_groupjb4+"<br/>"
                    //+"Dealer_map_cd="+Dealer_map_cdjb4+"<br/>"+"Loc_Cd="+Loc_Cdjb4+"<br/>"+"Comp_fa="+Comp_fajb4+"<br/>"+"Jcno="+Jcnojb4);

                    string Result_genbill = GenerateBillJB(UserIDgstjb5, Parent_groupjb5, Dealer_map_cdjb5, Loc_Cdjb5, Comp_fajb5, Jcnojb5,
                                                            cashcrjb5, saletypjb5, inv_cust_cdjb5, ins_namejb5, ins_party_cdjb5, cus_part_discjb5,
                                                            cus_lab_discjb5, credit_cardjb5, credit_card_numjb5, disc_auth_byjb5,
                                                            pickup_typejb5, pickup_datejb5, veh_delvd_byjb5, est_var_reas_cdjb5,
                                                            bill_delay_reas_cdjb5, bill_delay_remarksjb5, bill_remarksjb5,
                                                            part_ins_strjb5, labor_ins_strjb5);

                    Response.Write(Result_genbill);
                }
                else
                {
                    Response.Write("Null");
                }

                break;
            //---**********************************************************



            //------------------------------------jco_billing ends here---------------------

            //------------------------------------xxxxxxxxxxxxxxxxxxxxxx--------END OF GST CASES -------xxxxxxxxxxxxxxxxxxxxxxxxxxxx---------------------------------------------
            case ("UserAuthMSG"):
                string RegNo = Convert.ToString(Request.QueryString["RegNo"]);

                if (RegNo != null)
                {
                    string Result213 = UserAuthMSG(RegNo);
                    Response.Write(Result213);
                }
                break;
            case ("UserAuthMSG1"):
                string RegNo1 = Convert.ToString(Request.QueryString["RegNo"]);

                if (RegNo1 != null)
                {
                    string Result = UserAuthMSG1(RegNo1);
                    Response.Write(Result);
                }
                break;

            case ("GetDemandDetailsMenu"):
                string UserID500 = Convert.ToString(Request.QueryString["UserID"]);
                string RegNum500 = Convert.ToString(Request.QueryString["RegNum"]);
                string Menucode210 = Convert.ToString(Request.QueryString["Menucode"]);
                if (UserID500 != null)
                {
                    string Result900 = GetDemandDetailsMenu(UserID500, RegNum500, Menucode210);
                    Response.Write(Result900);
                }
                else
                {
                    Response.Write("Null UserName");
                }

                break;



            case ("BillPrint"):
                string UserID0071 = Convert.ToString(Request.QueryString["UserID"]);
                string JobCardno = Convert.ToString(Request.QueryString["JCNumber"]);
                if (UserID0071 != null && JobCardno != null)
                {
                    string Result00071 = BillPrint(UserID0071, JobCardno);
                    Response.Write(Result00071);
                }
                else
                {
                    Response.Write("Null");
                }

                break;


            case ("GetHisoryDetails"):
                string UserID007100 = Convert.ToString(Request.QueryString["UserID"]);
                string RegNum5001212 = Convert.ToString(Request.QueryString["RegNum"]);
                string Ronum = Convert.ToString(Request.QueryString["RoNum"]);
                if (UserID007100 != null && Ronum != null && RegNum5001212 != null)
                {
                    string Result00071 = GetHisoryDetails(UserID007100, RegNum5001212, Ronum);
                    Response.Write(Result00071);
                }
                else
                {
                    Response.Write("Null");
                }

                break;













            case ("DealereInfo"):
                string UserID = Convert.ToString(Request.QueryString["UserID"]);
                if (UserID != null)
                {
                    string Result2 = DealereInfo(UserID);
                    Response.Write(Result2);
                }
                break;




            case ("VtsValidation"):
                string UserID801 = Convert.ToString(Request.QueryString["UserID"]);
                Int32 Vts_Num = Convert.ToInt32(Request.QueryString["VtsNum"]);
                if (UserID801 != null)
                {
                    string Result103 = VtsValidation(UserID801, Vts_Num);
                    Response.Write(Result103);
                }
                else
                {
                    Response.Write("Null");
                }

                break;





            case ("UserCustomerVehicle"):
                string UserID2 = Convert.ToString(Request.QueryString["UserID"]);
                string RegNum = Convert.ToString(Request.QueryString["RegNum"]);
                if (UserID2 != null)
                {
                    string Result3 = UserCustomerVehicle(RegNum, UserID2);
                    Response.Write(Result3);
                }
                break;


            case ("CityDetails"):

                string Result4 = CityDetails();
                Response.Write(Result4);

                break;

            case ("ServiceCategoryDetails"):

                string Result5 = ServiceCategoryDetails();
                Response.Write(Result5);

                break;


            case ("TechnicalAdvancedetails"):
                string UserID3 = Convert.ToString(Request.QueryString["UserID"]);
                string RegNum3 = Convert.ToString(Request.QueryString["RegNum"]);
                if (UserID3 != null)
                {
                    string Result6 = TechnicalAdvancedetails(UserID3, RegNum3);
                    Response.Write(Result6);
                }

                break;
            case ("GetMenuDetails"):
                string UserID45 = Convert.ToString(Request.QueryString["UserID"]);
                string RegNum4 = Convert.ToString(Request.QueryString["RegNum"]);
                string MenuDescp4 = Convert.ToString(Request.QueryString["MenuDescp"]);
                if (UserID45 != null)
                {
                    string Result75 = GetMenuDetails(UserID45, RegNum4, MenuDescp4);
                    Response.Write(Result75);
                }
                else
                {
                    Response.Write("Null UserName");
                }

                break;


            case ("GetTechCampDetails"):
                string RegNum581 = Convert.ToString(Request.QueryString["RegNum"]);
                if (RegNum581 != null)
                {
                    string Result8 = GetTechCampDetails(RegNum581);
                    Response.Write(Result8);
                }
                else
                {
                    Response.Write("Please Enter Proper Reg No");
                }


                break;

            case ("HistoryMaster"):
                string RegNum58100 = Convert.ToString(Request.QueryString["RegNum"]);
                if (RegNum58100 != null)
                {
                    string Result8 = HistoryMaster(RegNum58100);
                    Response.Write(Result8);
                }
                else
                {
                    Response.Write("Please Enter Proper Reg No");
                }


                break;


            case ("GetDemandDetails"):
                string UserID5 = Convert.ToString(Request.QueryString["UserID"]);
                string RegNum5 = Convert.ToString(Request.QueryString["RegNum"]);
                string sercatcd79 = Convert.ToString(Request.QueryString["Sercatcd"]);
                string DemadDescp5 = Convert.ToString(Request.QueryString["DemadDescp"]);
                if (UserID5 != null)
                {
                    string Result9 = GetDemandDetails(UserID5, RegNum5, DemadDescp5, sercatcd79);
                    Response.Write(Result9);
                }
                else
                {
                    Response.Write("Null UserName");
                }

                break;
            case ("GetPartDetails"):
                string UserID6 = Convert.ToString(Request.QueryString["UserID"]);
                string RegNum6 = Convert.ToString(Request.QueryString["RegNum"]);
                string PartNum6 = Convert.ToString(Request.QueryString["PartNum"]);
                if (UserID6 != null)
                {
                    string Result10 = GetPartDetails(UserID6, RegNum6, PartNum6);
                    Response.Write(Result10);
                }
                else
                {
                    Response.Write("Null UserName");
                }

                break;

            case ("GetInventoryDetails"):
                string UserID7 = Convert.ToString(Request.QueryString["UserID"]);
                if (UserID7 != null)
                {
                    string Result11 = GetInventoryDetails(UserID7);
                    Response.Write(Result11);
                }
                else
                {
                    Response.Write("Null UserName");
                }

                break;

            case ("ServiceCategoryValidate"):
                string UserID8 = Convert.ToString(Request.QueryString["UserID"]);
                string RegNum8 = Convert.ToString(Request.QueryString["RegNum"]);
                string ServiceCatcode8 = Convert.ToString(Request.QueryString["ServiceCategoryCode"]);
                Int32 OMR = Convert.ToInt32(Request.QueryString["OMR"]);
                if (UserID8 != null)
                {
                    string Result12 = ServiceCategoryValidate(UserID8, RegNum8, ServiceCatcode8, OMR);
                    Response.Write(Result12);
                }
                else
                {
                    Response.Write("Null UserName");
                }

                break;
            case ("OmrValidate"):
                string RegNum9 = Convert.ToString(Request.QueryString["RegNum"]);
                Int64 OMR9 = Convert.ToInt64(Request.QueryString["Omr"]);
                if (RegNum9 != null)
                {
                    string Result13 = OmrValidate(RegNum9, OMR9);
                    Response.Write(Result13);
                }
                else
                {
                    Response.Write("Null");
                }

                break;

            case ("ModifyVehicleDetails"):
                string UserID10 = Convert.ToString(Request.QueryString["UserID"]);
                string vin10 = Convert.ToString(Request.QueryString["Regno"]);
                string VehUserName10 = Convert.ToString(Request.QueryString["VehUserName"]);
                if (UserID10 != null)
                {
                    string Result14 = ModifyVehicleDetails(UserID10, vin10, VehUserName10);
                    Response.Write(Result14);
                }
                else
                {
                    Response.Write("Null");
                }

                break;


            case ("GetlaborDetails"):
                string UserID11 = Convert.ToString(Request.QueryString["UserID"]);
                string RegNum11 = Convert.ToString(Request.QueryString["RegNum"]);
                string LaborCode11 = Convert.ToString(Request.QueryString["LaborCode"]);
                if (UserID11 != null)
                {
                    string Result14 = GetlaborDetails(UserID11, RegNum11, LaborCode11);
                    Response.Write(Result14);
                }
                else
                {
                    Response.Write("Null");
                }

                break;


            case ("GetPickupDetails"):
                string UserID12 = Convert.ToString(Request.QueryString["UserID"]);
                if (UserID12 != null)
                {
                    string Result15 = GetPickupDetails(UserID12);
                    Response.Write(Result15);
                }
                else
                {
                    Response.Write("Null");
                }

                break;

            case ("GetEstimationDetails"):
                string UserID13 = Convert.ToString(Request.QueryString["UserID"]);
                string MenuCode13 = Convert.ToString(Request.QueryString["MenuCode"]);
                string RegNum13 = Convert.ToString(Request.QueryString["RegNum"]);
                string SerCatCode = Convert.ToString(Request.QueryString["SerCatCd"]);

                if (UserID13 != null)
                {
                    string Result15 = GetEstimationDetails(UserID13, MenuCode13, RegNum13, SerCatCode);
                    Response.Write(Result15);
                }
                else
                {
                    Response.Write("Null");
                }

                break;

            case ("ModifyCustDetails"):
                string UserName = Convert.ToString(Request.QueryString["UserName"]);
                string CustIDnew = Convert.ToString(Request.QueryString["CustID"]);
                string CustName = Convert.ToString(Request.QueryString["CustName"]);
                string CustAdd1 = Convert.ToString(Request.QueryString["CustAdd1"]);
                string CustAdd2 = Convert.ToString(Request.QueryString["CustAdd2"]);
                string CustAdd3 = Convert.ToString(Request.QueryString["CustAdd3"]);
                string cityCode = Convert.ToString(Request.QueryString["cityCode"]);
                string Citydesc = Convert.ToString(Request.QueryString["Citydesc"]);
                string Email = Convert.ToString(Request.QueryString["Email"]);
                string phone = Convert.ToString(Request.QueryString["phone"]);
                string workingPhone = Convert.ToString(Request.QueryString["workingPhone"]);
                string mobile = Convert.ToString(Request.QueryString["mobile"]);
                string dob = Convert.ToString(Request.QueryString["dob"]);
                string doa = Convert.ToString(Request.QueryString["doa"]);

                if (UserName != null)
                {
                    string Result16 = ModifyCustDetails(UserName, CustIDnew, CustName, CustAdd1, CustAdd2, CustAdd3, cityCode, Citydesc, Email, phone, workingPhone, mobile, dob, doa);
                    Response.Write(Result16);
                }
                else
                {
                    Response.Write("Null");
                }

                break;

            case ("InsertAllDetails"):

                string UserID101 = Convert.ToString(Request.QueryString["UserID"]);
                string RegNum101 = Convert.ToString(Request.QueryString["RegNum"]);
                string VTS_No = Convert.ToString(Request.QueryString["VTS_NUM"]);
                string CatCode = Convert.ToString(Request.QueryString["CatCode"]);
                Int32 OMR11 = Convert.ToInt32(Request.QueryString["OMR"]);
                string date = Convert.ToString(Request.QueryString["date"]);
                string ADV_CD = Convert.ToString(Request.QueryString["ADV_CD"]);
                string MenuCd0 = Convert.ToString(Request.QueryString["MenuCd0"]);
                string DemandDesc0 = Convert.ToString(Request.QueryString["DemandDesc0"]);
                string PartDesc0 = Convert.ToString(Request.QueryString["PartDesc0"]);
                string LbrDesc0 = Convert.ToString(Request.QueryString["LbrDesc0"]);
                string InvcDesc0 = Convert.ToString(Request.QueryString["InvcDesc0"]);
                string Pick_Typ = Convert.ToString(Request.QueryString["Pick_Typ"]);
                string Pick_Dat = Convert.ToString(Request.QueryString["Pick_Dat"]);
                string Pick_Flag = Convert.ToString(Request.QueryString["Pick_Flag"]);
                string Pick_Loc = Convert.ToString(Request.QueryString["Pick_Loc"]);
                string Pick_Drv = Convert.ToString(Request.QueryString["Pick_Drv"]);
                string Pick_Rem = Convert.ToString(Request.QueryString["Pick_Rem"]);
                double Part_amt = Convert.ToDouble(Request.QueryString["PartAmt"]);
                double Lbr_amt = Convert.ToDouble(Request.QueryString["LbrAmt"]);
                string CustomerVehicleDtl = UserCustomerVehicle(RegNum101, UserID101);
                //string Dump3 = "Y";

                //if (CustomerVehicleDtl.Contains("TC"))
                //// {
                //String[] dump1 = CustomerVehicleDtl.Split(',');
                //String[] Dump2 = dump1[23].Split(':');
                //Dump3 = Dump2[1];
                //}

                string Tech_Cmp = Convert.ToString(Request.QueryString["Tech_Cmp"]);
                //string Omrvalidatin = OmrValidate(RegNum101, Convert.ToString(OMR11));


                //string Dump4 = "CUS";

                //if (CustomerVehicleDtl.Contains("IT"))
                //{
                //  String[] dump1 = CustomerVehicleDtl.Split(',');
                //  String[] Dump2 = dump1[1].Split(':');
                //   Dump4 = Dump2[1];
                // }

                string Iss_typ = Convert.ToString(Request.QueryString["Iss_typ"]);


                if (UserID101 != null)
                {
                    string Result22 = InsertAllDetails(UserID101, RegNum101, VTS_No, CatCode, OMR11, date, ADV_CD, MenuCd0, DemandDesc0, PartDesc0, LbrDesc0, InvcDesc0, Pick_Typ, Pick_Dat, Pick_Flag, Pick_Loc, Pick_Drv, Pick_Rem, Tech_Cmp, Iss_typ, Part_amt, Lbr_amt);
                    Response.Write(Result22);
                }


                else
                {
                    Response.Write("Null");
                }

                break;
            //------------written new procedure to get Appointment Details : 27 Sep 2017
            /*Added two more inputs : 16-Oct-2017    - Vectorofrm
            http://localhost//MarutiServiceDev/JCOService.aspx?func=GetAppointmentDetails&UserID=vinod.okf&dealer_cd=99999&loc_cd=999
            */
            case ("GetAppointmentDetails"):

                string aptdtl_UserID = Convert.ToString(Request.QueryString["UserID"]);
                Int32 aptdtl_DealerCode = Convert.ToInt32(Request.QueryString["dealer_cd"]);
                string aptdtl_LocCode = Convert.ToString(Request.QueryString["loc_cd"]);
                string aptdtl_IsTesting = Convert.ToString(Request.QueryString["isTesting"]);

                if (aptdtl_UserID != null && aptdtl_LocCode != null)
                {
                    string Result_Appntment_dTL = GetAppointmentDetails(aptdtl_UserID, aptdtl_DealerCode, aptdtl_LocCode, aptdtl_IsTesting);
                    Response.Write(Result_Appntment_dTL);
                }
                else
                {
                    Response.Write("Null");
                }

                break;

            case ("ServiceVersion"):
                Response.Write(string.Format("Version - {0}, Changes - {1}", "2.4.3.17", "New SP MULDMS.PKG_JCO_1.SP_JCO_GET_WASH_TYPE"));
                break;

            //------------written new procedure to get RFID Details : 16 Oct 2017
            /*Added two more inputs : 16-Oct-2017    - Vectorofrm
            http://localhost//MarutiServiceDev/JCOService.aspx?func=GetRFTagDetails&parent_group=999&dealer_cd=99999&loc_cd=999&UserID=vinod.okf&vin=test
            */
            case ("GetRFTagDetails"):

                string rftdtl_ParentGroup = Convert.ToString(Request.QueryString["parent_group"]);
                Int32 rftdtl_DealerCode = Convert.ToInt32(Request.QueryString["dealer_cd"]);
                string rftdtl_LocCode = Convert.ToString(Request.QueryString["loc_cd"]);
                string rftdtl_UserID = Convert.ToString(Request.QueryString["UserID"]);
                string rftdtl_vin = Convert.ToString(Request.QueryString["vin"]);
                string srvCategory = Convert.ToString(Request.QueryString["srv_cat"]);



                if (rftdtl_ParentGroup != null && rftdtl_DealerCode != null && rftdtl_LocCode != null && rftdtl_UserID != null && rftdtl_vin != null)
                {
                    string Result_RFT_dTL = GetRFTagDetails(rftdtl_ParentGroup, rftdtl_DealerCode, rftdtl_LocCode, rftdtl_UserID, rftdtl_vin, srvCategory);
                    Response.Write(Result_RFT_dTL);
                }
                else
                {
                    Response.Write("Null");
                }

                break;

            //------------written new procedure to get Appointment Details : 16 Oct 2017
            /*Added two more inputs : 16-Oct-2017    - Vectorofrm
            http://localhost//MarutiServiceDev/JCOService.aspx?func=GetRFTagScanTime&dealer_cd=99999&loc_cd=999&UserID=vinod.okf&rftag_no=999945
            */
            case ("GetRFTagScanTime"):

                Int32 rftSt_DealerCode = Convert.ToInt32(Request.QueryString["dealer_cd"]);
                string rftSt_LocCode = Convert.ToString(Request.QueryString["loc_cd"]);
                string rftSt_UserID = Convert.ToString(Request.QueryString["UserID"]);
                string rftSt_RFTNo = Convert.ToString(Request.QueryString["rftag_no"]);
                string srvCategoryCd = Convert.ToString(Request.QueryString["srv_cat"]);



                if (rftSt_DealerCode != null && rftSt_LocCode != null && rftSt_UserID != null && rftSt_RFTNo != null)
                {
                    string Result_RFT_ST = GetRFTagScanTime(rftSt_DealerCode, rftSt_LocCode, rftSt_UserID, rftSt_RFTNo, srvCategoryCd);
                    Response.Write(Result_RFT_ST);
                }
                else
                {
                    Response.Write("Null");
                }

                break;

            //------------written new procedure to Push DMS Message  : 21 Feb 2018 - Vectorform
            /*
            http://localhost//MarutiServiceDev/JCOService.aspx?func=PushDMSMessage&tran_type=&parent_group=&dealer_cd=99999&loc_cd=999&comp_fa=&doc_type=&doc_num=&created_by=
            */
            case ("PushDMSMessage"):

                string push_TranType = Convert.ToString(Request.QueryString["tran_type"]);
                string push_ParentGroup = Convert.ToString(Request.QueryString["parent_group"]);
                Int32 push_DealerCode = Convert.ToInt32(Request.QueryString["dealer_cd"]);
                string push_LocCode = Convert.ToString(Request.QueryString["loc_cd"]);
                string push_CompFa = Convert.ToString(Request.QueryString["comp_fa"]);
                string push_DocType = Convert.ToString(Request.QueryString["doc_type"]);
                string push_DocNum = Convert.ToString(Request.QueryString["doc_num"]);
                string push_CreatedBy = Convert.ToString(Request.QueryString["created_by"]);

                if (push_TranType != null && push_ParentGroup != null && push_DealerCode != null && push_LocCode != null &&
                    push_CompFa != null && push_DocType != null && push_DocNum != null && push_CreatedBy != null)
                {
                    string Result_Push = PushDMSMessage(push_TranType, push_ParentGroup, push_DealerCode, push_LocCode, push_CompFa, push_DocType, push_DocNum, push_CreatedBy);
                    Response.Write(Result_Push);
                }
                else
                {
                    Response.Write("Null");
                }

                break;

            //------------written new procedure to Get Labour Details : 26 Feb 2018 - Vectorform
            /*
            http://localhost//MarutiServiceDev/JCOService.aspx?func=GetNJCOLabourDetails&parent=&dealer_cd=99999&loc_cd=999&reg_num=&srv_cat_cd=
             */
            case ("GetNJCOLabourDetails"):
                {
                    string ld_parent = Convert.ToString(Request.QueryString["parent"]);
                    int ld_dealer_cd = Convert.ToInt32(Request.QueryString["dealer_cd"]);
                    string ld_loc_cd = Convert.ToString(Request.QueryString["loc_cd"]);
                    string ld_reg_num = Convert.ToString(Request.QueryString["reg_num"]);
                    string ld_srv_cat_cd = Convert.ToString(Request.QueryString["srv_cat_cd"]);

                    if (!string.IsNullOrEmpty(ld_parent) && !string.IsNullOrEmpty(ld_loc_cd) && !string.IsNullOrEmpty(ld_reg_num) && !string.IsNullOrEmpty(ld_srv_cat_cd))
                    {
                        string result = dbHelper.GetNJCOLabourDetails(ld_parent, ld_dealer_cd, ld_loc_cd, ld_reg_num, ld_srv_cat_cd);
                        Response.Write(result);
                    }
                    else
                    {
                        Response.Write("Null");
                    }
                }
                break;


                #endregion

        }
    }

    /// <summary>
    /// JCDmdWeaValidate is used for validate domestic warranty
    /// </summary>
    /// <param name="pn_pmc"></param>
    /// <param name="pn_vin"></param>
    /// <param name="pn_ro_date"></param>
    /// <param name="pn_omr"></param>
    /// <param name="pn_demand"></param>
    /// <returns></returns>
    public string JCDmdWeaValidate(string pn_pmc, string pn_vin, string pn_ro_date, string pn_omr, string pn_demand)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();
            CMD = new OracleCommand("PKG_JCO_1.SP_JCO_DMD_WEA_VALIDATE", OBJ);
            CMD.Parameters.Add("PN_PMC", OracleDbType.Int16, 1, ParameterDirection.Input).Value = Convert.ToInt16(pn_pmc);
            CMD.Parameters.Add("PN_VIN", OracleDbType.Varchar2, 22, ParameterDirection.Input).Value = Convert.ToString(pn_vin);
            if (pn_ro_date == "")
                CMD.Parameters.Add("PN_RO_DATE", OracleDbType.Date, ParameterDirection.Input).Value = DBNull.Value;
            else
                CMD.Parameters.Add("PN_RO_DATE", OracleDbType.Date, ParameterDirection.Input).Value = Convert.ToDateTime(pn_ro_date);
            CMD.Parameters.Add("PN_OMR", OracleDbType.Int32, 8, ParameterDirection.Input).Value = Convert.ToString(pn_omr);
            CMD.Parameters.Add("PN_DEMAND", OracleDbType.Varchar2, 10, ParameterDirection.Input).Value = Convert.ToString(pn_demand);
            CMD.Parameters.Add("PO_ERR_CD", OracleDbType.Int32, 10).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("PO_ERR_MSG", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteReader();


            if (Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) == "0")
            {
                string javascriptStr = "{";
                javascriptStr = javascriptStr + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "\"" + ","
                                            //+ "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value) + "\"" + "\"";
                                            + "\"" + Convert.ToString("M") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value)) + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;

                Logger.SuccessLogPrint("JCDmdWeaValidate", "SP_JCO_DMD_WEA_VALIDATE", "PN_PMC': '" + pn_pmc + "', 'PN_VIN': '" + pn_vin + "', 'PN_RO_DATE':'" + pn_ro_date + "', 'PN_OMR':'" + pn_omr + "', 'PN_DEMAND':'" + pn_demand, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));

            }
            else
            {
                string javascriptStr = "{";
                javascriptStr = javascriptStr
                    + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "\"" + ","
                    + "\"" + Convert.ToString("M") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value)) + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;
            }
            //OBJ.Close();
        }
        catch (Exception EX)
        {
            OBJ.Close();
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("JCDmdWeaValidate", "SP_JCO_DMD_WEA_VALIDATE", "PN_PMC': '" + pn_pmc + "', 'PN_VIN': '" + pn_vin + "', 'PN_RO_DATE':'" + pn_ro_date + "', 'PN_OMR':'" + pn_omr + "', 'PN_DEMAND':'" + pn_demand, EX);
        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;
    }

    /// <summary>
    /// JCPartValidate function is used for validate the part 
    /// Created Date 18-JULY-2019
    /// </summary>
    /// <param name="pn_pmc"></param>
    /// <param name="pn_vin"></param>
    /// <param name="pn_srvtype"></param>
    /// <param name="pn_partno"></param>
    /// <returns></returns>
    public string JCPartValidate(string pn_pmc, string pn_vin, string pn_srvtype, string pn_partno)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();
            CMD = new OracleCommand("PKG_JCO_1.SP_JCO_PART_VALIDATE", OBJ);
            CMD.Parameters.Add("PN_PMC", OracleDbType.Int16, 1, ParameterDirection.Input).Value = Convert.ToInt16(pn_pmc);
            CMD.Parameters.Add("PN_VIN", OracleDbType.Varchar2, 22, ParameterDirection.Input).Value = Convert.ToString(pn_vin);
            CMD.Parameters.Add("PN_SRV_TYPE", OracleDbType.Varchar2, 5, ParameterDirection.Input).Value = Convert.ToString(pn_srvtype);
            CMD.Parameters.Add("PN_PART_NUM", OracleDbType.Varchar2, 15, ParameterDirection.Input).Value = Convert.ToString(pn_partno);
            CMD.Parameters.Add("PO_ERR_CD", OracleDbType.Int32, 10).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("PO_ERR_MSG", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteReader();


            if (Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) == "0")
            {
                string javascriptStr = "{";
                javascriptStr = javascriptStr + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "\"" + ","
                                            //+ "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value) + "\"" + "\"";
                                            + "\"" + Convert.ToString("M") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value)) + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;

                Logger.SuccessLogPrint("JCPartValidate", "SP_JCO_PART_VALIDATE", "'PN_PMC': '" + pn_pmc + "', 'PN_VIN': '" + pn_vin + "', 'PN_SRV_TYPE':'" + pn_srvtype + "','PN_PART_NUM':'" + pn_partno, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));
            }
            else
            {

                string javascriptStr = "{";
                javascriptStr = javascriptStr
                    + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "\"" + ","
                    //+ "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value) + "\"" + "\"";
                    + "\"" + Convert.ToString("M") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value)) + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;
            }
            //OBJ.Close();
        }
        catch (Exception EX)
        {
            OBJ.Close();
            //Result = ex.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("JCPartValidate", "SP_JCO_PART_VALIDATE", "'PN_PMC': '" + pn_pmc + "', 'PN_VIN': '" + pn_vin + "', 'PN_SRV_TYPE':'" + pn_srvtype + "','PN_PART_NUM':'" + pn_partno, EX);
        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;

    }

    public string LabourAutoFlow(string userId, string vin, string srvtype)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();

            CMD = new OracleCommand("pkg_jco_1.sp_jco_labor_autoflow", OBJ);
            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(userId);
            CMD.Parameters.Add("pn_vin", OracleDbType.Varchar2, 22, ParameterDirection.Input).Value = Convert.ToString(vin);
            CMD.Parameters.Add("pn_srv_type", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(srvtype);
            CMD.Parameters.Add("po_autoflow_flag", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_labor_cd_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 2000).Direction = ParameterDirection.Output;
            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();


            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {
                OracleDataReader dr = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_labor_cd_refcur"].Value).GetDataReader();

                string javascriptStr = "{";
                javascriptStr = javascriptStr + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                                            //+ "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_err_msg"].Value)) + ","
                                            + "\"" + Convert.ToString("FLAG") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_autoflow_flag"].Value)) + ","
                                            + "\"" + Convert.ToString("LABOR") + "\"" + ":" + "[";

                while (dr.Read())
                {
                    javascriptStr += "{" + "\"" + Convert.ToString("CD") + "\"" + ":" + "\"" + Convert.ToString(dr[0]) + "\"" + "," +
                                           "\"" + Convert.ToString("DESC") + "\"" + ":" + "\"" + dbHelper.EscapSpecialCharacters(Convert.ToString(dr[1])) + "\"" + "," +
                                            "\"" + Convert.ToString("SYSDE") + "\"" + ":" + "\"" + Convert.ToString(dr[2]) + "\"" + "," +
                                            "\"" + Convert.ToString("SUBSYSDE") + "\"" + ":" + "\"" + Convert.ToString(dr[3]) + "\"" + "," +
                                            "\"" + Convert.ToString("FRMHRS") + "\"" + ":" + "\"" + Convert.ToString(dr[4]) + "\"" + "," +
                                           "\"" + Convert.ToString("AMT") + "\"" + ":" + "\"" + Convert.ToString(dr[5]) + "\"" + "}" + ",";
                }

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "]" + "}";
                Result = javascriptStr;

                Logger.SuccessLogPrint("LabourAutoFlow", "sp_jco_labor_autoflow", "'pn_user_id': '" + userId + "', 'pn_vin': '" + vin + "', 'pn_srv_type':'" + srvtype, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));
            }
            else
            {
                string javascriptStr = "{";
                javascriptStr = javascriptStr + "\"" + Convert.ToString("S") + "\"" + ":"
                                           + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                                           + "\"" + Convert.ToString("M") + "\""
                                          + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "--" + Convert.ToString(userId) + "--" + Convert.ToString(vin) + "--" + Convert.ToString(srvtype) + "\"" + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;
            }
        }
        catch (Exception EX)
        {
            OBJ.Close();
            //Result = EX.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("LabourAutoFlow", "sp_jco_labor_autoflow", "'pn_user_id': '" + userId + "', 'pn_vin': '" + vin + "', 'pn_srv_type':'" + srvtype, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;
    }

    // added new function by gst on 30 april 2015
    public string NewServiceCategoryValidate(string UserID1, string vin, string ServiceTypeCode, Int32 OMR, string ronum)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();

            CMD = new OracleCommand("pkg_jco_1.sp_jco_get_srv_cat_validate", OBJ);
            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(UserID1);
            CMD.Parameters.Add("pn_vin", OracleDbType.Varchar2, 22, ParameterDirection.Input).Value = Convert.ToString(vin);
            CMD.Parameters.Add("pn_srv_type_cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(ServiceTypeCode);
            CMD.Parameters.Add("pn_omr", OracleDbType.Int32, 20, ParameterDirection.Input).Value = Convert.ToString(OMR);
            //added new parameter as on 19 jun 2015 pn_ro_num
            CMD.Parameters.Add("pn_ro_num", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(ronum);

            CMD.Parameters.Add("po_sub_srv_type_Cd", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_sub_srv_type_desc", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            //added new parameter on 21 NOV 2022 by GAGAN SHARMA
            CMD.Parameters.Add("po_srv_duedate", OracleDbType.Date).Direction = ParameterDirection.Output;
            //added new parameter on 30 NOV 2022 by GAGAN SHARMA
            CMD.Parameters.Add("po_srv_type_cd", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 2000).Direction = ParameterDirection.Output;
            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();


            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {
                string javascriptStr = "{";
                javascriptStr = javascriptStr + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                                            //+ "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_err_msg"].Value)) + ","
                                            //+ "\"" + Convert.ToString("SSRVTCD") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_sub_srv_type_Cd"].Value) + "\"" + ","
                                            + "\"" + Convert.ToString("SSRVTCD") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_sub_srv_type_Cd"].Value)) + ","
                                            //+ "\"" + Convert.ToString("SSRVTCDESC") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_sub_srv_type_desc"].Value) + "\"" + "\"";
                                            + "\"" + Convert.ToString("SSRVTCDESC") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_sub_srv_type_desc"].Value)) + "\"";
                //+ "\"" + Convert.ToString("SRV_DUE_DATE") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_srv_duedate"].Value)) + ","
                //+ "\"" + Convert.ToString("SRV_TYPE_CD") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_srv_type_cd"].Value)) + "\"";


                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;

                // Response.Write("po_sub_srv_type_Cd"+ Convert.ToString(CMD.Parameters["po_sub_srv_type_Cd"].Value));

                Logger.SuccessLogPrint("NewServiceCategoryValidate", "sp_jco_get_srv_cat_validate", "'pn_user_id': '" + UserID1 + "', 'pn_vin': '" + vin + "', 'pn_srv_type_cd':'" + ServiceTypeCode + "','pn_omr':'" + OMR + "','pn_ro_num':'" + ronum, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));
            }
            else
            {
                string javascriptStr = "{";
                javascriptStr = javascriptStr + "\"" + Convert.ToString("S") + "\"" + ":"
                                           + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                                           + "\"" + Convert.ToString("M") + "\""
                                          + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";


                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;



            }

            //OBJ.Close();

        }
        catch (Exception EX)
        {
            OBJ.Close();
            //Result = EX.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.SuccessLogPrint("NewServiceCategoryValidate", "sp_jco_get_srv_cat_validate", "'pn_user_id': '" + UserID1 + "', 'pn_vin': '" + vin + "', 'pn_srv_type_cd':'" + ServiceTypeCode + "','pn_omr':'" + OMR + "','pn_ro_num':'" + ronum, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;

    }

    //---------------------------NewServiceCategoryValidtate fn ends here--------------------- 

    // added new service call for Approval Status Codes
    public string ApprovalStatusCodes(string UserID)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();

            CMD = new OracleCommand("pkg_jco_1.SP_JCO_APPRV_STATUS", OBJ);
            CMD.Parameters.Add("PN_USER_ID", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(UserID);

            CMD.Parameters.Add("PO_STATUS_REFCUR", OracleDbType.RefCursor, 20).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("PO_ERR_CD", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("PO_ERR_MSG", OracleDbType.Varchar2, 2000).Direction = ParameterDirection.Output;
            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();


            if (Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) == "0")
            {
                OracleDataReader dr = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["PO_STATUS_REFCUR"].Value).GetDataReader();

                string javascriptStr = "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "0" + "\"" + ","
                                 + "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value) + "\"" + ","
                                 + "\"" + Convert.ToString("APSC") + "\"" + ":" + "[";
                while (dr.Read())
                {
                    javascriptStr = javascriptStr + "{" + "\"" + Convert.ToString(dr[0]) + "\"" + ":" + "\"" + Convert.ToString(dr[1]) + "\"" + "}" + ",";

                }
                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "]" + "}";

                Result = javascriptStr;
                if (dr != null)
                {
                    dr.Dispose();
                    dr = null;
                }
                Logger.SuccessLogPrint("ApprovalStatusCodes", "SP_JCO_APPRV_STATUS", "'PN_USER_ID': '" + UserID, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));

            }
            else
            {
                string javascriptStr = "{";
                javascriptStr = javascriptStr + "\"" + Convert.ToString("S") + "\"" + ":"
                                           + "\"" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "\"" + ","
                                           + "\"" + Convert.ToString("M") + "\""
                                          + ":" + "\"" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value) + "\"" + "\"";


                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;
            }

        }
        catch (Exception EX)
        {
            OBJ.Close();
            //Result = EX.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("ApprovalStatusCodes", "SP_JCO_APPRV_STATUS", "'PN_USER_ID': '" + UserID, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;

    }
    //---------------------------Approval Status Codes fn ends here--------------------- 

    //added new function GetVehicleModelDetail by gst on 30 april 2015
    public string GetVehicleModelDetail(string UserID1)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["Co?nectionStrings"]));
        try
        {
            OBJ.Open();

            CMD = new OracleCommand("pkg_jco_1.sp_get_veh_model_dtl", OBJ);
            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(UserID1);
            CMD.Parameters.Add("po_veh_mod_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 2000).Direction = ParameterDirection.Output;
            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();

            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {

                OracleDataReader dr = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_veh_mod_refcur"].Value).GetDataReader();

                string javascriptStr = "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "0" + "\"" + ","
                                 + "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + ","
                                 + "\"" + Convert.ToString("VMD") + "\"" + ":" + "[";
                while (dr.Read())
                {
                    javascriptStr = javascriptStr + "{" + "\"" + Convert.ToString(dr[0]) + "\"" + ":" + "\"" + Convert.ToString(dr[1]) + "\"" + "}" + ",";

                }
                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "]" + "}";
                //OBJ.Close();
                Result = javascriptStr;
                if (dr != null)
                {
                    dr.Dispose();
                    dr = null;
                }
                Logger.SuccessLogPrint("GetVehicleModelDetail", "sp_get_veh_model_dtl", "'pn_user_id': '" + UserID1, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));

            }
            else
            {
                string javascriptStr = "{";
                javascriptStr = javascriptStr
                      + ("\"" + Convert.ToString("S") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                    + "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"");
                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;

                //Result = Convert.ToString(CMD.Parameters["po_err_cd"].Value) + ":" + Convert.ToString(CMD.Parameters["po_err_msg"].Value);
            }
            //OBJ.Close();
        }
        catch (Exception EX)
        {
            OBJ.Close();
            //Result = ex.Message;
            Result = Result + ("{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}");
            Logger.ErrorLogException("GetVehicleModelDetail", "sp_get_veh_model_dtl", "'pn_user_id': '" + UserID1, EX);
        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;


    }
    //-----------  GetVehicleModelDetail fn ends here----------------------------



    //added new function GetVehicleSystemDetail by gst on 30 april 2015
    public string GetVehicleSystemDetail(string UserID1)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();

            CMD = new OracleCommand("pkg_jco_1.sp_get_veh_sys_dtl", OBJ);
            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(UserID1);
            CMD.Parameters.Add("po_veh_sys_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 2000).Direction = ParameterDirection.Output;
            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();

            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {

                OracleDataReader dr = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_veh_sys_refcur"].Value).GetDataReader();

                string javascriptStr = "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "0" + "\"" + ","
                                      //+ "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + ","
                                      + "\"" + Convert.ToString("M") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_err_msg"].Value)) + ","
                                        + "\"" + Convert.ToString("VSD") + "\"" + ":" + "[";
                while (dr.Read())
                {
                    javascriptStr = javascriptStr + "{" + "\"" + Convert.ToString(dr[0]) + "\"" + ":" + "\"" + Convert.ToString(dr[1]) + "\"" + "}" + ",";
                }
                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "]" + "}";
                //OBJ.Close();
                Result = javascriptStr;
                if (dr != null)
                {
                    dr.Dispose();
                    dr = null;
                }
                Logger.SuccessLogPrint("GetVehicleSystemDetail", "sp_get_veh_sys_dtl", "'pn_user_id': '" + UserID1, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));
            }
            else
            {
                string javascriptStr = "{";
                javascriptStr = javascriptStr
                    + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                    + "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";
                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;

            }
            //OBJ.Close();
        }
        catch (Exception EX)
        {
            OBJ.Close();
            //Result = ex.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("GetVehicleSystemDetail", "sp_get_veh_sys_dtl", "'pn_user_id': '" + UserID1, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;


    }
    //-----------  GetVehicleSystemDetail fn ends here----------------------------

    //added new fn GetVehicleSubSystemDetail by gst on 30 april 2015
    //http://localhost/MarutiServiceDev/JCOService.aspx?func=GetVehicleSubSystemDetail&userid=mul.mssd.sa1&veh_sys_cd=A
    public string GetVehicleSubSystemDetail(string UserID1, string veh_sys_cd)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();

            CMD = new OracleCommand("pkg_jco_1.sp_get_veh_sub_sys_dtl", OBJ);
            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(UserID1);
            CMD.Parameters.Add("pn_veh_sys_cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(veh_sys_cd);

            CMD.Parameters.Add("po_veh_sub_sys_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 2000).Direction = ParameterDirection.Output;
            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();

            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {

                OracleDataReader dr = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_veh_sub_sys_refcur"].Value).GetDataReader();

                string javascriptStr = "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "0" + "\"" + ","
                                   //+ "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + ","
                                   + "\"" + Convert.ToString("M") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_err_msg"].Value)) + ","
                                     + "\"" + Convert.ToString("VSSD") + "\"" + ":" + "[";
                while (dr.Read())
                {
                    javascriptStr = javascriptStr + "{" + "\"" + Convert.ToString(dr[0]) + "\"" + ":" + "\"" + Convert.ToString(dr[1]) + "\"" + "}" + ",";
                }
                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "]" + "}";
                //OBJ.Close();
                Result = javascriptStr;
                if (dr != null)
                {
                    dr.Dispose();
                    dr = null;
                }
                Logger.SuccessLogPrint("GetVehicleSubSystemDetail", "sp_get_veh_sub_sys_dtl", "'pn_user_id': '" + UserID1 + "','pn_veh_sys_cd':'" + veh_sys_cd, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));
            }
            else
            {
                string javascriptStr = "{";
                javascriptStr = javascriptStr
                    + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                    + "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";
                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;

            }
            //OBJ.Close();
        }
        catch (Exception EX)
        {
            OBJ.Close();
            //Result = ex.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("GetVehicleSubSystemDetail", "sp_get_veh_sub_sys_dtl", "'pn_user_id': '" + UserID1 + "','pn_veh_sys_cd':'" + veh_sys_cd, EX);
        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;


    }
    //-----------  GetVehicleSubSystemDetail fn ends here----------------------------

    //added new fn LaborCodeValidtate by gst on 30 april 2015
    public string LaborCodeValidtate(string UserID1, string opr_cd, string svar_cd, string srv_cat_cd)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();

            CMD = new OracleCommand("pkg_jco_1.sp_jco_labor_cd_validate", OBJ);
            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(UserID1);
            CMD.Parameters.Add("pn_opr_cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(opr_cd);
            CMD.Parameters.Add("pn_svar_cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(svar_cd);
            CMD.Parameters.Add("pn_srv_cat_cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(srv_cat_cd);


            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 2000).Direction = ParameterDirection.Output;
            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();


            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {
                string javascriptStr = "{";
                javascriptStr = javascriptStr + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                                 + "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;

                Logger.SuccessLogPrint("LaborCodeValidtate", "sp_jco_labor_cd_validate", "'pn_user_id': '" + UserID1 + "','pn_opr_cd':'" + opr_cd + "','pn_svar_cd':'" + svar_cd + "','pn_srv_cat_cd':'" + srv_cat_cd, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));

            }
            else
            {
                string javascriptStr = "{";
                javascriptStr = javascriptStr + "\"" + Convert.ToString("S") + "\"" + ":"
                                           + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                                          + "\"" + Convert.ToString("M") + "\""
                                          + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";


                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;



            }

            //OBJ.Close();

        }
        catch (Exception EX)
        {
            OBJ.Close();
            //Result = EX.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("LaborCodeValidtate", "sp_jco_labor_cd_validate", "'pn_user_id': '" + UserID1 + "','pn_opr_cd':'" + opr_cd + "','pn_svar_cd':'" + svar_cd + "','pn_srv_cat_cd':'" + srv_cat_cd, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;

    }
    //-----------  LaborCodeValidtate fn ends here----------------------------

    // added new fn DemandCodeValidate by gst on 30 april 2015
    public string DemandCodeValidate(string UserID1, string demand_cd, string srv_cat_cd1)
    {

        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();

            CMD = new OracleCommand("pkg_jco_1.sp_jco_demand_cd_validate", OBJ);
            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(UserID1);
            CMD.Parameters.Add("pn_demand_cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(demand_cd);
            CMD.Parameters.Add("pn_srv_cat_cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(srv_cat_cd1);


            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 2000).Direction = ParameterDirection.Output;
            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();


            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {
                string javascriptStr = "{";
                javascriptStr = javascriptStr + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                          + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;

                Logger.SuccessLogPrint("DemandCodeValidate", "sp_jco_demand_cd_validate", "'pn_user_id': '" + UserID1 + "','pn_demand_cd':'" + demand_cd + "','pn_srv_cat_cd':'" + srv_cat_cd1, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));
            }
            else
            {
                string javascriptStr = "{";
                javascriptStr = javascriptStr + "\"" + Convert.ToString("S") + "\"" + ":"
                                           + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                                           + "\"" + Convert.ToString("M") + "\""
                                          + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";


                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;



            }

            //OBJ.Close();


        }
        catch (Exception EX)
        {
            OBJ.Close();
            //Result = EX.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("DemandCodeValidate", "sp_jco_demand_cd_validate", "'pn_user_id': '" + UserID1 + "','pn_demand_cd':'" + demand_cd + "','pn_srv_cat_cd':'" + srv_cat_cd1, EX);
        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;


    }
    //-----------  DemandCodeValidate fn ends here----------------------------

    //added new function GetUnApprovedFitment by gst on 30 april 2015
    public string GetUnApprovedFitment(string UserID1)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();

            CMD = new OracleCommand("pkg_jco_1.sp_jco_get_unapprv_fitment", OBJ);
            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(UserID1);
            CMD.Parameters.Add("po_unapprv_fitment_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 2000).Direction = ParameterDirection.Output;
            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();

            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {

                OracleDataReader dr = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_unapprv_fitment_refcur"].Value).GetDataReader();

                string javascriptStr = "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "0" + "\"" + ","
                                    //+ "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + ","
                                    + "\"" + Convert.ToString("M") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_err_msg"].Value)) + ","
                                        + "\"" + Convert.ToString("UAFT") + "\"" + ":" + "[";
                while (dr.Read())
                {
                    javascriptStr = javascriptStr + "{" + "\"" + Convert.ToString(dr[0]) + "\"" + ":" + "\"" + Convert.ToString(dr[1]) + "\"" + "}" + ",";
                }
                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "]" + "}";
                //OBJ.Close();
                Result = javascriptStr;
                if (dr != null)
                {
                    dr.Dispose();
                    dr = null;
                }
                Logger.SuccessLogPrint("GetUnApprovedFitment", "sp_jco_get_unapprv_fitment", "'pn_user_id': '" + UserID1, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));

            }
            else
            {
                string javascriptStr = "{";
                javascriptStr = javascriptStr
                    + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                    + "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";
                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;

                //Result = Convert.ToString(CMD.Parameters["po_err_cd"].Value) + ":" + Convert.ToString(CMD.Parameters["po_err_msg"].Value);
            }
            //OBJ.Close();
        }
        catch (Exception EX)
        {
            OBJ.Close();
            //Result = ex.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("GetUnApprovedFitment", "sp_jco_get_unapprv_fitment", "'pn_user_id': '" + UserID1, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;


    }
    //-----------  GetUnApprovedFitment fn ends here----------------------------

    // ---------------------------------------added new functions on 6 may 2015 by gst------------------------------
    public string NewUserCustomerVehicleDetails(string RegNum, string Vin, string userID, string FindId)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["conoracle_PushApi"]));
        OracleDataReader dr = null;

        try
        {
            OBJ.Open();
            //CMD = new OracleCommand("pkg_jco_1.sp_jco_get_cust_veh_dtl", OBJ);            

            //added new sp name as per Mahima San ITD email 13JAN2020
            CMD = new OracleCommand("pkg_jco_1.sp_jco_get_cust_veh_dtl1", OBJ);

            //added new parameter pn_reg_num with inout parameter 06JAN2020 by mukesh sinha
            OracleParameter InOutParam = new OracleParameter("pn_reg_num", OracleDbType.Varchar2, 20);
            InOutParam.Direction = ParameterDirection.InputOutput;
            InOutParam.Value = RegNum;
            CMD.Parameters.Add(InOutParam);

            //added new parameter PN_VIN 18DEC2019 by mukesh sinha
            CMD.Parameters.Add("PN_VIN", OracleDbType.Varchar2, 22, ParameterDirection.Input).Value = Vin;
            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = userID;
            //New input parmeter PN_FIND_ID added by mukesh sinha 01JUNE2021 for Sensegiz application
            CMD.Parameters.Add("PN_FIND_ID", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = FindId;
            CMD.Parameters.Add("pco_cust_id", OracleDbType.Varchar2, 10).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("pco_cust_name ", OracleDbType.Varchar2, 30).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("pco_cust_add1", OracleDbType.Varchar2, 50).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("pco_cust_add2", OracleDbType.Varchar2, 50).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("pco_cust_add3", OracleDbType.Varchar2, 50).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("pco_city_cd", OracleDbType.Varchar2, 3).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("pco_city_desc", OracleDbType.Varchar2, 50).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("pco_email", OracleDbType.Varchar2, 100).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("pco_email1", OracleDbType.Varchar2, 100).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("pco_phone", OracleDbType.Varchar2, 50).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("pco_work_phone", OracleDbType.Varchar2, 50).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("pco_mobile", OracleDbType.Varchar2, 50).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("pco_dob", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("pco_doa", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("pvo_model_cd", OracleDbType.Varchar2, 7).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("pvo_model_desc", OracleDbType.Varchar2, 50).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("pvo_variant_cd", OracleDbType.Varchar2, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("pvo_variant_desc", OracleDbType.Varchar2, 50).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("pvo_color_cd", OracleDbType.Varchar2, 4).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("pvo_color_desc", OracleDbType.Varchar2, 30).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("pvo_vin", OracleDbType.Varchar2, 22).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("pvo_chassis_num", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("pvo_engine_prefix", OracleDbType.Varchar2, 5).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("pvo_engine_num", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("pvo_sale_date", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("pvo_tech_campaign", OracleDbType.Varchar2, 1).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("pvo_revisit_status", OracleDbType.Varchar2, 5).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("pvo_cust_cat", OracleDbType.Varchar2, 5).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("pvo_srv_adv_cd", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("pvo_tv_flag", OracleDbType.Varchar2, 1).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("pvo_tv_contract_no", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("pvo_tv_expiry_date", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("pvo_tv_sale_date", OracleDbType.Date).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("pvo_n2n_flag", OracleDbType.Varchar2, 1).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("pvo_n2n_contract_no", OracleDbType.Varchar2, 50).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("pvo_n2n_expiry_date", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("pvo_ew_type", OracleDbType.Varchar2, 5).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("pvo_ew_contract_no", OracleDbType.Varchar2, 12).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("pvo_ew_expiry_date", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("pvo_mi_flag", OracleDbType.Varchar2, 1).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("pvo_mi_policy_no", OracleDbType.Varchar2, 25).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("pvo_mi_validity_date", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("pvo_amc_yn", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("pvo_amc_enrol_no", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("pvo_amc_package_name", OracleDbType.Varchar2, 100).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("pvo_amc_expiry_date", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("pvo_vehicle_checkin_date", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("pvo_last_omr", OracleDbType.Int32, 20).Direction = ParameterDirection.Output;

            //Added new parameter PVO_SUBS_YN and ref cursor PO_PVO_SUBSCRIBER_DET added by mukesh sinha 15NOV2019
            CMD.Parameters.Add("PVO_SUBS_YN", OracleDbType.Varchar2, 1).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("PVO_SUBSCRIBER_DET", OracleDbType.RefCursor).Direction = ParameterDirection.Output;

            //Added new parameter ref cursor PVO_SUBSCRIPTION_HIST added by mukesh sinha 26DEC2019
            CMD.Parameters.Add("PVO_SUBSCRIPTION_HIST", OracleDbType.RefCursor).Direction = ParameterDirection.Output;

            //Added new parameter PVO_FIRST_SERV_YN added by mukesh sinha 27FEB2020
            //CMD.Parameters.Add("PVO_FIRST_SERV_YN", OracleDbType.Varchar2, 1).Direction = ParameterDirection.Output;

            //Added new three parameter by mukesh sinha 13APRIL2020
            CMD.Parameters.Add("PO_DIY_SRV_TYPE", OracleDbType.Varchar2, 5).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("PO_DIY_SRV_TYPE_DESC", OracleDbType.Varchar2, 100).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("PO_DIY_ODOMETER", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("PO_DIY_CUST_DMD_YN", OracleDbType.Varchar2, 1).Direction = ParameterDirection.Output;

            // added new po_Counter_measure output parameter by mukesh sinha 14JAN2020 Output flag - Y/N
            CMD.Parameters.Add("po_Counter_measure", OracleDbType.Varchar2, 10).Direction = ParameterDirection.Output;

            //Added new po_find_id_yn output parameter by mukesh sinha 14JAN2021 for Sensegiz application 
            CMD.Parameters.Add("po_find_id_yn", OracleDbType.Varchar2, 1).Direction = ParameterDirection.Output;

            //Added new out parameter po_ccp_yn by GAGAN Sharma 10MARCH2022 for MTAB
            CMD.Parameters.Add("po_ccp_yn", OracleDbType.Varchar2, 1).Direction = ParameterDirection.Output;

            //Added new out parameter PO_RECALL_PIC_YN by GAGAN Sharma 4APRIL2022
            CMD.Parameters.Add("PO_RECALL_PIC_YN", OracleDbType.Varchar2, 1).Direction = ParameterDirection.Output;

            //Added new parameter ref cursor po_ccp_refcur Cursor sby gagan sharma 6MAY2022//
            CMD.Parameters.Add("po_ccp_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;

            //Added new out parameter po_subsequent_visit_yn sby gagan sharma 13SEPT2022//
            CMD.Parameters.Add("po_subsequent_visit_yn", OracleDbType.Varchar2, 1).Direction = ParameterDirection.Output;

            //Added new out parameter PO_TC_YN_NEW  sby gagan sharma 27 OCT 2022//
            CMD.Parameters.Add("PO_TC_YN_NEW", OracleDbType.Varchar2, 1).Direction = ParameterDirection.Output;
            //Added new out parameter PO_RECALL_PIC_YN_NEW  sby gagan sharma 27 OCT 2022//
            CMD.Parameters.Add("PO_RECALL_PIC_YN_NEW", OracleDbType.Varchar2, 1).Direction = ParameterDirection.Output;

            //PVO_FC_OK Added by GAGAN SHARMA 20 FEB 2023
            CMD.Parameters.Add("PVO_FC_OK", OracleDbType.Date).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("PVO_CATALYTIC_CONV_NUM", OracleDbType.Varchar2, 50).Direction = ParameterDirection.Output;

            //Added new refcursor PO_holdup_refcur  by GAGAN SHARMA 23 NOV 2022
            //CMD.Parameters.Add("PO_holdup_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;

            //added by GAGAN 30 JUNE 2023
            CMD.Parameters.Add("PVO_CORP_CUST_FLAG", OracleDbType.Varchar2, 1).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("PVO_CORP_NAME", OracleDbType.Varchar2, 500).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 500).Direction = ParameterDirection.Output;

            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();
            //Response.Write("em="+CMD.Parameters["pvo_amc_expiry_date"].Value);

            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0" || Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "-6502")
            {
                string strSplChar = @"\";
                //Response.Write("em="+CMD.Parameters["pco_email"].Value);
                string javascriptStr = "{";
                javascriptStr = javascriptStr
                    + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "0" + "\"" + ","
                    //+ "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + ","
                    + "\"" + Convert.ToString("M") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_err_msg"].Value)) + ","
                    + "\"" + Convert.ToString("ID") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["pco_cust_id"].Value)) + ","
                    + "\"" + Convert.ToString("CN") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["pco_cust_name "].Value)) + ","
                    + "\"" + Convert.ToString("A1") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["pco_cust_add1"].Value)) + ","
                    + "\"" + Convert.ToString("A2") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["pco_cust_add2"].Value)) + ","
                    + "\"" + Convert.ToString("A3") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["pco_cust_add3"].Value)) + ","
                    + "\"" + Convert.ToString("CC") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["pco_city_cd"].Value)) + ","
                    + "\"" + Convert.ToString("CD") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["pco_city_desc"].Value)) + ","
                    //+ "\"" + Convert.ToString("EM") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["pco_email"].Value).Replace(strSplChar, "") + "\"" + ","
                    + "\"" + Convert.ToString("EM") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["pco_email"].Value).Replace(strSplChar, "")) + ","
                    //+ "\"" + Convert.ToString("EM1") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["pco_email1"].Value).Replace(strSplChar, "") + "\"" + ","
                    + "\"" + Convert.ToString("EM1") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["pco_email1"].Value).Replace(strSplChar, "")) + ","
                    //+ "\"" + Convert.ToString("PH") + "\"" + ":" + "\"" + CMD.Parameters["pco_phone"].Value + "\"" + ","
                    + "\"" + Convert.ToString("PH") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["pco_phone"].Value)) + ","
                    //+ "\"" + Convert.ToString("WP") + "\"" + ":" + "\"" + CMD.Parameters["pco_work_phone"].Value + "\"" + ","
                    + "\"" + Convert.ToString("WP") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["pco_work_phone"].Value)) + ","
                    + "\"" + Convert.ToString("MO") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["pco_mobile"].Value)) + ","
                    + "\"" + Convert.ToString("DB") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["pco_dob"].Value)) + ","
                    //+ "\"" + Convert.ToString("PD") + "\"" + ":" + "\"" + CMD.Parameters["pco_doa"].Value + "\"" + ","
                    + "\"" + Convert.ToString("PD") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["pco_doa"].Value)) + ","

                    + "\"" + Convert.ToString("MC") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["pvo_model_cd"].Value)) + ","
                    + "\"" + Convert.ToString("MD") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["pvo_model_desc"].Value)) + ","
                    + "\"" + Convert.ToString("VC") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["pvo_variant_cd"].Value)) + ","
                    + "\"" + Convert.ToString("VD") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["pvo_variant_desc"].Value)) + ","
                    + "\"" + Convert.ToString("CO") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["pvo_color_cd"].Value)) + ","
                    + "\"" + Convert.ToString("DE") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["pvo_color_desc"].Value)) + ","
                    + "\"" + Convert.ToString("VI") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["pvo_vin"].Value)) + ","
                    + "\"" + Convert.ToString("CHSN") + "\"" + ":" + "\"" + CMD.Parameters["pvo_chassis_num"].Value + "\"" + ","

                    + "\"" + Convert.ToString("ENP") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["pvo_engine_prefix"].Value)) + ","
                    + "\"" + Convert.ToString("EN") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["pvo_engine_num"].Value)) + ","
                    + "\"" + Convert.ToString("SD") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["pvo_sale_date"].Value)) + ","
                    + "\"" + Convert.ToString("TC") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["pvo_tech_campaign"].Value)) + ","
                    //+ "\"" + Convert.ToString("RVS") + "\"" + ":" + "\"" + CMD.Parameters["pvo_revisit_status"].Value + "\"" + ","
                    + "\"" + Convert.ToString("RVS") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["pvo_revisit_status"].Value)) + ","
                    //+ "\"" + Convert.ToString("CCT") + "\"" + ":" + "\"" + CMD.Parameters["pvo_cust_cat"].Value + "\"" + ","
                    + "\"" + Convert.ToString("CCT") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["pvo_cust_cat"].Value)) + ","
                    + "\"" + Convert.ToString("SACD") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["pvo_srv_adv_cd"].Value)) + ","

                    + "\"" + Convert.ToString("FG") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["pvo_tv_flag"].Value)) + ","
                    + "\"" + Convert.ToString("TVCN") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["pvo_tv_contract_no"].Value)) + ","
                    + "\"" + Convert.ToString("TS") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["pvo_tv_sale_date"].Value)) + ","
                    + "\"" + Convert.ToString("ED") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["pvo_tv_expiry_date"].Value)) + ","

                    + "\"" + Convert.ToString("PF") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["pvo_n2n_flag"].Value)) + ","
                    //+ "\"" + Convert.ToString("PN") + "\"" + ":" + "\"" + CMD.Parameters["pvo_n2n_contract_no"].Value + "\"" + ","
                    + "\"" + Convert.ToString("PN") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["pvo_n2n_contract_no"].Value)) + ","
                    //+ "\"" + Convert.ToString("PE") + "\"" + ":" + "\"" + CMD.Parameters["pvo_n2n_expiry_date"].Value + "\"" + ","
                    + "\"" + Convert.ToString("PE") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["pvo_n2n_expiry_date"].Value)) + ","

                    //+ "\"" + Convert.ToString("WT") + "\"" + ":" + "\"" + CMD.Parameters["pvo_ew_type"].Value + "\"" + ","
                    + "\"" + Convert.ToString("WT") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["pvo_ew_type"].Value)) + ","
                    //+ "\"" + Convert.ToString("WC") + "\"" + ":" + "\"" + CMD.Parameters["pvo_ew_contract_no"].Value + "\"" + ","
                    + "\"" + Convert.ToString("WC") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["pvo_ew_contract_no"].Value)) + ","
                    //+ "\"" + Convert.ToString("EE") + "\"" + ":" + "\"" + CMD.Parameters["pvo_ew_expiry_date"].Value + "\"" + ","
                    + "\"" + Convert.ToString("EE") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["pvo_ew_expiry_date"].Value)) + ","

                    + "\"" + Convert.ToString("MF") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["pvo_mi_flag"].Value)) + ","
                    + "\"" + Convert.ToString("PM") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["pvo_mi_policy_no"].Value)) + ","
                    + "\"" + Convert.ToString("TA") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["pvo_mi_validity_date"].Value)) + ","

                    + "\"" + Convert.ToString("AYN") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["pvo_amc_yn"].Value)) + ","

                    //+ "\"" + Convert.ToString("AEN") + "\"" + ":" + "\"" + CMD.Parameters["pvo_amc_enrol_no"].Value + "\"" + ","
                    + "\"" + Convert.ToString("AEN") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["pvo_amc_enrol_no"].Value)) + ","
                    //+ "\"" + Convert.ToString("APN") + "\"" + ":" + "\"" + CMD.Parameters["pvo_amc_package_name"].Value + "\"" + ","
                    + "\"" + Convert.ToString("APN") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["pvo_amc_package_name"].Value)) + ","
                    //+ "\"" + Convert.ToString("AEDT") + "\"" + ":" + "\"" + CMD.Parameters["pvo_amc_expiry_date"].Value + "\"" + ","
                    + "\"" + Convert.ToString("AEDT") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["pvo_amc_expiry_date"].Value)) + ","
                    //+ "\"" + Convert.ToString("VCDT") + "\"" + ":" + "\"" + CMD.Parameters["pvo_vehicle_checkin_date"].Value + "\"" + ","
                    + "\"" + Convert.ToString("VCDT") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["pvo_vehicle_checkin_date"].Value)) + ","

                    + "\"" + Convert.ToString("LOMR") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["pvo_last_omr"].Value)) + ","
                    + "\"" + Convert.ToString("SUBS_YN") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["PVO_SUBS_YN"].Value)) + ","
                    //added new out parameter pn_reg_num by mukesh sinha 06JAN2020
                    + "\"" + Convert.ToString("REG_NUM") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["pn_reg_num"].Value)) + ","
                    //+ "\"" + Convert.ToString("FIRST_SERV_YN") + "\"" + ":" + "\"" + CMD.Parameters["PVO_FIRST_SERV_YN"].Value + "\"" + ","
                    //added new three out parameter by mukesh sinha 13APRIL2020

                    //+ "\"" + Convert.ToString("DIY_SRV_TYPE") + "\"" + ":" + "\"" + CMD.Parameters["PO_DIY_SRV_TYPE"].Value + "\"" + ","
                    + "\"" + Convert.ToString("DIY_SRV_TYPE") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["PO_DIY_SRV_TYPE"].Value)) + ","
                    //+ "\"" + Convert.ToString("DIY_SRV_TYPE_DESC") + "\"" + ":" + "\"" + CMD.Parameters["PO_DIY_SRV_TYPE_DESC"].Value + "\"" + ","
                    + "\"" + Convert.ToString("DIY_SRV_TYPE_DESC") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["PO_DIY_SRV_TYPE_DESC"].Value)) + ","
                    //+ "\"" + Convert.ToString("DIY_ODOMETER") + "\"" + ":" + "\"" + CMD.Parameters["PO_DIY_ODOMETER"].Value + "\"" + ","
                    + "\"" + Convert.ToString("DIY_ODOMETER") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["PO_DIY_ODOMETER"].Value)) + ","
                    + "\"" + Convert.ToString("COUNTER_MEASURE") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_Counter_measure"].Value)) + ","
                    + "\"" + Convert.ToString("FIND_ID_YN") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_find_id_yn"].Value)) + ","
                    //Added New Parameter by gagan sharma 10MARCH2022
                    + "\"" + Convert.ToString("CCP_YN") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_ccp_yn"].Value)) + ","

                    //Added New Parameter by gagan sharma 4APRIL2022
                    + "\"" + Convert.ToString("RECALL_PIC") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["PO_RECALL_PIC_YN"].Value)) + ","

                    + "\"" + Convert.ToString("DIY_CUST_DMD_YN") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["PO_DIY_CUST_DMD_YN"].Value)) + ","
                     //Added by GAGAN SHARMA 19 SEPT 2022
                     + "\"" + Convert.ToString("Subsequent_Visit_YN") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_subsequent_visit_yn"].Value)) + ","
                     //Added by GAGAN SHARMA 27 OCT 2022
                     + "\"" + Convert.ToString("TC_YN_NEW") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["PO_TC_YN_NEW"].Value)) + ","
                     //Added by GAGAN SHARMA 27 OCT 2022
                     + "\"" + Convert.ToString("RECALL_PIC_YN_NEW") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["PO_RECALL_PIC_YN_NEW"].Value)) + ","
                      //Added by GAGAN SHARMA 20 FEB 2023
                      + "\"" + Convert.ToString("FC_OK") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["PVO_FC_OK"].Value)) + ","
                       + "\"" + Convert.ToString("CATALYTIC_NUM") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["PVO_CATALYTIC_CONV_NUM"].Value)) + ","
                + "\"" + Convert.ToString("PVO_CORP_CUST_FLAG") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["PVO_CORP_CUST_FLAG"].Value)) + ",";
                //+ "\"" + Convert.ToString("PVO_CORP_NAME") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["PVO_CORP_NAME"].Value)) + ",";

                //Added new parameter ref cursor PO_PVO_SUBSCRIBER_DET added by mukesh sinha 15NOV2019
                dr = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["PVO_SUBSCRIBER_DET"].Value).GetDataReader();
                javascriptStr = javascriptStr + "\"" + "SUBSCRIBER_DET" + "\"" + ":" + "[";

                int cnt = 0;

                while (dr.Read())
                {
                    cnt = 1;
                    javascriptStr = javascriptStr + "{" + "\"" + Convert.ToString("DMS_SUBSCRIBER_ID") + "\"" + ":" + "\"" + Convert.ToString(dr[0]) + "\"" + ","
                                     + "\"" + Convert.ToString("SUBS_NAME") + "\"" + ":" + "\"" + Convert.ToString(dr[1]) + "\"" + ","
                                     + "\"" + Convert.ToString("SUBS_EMAIL") + "\"" + ":" + "\"" + Convert.ToString(dr[2]) + "\"" + ","
                                     + "\"" + Convert.ToString("SUBS_DOB") + "\"" + ":" + "\"" + Convert.ToString(dr[3]) + "\"" + ","
                                     + "\"" + Convert.ToString("SUBS_ADD1") + "\"" + ":" + "\"" + Convert.ToString(dr[4]) + "\"" + ","
                                     + "\"" + Convert.ToString("SUBS_ADD2") + "\"" + ":" + "\"" + Convert.ToString(dr[5]) + "\"" + ","
                                     + "\"" + Convert.ToString("SUBS_ADD3") + "\"" + ":" + "\"" + Convert.ToString(dr[6]) + "\"" + ","
                                     + "\"" + Convert.ToString("SUBS_PIN") + "\"" + ":" + "\"" + Convert.ToString(dr[7]) + "\"" + ","
                                     + "\"" + Convert.ToString("SUBS_CITY_CD") + "\"" + ":" + "\"" + Convert.ToString(dr[8]) + "\"" + ","
                                     + "\"" + Convert.ToString("SUBS_CITY_DESC") + "\"" + ":" + "\"" + Convert.ToString(dr[9]) + "\"" + ","
                                     + "\"" + Convert.ToString("SUBS_STATE_CD") + "\"" + ":" + "\"" + Convert.ToString(dr[10]) + "\"" + ","
                                     + "\"" + Convert.ToString("SUBS_STATE_DESC") + "\"" + ":" + "\"" + Convert.ToString(dr[11]) + "\"" + ","
                                     + "\"" + Convert.ToString("SUBS_MOBILE") + "\"" + ":" + "\"" + Convert.ToString(dr[12]) + "\"" + "}" + "," + "";
                }

                if (cnt == 1)
                {
                    javascriptStr = javascriptStr.Remove(javascriptStr.Length - 1, 1);
                }

                javascriptStr = javascriptStr + "]" + ",";
                if (dr != null)
                {
                    dr.Dispose();
                    dr = null;
                }

                //Added new parameter ref cursor PVO_SUBSCRIPTION_HIST added by mukesh sinha 26DEC2019
                dr = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["PVO_SUBSCRIPTION_HIST"].Value).GetDataReader();
                javascriptStr = javascriptStr + "\"" + "SUBSCRIPTION_HIST" + "\"" + ":" + "[";


                while (dr.Read())
                {
                    cnt = 2;
                    javascriptStr = javascriptStr + "{" + "\"" + Convert.ToString("DMS_SUBSCRIBER_ID") + "\"" + ":" + "\"" + Convert.ToString(dr[0]) + "\"" + ","
                                     + "\"" + Convert.ToString("SUBS_NAME") + "\"" + ":" + "\"" + Convert.ToString(dr[1]) + "\"" + ","
                                     + "\"" + Convert.ToString("FROM_DATE") + "\"" + ":" + "\"" + Convert.ToString(dr[2]) + "\"" + ","
                                     + "\"" + Convert.ToString("TO_DATE") + "\"" + ":" + "\"" + Convert.ToString(dr[3]) + "\"" + ","
                                     + "\"" + Convert.ToString("SUBS_EMAIL") + "\"" + ":" + "\"" + Convert.ToString(dr[4]) + "\"" + ","
                                     + "\"" + Convert.ToString("SUBS_DOB") + "\"" + ":" + "\"" + Convert.ToString(dr[5]) + "\"" + ","
                                     + "\"" + Convert.ToString("SUBS_ADD1") + "\"" + ":" + "\"" + Convert.ToString(dr[6]) + "\"" + ","
                                     + "\"" + Convert.ToString("SUBS_ADD2") + "\"" + ":" + "\"" + Convert.ToString(dr[7]) + "\"" + ","
                                     + "\"" + Convert.ToString("SUBS_ADD3") + "\"" + ":" + "\"" + Convert.ToString(dr[8]) + "\"" + ","
                                     + "\"" + Convert.ToString("SUBS_PIN") + "\"" + ":" + "\"" + Convert.ToString(dr[9]) + "\"" + ","
                                     + "\"" + Convert.ToString("SUBS_CITY_CD") + "\"" + ":" + "\"" + Convert.ToString(dr[10]) + "\"" + ","
                                     + "\"" + Convert.ToString("SUBS_CITY_DESC") + "\"" + ":" + "\"" + Convert.ToString(dr[11]) + "\"" + ","
                                     + "\"" + Convert.ToString("SUBS_STATE_CD") + "\"" + ":" + "\"" + Convert.ToString(dr[12]) + "\"" + ","
                                     + "\"" + Convert.ToString("SUBS_STATE_DESC") + "\"" + ":" + "\"" + Convert.ToString(dr[13]) + "\"" + ","
                                     + "\"" + Convert.ToString("SUBS_MOBILE") + "\"" + ":" + "\"" + Convert.ToString(dr[14]) + "\"" + "}" + "," + "";
                }
                if (cnt == 2)
                {
                    javascriptStr = javascriptStr.Remove(javascriptStr.Length - 1, 1);
                }
                javascriptStr = javascriptStr + "]" + ",";
                if (dr != null)
                {
                    dr.Dispose();
                    dr = null;
                }
                //Added new parameter po_ccp_refcur added by gagan sharma 6MAY2022
                dr = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_ccp_refcur"].Value).GetDataReader();
                javascriptStr = javascriptStr + "\"" + "po_ccp_refcur" + "\"" + ":" + "[";


                while (dr.Read())
                {
                    cnt = 3;
                    javascriptStr = javascriptStr + "{" + "\"" + Convert.ToString("CCP_PolicyNo") + "\"" + ":" + "\"" + Convert.ToString(dr["CCP_PolicyNo"]) + "\"" + ","
                                     + "\"" + Convert.ToString("CCP_Validity") + "\"" + ":" + "\"" + Convert.ToString(dr["CCP_Validity"]) + "\"" + ","
                                     + "\"" + Convert.ToString("CCP_Description") + "\"" + ":" + "\"" + Convert.ToString(dr["CCP_Description"]) + "\"" + ","
                                     + "\"" + Convert.ToString("CCP_RENEWABLE_YN") + "\"" + ":" + "\"" + Convert.ToString(dr["ccp_renewable_yn"]) + "\"" + "}" + "," + "";
                    //added CCP_RENEWABLE_YN as on 24APRIL23 by Nagmani Chauhan
                }

                if (cnt == 3)
                {
                    javascriptStr = javascriptStr.Remove(javascriptStr.Length - 1, 1);
                }
                //javascriptStr = javascriptStr + "]" + ",";
                //if (dr != null)
                //{
                ///    dr.Dispose();
                //    dr = null;
                // }
                //Added new parameter PO_holdup_refcur added by gagan sharma 23 NOV 2022
                // dr = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["PO_holdup_refcur"].Value).GetDataReader();
                //javascriptStr = javascriptStr + "\"" + "PO_holdup_refcur" + "\"" + ":" + "[";

                //while (dr.Read())
                //{
                ////    cnt = 4;
                //    javascriptStr = javascriptStr + "{" + "\"" + Convert.ToString("REASON_DESC") + "\"" + ":" + "\"" + Convert.ToString(dr["REASON_DESC"]) + "\"" + ","
                //                     + "\"" + Convert.ToString("REASON_CD") + "\"" + ":" + "\"" + Convert.ToString(dr["REASON_CD"]) + "\"" + ","
                //                     + "\"" + Convert.ToString("REASON_TYPE") + "\"" + ":" + "\"" + Convert.ToString(dr["REASON_TYPE"]) + "\"" + "}" + "," + "";
                //}

                //if (cnt == 4)
                //{
                //    javascriptStr = javascriptStr.Remove(javascriptStr.Length - 1, 1);
                //}
                javascriptStr = javascriptStr + "]";
                if (dr != null)
                {
                    dr.Dispose();
                    dr = null;
                }
                javascriptStr += "}";
                Result = javascriptStr;
                Logger.SuccessLogPrint("NewUserCustomerVehicleDetails", "sp_jco_get_cust_veh_dtl1", "'pn_reg_num': '" + RegNum + "','PN_VIN':'" + Vin + "','pn_user_id':'" + userID + "','PN_FIND_ID':'" + FindId, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));
            }
            else
            {
                string javascriptStr = "{";
                javascriptStr = javascriptStr
                    + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                    + "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";
                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;
            }

        }
        catch (Exception EX)
        {
            OBJ.Close();
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("NewUserCustomerVehicleDetails", "sp_jco_get_cust_veh_dtl1", "'pn_reg_num': '" + RegNum + "','PN_VIN':'" + Vin + "','pn_user_id':'" + userID + "','PN_FIND_ID':'" + FindId, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;
    }

    public string NewGetPickupDetails(string UserID)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();
            CMD = new OracleCommand("pkg_jco_1.sp_jco_get_pickup_dtl", OBJ);
            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(UserID);

            CMD.Parameters.Add("po_pickup_type_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_pickup_loc_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_driver_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_mms_num", OracleDbType.RefCursor).Direction = ParameterDirection.Output;


            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;

            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();
            int Cnter = 0;
            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {

                OracleDataReader dr = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_pickup_type_refcur"].Value).GetDataReader();
                string javascriptStr = "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "0" + "\"" + ","
                //+ "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + ","
                + "\"" + Convert.ToString("M") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_err_msg"].Value)) + ","
                + "\"" + "PT" + "\"" + ":" + "[";
                while (dr.Read())
                {

                    javascriptStr += "{" + "\"" + Convert.ToString(dr[0]) + "\"" + ":" + "\"" + Convert.ToString(dr[1]) + "\"" + "}" + ",";
                    Cnter = 1;
                }
                if (Cnter == 1)
                {
                    if (javascriptStr.Length > 1)
                        javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                }
                javascriptStr = javascriptStr + "]" + ",";

                OracleDataReader dr1 = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_pickup_loc_refcur"].Value).GetDataReader();
                javascriptStr += "\"" + "PL" + "\"" + ":" + "[";
                while (dr1.Read())
                {
                    javascriptStr += "{" + "\"" + Convert.ToString(dr1[1]) + "\"" + ":" + "\"" + Convert.ToString(dr1[0]) + "\"" + "}" + ",";
                    Cnter = 2;
                }
                if (Cnter == 2)
                {
                    if (javascriptStr.Length > 1)
                        javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                }
                javascriptStr = javascriptStr + "]" + ",";


                OracleDataReader dr2 = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_driver_refcur"].Value).GetDataReader();
                javascriptStr += "\"" + "DN" + "\"" + ":" + "[";
                while (dr2.Read())
                {
                    javascriptStr += "{" + "\"" + Convert.ToString(dr2[0]) + "\"" + ":" + "\"" + Convert.ToString(dr2[1]) + "\"" + "}" + ",";
                    Cnter = 3;
                }
                if (Cnter == 3)
                {
                    if (javascriptStr.Length > 1)
                        javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                }
                javascriptStr = javascriptStr + "]" + ",";

                //--
                OracleDataReader dr3 = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_mms_num"].Value).GetDataReader();
                javascriptStr += "\"" + "MMSNUM" + "\"" + ":" + "[";
                while (dr3.Read())
                {
                    javascriptStr += "{" + "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(dr3[0]) + "\"" + "}" + ",";
                    Cnter = 4;
                }
                if (Cnter == 4)
                {
                    if (javascriptStr.Length > 1)
                        javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                }
                javascriptStr = javascriptStr + "]" + "}";



                //OBJ.Close();

                Result = javascriptStr;

                if (dr != null)
                {
                    dr.Dispose();
                    dr = null;
                }

                if (dr1 != null)
                {
                    dr1.Dispose();
                    dr1 = null;
                }

                if (dr2 != null)
                {
                    dr2.Dispose();
                    dr2 = null;
                }

                if (dr3 != null)
                {
                    dr3.Dispose();
                    dr3 = null;
                }
                Logger.SuccessLogPrint("NewGetPickupDetails", "sp_jco_get_pickup_dtl", "'pn_user_id': '" + UserID, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));
            }
            else
            {
                string javascriptStr = "{";


                javascriptStr = javascriptStr + "\"" + Convert.ToString("S") + "\"" + ":"
                                           + "\"" + "1" + "\"" + ","
                             + "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;
            }
            //OBJ.Close();
        }
        catch (Exception EX)
        {
            OBJ.Close();
            //Result = ex.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("NewGetPickupDetails", "sp_jco_get_pickup_dtl", "'pn_user_id': '" + UserID, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;

    }


    public string NewGetPartDetails(string userID, string partnumber)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();
            CMD = new OracleCommand("pkg_jco_1.sp_jco_get_part_dtl", OBJ);
            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(userID);
            CMD.Parameters.Add("pn_part_num", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(partnumber);


            CMD.Parameters.Add("po_part_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();
            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {

                OracleDataReader dr = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_part_refcur"].Value).GetDataReader();

                string javascriptStr = "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "0" + "\"" + ","
                                        + "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + ","
                                        + "\"" + "P" + "\"" + ":" + "[";
                while (dr.Read())
                {
                    javascriptStr += "{" + "\"" + Convert.ToString("PN") + "\"" + ":" + "\"" + Convert.ToString(dr[0]) + "\"" + "," +
                                           "\"" + Convert.ToString("PD") + "\"" + ":" + "\"" + dbHelper.EscapSpecialCharacters(Convert.ToString(dr[1])) + "\"" + "," +
                                            "\"" + Convert.ToString("MRP") + "\"" + ":" + "\"" + Convert.ToString(dr[2]) + "\"" + "," +
                                           "\"" + Convert.ToString("STCKNUM") + "\"" + ":" + "\"" + Convert.ToString(dr[3]) + "\"" + "}" + ",";

                }
                javascriptStr = javascriptStr.Remove(javascriptStr.Length - 1, 1);


                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr += "}]" + "}";
                //OBJ.Close();
                Result = javascriptStr;

                if (dr != null)
                {
                    dr.Dispose();
                    dr = null;
                }

                Logger.SuccessLogPrint("NewGetPartDetails", "sp_jco_get_part_dtl", "'pn_user_id': '" + userID + "','pn_part_num':'" + partnumber, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));

            }
            else
            {
                string javascriptStr = "{";


                javascriptStr = javascriptStr + "\"" + Convert.ToString("S") + "\"" + ":"
                                           + "\"" + "1" + "\"" + ","
                                        + "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";
                //javascriptStr += ;
                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;

            }
            //OBJ.Close();
        }
        catch (Exception EX)
        {
            OBJ.Close();
            //Result = ex.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("NewGetPartDetails", "sp_jco_get_part_dtl", "'pn_user_id': '" + userID + "','pn_part_num':'" + partnumber, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;
    }


    public string NewModifyCustDetails(string CustID, string UserName, string cust_mod_flag, string CustName, string CustAdd1, string CustAdd2, string CustAdd3, string cityCode, string Citydesc, string Email,
                                   string Email1, string phone, string workingPhone, string mobile, string dob, string doa)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {

            OBJ.Open();
            CMD = new OracleCommand("pkg_jco_1.sp_jco_modify_cust_dtl", OBJ);

            CMD.Parameters.Add("pn_cust_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(CustID);
            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(UserName);
            CMD.Parameters.Add("pn_cust_mod_flag", OracleDbType.Varchar2, 1, ParameterDirection.Input).Value = Convert.ToString(cust_mod_flag);
            CMD.Parameters.Add("pn_cust_name", OracleDbType.Varchar2, 30, ParameterDirection.Input).Value = Convert.ToString(CustName);
            CMD.Parameters.Add("pn_cust_add1", OracleDbType.Varchar2, 50, ParameterDirection.Input).Value = Convert.ToString(CustAdd1);
            CMD.Parameters.Add("pn_cust_add2", OracleDbType.Varchar2, 50, ParameterDirection.Input).Value = Convert.ToString(CustAdd2);
            CMD.Parameters.Add("pn_cust_add3", OracleDbType.Varchar2, 50, ParameterDirection.Input).Value = Convert.ToString(CustAdd3);
            CMD.Parameters.Add("pn_city_cd", OracleDbType.Varchar2, 3, ParameterDirection.Input).Value = Convert.ToString(cityCode);

            CMD.Parameters.Add("pn_city_desc", OracleDbType.Varchar2, 50, ParameterDirection.Input).Value = Convert.ToString(Citydesc);
            CMD.Parameters.Add("pn_email", OracleDbType.Varchar2, 100, ParameterDirection.Input).Value = Convert.ToString(Email);
            CMD.Parameters.Add("pn_email1", OracleDbType.Varchar2, 100, ParameterDirection.Input).Value = Convert.ToString(Email1);

            CMD.Parameters.Add("pn_phone", OracleDbType.Varchar2, 50, ParameterDirection.Input).Value = Convert.ToString(phone);
            CMD.Parameters.Add("pn_work_phone", OracleDbType.Varchar2, 50, ParameterDirection.Input).Value = Convert.ToString(workingPhone);
            CMD.Parameters.Add("pn_mobile", OracleDbType.Varchar2, 50, ParameterDirection.Input).Value = Convert.ToString(mobile);
            if (dob == "")
                CMD.Parameters.Add("pn_dob", OracleDbType.Date, ParameterDirection.Input).Value = DBNull.Value;//Convert.ToDateTime(dob);
            else
                CMD.Parameters.Add("pn_dob", OracleDbType.Date, ParameterDirection.Input).Value = Convert.ToDateTime(dob);
            if (doa == "")
                CMD.Parameters.Add("pn_doa", OracleDbType.Date, ParameterDirection.Input).Value = DBNull.Value;//Convert.ToDateTime(doa);
            else
                CMD.Parameters.Add("pn_doa", OracleDbType.Date, ParameterDirection.Input).Value = Convert.ToDateTime(doa);

            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
            CMD.CommandType = CommandType.StoredProcedure;
            int cntRowsEffected = CMD.ExecuteNonQuery();

            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {


                string javascriptStr = "{";
                javascriptStr = javascriptStr
                    + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "0" + "\"" + ","
                    //+ "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + ","
                    + "\"" + Convert.ToString("M") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_err_msg"].Value)) + ","
                    + "\"" + Convert.ToString("ROWCNT") + "\"" + ":" + "\"" + cntRowsEffected.ToString() + "\"" + ","
                    + "\"" + Convert.ToString("CN") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["pn_cust_name"].Value)) + ","
                    + "\"" + Convert.ToString("A1") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["pn_cust_add1"].Value)) + ","
                    + "\"" + Convert.ToString("A2") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["pn_cust_add2"].Value)) + ","
                    + "\"" + Convert.ToString("A3") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["pn_cust_add3"].Value)) + ","
                    + "\"" + Convert.ToString("CC") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["pn_city_cd"].Value)) + ","
                    + "\"" + Convert.ToString("CD") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["pn_city_desc"].Value)) + ","
                    + "\"" + Convert.ToString("EM") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["pn_email"].Value)) + ","
                    //+ "\"" + Convert.ToString("EM1") + "\"" + ":" + "\"" + CMD.Parameters["pn_email1"].Value + "\"" + ","
                    + "\"" + Convert.ToString("PH") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["pn_phone"].Value)) + ","
                    + "\"" + Convert.ToString("WP") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["pn_work_phone"].Value)) + ","
                    + "\"" + Convert.ToString("MO") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["pn_mobile"].Value)) + ","
                    + "\"" + Convert.ToString("DB") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["pn_dob"].Value)) + ","
                    + "\"" + Convert.ToString("PD") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["pn_doa"].Value)) + "\"";


                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;

                Logger.SuccessLogPrint("NewModifyCustDetails", "sp_jco_modify_cust_dtl", "'pn_cust_id': '" + CustID + "','pn_user_id':'" + UserName + "','pn_cust_mod_flag':'" + cust_mod_flag + "','pn_cust_name':'" + CustName + "','pn_cust_add1':'" + CustAdd1 + "','pn_cust_add2':'" + CustAdd2 + "','pn_cust_add3':'" + CustAdd3
                 + "','pn_city_cd':'" + cityCode + "','pn_city_desc':'" + Citydesc + "','pn_email':'" + Email + "','pn_email1':'" + Email1 + "','pn_phone':'" + phone + "','pn_work_phone':'" + workingPhone + "','pn_mobile':'" + mobile + "','pn_dob':'" + dob + "','pn_doa':'" + doa, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));

            }
            else
            {

                string javascriptStr = "{";
                javascriptStr = javascriptStr + "\"" + Convert.ToString("S") + "\"" + ":"
                                           + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                                           + "\"" + Convert.ToString("M") + "\""
                                          + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;
            }

            //OBJ.Close();

        }
        catch (Exception EX)
        {
            OBJ.Close();
            //Result = ex.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("NewModifyCustDetails", "sp_jco_modify_cust_dtl", "'pn_cust_id': '" + CustID + "','pn_user_id':'" + UserName + "','pn_cust_mod_flag':'" + cust_mod_flag + "','pn_cust_name':'" + CustName + "','pn_cust_add1':'" + CustAdd1 + "','pn_cust_add2':'" + CustAdd2 + "','pn_cust_add3':'" + CustAdd3
               + "','pn_city_cd':'" + cityCode + "','pn_city_desc':'" + Citydesc + "','pn_email':'" + Email + "','pn_email1':'" + Email1 + "','pn_phone':'" + phone + "','pn_work_phone':'" + workingPhone + "','pn_mobile':'" + mobile + "','pn_dob':'" + dob + "','pn_doa':'" + doa, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;
    }


    public string NewOmrValidate(string UserID1, double Omr, Int64 lastOmr, string vin, string srv_type)
    {//called proce with some new parameters
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();
            CMD = new OracleCommand("pkg_jco_1.sp_jco_omr_validate", OBJ);
            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(UserID1);
            CMD.Parameters.Add("pn_omr", OracleDbType.Double, ParameterDirection.Input).Value = Convert.ToDouble(Omr);
            CMD.Parameters.Add("pn_last_omr", OracleDbType.Int64, ParameterDirection.Input).Value = Convert.ToInt64(lastOmr);
            CMD.Parameters.Add("pn_vin", OracleDbType.Varchar2, 22, ParameterDirection.Input).Value = Convert.ToString(vin);
            CMD.Parameters.Add("pn_srv_type", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(srv_type);

            CMD.Parameters.Add("po_sub_srv_type_Cd", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_sub_srv_type_desc", OracleDbType.Varchar2, 50).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_omr_change", OracleDbType.Varchar2, 1).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteReader();

            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {

                string javascriptStr = "{";
                javascriptStr = javascriptStr
                    + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "0" + "\"" + ","
                    //+ "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + ","
                    + "\"" + Convert.ToString("M") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_err_msg"].Value)) + ","
                    //+ "\"" + Convert.ToString("SSTC") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_sub_srv_type_Cd"].Value) + "\"" + ","
                    + "\"" + Convert.ToString("SSTC") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_sub_srv_type_Cd"].Value)) + ","
                    //+ "\"" + Convert.ToString("SSTD") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_sub_srv_type_desc"].Value) + "\"" + ","
                    + "\"" + Convert.ToString("SSTD") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_sub_srv_type_desc"].Value)) + ","
                    //+ "\"" + Convert.ToString("OMRCHNG") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_omr_change"].Value) + "\"" + "\"";
                    + "\"" + Convert.ToString("OMRCHNG") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_omr_change"].Value)) + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;

                Logger.SuccessLogPrint("NewOmrValidate", "sp_jco_omr_validate", "'pn_user_id': '" + UserID1 + "','pn_omr':'" + Omr + "','pn_last_omr':'" + lastOmr + "','pn_vin':'" + vin + "','pn_srv_type':'" + srv_type, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));

            }
            else
            {

                string javascriptStr = "{";
                javascriptStr = javascriptStr
                                      + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                                      + "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";


                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;
            }
            //OBJ.Close();
        }
        catch (Exception EX)
        {
            OBJ.Close();
            //Result = ex.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("NewOmrValidate", "sp_jco_omr_validate", "'pn_user_id': '" + UserID1 + "','pn_omr':'" + Omr + "','pn_last_omr':'" + lastOmr + "','pn_vin':'" + vin + "','pn_srv_type':'" + srv_type, EX);


        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;
    }

    // ---- add on 21 Dec 2017

    public string GetCustVehRFIDDetail(string rfIdNo, string dealerMapCd, string locCd)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();
            CMD = new OracleCommand("Pkg_njco.SP_NJCO_GET_CUSTVEH_RFID_DTL", OBJ);

            CMD.Parameters.Add("pn_rfid_num", OracleDbType.Varchar2, 100, ParameterDirection.Input).Value = Convert.ToString(rfIdNo);
            CMD.Parameters.Add("pn_dealer_map_cd", OracleDbType.Varchar2, 100, ParameterDirection.Input).Value = Convert.ToString(dealerMapCd);
            CMD.Parameters.Add("pn_loc_Cd", OracleDbType.Varchar2, 100, ParameterDirection.Input).Value = Convert.ToString(locCd);


            CMD.Parameters.Add("po_reg_num", OracleDbType.Varchar2, 100).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_cust_name", OracleDbType.Varchar2, 100).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_cust_mobile", OracleDbType.Varchar2, 100).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;

            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();


            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {
                string javascriptStr = "{";
                javascriptStr = javascriptStr + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                            + "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + ","
                            + "\"" + Convert.ToString("REGNO") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_reg_num"].Value) + "\"" + ","
                            + "\"" + Convert.ToString("CUSTNAME") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_cust_name"].Value) + "\"" + ","
                            + "\"" + Convert.ToString("CUSTMOBILE") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_cust_mobile"].Value) + "\"" + "\"";


                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;

                Logger.SuccessLogPrint("GetCustVehRFIDDetail", "SP_NJCO_GET_CUSTVEH_RFID_DTL", "'pn_rfid_num': '" + rfIdNo + "','pn_dealer_map_cd':'" + dealerMapCd + "','pn_loc_Cd':'" + locCd, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));

            }
            else
            {
                string javascriptStr = "{";

                javascriptStr = javascriptStr + "\"" + Convert.ToString("S") + "\"" + ":"
                                           + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                                           + "\"" + Convert.ToString("M") + "\""
                                          + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;
            }



            //OBJ.Close();

        }
        catch (Exception EX)
        {
            OBJ.Close();
            //Result = EX.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("GetCustVehRFIDDetail", "SP_NJCO_GET_CUSTVEH_RFID_DTL", "'pn_rfid_num': '" + rfIdNo + "','pn_dealer_map_cd':'" + dealerMapCd + "','pn_loc_Cd':'" + locCd, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;
    }

    // -----------------------------------added functions on 7 may 2015-----------------------------

    public string NewUserAuth(string UserName, string Password, string Imei, string Version, string vUpdate)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["conoracle_PushApi"]));
        try
        {
            OBJ.Open();
            CMD = new OracleCommand("pkg_jco_1.sp_jco_user_validate", OBJ);

            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(UserName);
            CMD.Parameters.Add("pn_pwd", OracleDbType.Varchar2, 50, ParameterDirection.Input).Value = Convert.ToString(Password);
            //added two parameters imei and version to these fn on 7 may  2015 by gst
            CMD.Parameters.Add("pn_imei", OracleDbType.Varchar2, 50, ParameterDirection.Input).Value = Convert.ToString(Imei);
            CMD.Parameters.Add("pn_version", OracleDbType.Varchar2, 10, ParameterDirection.Input).Value = Convert.ToString(Version);

            CMD.Parameters.Add("po_parent_group", OracleDbType.Varchar2, 5).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_dealer_map_cd", OracleDbType.Int32, 5).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_loc_cd", OracleDbType.Varchar2, 5).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_comp_fa", OracleDbType.Varchar2, 4).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_dealer_name", OracleDbType.Varchar2, 70).Direction = ParameterDirection.Output;

            //start added five new parameters as per warranty protal requirement created by mukesh sinha
            CMD.Parameters.Add("PO_DEALER_CODE", OracleDbType.Varchar2, 13).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("PO_REGION_CD", OracleDbType.Varchar2, 3).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("PO_REGION", OracleDbType.Varchar2, 50).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("PO_ZONE_CD", OracleDbType.Varchar2, 2).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("PO_ZONE", OracleDbType.Varchar2, 30).Direction = ParameterDirection.Output;
            //end added five new parameters as per warranty protal requirement created by mukesh sinha
            CMD.Parameters.Add("po_loc_desc", OracleDbType.Varchar2, 50).Direction = ParameterDirection.Output;
            //added this key by kritika kulariya
            CMD.Parameters.Add("PO_OUTLET_CD", OracleDbType.Varchar2, 5).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_emp_cd", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("PO_DESG_CD", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("PO_ACCESS_FLAG", OracleDbType.Varchar2, 3).Direction = ParameterDirection.Output;
            //Added Out param by GAGAN Sharma 24 FEB 2023 PO_GEO_RADIUS_RANGE OUT NUMBER
            CMD.Parameters.Add("PO_GEO_RADIUS_RANGE", OracleDbType.Int32).Direction = ParameterDirection.Output;
            //Added Out param by Nagmani Chauhan 17 MAY 2023 po_cont_no OUT NUMBER
            CMD.Parameters.Add("po_cont_no", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;

            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();


            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {
                string empCd = Convert.ToString(CMD.Parameters["po_emp_cd"].Value);
                string javascriptStr = "{";
                javascriptStr = javascriptStr + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                            //+ "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + ","
                            + "\"" + Convert.ToString("M") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_err_msg"].Value)) + ","
                            + "\"" + Convert.ToString("PG") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_parent_group"].Value) + "\"" + ","
                            + "\"" + Convert.ToString("DMC") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_dealer_map_cd"].Value) + "\"" + ","
                            + "\"" + Convert.ToString("LC") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_loc_cd"].Value) + "\"" + ","
                            + "\"" + Convert.ToString("CFA") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_comp_fa"].Value) + "\"" + ","
                            + "\"" + Convert.ToString("LDSC") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_loc_desc"].Value) + "\"" + ","
                            + "\"" + Convert.ToString("EMPCD") + "\"" + ":" + "\"" + ((!string.IsNullOrEmpty(vUpdate) && "1".Equals(vUpdate)) ? empCd : empCd.Replace("$", "-")) + "\"" + ","
                            + "\"" + Convert.ToString("EMPCD1") + "\"" + ":" + "\"" + empCd + "\"" + ","
                            + "\"" + Convert.ToString("DESGCD") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["PO_DESG_CD"].Value) + "\"" + ","
                            + "\"" + Convert.ToString("ACCESS_FLAG") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["PO_ACCESS_FLAG"].Value) + "\"" + ","
                            //Added by GAGAN SHARMA 24 FEB 2023 GEO_RADIUS_RANGE
                            + "\"" + Convert.ToString("GEO_RADIUS_RANGE") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["PO_GEO_RADIUS_RANGE"].Value) + "\"" + ","
                            //Added Out param by Nagmani Chauhan 17 MAY 2023 po_cont_no OUT NUMBER
                            + "\"" + Convert.ToString("CONT_NO") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_cont_no"].Value) + "\"" + ","
                            //outlet code added by kritika kulariya
                            + "\"" + Convert.ToString("OUTLET_CD") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["PO_OUTLET_CD"].Value) + "\"" + ","
                            + "\"" + Convert.ToString("DN") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_dealer_name"].Value) + "\"" + ","
                            //start added five new parameters as per warranty protal requirement created by mukesh sinha
                            + "\"" + Convert.ToString("DEALER_CODE") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["PO_DEALER_CODE"].Value) + "\"" + ","
                            + "\"" + Convert.ToString("REGION_CD") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["PO_REGION_CD"].Value) + "\"" + ","
                            + "\"" + Convert.ToString("REGION") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["PO_REGION"].Value) + "\"" + ","
                            + "\"" + Convert.ToString("ZONE_CD") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["PO_ZONE_CD"].Value) + "\"" + ","
                            + "\"" + Convert.ToString("ZONE") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["PO_ZONE"].Value) + "\"" + "\"";
                //end added five new parameters as per warranty protal requirement  created by mukesh sinha

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;

                Logger.SuccessLogPrint("NewUserAuth", "sp_jco_user_validate", "'pn_user_id': '" + UserName + "','pn_pwd':'" + Password + "','pn_imei':'" + Imei + "','pn_version':'" + Version, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));

            }
            else
            {
                string javascriptStr = "{";

                javascriptStr = javascriptStr + "\"" + Convert.ToString("S") + "\"" + ":"
                                           + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                                           + "\"" + Convert.ToString("M") + "\""
                                          + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;
            }
        }
        catch (Exception EX)
        {
            OBJ.Close();
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("NewUserAuth", "sp_jco_user_validate", "'pn_user_id': '" + UserName + "','pn_pwd':'" + Password + "','pn_imei':'" + Imei + "','pn_version':'" + Version, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;
    }

    public string GetNewLaborDetails(string Username, string svar_cd, string veh_sys_cd, string veh_sub_sys_cd)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();
            CMD = new OracleCommand("pkg_jco_1.sp_jco_get_labor_dtl", OBJ);
            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(Username);
            CMD.Parameters.Add("pn_svar_Cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(svar_cd);
            CMD.Parameters.Add("pn_veh_sys_cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(veh_sys_cd);
            CMD.Parameters.Add("pn_veh_sub_sys_Cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(veh_sub_sys_cd);


            CMD.Parameters.Add("po_labor_cd_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();

            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {
                OracleDataReader dr = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_labor_cd_refcur"].Value).GetDataReader();
                string javascriptStr = "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "0" + "\"" + ","
                                        //+ "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + ","
                                        + "\"" + Convert.ToString("M") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_err_msg"].Value)) + ","
                                        + "\"" + "LDTL" + "\"" + ":" + "[";
                int cnter = 0;
                while (dr.Read())
                {

                    cnter = 1;
                    javascriptStr = javascriptStr
                                    + "{" + "\"" + Convert.ToString("LC") + "\"" + ":" + "\"" + Convert.ToString(dr[0]) + "\"" + ","
                                    + "\"" + Convert.ToString("LDSC") + "\"" + ":" + "\"" + Convert.ToString(dr[1]) + "\"" + ","
                                    + "\"" + Convert.ToString("VSD") + "\"" + ":" + "\"" + Convert.ToString(dr[2]) + "\"" + ","
                                    + "\"" + Convert.ToString("VSSD") + "\"" + ":" + "\"" + Convert.ToString(dr[3]) + "\"" + ","
                                    + "\"" + Convert.ToString("FRMHRS") + "\"" + ":" + "\"" + Convert.ToString(dr[4]) + "\"" + ","
                                    + "\"" + Convert.ToString("FAMT") + "\"" + ":" + "\"" + Convert.ToString(dr[5]) + "\"" + "},";
                    //if uncommented following den get an error asked to maruti abt these param
                    //+ "\"" + Convert.ToString("LAMT") + "\"" + ":" + "\"" + Convert.ToString(dr[6]) + "\"" +"},";


                }
                if (cnter == 1)
                {
                    if (javascriptStr.Length > 1)
                        javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                }
                javascriptStr = javascriptStr + "]" + "}";
                //OBJ.Close();
                Result = javascriptStr;

                if (dr != null)
                {
                    dr.Dispose();
                    dr = null;
                }
                Logger.SuccessLogPrint("GetNewLaborDetails", "sp_jco_get_labor_dtl", "'pn_user_id': '" + Username + "','pn_svar_Cd':'" + svar_cd + "','pn_veh_sys_cd':'" + veh_sys_cd + "','pn_veh_sub_sys_Cd':'" + veh_sub_sys_cd, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));

            }
            else
            {

                string javascriptStr = "{";

                javascriptStr = javascriptStr
                                              + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                                              + "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;

            }
            //OBJ.Close();
        }
        catch (Exception EX)
        {
            OBJ.Close();
            //Result = ex.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("GetNewLaborDetails", "sp_jco_get_labor_dtl", "'pn_user_id': '" + Username + "','pn_svar_Cd':'" + svar_cd + "','pn_veh_sys_cd':'" + veh_sys_cd + "','pn_veh_sub_sys_Cd':'" + veh_sub_sys_cd, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;
    }

    public string GetTechDetails(string UserID1, string group_cd)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();

            CMD = new OracleCommand("pkg_jco_1.sp_jco_get_tech_dtl", OBJ);
            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(UserID1);
            CMD.Parameters.Add("pn_group_cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(group_cd);
            CMD.Parameters.Add("po_tech_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 2000).Direction = ParameterDirection.Output;
            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();

            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {
                int cnter = 0;
                OracleDataReader dr = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_tech_refcur"].Value).GetDataReader();

                string javascriptStr = "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "0" + "\"" + ","
                //+ "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + ","
                + "\"" + Convert.ToString("M") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_err_msg"].Value)) + ","
                + "\"" + Convert.ToString("TCHDTL") + "\"" + ":" + "[";
                while (dr.Read())
                {
                    cnter = 1;
                    javascriptStr = javascriptStr + "{" + "\"" + Convert.ToString(dr[0]) + "\"" + ":" + "\"" + Convert.ToString(dr[1]) + "\"" + "}" + ",";
                }

                if (cnter == 1)
                {
                    if (javascriptStr.Length > 1)
                        javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                }
                javascriptStr = javascriptStr + "]" + "}";
                //OBJ.Close();
                Result = javascriptStr;

                if (dr != null)
                {
                    dr.Dispose();
                    dr = null;
                }
                Logger.SuccessLogPrint("GetTechDetails", "sp_jco_get_tech_dtl", "'pn_user_id': '" + UserID1 + "','pn_group_cd':'" + group_cd, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));

            }
            else
            {
                string javascriptStr = "{";
                javascriptStr = javascriptStr
                    + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                    //+ "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";
                    + "\"" + Convert.ToString("M") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_err_msg"].Value)) + "\"";
                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;


            }
            //OBJ.Close();
        }
        catch (Exception EX)
        {
            OBJ.Close();
            //Result = ex.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("GetTechDetails", "sp_jco_get_tech_dtl", "'pn_user_id': '" + UserID1 + "','pn_group_cd':'" + group_cd, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;


    }

    public string GetMenuCodeDetails(string UserID, string Regno, string Menu_cd, string srv_cat_cd, string pl_mod_flag)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();
            CMD = new OracleCommand("pkg_jco_1.sp_jco_get_menu_Code_dtl", OBJ);
            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(UserID);
            CMD.Parameters.Add("PN_REG_NUM", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(Regno);
            CMD.Parameters.Add("pn_menu_cd", OracleDbType.Varchar2, 10, ParameterDirection.Input).Value = Convert.ToString(Menu_cd);
            CMD.Parameters.Add("pn_srv_cat_cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(srv_cat_cd);
            CMD.Parameters.Add("pn_pl_mod_flag", OracleDbType.Varchar2, 1, ParameterDirection.Input).Value = Convert.ToString(pl_mod_flag);

            CMD.Parameters.Add("po_demand_cd_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_part_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_labor_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;

            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();
            string javascriptStr = "";
            int cnt = 0;
            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {
                OracleDataReader dr = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_demand_cd_refcur"].Value).GetDataReader();
                javascriptStr += "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "0" + "\"" + ","
                                  + "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + ","
                                  + "\"" + "DC" + "\"" + ":" + "[";
                while (dr.Read())
                {
                    cnt = 1;
                    javascriptStr += "{" + "\"" + Convert.ToString(dr[0]) + "\"" + ":" + "\"" + Convert.ToString(dr[1]) + "\"" + "}" + ",";
                }
                if (cnt == 1)
                {
                    javascriptStr = javascriptStr.Remove(javascriptStr.Length - 1, 1);
                }

                javascriptStr += "],";

                OracleDataReader dr1 = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_part_refcur"].Value).GetDataReader();
                javascriptStr += "\"" + "P" + "\"" + ":" + "[";
                while (dr1.Read())
                {
                    cnt = 2;
                    javascriptStr += "{" + "\"" + Convert.ToString("PN") + "\"" + ":" + "\"" + Convert.ToString(dr1[0]) + "\"" + "," +
                                      "\"" + Convert.ToString("PD") + "\"" + ":" + "\"" + Convert.ToString(dr1[1]) + "\"" + "," +
                                      "\"" + Convert.ToString("IQTY") + "\"" + ":" + "\"" + Convert.ToString(dr1[2]) + "\"" + "," +
                                      "\"" + Convert.ToString("PA") + "\"" + ":" + "\"" + Convert.ToString(dr1[3]) + "\"" + "}" + ",";

                }
                if (cnt == 2)
                {
                    javascriptStr = javascriptStr.Remove(javascriptStr.Length - 1, 1);
                }

                javascriptStr += "],";


                OracleDataReader dr2 = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_labor_refcur"].Value).GetDataReader();
                javascriptStr += "\"" + "L" + "\"" + ":" + "[";
                while (dr2.Read())
                {
                    cnt = 3;
                    javascriptStr += "{" + "\"" + Convert.ToString("LCD") + "\"" + ":" + "\"" + Convert.ToString(dr2[0]) + "\"" + "," +
                                      "\"" + Convert.ToString("LDSC") + "\"" + ":" + "\"" + Convert.ToString(dr2[1]) + "\"" + "," +
                                      "\"" + Convert.ToString("LAMT") + "\"" + ":" + "\"" + Convert.ToString(dr2[2]) + "\"" + "}" + ",";
                }
                if (cnt == 3)
                {
                    javascriptStr = javascriptStr.Remove(javascriptStr.Length - 1, 1);
                }

                javascriptStr += "]" + "}";

                Result = javascriptStr;

                if (dr != null)
                {
                    dr.Dispose();
                    dr = null;
                }

                if (dr1 != null)
                {
                    dr1.Dispose();
                    dr1 = null;
                }

                if (dr2 != null)
                {
                    dr2.Dispose();
                    dr2 = null;
                }
                Logger.SuccessLogPrint("GetMenuCodeDetails", "sp_jco_get_tech_dtl", "'pn_user_id': '" + UserID + "','PN_REG_NUM':'" + Regno + "','pn_menu_cd':'" + Menu_cd + "','pn_srv_cat_cd':'" + srv_cat_cd + "','pn_pl_mod_flag':'" + pl_mod_flag, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));


            }
            else
            {
                javascriptStr = "{";
                javascriptStr = javascriptStr + "\"" + Convert.ToString("S") + "\"" + ":"
                                           + "\"" + "1" + "\"" + ","
                                          + "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;
            }
            //OBJ.Close();
        }
        catch (Exception EX)
        {
            OBJ.Close();
            //Result = ex.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("GetMenuCodeDetails", "sp_jco_get_tech_dtl", "'pn_user_id': '" + UserID + "','PN_REG_NUM':'" + Regno + "','pn_menu_cd':'" + Menu_cd + "','pn_srv_cat_cd':'" + srv_cat_cd + "','pn_pl_mod_flag':'" + pl_mod_flag, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;

    }

    public string NewGetInventoryDetails(string userID)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();
            CMD = new OracleCommand("pkg_jco_1.sp_jco_get_inventory_dtl", OBJ);
            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(userID);
            CMD.Parameters.Add("po_inv_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();

            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {

                OracleDataReader dr = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_inv_refcur"].Value).GetDataReader();
                int Cnter = 0;
                string javascriptStr = "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "0" + "\"" + ","
                       //+ "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + ","
                       + "\"" + Convert.ToString("M") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_err_msg"].Value)) + ","
                       + "\"" + Convert.ToString("K") + "\"" + ":" + "[";
                while (dr.Read())
                {
                    javascriptStr = javascriptStr + "{" + "\"" + Convert.ToString(dr[0]) + "\"" + ":" + "\"" + Convert.ToString(dr[1]) + "\"" + "}" + ",";
                    Cnter = 1;
                }
                if (Cnter == 1)
                {
                    if (javascriptStr.Length > 1)
                        javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                }
                javascriptStr = javascriptStr + "]" + "}";
                //OBJ.Close();
                Result = javascriptStr;

                if (dr != null)
                {
                    dr.Dispose();
                    dr = null;
                }
                Logger.SuccessLogPrint("NewGetInventoryDetails", "sp_jco_get_tech_dtl", "'pn_user_id': '" + userID, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));

            }
            else
            {
                string javascriptStr = "{";

                javascriptStr = javascriptStr + "\"" + Convert.ToString("S") + "\"" + ":"
                                           + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                                           + "\"" + Convert.ToString("M") + "\""
                                          + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;


            }
            //OBJ.Close();
        }
        catch (Exception EX)
        {
            OBJ.Close();
            //Result = ex.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("NewGetInventoryDetails", "sp_jco_get_tech_dtl", "'pn_user_id': '" + userID, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;
    }

    public string GetSaletype(string UserID1)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();

            CMD = new OracleCommand("pkg_jco_1.sp_jco_get_sale_type", OBJ);
            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(UserID1);

            CMD.Parameters.Add("po_sale_type", OracleDbType.RefCursor).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 2000).Direction = ParameterDirection.Output;
            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();

            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {

                OracleDataReader dr = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_sale_type"].Value).GetDataReader();

                string javascriptStr = "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "0" + "\"" + ","
                             //+ "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + ","
                             + "\"" + Convert.ToString("M") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_err_msg"].Value)) + ","
                                + "\"" + Convert.ToString("GSALETYPE") + "\"" + ":" + "[";
                while (dr.Read())
                {
                    javascriptStr = javascriptStr + "{" + "\"" + Convert.ToString(dr[0]) + "\"" + ":" + "\"" + Convert.ToString(dr[1]) + "\"" + "}" + ",";
                }
                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "]" + "}";
                //OBJ.Close();
                Result = javascriptStr;

                if (dr != null)
                {
                    dr.Dispose();
                    dr = null;
                }
                Logger.SuccessLogPrint("GetSaletype", "sp_jco_get_sale_type", "'pn_user_id': '" + UserID1, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));

            }
            else
            {
                string javascriptStr = "{";
                javascriptStr = javascriptStr
                    + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                    + "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";
                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;

                //Result = Convert.ToString(CMD.Parameters["po_err_cd"].Value) + ":" + Convert.ToString(CMD.Parameters["po_err_msg"].Value);
            }
            //OBJ.Close();
        }
        catch (Exception EX)
        {
            OBJ.Close();
            //Result = ex.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("GetSaletype", "sp_jco_get_sale_type", "'pn_user_id': '" + UserID1, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;


    }

    public string GetEstimationType(string UserID1)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();

            CMD = new OracleCommand("pkg_jco_1.sp_jco_get_estim_type", OBJ);
            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(UserID1);

            CMD.Parameters.Add("po_estim_type", OracleDbType.RefCursor).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 2000).Direction = ParameterDirection.Output;
            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();

            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {
                int cnter = 0;
                OracleDataReader dr = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_estim_type"].Value).GetDataReader();

                string javascriptStr = "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "0" + "\"" + ","
                //+ "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + ","
                + "\"" + Convert.ToString("M") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_err_msg"].Value)) + ","
                + "\"" + Convert.ToString("GESTYPE") + "\"" + ":" + "[";
                while (dr.Read())
                {
                    cnter = 1;
                    javascriptStr = javascriptStr + "{" + "\"" + Convert.ToString(dr[0]) + "\"" + ":" + "\"" + Convert.ToString(dr[1]) + "\"" + "}" + ",";
                }
                if (cnter == 1)
                {
                    if (javascriptStr.Length > 1)
                        javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                }
                javascriptStr = javascriptStr + "]" + "}";
                //OBJ.Close();
                Result = javascriptStr;

                if (dr != null)
                {
                    dr.Dispose();
                    dr = null;
                }
                Logger.SuccessLogPrint("GetEstimationType", "sp_jco_get_estim_type", "'pn_user_id': '" + UserID1, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));

            }
            else
            {
                string javascriptStr = "{";
                javascriptStr = javascriptStr
                    + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                    + "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";
                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;


            }
            //OBJ.Close();
        }
        catch (Exception EX)
        {
            OBJ.Close();
            //Result = ex.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("GetEstimationType", "sp_jco_get_estim_type", "'pn_user_id': '" + UserID1, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;


    }

    public string GetSrvEstimationHdr(string UserID1, string Regno)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();

            CMD = new OracleCommand("pkg_jco_1.sp_jco_get_srv_estim_hdr", OBJ);
            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(UserID1);
            CMD.Parameters.Add("pn_reg_num", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(Regno);
            //CMD.Parameters.Add("pn_estim_num", OracleDbType.Varchar2, 50, ParameterDirection.Input).Value = Convert.ToString(estno);	

            CMD.Parameters.Add("po_ESTIM_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 2000).Direction = ParameterDirection.Output;
            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();

            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {
                int cnter = 0;
                OracleDataReader dr = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_estim_refcur"].Value).GetDataReader();

                string javascriptStr = "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "0" + "\"" + ","
                // + "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + ","
                 + "\"" + Convert.ToString("M") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_err_msg"].Value)) + ","
                // + "\"" + Convert.ToString("REGNO") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["pn_reg_num"].Value) + "\"" + ","
                + "\"" + Convert.ToString("GSEHDR") + "\"" + ":" + "[";
                while (dr.Read())
                {
                    cnter = 1;


                    javascriptStr = javascriptStr
                                        + "{" + "\"" + Convert.ToString("ENO") + "\"" + ":" + "\"" + Convert.ToString(dr[0]) + "\"" + ","
                                        + "\"" + Convert.ToString("EDATE") + "\"" + ":" + "\"" + Convert.ToString(dr[1]) + "\"" + ","
                                        + "\"" + Convert.ToString("ETYPECD") + "\"" + ":" + "\"" + Convert.ToString(dr[2]) + "\"" + ","
                                        + "\"" + Convert.ToString("ETYPEDSC") + "\"" + ":" + "\"" + Convert.ToString(dr[3]) + "\"" + ","
                                        + "\"" + Convert.ToString("EAMT") + "\"" + ":" + "\"" + Convert.ToString(dr[4]) + "\"" + ","
                                        + "\"" + Convert.ToString("SUPPNO") + "\"" + ":" + "\"" + Convert.ToString(dr[5]) + "\"" + "},";


                }
                if (cnter == 1)
                {
                    if (javascriptStr.Length > 1)
                        javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                }
                javascriptStr = javascriptStr + "]" + "}";
                //OBJ.Close();
                Result = javascriptStr;

                if (dr != null)
                {
                    dr.Dispose();
                    dr = null;
                }
                Logger.SuccessLogPrint("GetSrvEstimationHdr", "sp_jco_get_srv_estim_hdr", "'pn_user_id': '" + UserID1 + "','pn_reg_num':'" + Regno, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));


            }
            else
            {
                string javascriptStr = "{";
                javascriptStr = javascriptStr
                    + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                    + "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";
                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;

                //Result = Convert.ToString(CMD.Parameters["po_err_cd"].Value) + ":" + Convert.ToString(CMD.Parameters["po_err_msg"].Value);
            }
            //OBJ.Close();
        }
        catch (Exception EX)
        {
            OBJ.Close();
            //Result = ex.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("GetSrvEstimationHdr", "sp_jco_get_srv_estim_hdr", "'pn_user_id': '" + UserID1 + "','pn_reg_num':'" + Regno, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;


    }

    public string GetSrvEstimationHdr1(string UserID1, string estno)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();

            CMD = new OracleCommand("pkg_jco_1.sp_jco_get_srv_estim_hdr", OBJ);
            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(UserID1);

            CMD.Parameters.Add("pn_estim_num", OracleDbType.Varchar2, 50, ParameterDirection.Input).Value = Convert.ToString(estno);

            CMD.Parameters.Add("po_ESTIM_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("pn_reg_num", OracleDbType.Varchar2, 2000).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 2000).Direction = ParameterDirection.Output;
            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();

            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {
                int cnter = 0;
                OracleDataReader dr = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_ESTIM_refcur"].Value).GetDataReader();

                string javascriptStr = "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "0" + "\"" + ","
                 //+ "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + ","
                 + "\"" + Convert.ToString("M") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_err_msg"].Value)) + ","
                 //+ "\"" + Convert.ToString("REGNO1") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["pn_reg_num"].Value) + "\"" + ","
                 + "\"" + Convert.ToString("REGNO1") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["pn_reg_num"].Value)) + ","
                + "\"" + Convert.ToString("GSEHDR1") + "\"" + ":" + "[";
                while (dr.Read())
                {
                    cnter = 1;


                    javascriptStr = javascriptStr
                                        + "{" + "\"" + Convert.ToString("ENO") + "\"" + ":" + "\"" + Convert.ToString(dr[0]) + "\"" + ","
                                        + "\"" + Convert.ToString("EDATE") + "\"" + ":" + "\"" + Convert.ToString(dr[1]) + "\"" + ","
                                        + "\"" + Convert.ToString("ETYPECD") + "\"" + ":" + "\"" + Convert.ToString(dr[2]) + "\"" + ","
                                        + "\"" + Convert.ToString("ETYPEDSC") + "\"" + ":" + "\"" + Convert.ToString(dr[3]) + "\"" + ","
                                        + "\"" + Convert.ToString("EAMT") + "\"" + ":" + "\"" + Convert.ToString(dr[4]) + "\"" + ","
                                        + "\"" + Convert.ToString("SUPPNO") + "\"" + ":" + "\"" + Convert.ToString(dr[5]) + "\"" + "},";


                }
                if (cnter == 1)
                {
                    if (javascriptStr.Length > 1)
                        javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                }
                javascriptStr = javascriptStr + "]" + "}";
                //OBJ.Close();
                Result = javascriptStr;

                if (dr != null)
                {
                    dr.Dispose();
                    dr = null;
                }
                Logger.SuccessLogPrint("GetSrvEstimationHdr1", "sp_jco_get_srv_estim_hdr", "'pn_user_id': '" + UserID1 + "','pn_estim_num':'" + estno, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));

            }
            else
            {
                string javascriptStr = "{";
                javascriptStr = javascriptStr
                    + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                    + "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";
                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;

                //Result = Convert.ToString(CMD.Parameters["po_err_cd"].Value) + ":" + Convert.ToString(CMD.Parameters["po_err_msg"].Value);
            }
            //OBJ.Close();
        }
        catch (Exception EX)
        {
            OBJ.Close();
            //Result = ex.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("GetSrvEstimationHdr1", "sp_jco_get_srv_estim_hdr", "'pn_user_id': '" + UserID1 + "','pn_estim_num':'" + estno, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;


    }

    public string GetSrvEstmDetails(string UserID, string Regno, string estm_no)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();
            CMD = new OracleCommand("pkg_jco_1.sp_jco_get_SRV_ESTIM_DTL", OBJ);
            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(UserID);
            CMD.Parameters.Add("pn_reg_num", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(Regno);
            CMD.Parameters.Add("pn_estim_no", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(estm_no);

            CMD.Parameters.Add("pn_out_reg", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_part_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_labor_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;

            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();
            string javascriptStr = "";
            int cnt = 0;
            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {
                OracleDataReader dr1 = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_part_refcur"].Value).GetDataReader();
                javascriptStr += "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "0" + "\"" + ","
                // + "\"" + Convert.ToString("REGNUM") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["pn_out_reg"].Value) + "\"" + ","
                 + "\"" + Convert.ToString("REGNUM") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["pn_out_reg"].Value)) + ","
                 //+ "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + ","
                 + "\"" + Convert.ToString("M") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_err_msg"].Value)) + ","
                + "\"" + "PART" + "\"" + ":" + "[";

                while (dr1.Read())
                {
                    cnt = 1;
                    javascriptStr += "{" + "\"" + Convert.ToString("PNO") + "\"" + ":" + "\"" + Convert.ToString(dr1[0]) + "\"" + "," +
                                      "\"" + Convert.ToString("PDSC") + "\"" + ":" + "\"" + Convert.ToString(dr1[1]) + "\"" + "," +
                                      "\"" + Convert.ToString("IQTY") + "\"" + ":" + "\"" + Convert.ToString(dr1[2]) + "\"" + "," +
                                      "\"" + Convert.ToString("PAMT") + "\"" + ":" + "\"" + Convert.ToString(dr1[3]) + "\"" + "}" + ",";

                }
                if (cnt == 1)
                {
                    javascriptStr = javascriptStr.Remove(javascriptStr.Length - 1, 1);
                }

                javascriptStr += "],";


                OracleDataReader dr2 = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_labor_refcur"].Value).GetDataReader();
                javascriptStr += "\"" + "LABOR" + "\"" + ":" + "[";
                while (dr2.Read())
                {
                    cnt = 2;
                    javascriptStr += "{" + "\"" + Convert.ToString("LCD") + "\"" + ":" + "\"" + Convert.ToString(dr2[0]) + "\"" + "," +
                                      "\"" + Convert.ToString("LDSC") + "\"" + ":" + "\"" + Convert.ToString(dr2[1]) + "\"" + "," +
                                      "\"" + Convert.ToString("LAMT") + "\"" + ":" + "\"" + Convert.ToString(dr2[2]) + "\"" + "}" + ",";
                }
                if (cnt == 2)
                {
                    javascriptStr = javascriptStr.Remove(javascriptStr.Length - 1, 1);
                }

                javascriptStr += "]" + "}";
                Result = javascriptStr;

                if (dr1 != null)
                {
                    dr1.Dispose();
                    dr1 = null;
                }

                if (dr2 != null)
                {
                    dr2.Dispose();
                    dr2 = null;
                }
                Logger.SuccessLogPrint("GetSrvEstmDetails", "sp_jco_get_SRV_ESTIM_DTL", "'pn_user_id': '" + UserID + "','pn_reg_num':'" + Regno + "','pn_estim_no':'" + estm_no, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));

            }
            else
            {
                javascriptStr = "{";


                javascriptStr = javascriptStr + "\"" + Convert.ToString("S") + "\"" + ":"
                                           + "\"" + "1" + "\"" + ","
                            + "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;
            }
            //OBJ.Close();
        }
        catch (Exception EX)
        {
            OBJ.Close();
            //Result = ex.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                       + "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("GetSrvEstmDetails", "sp_jco_get_SRV_ESTIM_DTL", "'pn_user_id': '" + UserID + "','pn_reg_num':'" + Regno + "','pn_estim_no':'" + estm_no, EX);


        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;

    }

    public string GetNewMenuDetails(string UserID, string svar_cd)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();
            CMD = new OracleCommand("pkg_jco_1.sp_jco_get_menu_dtl", OBJ);
            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(UserID);
            CMD.Parameters.Add("pn_svar_cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(svar_cd);



            CMD.Parameters.Add("po_menu_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();
            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {
                int cnter = 0;
                OracleDataReader dr = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_menu_refcur"].Value).GetDataReader();

                string javascriptStr = "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "0" + "\"" + ","
                                        //+ "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + ","
                                        + "\"" + Convert.ToString("M") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_err_msg"].Value)) + ","
                                        + "\"" + "MCD" + "\"" + ":" + "[";
                while (dr.Read())
                {
                    cnter = 1;
                    javascriptStr += "{" + "\"" + Convert.ToString("MC") + "\"" + ":" + "\"" + Convert.ToString(dr[0]) + "\"" + "," +
                                           "\"" + Convert.ToString("MD") + "\"" + ":" + "\"" + Convert.ToString(dr[1]) + "\"" + "," +
                                           "\"" + Convert.ToString("POPYN") + "\"" + ":" + "\"" + Convert.ToString(dr[2]) + "\"" + "}" + ",";

                }

                if (cnter == 1)
                {
                    if (javascriptStr.Length > 1)
                        javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                }
                javascriptStr += "]" + "}";
                //OBJ.Close();
                Result = javascriptStr;

                if (dr != null)
                {
                    dr.Dispose();
                    dr = null;
                }
                Logger.SuccessLogPrint("GetNewMenuDetails", "sp_jco_get_menu_dtl", "'pn_user_id': '" + UserID, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));

            }
            else
            {
                string javascriptStr = "{";
                javascriptStr = javascriptStr
                                              + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                                              + "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";
                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;
            }
            //OBJ.Close();
        }
        catch (Exception EX)
        {
            OBJ.Close();
            //Result = ex.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("GetNewMenuDetails", "sp_jco_get_menu_dtl", "'pn_user_id': '" + UserID, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;
    }

    //-----------written some fns on 8 may 2015---------------------------------

    public string GetExistingJC(string userID)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {

            OBJ.Open();
            CMD = new OracleCommand("pkg_jco_1.sp_jco_get_exist_jc", OBJ);

            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(userID);

            CMD.Parameters.Add("po_srv_adv_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();
            OracleDataReader dr = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_srv_adv_refcur"].Value).GetDataReader();

            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {

                string javascriptStr = "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "0" + "\"" + ","
                                        //+ "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + ","
                                        + "\"" + Convert.ToString("M") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_err_msg"].Value)) + ","
                                        + "\"" + "EXJC" + "\"" + ":" + "[";
                int cntr = 0;

                while (dr.Read())
                {
                    cntr = 1;
                    //CN and CONTNUM changes done (back slash replace with forward slash) as per Ashutosh ITD approval mail 07-JAN-2020 by Mukesh Sinha.
                    string strSplChar = @"\";
                    string strCN = Convert.ToString(dr[4]).Contains(strSplChar) ? Convert.ToString(dr[4]).Replace(strSplChar, "/") : Convert.ToString(dr[4]);
                    string strCONTNUM = Convert.ToString(dr[5]).Contains(strSplChar) ? Convert.ToString(dr[5]).Replace(strSplChar, "/") : Convert.ToString(dr[5]);
                    javascriptStr = javascriptStr
                                    + "{" + "\"" + Convert.ToString("RegNum") + "\"" + ":" + "\"" + Convert.ToString(dr[0]) + "\"" + ","
                                    + "\"" + Convert.ToString("JCOD") + "\"" + ":" + "\"" + Convert.ToString(dr[1]) + "\"" + ","
                                    + "\"" + Convert.ToString("JCNO") + "\"" + ":" + "\"" + Convert.ToString(dr[2]) + "\"" + ","
                                    + "\"" + Convert.ToString("JCS") + "\"" + ":" + "\"" + Convert.ToString(dr[3]) + "\"" + ","
                                    + "\"" + Convert.ToString("CN") + "\"" + ":" + "\"" + strCN + "\"" + ","
                                    + "\"" + Convert.ToString("CONTNUM") + "\"" + ":" + "\"" + strCONTNUM + "\"" + ","
                                    + "\"" + Convert.ToString("MDL") + "\"" + ":" + "\"" + Convert.ToString(dr[6]) + "\"" + ","
                                    + "\"" + Convert.ToString("SRVTYPE") + "\"" + ":" + "\"" + Convert.ToString(dr[7]) + "\"" + ","
                                    + "\"" + Convert.ToString("SRVACD") + "\"" + ":" + "\"" + Convert.ToString(dr[8]) + "\"" + ","
                                    + "\"" + Convert.ToString("SRVSDVNAME") + "\"" + ":" + "\"" + Convert.ToString(dr[9]) + "\"" + ","
                                    + "\"" + Convert.ToString("FLG") + "\"" + ":" + "\"" + Convert.ToString(dr[10]) + "\"" + ","
                                    + "\"" + Convert.ToString("PROMDT") + "\"" + ":" + "\"" + Convert.ToString(dr[11]) + "\"" + ","
                                    + "\"" + Convert.ToString("APPROVALSTATUS") + "\"" + ":" + "\"" + Convert.ToString(dr[12]) + "\"" + ","
                                    + "\"" + Convert.ToString("EMAIL") + "\"" + ":" + "\"" + Convert.ToString(dr["EMAIL"]) + "\"" + ","
                                    + "\"" + Convert.ToString("FINAL_INSPECTION") + "\"" + ":" + "\"" + Convert.ToString(dr["FINAL_INSPECTION"]) + "\"" + ","
                                    + "\"" + Convert.ToString("CCP_ELIGIBLE") + "\"" + ":" + "\"" + Convert.ToString(dr["ccp_eligible"]) + "\"" + ","
                                    + "\"" + Convert.ToString("CCP_NUM") + "\"" + ":" + "\"" + Convert.ToString(dr["ccp_num"]) + "\"" + "},";
                    //added CCP_RENEWABLR_YN as on 24APRIL23 by Nagmani Chauhan

                }
                if (cntr == 1)
                {
                    if (javascriptStr.Length > 1)
                        javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                }
                javascriptStr = javascriptStr + "]" + "}";
                //OBJ.Close();
                Result = javascriptStr;

                if (dr != null)
                {
                    dr.Dispose();
                    dr = null;
                }
                Logger.SuccessLogPrint("GetExistingJC", "sp_jco_get_exist_jc", "'pn_user_id': '" + userID, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));

            }
            else
            {

                string javascriptStr = "{";

                javascriptStr = javascriptStr
                                              + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                                              + "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;
            }
            //OBJ.Close();
        }
        catch (Exception EX)
        {
            OBJ.Close();
            //Result = ex.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("GetExistingJC", "sp_jco_get_exist_jc", "'pn_user_id': '" + userID, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;
    }

    //----------------------------------written some fns on 11 may 2015----------------------------------------------

    public string GetServiceCategory(string userID)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();
            CMD = new OracleCommand("pkg_jco_1.sp_jco_get_srv_cat", OBJ);
            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(userID);

            CMD.Parameters.Add("po_srv_cat", OracleDbType.RefCursor).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;

            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();

            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {

                OracleDataReader dr = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_srv_cat"].Value).GetDataReader();
                int Cnter = 0;
                string javascriptStr = "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "0" + "\"" + ","
                //+ "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + ","
                + "\"" + Convert.ToString("M") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_err_msg"].Value)) + ","
                + "\"" + Convert.ToString("SRVCAT") + "\"" + ":" + "[";
                while (dr.Read())
                {
                    javascriptStr = javascriptStr + "{" + "\"" + Convert.ToString(dr[0]) + "\"" + ":" + "\"" + Convert.ToString(dr[1]) + "\"" + "}" + ",";
                    Cnter = 1;
                }
                if (Cnter == 1)
                {
                    if (javascriptStr.Length > 1)
                        javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                }
                javascriptStr = javascriptStr + "]" + "}";
                //OBJ.Close();
                Result = javascriptStr;

                if (dr != null)
                {
                    dr.Dispose();
                    dr = null;
                }
                Logger.SuccessLogPrint("GetServiceCategory", "sp_jco_get_srv_cat", "'pn_user_id': '" + userID, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));

            }
            else
            {
                string javascriptStr = "{";


                javascriptStr = javascriptStr + "\"" + Convert.ToString("S") + "\"" + ":"
                                           + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                                           + "\"" + Convert.ToString("M") + "\""
                                          + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";
                //javascriptStr += ;
                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;
                // Result = Convert.ToString(CMD.Parameters["po_err_cd"].Value) + ":" + Convert.ToString(CMD.Parameters["po_err_msg"].Value);

            }
            //OBJ.Close();
        }
        catch (Exception EX)
        {
            OBJ.Close();
            //Result = ex.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("GetServiceCategory", "sp_jco_get_srv_cat", "'pn_user_id': '" + userID, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;
    }

    public string NewUserAuthMSG(string Regno)
    {

        string Result = "", javascriptStr = "";
        using (OracleConnection connection = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"])))
        {
            try
            {
                connection.Open();

                OracleCommand command = new OracleCommand("pkg_jco_1.check_insurance", connection);
                command.CommandType = CommandType.StoredProcedure;

                command.Parameters.Add("ret", OracleDbType.Varchar2, 500).Direction = ParameterDirection.ReturnValue;

                command.Parameters.Add("pn_reg_num", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Input;
                command.Parameters["pn_reg_num"].Value = Convert.ToString(Regno);

                command.ExecuteNonQuery();
                Console.WriteLine(command.Parameters["ret"].Value);

                connection.Close();
                javascriptStr = "{";
                javascriptStr = javascriptStr

                    + "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(command.Parameters["ret"].Value) + "\"" + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;
                //Result = Convert.ToString(command.Parameters["ret"].Value);
                return Result;

            }
            catch (Exception EX)
            {
                Logger.ErrorLogException("NewUserAuthMSG", "check_insurance", "pn_reg_num': '" + Regno, EX);
            }
            return Result;
        }
    }

    public string GetSaAdv(string userID)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();
            CMD = new OracleCommand("pkg_jco_1.sp_jco_get_sa_adv", OBJ);
            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(userID);

            CMD.Parameters.Add("po_srv_adv_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;

            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();

            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {

                OracleDataReader dr = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_srv_adv_refcur"].Value).GetDataReader();
                int Cnter = 0;
                string javascriptStr = "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "0" + "\"" + ","
                  //+ "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + ","
                  + "\"" + Convert.ToString("M") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_err_msg"].Value)) + ","
                  + "\"" + Convert.ToString("SRVADV") + "\"" + ":" + "[";
                while (dr.Read())
                {
                    javascriptStr = javascriptStr + "{" + "\"" + Convert.ToString(dr[0]) + "\"" + ":" + "\"" + Convert.ToString(dr[1]) + "\"" + "}" + ",";
                    Cnter = 1;
                }
                if (Cnter == 1)
                {
                    if (javascriptStr.Length > 1)
                        javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                }
                javascriptStr = javascriptStr + "]" + "}";
                //OBJ.Close();
                Result = javascriptStr;

                if (dr != null)
                {
                    dr.Dispose();
                    dr = null;
                }
                Logger.SuccessLogPrint("GetSaAdv", "sp_jco_get_sa_adv", "'pn_user_id': '" + userID, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));

            }
            else
            {
                string javascriptStr = "{";


                javascriptStr = javascriptStr + "\"" + Convert.ToString("S") + "\"" + ":"
                                           + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                                           + "\"" + Convert.ToString("M") + "\""
                                          + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";
                //javascriptStr += ;
                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;
                // Result = Convert.ToString(CMD.Parameters["po_err_cd"].Value) + ":" + Convert.ToString(CMD.Parameters["po_err_msg"].Value);

            }
            //OBJ.Close();
        }
        catch (Exception EX)
        {
            OBJ.Close();
            //Result = ex.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("GetSaAdv", "sp_jco_get_sa_adv", "'pn_user_id': '" + userID, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;
    }

    public string NewGetDemandCodeDetails(string userID)
    {
        String Result = String.Empty;

        var ConnectionTime = Convert.ToInt32(System.Configuration.ConfigurationManager.AppSettings["ConnectionTimeOut"].ToString());
        var RetryConnectCount = Convert.ToInt32(System.Configuration.ConfigurationManager.AppSettings["RetryConnectCount"].ToString());
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        var success = false;
        var count = 0;
        while (!success && count <= RetryConnectCount)
        {
            try
            {
                OBJ.Open();
                CMD = new OracleCommand("pkg_jco_1.sp_jco_get_demand_cd_dtl", OBJ);
                CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(userID);



                CMD.Parameters.Add("po_demand_cd_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;

                CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
                CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
                CMD.CommandType = CommandType.StoredProcedure;
                CMD.CommandTimeout = ConnectionTime;
                CMD.ExecuteNonQuery();

                if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
                {
                    int cnter = 0;
                    OracleDataReader dr = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_demand_cd_refcur"].Value).GetDataReader();

                    string javascriptStr = "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "0" + "\"" + ","
                                           //+ "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + ","
                                           + "\"" + Convert.ToString("M") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_err_msg"].Value)) + ","
                                           + "\"" + "DCD" + "\"" + ":" + "[";
                    while (dr.Read())
                    {
                        cnter = 1;
                        javascriptStr += "{" + "\"" + Convert.ToString("DC") + "\"" + ":" + "\"" + Convert.ToString(dr[0]) + "\"" + "," +
                                               "\"" + Convert.ToString("DD") + "\"" + ":" + "\"" + Convert.ToString(dr[1]) + "\"" + "," +
                                                "\"" + Convert.ToString("SRVT") + "\"" + ":" + "\"" + Convert.ToString(dr[2]) + "\"" + "," +
                                               "\"" + Convert.ToString("POPYN") + "\"" + ":" + "\"" + Convert.ToString(dr[3]) + "\"" + "}" + ",";
                    }

                    if (cnter == 1)
                    {
                        if (javascriptStr.Length > 1)
                            javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                    }
                    javascriptStr += "]" + "}";
                    //OBJ.Close();
                    Result = javascriptStr;

                    if (dr != null)
                    {
                        dr.Dispose();
                        dr = null;
                    }
                    Logger.SuccessLogPrint("NewGetDemandCodeDetails", "sp_jco_get_demand_cd_dtl", "'pn_user_id': '" + userID, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));
                    Logger.ApiLogPrint("NewGetDemandCodeDetails", "sp_jco_get_demand_cd_dtl", "'pn_user_id': '" + userID, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));
                }
                else
                {
                    string javascriptStr = "{";
                    javascriptStr = javascriptStr + "\"" + Convert.ToString("S") + "\"" + ":"
                                               + "\"" + "1" + "\"" + ","
                                               //+ "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";
                                               + "\"" + Convert.ToString("M") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_err_msg"].Value)) + "\"";

                    if (javascriptStr.Length > 1)
                        javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                    javascriptStr = javascriptStr + "}";
                    Result = javascriptStr;

                }
                //added to this success as true
                success = true;
                //OBJ.Close();
            }
            catch (Exception EX)
            {
                OBJ.Close();
                //Result = ex.Message;
                Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "1" + "\"" + ","
                                                + "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
                Logger.ErrorLogException("NewGetDemandCodeDetails", "sp_jco_get_demand_cd_dtl", "'pn_user_id': '" + userID, EX);
                Logger.ApiLogPrint("NewGetDemandCodeDetails", "sp_jco_get_demand_cd_dtl", "'pn_user_id': '" + userID, EX);
                count += 1;
            }
            finally
            {
                if (CMD != null)
                {
                    CMD.Dispose();
                    CMD = null;
                }
                if (OBJ != null && (OBJ.State == ConnectionState.Open))
                {
                    OBJ.Dispose();
                    OBJ = null;
                }
            }
        }
        if (success == false)
        {
            Logger.ApiLogPrint("NewGetDemandCodeDetails", "sp_jco_get_demand_cd_dtl", "'pn_user_id': '" + userID, "Failed to do the thing after 3 attempts");
        }
        return Result;
    }

    public string GetHistoryHDR(string regnum, string userID)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {

            OBJ.Open();
            CMD = new OracleCommand("pkg_jco_1.sp_jco_get_histroy_hdr", OBJ);
            CMD.Parameters.Add("pn_reg_num", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(regnum);
            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(userID);

            CMD.Parameters.Add("po_hist_hdr_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();
            OracleDataReader dr = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_hist_hdr_refcur"].Value).GetDataReader();

            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {
                int cnter = 0;

                string javascriptStr = "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "0" + "\"" + ","
                                          //+ "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + ","
                                          + "\"" + Convert.ToString("M") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_err_msg"].Value)) + ","
                                           + "\"" + "HHDR" + "\"" + ":" + "[";


                while (dr.Read())
                {
                    cnter = 1;


                    javascriptStr = javascriptStr
                                    + "{" + "\"" + Convert.ToString("JCN") + "\"" + ":" + "\"" + Convert.ToString(dr[0]) + "\"" + ","
                                    + "\"" + Convert.ToString("RODATE") + "\"" + ":" + "\"" + Convert.ToString(dr[1]) + "\"" + ","
                                    + "\"" + Convert.ToString("JCDT") + "\"" + ":" + "\"" + Convert.ToString(dr[2]) + "\"" + ","
                                    + "\"" + Convert.ToString("SRVCATCD") + "\"" + ":" + "\"" + Convert.ToString(dr[3]) + "\"" + ","
                                    + "\"" + Convert.ToString("SRVCATDSC") + "\"" + ":" + "\"" + Convert.ToString(dr[4]) + "\"" + ","
                                    + "\"" + Convert.ToString("OMR") + "\"" + ":" + "\"" + Convert.ToString(dr[5]) + "\"" + ","
                                    + "\"" + Convert.ToString("SRVDLRCD") + "\"" + ":" + "\"" + Convert.ToString(dr[6]) + "\"" + ","
                                    + "\"" + Convert.ToString("SRVDLRDSC") + "\"" + ":" + "\"" + Convert.ToString(dr[7]) + "\"" + ","
                                    + "\"" + Convert.ToString("BILLDATE") + "\"" + ":" + "\"" + Convert.ToString(dr[8]) + "\"" + ","
                                    + "\"" + Convert.ToString("BILLNO") + "\"" + ":" + "\"" + Convert.ToString(dr[9]) + "\"" + ","
                                    + "\"" + Convert.ToString("READYDATE") + "\"" + ":" + "\"" + Convert.ToString(dr[10]) + "\"" + ","
                                    + "\"" + Convert.ToString("PROMISEDDATE") + "\"" + ":" + "\"" + Convert.ToString(dr[11]) + "\"" + ","
                                    + "\"" + Convert.ToString("SANAME") + "\"" + ":" + "\"" + Convert.ToString(dr[12]) + "\"" + ","
                                    + "\"" + Convert.ToString("MECHNAME") + "\"" + ":" + "\"" + Convert.ToString(dr[13]) + "\"" + ","
                                    + "\"" + Convert.ToString("TECHADVNAME") + "\"" + ":" + "\"" + Convert.ToString(dr[14]) + "\"" + ","
                                    + "\"" + Convert.ToString("GROUPNAME") + "\"" + ":" + "\"" + Convert.ToString(dr[15]) + "\"" + ","
                                    + "\"" + Convert.ToString("PSFSTATUS") + "\"" + ":" + "\"" + Convert.ToString(dr[16]) + "\"" + ","
                                    + "\"" + Convert.ToString("PARTAMT") + "\"" + ":" + "\"" + Convert.ToString(dr[17]) + "\"" + ","
                                    + "\"" + Convert.ToString("LABOURAMT") + "\"" + ":" + "\"" + Convert.ToString(dr[18]) + "\"" + ","
                                    + "\"" + Convert.ToString("TOTAMT") + "\"" + ":" + "\"" + Convert.ToString(dr[19]) + "\"" + ","
                                    + "\"" + Convert.ToString("ESTPARTAMT") + "\"" + ":" + "\"" + Convert.ToString(dr[20]) + "\"" + ","
                                    + "\"" + Convert.ToString("ESTLABOURAMTe") + "\"" + ":" + "\"" + Convert.ToString(dr[21]) + "\"" + ","
                                    + "\"" + Convert.ToString("TOTESTAMT") + "\"" + ":" + "\"" + Convert.ToString(dr[22]) + "\"" + ","
                                    + "\"" + Convert.ToString("UNFITMENTYN") + "\"" + ":" + "\"" + Convert.ToString(dr[23]) + "\"" + ","
                                    + "\"" + Convert.ToString("PICKUPTYPE") + "\"" + ":" + "\"" + Convert.ToString(dr[24]) + "\"" + ","
                                    + "\"" + Convert.ToString("REMARKS") + "\"" + ":" + "\"" + Convert.ToString(dr[25]) + "\"" + "},";

                }
                if (cnter == 1)
                {
                    if (javascriptStr.Length > 1)
                        javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                }
                javascriptStr = javascriptStr + "]" + "}";

                Result = javascriptStr;

                if (dr != null)
                {
                    dr.Dispose();
                    dr = null;
                }
                Logger.SuccessLogPrint("GetHistoryHDR", "sp_jco_get_histroy_hdr", "'pn_reg_num': '" + regnum + "','pn_user_id':'" + userID, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));

            }
            else
            {

                string javascriptStr = "{";

                javascriptStr = javascriptStr
                                              + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                                              + "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;

            }
            //OBJ.Close();
        }
        catch (Exception EX)
        {
            OBJ.Close();
            //Result = ex.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("GetHistoryHDR", "sp_jco_get_histroy_hdr", "'pn_reg_num': '" + regnum + "','pn_user_id':'" + userID, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;
    }

    public string GetHistoryDetails(string jcnum, string UserID, string RegNum)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();
            CMD = new OracleCommand("pkg_jco_1.sp_jco_get_histroy_dtl", OBJ);

            CMD.Parameters.Add("pn_jc_num", OracleDbType.Varchar2, 12, ParameterDirection.Input).Value = Convert.ToString(jcnum);
            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(UserID);
            CMD.Parameters.Add("pn_reg_num", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(RegNum);

            CMD.Parameters.Add("po_followup_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_part_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_labor_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_demand_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;
            //PO_FC_OK PO_CATALYTIC_CONV_NUM added by GAGAN SHARMA 20 FEB 2023
            CMD.Parameters.Add("PO_FC_OK", OracleDbType.Date).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("PO_CATALYTIC_CONV_NUM", OracleDbType.Varchar2, 50).Direction = ParameterDirection.Output;
            //end GAGAN SHARMA 20 FEB 2023
            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();
            string javascriptStr = "";
            int cnt = 0;
            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {

                OracleDataReader dr = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_followup_refcur"].Value).GetDataReader();

                javascriptStr = "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "0" + "\"" + ","
                //+ "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + ","
                + "\"" + Convert.ToString("M") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_err_msg"].Value)) + ","
                //added by GAGAN SHARMA 20 FEB 2023
                 + "\"" + Convert.ToString("FC_OK") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["PO_FC_OK"].Value)) + ","
                  + "\"" + Convert.ToString("CATALYTIC_NUM") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["PO_CATALYTIC_CONV_NUM"].Value)) + ","
                + "\"" + "FOLLOWUP" + "\"" + ":" + "[";

                while (dr.Read())
                {
                    cnt = 1;
                    javascriptStr = javascriptStr +
                                          "{" + "\"" + Convert.ToString("FUD") + "\"" + ":" + "\"" + Convert.ToString(dr[0]) + "\"" + "," +
                                           "\"" + Convert.ToString("FUBY") + "\"" + ":" + "\"" + Convert.ToString(dr[1]) + "\"" + "," +
                                            "\"" + Convert.ToString("REMARKS") + "\"" + ":" + "\"" + Convert.ToString(dr[2]) + "\"" + "," +
                                           "\"" + Convert.ToString("SFLG") + "\"" + ":" + "\"" + Convert.ToString(dr[3]) + "\"" + "}" + ",";

                }

                if (cnt == 1)
                {
                    javascriptStr = javascriptStr.Remove(javascriptStr.Length - 1, 1);
                }

                javascriptStr += "],";


                OracleDataReader dr1 = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_part_refcur"].Value).GetDataReader();
                javascriptStr = javascriptStr + "\"" + "P" + "\"" + ":" + "[";
                while (dr1.Read())
                {
                    cnt = 2;
                    javascriptStr = javascriptStr + "{" + "\"" + Convert.ToString("PN") + "\"" + ":" + "\"" + Convert.ToString(dr1[0]) + "\"" + "," +
                                      "\"" + Convert.ToString("PD") + "\"" + ":" + "\"" + Convert.ToString(dr1[1]) + "\"" + "," +
                                      "\"" + Convert.ToString("IQTY") + "\"" + ":" + "\"" + Convert.ToString(dr1[2]) + "\"" + "," +
                                      "\"" + Convert.ToString("PAMT") + "\"" + ":" + "\"" + Convert.ToString(dr1[3]) + "\"" + "," +
                                      "\"" + Convert.ToString("PBILLABLETYPE") + "\"" + ":" + "\"" + Convert.ToString(dr1[4]) + "\"" + "}" + ",";

                }
                if (cnt == 2)
                {
                    javascriptStr = javascriptStr.Remove(javascriptStr.Length - 1, 1);
                }

                javascriptStr += "],";


                OracleDataReader dr2 = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_labor_refcur"].Value).GetDataReader();
                javascriptStr = javascriptStr + "\"" + "L" + "\"" + ":" + "[";
                while (dr2.Read())
                {
                    cnt = 3;
                    javascriptStr += "{" + "\"" + Convert.ToString("LCD") + "\"" + ":" + "\"" + Convert.ToString(dr2[0]) + "\"" + "," +
                                      "\"" + Convert.ToString("LDSC") + "\"" + ":" + "\"" + Convert.ToString(dr2[1]) + "\"" + "," +
                                      "\"" + Convert.ToString("LAMT") + "\"" + ":" + "\"" + Convert.ToString(dr2[2]) + "\"" + "," +
                                      "\"" + Convert.ToString("LBILLABLETYPE") + "\"" + ":" + "\"" + Convert.ToString(dr2[3]) + "\"" + "}" + ",";
                }
                if (cnt == 3)
                {
                    javascriptStr = javascriptStr.Remove(javascriptStr.Length - 1, 1);
                }

                javascriptStr = javascriptStr + "]" + ",";

                OracleDataReader dr3 = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_demand_refcur"].Value).GetDataReader();
                javascriptStr = javascriptStr + "\"" + "D" + "\"" + ":" + "[";
                while (dr3.Read())
                {
                    cnt = 4;
                    javascriptStr = javascriptStr + "{" + "\"" + Convert.ToString("DC") + "\"" + ":" + "\"" + Convert.ToString(dr3[0]) + "\"" + "," +
                                      "\"" + Convert.ToString("DD") + "\"" + ":" + "\"" + Convert.ToString(dr3[1]) + "\"" + "," +
                                      "\"" + Convert.ToString("CV") + "\"" + ":" + "\"" + Convert.ToString(dr3[2]) + "\"" + "}" + ",";
                }
                if (cnt == 4)
                {
                    javascriptStr = javascriptStr.Remove(javascriptStr.Length - 1, 1);
                }

                javascriptStr = javascriptStr + "]" + "}";

                Result = javascriptStr;

                if (dr != null)
                {
                    dr.Dispose();
                    dr = null;
                }

                if (dr1 != null)
                {
                    dr1.Dispose();
                    dr1 = null;
                }
                if (dr2 != null)
                {
                    dr2.Dispose();
                    dr2 = null;
                }
                if (dr3 != null)
                {
                    dr3.Dispose();
                    dr3 = null;
                }
                Logger.SuccessLogPrint("GetHistoryDetails", "sp_jco_get_histroy_dtl", "'pn_jc_num': '" + jcnum + "','pn_user_id':'" + UserID + "','pn_reg_num':'" + RegNum, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));

            }
            else
            {
                javascriptStr = "{";
                javascriptStr = javascriptStr + "\"" + Convert.ToString("S") + "\"" + ":"
                                           + "\"" + "1" + "\"" + ","
                                           + "\"" + Convert.ToString("M") + "\""
                                          + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;

            }
            //OBJ.Close();
        }
        catch (Exception EX)
        {
            OBJ.Close();
            //Result = ex.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("GetHistoryDetails", "sp_jco_get_histroy_dtl", "'pn_jc_num': '" + jcnum + "','pn_user_id':'" + UserID + "','pn_reg_num':'" + RegNum, EX);
        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;

    }


    public string NewVtsValidation(string Userid, Int32 VTS_NUM)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();
            CMD = new OracleCommand("pkg_jco_1.sp_jco_vts_num_validate", OBJ);
            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(Userid);
            CMD.Parameters.Add("pn_vts_card_num", OracleDbType.Int32, 4, ParameterDirection.Input).Value = Convert.ToInt32(VTS_NUM);
            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteReader();


            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {
                string javascriptStr = "{";
                javascriptStr = javascriptStr + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                                            //+ "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";
                                            + "\"" + Convert.ToString("M") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_err_msg"].Value)) + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;

                Logger.SuccessLogPrint("NewVtsValidation", "sp_jco_vts_num_validate", "'pn_user_id': '" + Userid + "','pn_vts_card_num':'" + VTS_NUM, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));

            }
            else
            {

                string javascriptStr = "{";
                javascriptStr = javascriptStr
                    + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                    + "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;
            }
            //OBJ.Close();
        }
        catch (Exception EX)
        {
            OBJ.Close();
            //Result = ex.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("NewVtsValidation", "sp_jco_vts_num_validate", "'pn_user_id': '" + Userid + "','pn_vts_card_num':'" + VTS_NUM, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;
    }


    public string GetCityDetails(string UserID1)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();

            CMD = new OracleCommand("pkg_jco_1.sp_jco_get_city_dtl", OBJ);
            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(UserID1);

            CMD.Parameters.Add("po_city_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;

            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();

            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {

                OracleDataReader dr = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_city_refcur"].Value).GetDataReader();

                string javascriptStr = "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "0" + "\"" + ","
                              //+ "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + ","
                              + "\"" + Convert.ToString("M") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_err_msg"].Value)) + ","
                              + "\"" + Convert.ToString("CITYDTL") + "\"" + ":" + "[";
                while (dr.Read())
                {
                    javascriptStr = javascriptStr + "{" + "\"" + Convert.ToString(dr[0]) + "\"" + ":" + "\"" + Convert.ToString(dr[1]) + "\"" + "}" + ",";
                }
                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "]" + "}";

                Result = javascriptStr;

                if (dr != null)
                {
                    dr.Dispose();
                    dr = null;
                }
                Logger.SuccessLogPrint("GetCityDetails", "sp_jco_get_city_dtl", "'pn_user_id': '" + UserID1, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));

            }
            else
            {
                string javascriptStr = "{";
                javascriptStr = javascriptStr
                    + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                    + "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";
                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;


            }
            //OBJ.Close();
        }
        catch (Exception EX)
        {
            OBJ.Close();
            //Result = ex.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("GetCityDetails", "sp_jco_get_city_dtl", "'pn_user_id': '" + UserID1, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;


    }


    public string GetMenuCardDetails(string userID, string RegNum, string srv_type_cd, string sub_srv_type_cd)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();
            CMD = new OracleCommand("pkg_jco_1.sp_get_menu_card_Dtl", OBJ);
            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(userID);
            CMD.Parameters.Add("pn_reg_num", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(RegNum);
            CMD.Parameters.Add("pn_srv_type_cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(srv_type_cd);
            CMD.Parameters.Add("pn_sub_srv_type_cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(sub_srv_type_cd);

            CMD.Parameters.Add("po_mcard_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();

            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {
                int cnter = 0;
                string javascriptStr = "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "0" + "\"" + ","
                                        + "\"" + Convert.ToString("M") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_err_msg"].Value)) + ","
                                        + "\"" + "MCDTL" + "\"" + ":" + "[";

                OracleDataReader dr = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_mcard_refcur"].Value).GetDataReader();
                while (dr.Read())
                {
                    cnter = 1;
                    javascriptStr = javascriptStr
                                    + "{" + "\"" + Convert.ToString("STC") + "\"" + ":" + "\"" + Convert.ToString(dr[0]) + "\"" + ","
                                    + "\"" + Convert.ToString("STDSC") + "\"" + ":" + "\"" + Convert.ToString(dr[1]) + "\"" + ","
                                    + "\"" + Convert.ToString("SRVCD") + "\"" + ":" + "\"" + Convert.ToString(dr[2]) + "\"" + ","
                                    + "\"" + Convert.ToString("SRVDSC") + "\"" + ":" + "\"" + Convert.ToString(dr[3]) + "\"" + ","
                                    + "\"" + Convert.ToString("SRVQTY") + "\"" + ":" + "\"" + Convert.ToString(dr[4]) + "\"" + ","
                                    + "\"" + Convert.ToString("GRPCD") + "\"" + ":" + "\"" + Convert.ToString(dr[5]) + "\"" + ","
                                    + "\"" + Convert.ToString("RATE") + "\"" + ":" + "\"" + Convert.ToString(dr[6]) + "\"" + ","
                                   + "\"" + Convert.ToString("MENU_PART_YN") + "\"" + ":" + "\"" + Convert.ToString(dr[7]) + "\"" + "},";

                }
                if (cnter == 1)
                {
                    if (javascriptStr.Length > 1)
                        javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                }
                javascriptStr = javascriptStr + "]" + "}";

                Result = javascriptStr;

                if (dr != null)
                {
                    dr.Dispose();
                    dr = null;
                }
                Logger.SuccessLogPrint("GetMenuCardDetails", "sp_get_menu_card_Dtl", "'pn_user_id': '" + userID + "','pn_reg_num':'" + RegNum + "','pn_srv_type_cd':'" + srv_type_cd + "','pn_sub_srv_type_cd':'" + sub_srv_type_cd, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));

            }
            else
            {
                string javascriptStr = "{";
                javascriptStr = javascriptStr
                                     + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "1" + "\"" + ","
                                     + "\"" + Convert.ToString("M") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_err_msg"].Value)) + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;

            }
            //OBJ.Close();
        }
        catch (Exception EX)
        {
            OBJ.Close();

            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("GetMenuCardDetails", "sp_get_menu_card_Dtl", "'pn_user_id': '" + userID + "','pn_reg_num':'" + RegNum + "','pn_srv_type_cd':'" + srv_type_cd + "','pn_sub_srv_type_cd':'" + sub_srv_type_cd, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;
    }
    //new fn to get part details date :19 dec 2015
    public string GetGroupPartDetails(string userID, string Grp_cd, string part_no)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();
            CMD = new OracleCommand("pkg_jco_1.sp_jco_get_group_part_dtl", OBJ);
            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(userID);
            CMD.Parameters.Add("pn_group_cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(Grp_cd);
            CMD.Parameters.Add("pn_part_num", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(part_no.Substring(0, 5));

            CMD.Parameters.Add("po_part_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();

            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {
                int cnter = 0;
                string javascriptStr = "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "0" + "\"" + ","
                                        + "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + ","
                                        + "\"" + "GGPDTL" + "\"" + ":" + "[";

                OracleDataReader dr = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_part_refcur"].Value).GetDataReader();
                while (dr.Read())
                {
                    cnter = 1;
                    javascriptStr = javascriptStr
                                    + "{" + "\"" + Convert.ToString("APC") + "\"" + ":" + "\"" + Convert.ToString(dr[0]) + "\"" + ","
                                    + "\"" + Convert.ToString("APD") + "\"" + ":" + "\"" + Convert.ToString(dr[1]) + "\"" + ","
                                    + "\"" + Convert.ToString("PC") + "\"" + ":" + "\"" + Convert.ToString(part_no) + "\"" + ","
                                    + "\"" + Convert.ToString("MRP") + "\"" + ":" + "\"" + Convert.ToString(dr[2]) + "\"" + "},";


                }
                if (cnter == 1)
                {
                    if (javascriptStr.Length > 1)
                        javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                }
                javascriptStr = javascriptStr + "]" + "}";

                Result = javascriptStr;
                if (dr != null)
                {
                    dr.Dispose();
                    dr = null;
                }
                Logger.SuccessLogPrint("GetGroupPartDetails", "sp_jco_get_group_part_dtl", "'pn_user_id': '" + userID + "','pn_group_cd':'" + Grp_cd + "','pn_part_num':'" + part_no, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));

            }
            else
            {
                string javascriptStr = "{";
                javascriptStr = javascriptStr
                                     + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "1" + "\"" + ","
                                     + "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;

            }
            //OBJ.Close();
        }
        catch (Exception EX)
        {
            OBJ.Close();

            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("GetGroupPartDetails", "sp_jco_get_group_part_dtl", "'pn_user_id': '" + userID + "','pn_group_cd':'" + Grp_cd + "','pn_part_num':'" + part_no, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;
    }



    public string GetTechAdv(string userID)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();
            CMD = new OracleCommand("pkg_jco_1.sp_jco_get_tech_adv", OBJ);
            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(userID);

            CMD.Parameters.Add("po_tech_adv_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;

            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();

            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {

                OracleDataReader dr = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_tech_adv_refcur"].Value).GetDataReader();
                int Cnter = 0;
                string javascriptStr = "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "0" + "\"" + ","
                //+ "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + ","
                + "\"" + Convert.ToString("M") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_err_msg"].Value)) + ","
                + "\"" + Convert.ToString("TECHADV") + "\"" + ":" + "[";
                while (dr.Read())
                {
                    javascriptStr = javascriptStr + "{" + "\"" + Convert.ToString(dr[0]) + "\"" + ":" + "\"" + Convert.ToString(dr[1]) + "\"" + "}" + ",";
                    Cnter = 1;
                }
                if (Cnter == 1)
                {
                    if (javascriptStr.Length > 1)
                        javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                }
                javascriptStr = javascriptStr + "]" + "}";
                //OBJ.Close();
                Result = javascriptStr;

                if (dr != null)
                {
                    dr.Dispose();
                    dr = null;
                }
                Logger.SuccessLogPrint("GetTechAdv", "sp_jco_get_tech_adv", "'pn_user_id': '" + userID, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));

            }
            else
            {
                string javascriptStr = "{";


                javascriptStr = javascriptStr + "\"" + Convert.ToString("S") + "\"" + ":"
                                           + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                                           + "\"" + Convert.ToString("M") + "\""
                                          + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;


            }
            //OBJ.Close();
        }
        catch (Exception EX)
        {
            OBJ.Close();
            //Result = ex.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";

            Logger.ErrorLogException("GetTechAdv", "sp_jco_get_tech_adv", "'pn_user_id': '" + userID, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;
    }


    public string GetBayDetails(string userID)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {

            OBJ.Open();
            CMD = new OracleCommand("pkg_jco_1.sp_jco_get_bay_dtl", OBJ);
            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(userID);

            CMD.Parameters.Add("po_bay_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();


            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {

                OracleDataReader dr = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_bay_refcur"].Value).GetDataReader();

                string javascriptStr = "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "0" + "\"" + ","
                //+ "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + ","
                + "\"" + Convert.ToString("M") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_err_msg"].Value)) + ","
                + "\"" + "BAYDTL" + "\"" + ":" + "[";
                while (dr.Read())
                {
                    javascriptStr += "{" + "\"" + Convert.ToString("BT") + "\"" + ":" + "\"" + Convert.ToString(dr[0]) + "\"" + "," +
                                           "\"" + Convert.ToString("BDSC") + "\"" + ":" + "\"" + Convert.ToString(dr[1]) + "\"" + "," +
                                           "\"" + Convert.ToString("BCD") + "\"" + ":" + "\"" + Convert.ToString(dr[2]) + "\"" + "}" + ",";

                }
                javascriptStr = javascriptStr.Remove(javascriptStr.Length - 1, 1);


                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr += "}]" + "}";
                //OBJ.Close();
                Result = javascriptStr;

                if (dr != null)
                {
                    dr.Dispose();
                    dr = null;
                }

                Logger.SuccessLogPrint("GetBayDetails", "sp_jco_get_bay_dtl", "'pn_user_id': '" + userID, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));

            }
            else
            {

                string javascriptStr = "{";

                javascriptStr = javascriptStr
                                              + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                                              + "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;

            }
            //OBJ.Close();
        }
        catch (Exception EX)
        {
            OBJ.Close();
            //Result = ex.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("GetBayDetails", "sp_jco_get_bay_dtl", "'pn_user_id': '" + userID, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;
    }


    public string GetGroupDetails(string userID)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();
            CMD = new OracleCommand("pkg_jco_1.sp_jco_get_group_dtl", OBJ);
            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(userID);

            CMD.Parameters.Add("po_group_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;

            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();

            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {

                OracleDataReader dr = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_group_refcur"].Value).GetDataReader();
                int Cnter = 0;
                string javascriptStr = "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "0" + "\"" + ","
                //+ "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + ","
                + "\"" + Convert.ToString("M") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_err_msg"].Value)) + ","
                + "\"" + Convert.ToString("GRPDTL") + "\"" + ":" + "[";
                while (dr.Read())
                {
                    javascriptStr = javascriptStr + "{" + "\"" + Convert.ToString(dr[0]) + "\"" + ":" + "\"" + Convert.ToString(dr[1]) + "\"" + "}" + ",";
                    Cnter = 1;
                }
                if (Cnter == 1)
                {
                    if (javascriptStr.Length > 1)
                        javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                }
                javascriptStr = javascriptStr + "]" + "}";

                Result = javascriptStr;

                if (dr != null)
                {
                    dr.Dispose();
                    dr = null;
                }
                Logger.SuccessLogPrint("GetGroupDetails", "sp_jco_get_group_dtl", "'pn_user_id': '" + userID, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));

            }
            else
            {
                string javascriptStr = "{";
                javascriptStr = javascriptStr + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                                              //+ "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";
                                              + "\"" + Convert.ToString("M") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_err_msg"].Value)) + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;


            }
            //OBJ.Close();
        }
        catch (Exception EX)
        {
            OBJ.Close();

            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("GetGroupDetails", "sp_jco_get_group_dtl", "'pn_user_id': '" + userID, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;
    }



    public string NewModifyVehicleDetails(string UserID, string regno, string VehUserName,
         string flag)  //string Email, string phone, string workingPhone, string mobile,
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();
            CMD = new OracleCommand("pkg_jco_1.sp_jco_modify_veh_dtl", OBJ);
            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(UserID);
            CMD.Parameters.Add("pn_reg_num", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(regno);
            if (flag != null && !string.IsNullOrEmpty(flag) && flag.Equals("in"))
            {
                CMD.Parameters.Add("pn_veh_user_name", OracleDbType.Varchar2, 100, ParameterDirection.Input).Value = Convert.ToString(VehUserName);
            }
            else
            {
                CMD.Parameters.Add("pn_veh_user_name", OracleDbType.Varchar2, 100).Direction = ParameterDirection.Output;
            }

            //11-Oct-2017 : Added four new inputs - Vectoform
            //CMD.Parameters.Add("pn_email", OracleDbType.Varchar2, 100, ParameterDirection.Input).Value = Convert.ToString(Email);

            //CMD.Parameters.Add("pn_phone", OracleDbType.Varchar2, 50, ParameterDirection.Input).Value = Convert.ToString(phone);
            //CMD.Parameters.Add("pn_work_phone", OracleDbType.Varchar2, 50, ParameterDirection.Input).Value = Convert.ToString(workingPhone);
            //CMD.Parameters.Add("pn_mobile", OracleDbType.Varchar2, 50, ParameterDirection.Input).Value = Convert.ToString(mobile);

            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;

            CMD.CommandType = CommandType.StoredProcedure;
            int cntRowsEffected = CMD.ExecuteNonQuery();


            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {

                //11-Oct-2017 : Added four new inputs, and sendig them in response - Vectoform
                string javascriptStr = "{";
                javascriptStr = javascriptStr + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                                            + "\"" + Convert.ToString("ROWCNT") + "\"" + ":" + "\"" + cntRowsEffected.ToString() + "\"" + ","
                                            //+ "\"" + Convert.ToString("UN") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["pn_veh_user_name"].Value) + "\"" + ","
                                            + "\"" + Convert.ToString("UN") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["pn_veh_user_name"].Value)) + ","

                                            //+ "\"" + Convert.ToString("EM") + "\"" + ":" + "\"" + CMD.Parameters["pn_email"].Value + "\"" + ","
                                            //+ "\"" + Convert.ToString("PH") + "\"" + ":" + "\"" + CMD.Parameters["pn_phone"].Value + "\"" + ","
                                            //+ "\"" + Convert.ToString("WP") + "\"" + ":" + "\"" + CMD.Parameters["pn_work_phone"].Value + "\"" + ","
                                            //+ "\"" + Convert.ToString("MO") + "\"" + ":" + "\"" + CMD.Parameters["pn_mobile"].Value + "\"" + ","

                                            //+ "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";
                                            + "\"" + Convert.ToString("M") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_err_msg"].Value)) + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;
                Logger.SuccessLogPrint("NewModifyVehicleDetails", "sp_jco_modify_veh_dtl", "'pn_user_id': '" + UserID + "','pn_reg_num':'" + regno + "','pn_veh_user_name':'" + VehUserName, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));

            }
            else
            {

                string javascriptStr = "{";
                javascriptStr = javascriptStr + "\"" + Convert.ToString("S") + "\"" + ":"
                                           + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                                           + "\"" + Convert.ToString("M") + "\""
                                          + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;
            }
            //OBJ.Close();
        }
        catch (Exception EX)
        {
            OBJ.Close();
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";

            Logger.ErrorLogException("NewModifyVehicleDetails", "sp_jco_modify_veh_dtl", "'pn_user_id': '" + UserID + "','pn_reg_num':'" + regno + "','pn_veh_user_name':'" + VehUserName, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;
    }

    public string GetMcardRejReason(string userID)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();
            CMD = new OracleCommand("pkg_jco_1.sp_jco_get_mcardrejreason", OBJ);
            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(userID);

            CMD.Parameters.Add("po_reject_reason_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;

            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();

            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {

                OracleDataReader dr = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_reject_reason_refcur"].Value).GetDataReader();
                int Cnter = 0;
                string javascriptStr = "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "0" + "\"" + ","
                                      //+ "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + ","
                                      + "\"" + Convert.ToString("M") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_err_msg"].Value)) + ","
                                      + "\"" + Convert.ToString("MCDRR") + "\"" + ":" + "[";
                while (dr.Read())
                {
                    javascriptStr = javascriptStr + "{" + "\"" + Convert.ToString(dr[0]) + "\"" + ":" + "\"" + Convert.ToString(dr[1]) + "\"" + "}" + ",";
                    Cnter = 1;
                }
                if (Cnter == 1)
                {
                    if (javascriptStr.Length > 1)
                        javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                }
                javascriptStr = javascriptStr + "]" + "}";
                //OBJ.Close();
                Result = javascriptStr;

                if (dr != null)
                {
                    dr.Dispose();
                    dr = null;
                }

                Logger.SuccessLogPrint("GetMcardRejReason", "sp_jco_get_mcardrejreason", "'pn_user_id': '" + userID, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));

            }
            else
            {
                string javascriptStr = "{";
                javascriptStr = javascriptStr + "\"" + Convert.ToString("S") + "\"" + ":"
                                           + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                                           //+ "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";
                                           + "\"" + Convert.ToString("M") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_err_msg"].Value)) + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;


            }
            //OBJ.Close();
        }
        catch (Exception EX)
        {
            OBJ.Close();
            //Result = ex.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("GetMcardRejReason", "sp_jco_get_mcardrejreason", "'pn_user_id': '" + userID, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;
    }

    //---added new fn to insert jc details on 15 may 2015---------------------------------
    //Changed data type of vts_card_num from int to string - 10-Nov-2017 - Vectorform
    //Added new key - qr_code  - 17-Jan-2017 - Vectorform
    public string NewInsertAllDetails(string RegNum, string UserID, string srv_cat_cd, string sub_srv_type_cd, Int32 OMR,
                                    string promised_date, string checkin_date, string sa_adv, string tech_adv, string bay_cd,
                                    string group_cd, string omr_change, Int32 vts_card_num, string tech_cd,
                                    string menu_ins_refcur, string demand_ins_refcur, string part_ins_refcur, string labor_ins_refcur, string inv_ins_refcur,
                                    string mcard_ins_refcur, string unapprv_fitment_refcur, string estm_refcur, string Pick_Typ, string Pick_Dat,
                                    string Pick_Flag, string Pick_Loc, string Pick_Drv, string Pick_Rem, string mms_num, string Emailid, string prob_str,
                                    double pn_part_est_amt, double pn_opr_est_amt, string rf_tag_num, string fcs_num, string qr_code,
                                    string cust_Remarks, string dlr_Remarks, string approval_Status,
                                    string ew_Flag, string ew_Type, string mcp_Flag, string mcp_Pckg, string wash_Type,
                                    string mms_Address, string mms_City, string mms_District, string mms_State, string mms_Pin,
                                    int audioCnt, string jc_scan_type, int ocas_cnt, int save_cnt, int sent_cnt, string final_Inspection,
                                    string c_measure_refcur, string BILLABLE_TYPE, string MI_NMI, string PANEL, string CUTTING_WELDING_YN,
                                    string PART_REPLACE_YN, string ENGINE_TRANSMISSION_YN, string FOR_CD, string SUGGESTED_PROMISE_DATE, string Tyres_Depth,
                                    string Battery_Condition, string Find_Id, string Recall_Type, string pn_ccp_yn, string pn_ccp_num, string CNG_TESTING_DUE, string CNG_TESTING_DATE)
    {

        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["conoracle_PushApi"]));
        try
        {
            OBJ.Open();
            CMD = new OracleCommand("pkg_jco_1.sp_jco_insert_dtl", OBJ);
            CMD.Parameters.Add("pn_reg_num", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(RegNum);
            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(UserID);
            CMD.Parameters.Add("pn_srv_cat_cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(srv_cat_cd);
            CMD.Parameters.Add("pn_sub_srv_type_cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(sub_srv_type_cd);
            CMD.Parameters.Add("pn_omr", OracleDbType.Int32, 8, ParameterDirection.Input).Value = Convert.ToInt32(OMR);

            if (promised_date == "")
                CMD.Parameters.Add("pn_promised_date", OracleDbType.Varchar2, ParameterDirection.Input).Value = DBNull.Value;//Convert.ToDateTime(promised_date);
            else
                CMD.Parameters.Add("pn_promised_date", OracleDbType.Varchar2, ParameterDirection.Input).Value = Convert.ToString(promised_date);//Convert.ToDateTime(promised_date);

            if (checkin_date == "")
                CMD.Parameters.Add("pn_checkin_date", OracleDbType.Varchar2, ParameterDirection.Input).Value = DBNull.Value;//Convert.ToDateTime(checkin_date);
            else
                CMD.Parameters.Add("pn_checkin_date", OracleDbType.Varchar2, ParameterDirection.Input).Value = Convert.ToString(checkin_date);//Convert.ToDateTime(checkin_date);

            CMD.Parameters.Add("pn_sa_adv", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(sa_adv);
            CMD.Parameters.Add("pn_tech_adv", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(tech_adv);
            CMD.Parameters.Add("pn_bay_cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(bay_cd);
            CMD.Parameters.Add("pn_group_cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(group_cd);
            CMD.Parameters.Add("pn_omr_change", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(omr_change);
            CMD.Parameters.Add("pn_vts_card_num", OracleDbType.Int32, 4, ParameterDirection.Input).Value = Convert.ToInt32(vts_card_num);
            CMD.Parameters.Add("pn_tech_cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(tech_cd);



            CMD.Parameters.Add("pn_menu_ins_str", OracleDbType.Varchar2, 3600, ParameterDirection.Input).Value = Convert.ToString(menu_ins_refcur);
            CMD.Parameters.Add("pn_demand_ins_str", OracleDbType.Varchar2, 3600, ParameterDirection.Input).Value = Convert.ToString(demand_ins_refcur);
            CMD.Parameters.Add("pn_part_ins_str", OracleDbType.Varchar2, 3600, ParameterDirection.Input).Value = Convert.ToString(part_ins_refcur);
            CMD.Parameters.Add("pn_labor_ins_str", OracleDbType.Varchar2, 3600, ParameterDirection.Input).Value = Convert.ToString(labor_ins_refcur);
            CMD.Parameters.Add("pn_inv_ins_str", OracleDbType.Varchar2, 3600, ParameterDirection.Input).Value = Convert.ToString(inv_ins_refcur);
            CMD.Parameters.Add("pn_mcard_ins_str", OracleDbType.Varchar2, 3600, ParameterDirection.Input).Value = Convert.ToString(mcard_ins_refcur);
            CMD.Parameters.Add("pn_unapprv_fit_str", OracleDbType.Varchar2, 3600, ParameterDirection.Input).Value = Convert.ToString(unapprv_fitment_refcur);
            CMD.Parameters.Add("pn_estm_str", OracleDbType.Varchar2, 500, ParameterDirection.Input).Value = Convert.ToString(estm_refcur);

            CMD.Parameters.Add("pn_pickup_type", OracleDbType.Varchar2, 25, ParameterDirection.Input).Value = Convert.ToString(Pick_Typ);

            if (Pick_Dat == "")
                CMD.Parameters.Add("pn_pickup_date", OracleDbType.Varchar2, ParameterDirection.Input).Value = DBNull.Value;//Convert.ToDateTime(Pick_Dat);
            else
                CMD.Parameters.Add("pn_pickup_date", OracleDbType.Varchar2, ParameterDirection.Input).Value = Convert.ToString(Pick_Dat);

            CMD.Parameters.Add("pn_free_pikcup_flag", OracleDbType.Varchar2, 1, ParameterDirection.Input).Value = Convert.ToString(Pick_Flag);
            CMD.Parameters.Add("pn_pickup_loc_cd", OracleDbType.Varchar2, 5, ParameterDirection.Input).Value = Convert.ToString(Pick_Loc);
            CMD.Parameters.Add("pn_pickup_driver", OracleDbType.Varchar2, 30, ParameterDirection.Input).Value = Convert.ToString(Pick_Drv);
            CMD.Parameters.Add("pn_pikcup_remarks", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(Pick_Rem);
            CMD.Parameters.Add("pn_mms_num", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(mms_num);
            CMD.Parameters.Add("pn_email_id", OracleDbType.Varchar2, 5, ParameterDirection.Input).Value = Convert.ToString(Emailid);
            //new param added on 27 nov 2015
            CMD.Parameters.Add("pn_prob_str", OracleDbType.Varchar2, 500, ParameterDirection.Input).Value = Convert.ToString(prob_str);
            //two new params added on 5 apr 2015

            CMD.Parameters.Add("pn_part_est_amt", OracleDbType.Double, ParameterDirection.Input).Value = Convert.ToDouble(pn_part_est_amt);
            CMD.Parameters.Add("pn_opr_est_amt", OracleDbType.Double, ParameterDirection.Input).Value = Convert.ToDouble(pn_opr_est_amt);

            CMD.Parameters.Add("PN_RFTAG_NUM", OracleDbType.Varchar2, 500, ParameterDirection.Input).Value = Convert.ToString(rf_tag_num);

            CMD.Parameters.Add("PN_FSC_NUM", OracleDbType.Varchar2, 500, ParameterDirection.Input).Value = Convert.ToString(fcs_num);

            CMD.Parameters.Add("PN_QR_CODE", OracleDbType.Varchar2, 500, ParameterDirection.Input).Value = Convert.ToString(qr_code); // 17-Jan-2018 :  new parameter added by  Vectorform
            //CMD.Parameters.Add("pn_part_est_amt", OracleDbType.Int32, 8, ParameterDirection.Input).Value = Convert.ToInt32(pn_part_est_amt);
            //CMD.Parameters.Add("pn_opr_est_amt", OracleDbType.Int32, 8, ParameterDirection.Input).Value = Convert.ToInt32(pn_opr_est_amt);
            //Response.Write("pn_part_est_amt======="+pn_part_est_amt);

            CMD.Parameters.Add("PN_CUST_REMARKS", OracleDbType.Varchar2, 500, ParameterDirection.Input).Value = cust_Remarks;
            CMD.Parameters.Add("PN_DLR_REMARKS", OracleDbType.Varchar2, 500, ParameterDirection.Input).Value = dlr_Remarks;
            CMD.Parameters.Add("PN_APPRV_STATUS", OracleDbType.Varchar2, 500, ParameterDirection.Input).Value = approval_Status;

            CMD.Parameters.Add("PN_EW_INTRST_YN", OracleDbType.Varchar2, 10, ParameterDirection.Input).Value = ew_Flag;
            CMD.Parameters.Add("PN_EW_INTRST_TYPE", OracleDbType.Varchar2, 500, ParameterDirection.Input).Value = ew_Type;
            CMD.Parameters.Add("PN_MCP_INTRST_YN", OracleDbType.Varchar2, 10, ParameterDirection.Input).Value = mcp_Flag;
            CMD.Parameters.Add("PN_MCP_INTRST_PKG", OracleDbType.Varchar2, 500, ParameterDirection.Input).Value = mcp_Pckg;

            CMD.Parameters.Add("PN_WASH_TYPE", OracleDbType.Varchar2, 500, ParameterDirection.Input).Value = wash_Type;

            //added new five parameter mms for address 04JULY2019 by mukesh sinha
            if (string.IsNullOrEmpty(mms_Address))
                CMD.Parameters.Add("PN_MMS_ADDRESS", OracleDbType.Varchar2, 100, ParameterDirection.Input).Value = DBNull.Value;
            else
                CMD.Parameters.Add("PN_MMS_ADDRESS", OracleDbType.Varchar2, 100, ParameterDirection.Input).Value = Convert.ToString(mms_Address);

            if (string.IsNullOrEmpty(mms_City))
                CMD.Parameters.Add("PN_MMS_CITY", OracleDbType.Varchar2, 50, ParameterDirection.Input).Value = DBNull.Value;
            else
                CMD.Parameters.Add("PN_MMS_CITY", OracleDbType.Varchar2, 50, ParameterDirection.Input).Value = Convert.ToString(mms_City);

            if (string.IsNullOrEmpty(mms_District))
                CMD.Parameters.Add("PN_MMS_DISTRICT", OracleDbType.Varchar2, 50, ParameterDirection.Input).Value = DBNull.Value;
            else
                CMD.Parameters.Add("PN_MMS_DISTRICT", OracleDbType.Varchar2, 50, ParameterDirection.Input).Value = Convert.ToString(mms_District);

            if (string.IsNullOrEmpty(mms_State))
                CMD.Parameters.Add("PN_MMS_STATE", OracleDbType.Varchar2, 50, ParameterDirection.Input).Value = DBNull.Value;
            else
                CMD.Parameters.Add("PN_MMS_STATE", OracleDbType.Varchar2, 50, ParameterDirection.Input).Value = Convert.ToString(mms_State);

            if (string.IsNullOrEmpty(mms_Pin))
                CMD.Parameters.Add("PN_MMS_PIN", OracleDbType.Varchar2, 6, ParameterDirection.Input).Value = DBNull.Value;
            else
                CMD.Parameters.Add("PN_MMS_PIN", OracleDbType.Varchar2, 6, ParameterDirection.Input).Value = Convert.ToString(mms_Pin);

            //added new parameter pn_audio_count for smart talk audio count 08AUG2019 by mukesh sinha
            CMD.Parameters.Add("PN_AUDIO_COUNT", OracleDbType.Int32, 25, ParameterDirection.Input).Value = audioCnt;
            //added new parmeter PN_JC_SCAN_TYPE for subscriber mobility  17DEC2019 by mukesh sinha

            if (string.IsNullOrEmpty(jc_scan_type))
                CMD.Parameters.Add("PN_JC_SCAN_TYPE", OracleDbType.Varchar2, ParameterDirection.Input).Value = DBNull.Value;
            else
                CMD.Parameters.Add("PN_JC_SCAN_TYPE", OracleDbType.Varchar2, ParameterDirection.Input).Value = jc_scan_type;

            //Start Added new three input parameters by mukesh sinha 17APRIL2020
            CMD.Parameters.Add("PN_OCAS_CNT", OracleDbType.Int32, 8, ParameterDirection.Input).Value = ocas_cnt;
            CMD.Parameters.Add("PN_SAVE_CNT", OracleDbType.Int32, 8, ParameterDirection.Input).Value = save_cnt;
            CMD.Parameters.Add("PN_SENT_CNT", OracleDbType.Int32, 8, ParameterDirection.Input).Value = sent_cnt;
            //End Added new three input parameters by mukesh sinha 17APRIL2020          

            //start added PN_Counter_Measure_DTL input parameter by mukesh sinha 20JAN2021 
            CMD.Parameters.Add("PN_Counter_Measure_DTL", OracleDbType.Varchar2, 4000, ParameterDirection.Input).Value = c_measure_refcur;
            //end added PN_Counter_Measure_DTL input parameter by mukesh sinha 20JAN2021 

            //start added input parameters by mukesh sinha 18FEB2021 
            CMD.Parameters.Add("PN_BILLABLE_TYPE", OracleDbType.Varchar2, 1, ParameterDirection.Input).Value = BILLABLE_TYPE;
            CMD.Parameters.Add("PN_MI_NMI", OracleDbType.Varchar2, 3, ParameterDirection.Input).Value = MI_NMI;
            //CMD.Parameters.Add("PN_PANEL", OracleDbType.Int32, 2, ParameterDirection.Input).Value = Convert.ToInt32(PANEL);
            CMD.Parameters.Add("PN_PANEL", OracleDbType.Varchar2, 2, ParameterDirection.Input).Value = PANEL;
            CMD.Parameters.Add("PN_CUTTING_WELDING_YN", OracleDbType.Varchar2, 1, ParameterDirection.Input).Value = CUTTING_WELDING_YN;
            CMD.Parameters.Add("PN_PART_REPLACE_YN", OracleDbType.Varchar2, 1, ParameterDirection.Input).Value = PART_REPLACE_YN;
            CMD.Parameters.Add("PN_ENGINE_TRANSMISSION_YN", OracleDbType.Varchar2, 1, ParameterDirection.Input).Value = ENGINE_TRANSMISSION_YN;
            if (!string.IsNullOrEmpty(SUGGESTED_PROMISE_DATE))
                CMD.Parameters.Add("PN_SUGGESTED_PROMISE_DATE", OracleDbType.Varchar2, ParameterDirection.Input).Value = SUGGESTED_PROMISE_DATE;
            else
                CMD.Parameters.Add("PN_SUGGESTED_PROMISE_DATE", OracleDbType.Varchar2, ParameterDirection.Input).Value = DBNull.Value;
            //End added input parameters by mukesh sinha 18FEB2021

            //Start added new input parameters by mukesh sinha 02APRIL2021
            CMD.Parameters.Add("PN_Tire_Depth", OracleDbType.Varchar2, 4000, ParameterDirection.Input).Value = Tyres_Depth;
            CMD.Parameters.Add("PN_Battery_Condition", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Battery_Condition;
            //Start added new input parameters by mukesh sinha 02APRIL2021

            //Start added new input parameters by mukesh sinha 01JUNE2021 for Sensegiz application
            CMD.Parameters.Add("PN_FIND_ID", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Find_Id;

            //Added new parametr by GAGAN Sharma 30MARCH2022
            CMD.Parameters.Add("PN_RECALL_TYPE", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Recall_Type;

            //Added PN_CNG_TESTING_DUE , PN_CNG_TESTING_DATE by gagan sharma 4JAN2023
            CMD.Parameters.Add("PN_CNG_TESTING_DUE", OracleDbType.Varchar2, 1, ParameterDirection.Input).Value = CNG_TESTING_DUE;//Possible values Y & N
            if (CNG_TESTING_DATE == "")
                CMD.Parameters.Add("PN_CNG_TESTING_DATE", OracleDbType.Varchar2, ParameterDirection.Input).Value = DBNull.Value;//Aded on 04-01-2023
            else
                CMD.Parameters.Add("PN_CNG_TESTING_DATE", OracleDbType.Varchar2, ParameterDirection.Input).Value = CNG_TESTING_DATE;

            CMD.Parameters.Add("po_job_card_num", OracleDbType.Varchar2, 12).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 3600).Direction = ParameterDirection.Output;

            //added Final Inspection input parameter by mukesh sinha 22SEPT2020
            CMD.Parameters.Add("PN_FINAL_INSPECTION", OracleDbType.Varchar2, 1, ParameterDirection.Input).Value = final_Inspection;

            //Added pn_ccp_yn pn_ccp_num by gagan sharma 6MAY2022
            CMD.Parameters.Add("pn_ccp_yn", OracleDbType.Varchar2, 1, ParameterDirection.Input).Value = pn_ccp_yn;
            CMD.Parameters.Add("pn_ccp_num", OracleDbType.Varchar2, 12, ParameterDirection.Input).Value = pn_ccp_num;

            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();

            string errCd = Convert.ToString(CMD.Parameters["po_err_cd"].Value);
            if (errCd.Equals(string.Empty, StringComparison.InvariantCultureIgnoreCase) || errCd.Equals("0", StringComparison.InvariantCultureIgnoreCase))
            {
                string javascriptStr = "{";
                javascriptStr = javascriptStr + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                                            //+ "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_err_msg"].Value)) + ","
                                            + "\"" + Convert.ToString("JB") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_job_card_num"].Value) + "\"" + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;
                Logger.SuccessLogPrint("NewInsertAllDetails", "sp_jco_insert_dtl", "'RegNum': '" + RegNum + "', 'pn_user_id': '" + UserID + "', 'pn_srv_cat_cd':'" + srv_cat_cd + "','pn_sub_srv_type_cd':'" + sub_srv_type_cd
               + "','pn_omr':'" + OMR + "','pn_promised_date':'" + promised_date + "','pn_checkin_date':'" + checkin_date + "','pn_sa_adv':'" + sa_adv + "','pn_tech_adv':'"
               + tech_adv + "','pn_bay_cd':'" + bay_cd + "','pn_group_cd':'" + group_cd + "','pn_omr_change':'" + omr_change + "','pn_vts_card_num':'" + vts_card_num
               + "','pn_tech_cd':'" + tech_cd + "','pn_menu_ins_str':'" + menu_ins_refcur + "','pn_demand_ins_str':'" + demand_ins_refcur + "','pn_part_ins_str':'"
               + part_ins_refcur + "','pn_labor_ins_str':'" + labor_ins_refcur + "','pn_inv_ins_str':'" + inv_ins_refcur + "','pn_mcard_ins_str':'" + mcard_ins_refcur
               + "','pn_unapprv_fit_str':'" + unapprv_fitment_refcur + "','pn_estm_str':'" + estm_refcur + "','pn_pickup_type':'" + Pick_Typ + "','pn_pickup_date':'" + Pick_Dat
               + "','pn_free_pikcup_flag':'" + Pick_Flag + "','pn_pickup_loc_cd':'" + Pick_Loc + "','pn_pickup_driver':'" + Pick_Drv + "','pn_pikcup_remarks':'" + Pick_Rem
               + "','pn_mms_num':'" + mms_num + "','pn_email_id':'" + Emailid + "','pn_prob_str':'" + prob_str + "','pn_part_est_amt':'" + pn_part_est_amt + "','pn_opr_est_amt':'"
               + pn_opr_est_amt + "','PN_RFTAG_NUM':'" + rf_tag_num + "','PN_FSC_NUM':'" + fcs_num + "','PN_QR_CODE':'" + qr_code + "','PN_CUST_REMARKS':'" + cust_Remarks
               + "','PN_DLR_REMARKS':'" + dlr_Remarks + "','PN_APPRV_STATUS':'" + approval_Status + "','PN_EW_INTRST_YN':'" + ew_Flag + "','PN_EW_INTRST_TYPE':'" + ew_Type
               + "','PN_MCP_INTRST_YN':'" + mcp_Flag + "','PN_MCP_INTRST_PKG':'" + mcp_Pckg + "','PN_WASH_TYPE':'" + wash_Type + "','PN_MMS_ADDRESS':'" + mms_Address
               + "','PN_MMS_CITY':'" + mms_City + "','PN_MMS_DISTRICT':'" + mms_District + "','PN_MMS_STATE':'" + mms_State + "','PN_MMS_PIN':'" + mms_Pin + "','PN_AUDIO_COUNT':'"
               + audioCnt + "','PN_JC_SCAN_TYPE':'" + jc_scan_type + "','PN_OCAS_CNT':'" + ocas_cnt + "','PN_SAVE_CNT':'" + save_cnt + "','PN_SENT_CNT':'" + sent_cnt
               + "','PN_Counter_Measure_DTL':'" + c_measure_refcur + "','PN_BILLABLE_TYPE':'" + BILLABLE_TYPE + "','PN_MI_NMI':'" + MI_NMI + "','PN_PANEL':'" + PANEL
               + "','PN_CUTTING_WELDING_YN':'" + CUTTING_WELDING_YN + "','PN_PART_REPLACE_YN':'" + PART_REPLACE_YN + "','PN_ENGINE_TRANSMISSION_YN':'"
               + ENGINE_TRANSMISSION_YN + "','PN_SUGGESTED_PROMISE_DATE':'" + SUGGESTED_PROMISE_DATE + "','PN_Tire_Depth':'" + Tyres_Depth + "','PN_Battery_Condition':'"
               + Battery_Condition + "','PN_FIND_ID':'" + Find_Id + "','PN_RECALL_TYPE':'" + Recall_Type + "','pn_ccp_yn':'" + pn_ccp_yn + "','pn_ccp_num':'" + pn_ccp_num + "'CNG_TESTING_DUE':'" + CNG_TESTING_DUE + "', 'CNG_TESTING_DATE':'" + CNG_TESTING_DATE, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));

            }
            else
            {//Response.Write("ssssssssss");
                string javascriptStr = "{";
                javascriptStr = javascriptStr + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                                              //+ "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";
                                              + "\"" + Convert.ToString("M") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_err_msg"].Value)) + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;
                Logger.Log(Result);
            }

            //OBJ.Close();

        }
        catch (Exception EX)
        {

            OBJ.Close();
            StringBuilder sb = null;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";


            Logger.ErrorLogException("NewInsertAllDetails", "sp_jco_insert_dtl", "'RegNum': '" + RegNum + "', 'pn_user_id': '" + UserID + "', 'pn_srv_cat_cd':'" + srv_cat_cd + "','pn_sub_srv_type_cd':'" + sub_srv_type_cd
                + "','pn_omr':'" + OMR + "','pn_promised_date':'" + promised_date + "','pn_checkin_date':'" + checkin_date + "','pn_sa_adv':'" + sa_adv + "','pn_tech_adv':'"
                + tech_adv + "','pn_bay_cd':'" + bay_cd + "','pn_group_cd':'" + group_cd + "','pn_omr_change':'" + omr_change + "','pn_vts_card_num':'" + vts_card_num
                + "','pn_tech_cd':'" + tech_cd + "','pn_menu_ins_str':'" + menu_ins_refcur + "','pn_demand_ins_str':'" + demand_ins_refcur + "','pn_part_ins_str':'"
                + part_ins_refcur + "','pn_labor_ins_str':'" + labor_ins_refcur + "','pn_inv_ins_str':'" + inv_ins_refcur + "','pn_mcard_ins_str':'" + mcard_ins_refcur
                + "','pn_unapprv_fit_str':'" + unapprv_fitment_refcur + "','pn_estm_str':'" + estm_refcur + "','pn_pickup_type':'" + Pick_Typ + "','pn_pickup_date':'" + Pick_Dat
                + "','pn_free_pikcup_flag':'" + Pick_Flag + "','pn_pickup_loc_cd':'" + Pick_Loc + "','pn_pickup_driver':'" + Pick_Drv + "','pn_pikcup_remarks':'" + Pick_Rem
                + "','pn_mms_num':'" + mms_num + "','pn_email_id':'" + Emailid + "','pn_prob_str':'" + prob_str + "','pn_part_est_amt':'" + pn_part_est_amt + "','pn_opr_est_amt':'"
                + pn_opr_est_amt + "','PN_RFTAG_NUM':'" + rf_tag_num + "','PN_FSC_NUM':'" + fcs_num + "','PN_QR_CODE':'" + qr_code + "','PN_CUST_REMARKS':'" + cust_Remarks
                + "','PN_DLR_REMARKS':'" + dlr_Remarks + "','PN_APPRV_STATUS':'" + approval_Status + "','PN_EW_INTRST_YN':'" + ew_Flag + "','PN_EW_INTRST_TYPE':'" + ew_Type
                + "','PN_MCP_INTRST_YN':'" + mcp_Flag + "','PN_MCP_INTRST_PKG':'" + mcp_Pckg + "','PN_WASH_TYPE':'" + wash_Type + "','PN_MMS_ADDRESS':'" + mms_Address
                + "','PN_MMS_CITY':'" + mms_City + "','PN_MMS_DISTRICT':'" + mms_District + "','PN_MMS_STATE':'" + mms_State + "','PN_MMS_PIN':'" + mms_Pin + "','PN_AUDIO_COUNT':'"
                + audioCnt + "','PN_JC_SCAN_TYPE':'" + jc_scan_type + "','PN_OCAS_CNT':'" + ocas_cnt + "','PN_SAVE_CNT':'" + save_cnt + "','PN_SENT_CNT':'" + sent_cnt
                + "','PN_Counter_Measure_DTL':'" + c_measure_refcur + "','PN_BILLABLE_TYPE':'" + BILLABLE_TYPE + "','PN_MI_NMI':'" + MI_NMI + "','PN_PANEL':'" + PANEL
                + "','PN_CUTTING_WELDING_YN':'" + CUTTING_WELDING_YN + "','PN_PART_REPLACE_YN':'" + PART_REPLACE_YN + "','PN_ENGINE_TRANSMISSION_YN':'"
                + ENGINE_TRANSMISSION_YN + "','PN_SUGGESTED_PROMISE_DATE':'" + SUGGESTED_PROMISE_DATE + "','PN_Tire_Depth':'" + Tyres_Depth + "','PN_Battery_Condition':'"
                + Battery_Condition + "','PN_FIND_ID':'" + Find_Id + "','PN_RECALL_TYPE':'" + Recall_Type + "','pn_ccp_yn':'" + pn_ccp_yn + "','pn_ccp_num':'" + pn_ccp_num + "'CNG_TESTING_DUE':'" + CNG_TESTING_DUE + "', 'CNG_TESTING_DATE':'" + CNG_TESTING_DATE, EX);
        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;
    }//end of fn



    //----------added following fns on 22 may 2015 -----------------

    public string NewBillPrint(string userID, string JobCardnum)
    {
        string javascriptStr = "";
        string javascriptStr1 = "";
        string javascriptStr2 = "";
        //new variable declared to store refcur values
        string partrefcurStr = "";
        string Hist1dtlrefcurStr = "";
        string Hist2dtlrefcurStr = "";
        string Subscriber_DetailRefCursor = string.Empty;
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();
            CMD = new OracleCommand("pkg_jco_1.sp_jcbill_print", OBJ);

            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(userID);
            CMD.Parameters.Add("pn_jc_no", OracleDbType.Varchar2, 12, ParameterDirection.Input).Value = Convert.ToString(JobCardnum);

            CMD.Parameters.Add("po_jc_date", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_cust_id", OracleDbType.Varchar2, 10).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_cust_name", OracleDbType.Varchar2, 100).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_cust_add", OracleDbType.Varchar2, 500).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_cust_phone", OracleDbType.Varchar2, 50).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_car_user_name", OracleDbType.Varchar2, 100).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_email", OracleDbType.Varchar2, 100).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_reg_num", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_chassis_num", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_engine_num", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_model", OracleDbType.Varchar2, 50).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_milege", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_sold_by", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_sold_date", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_key_no", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_tv_sale_date", OracleDbType.Varchar2, 100).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_service_type", OracleDbType.Varchar2, 50).Direction = ParameterDirection.Output;
            //new param added as on 21 may 2015

            CMD.Parameters.Add("po_sub_service_type", OracleDbType.Varchar2, 50).Direction = ParameterDirection.Output;
            //----

            CMD.Parameters.Add("po_demand_ref_cur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_instructions", OracleDbType.Varchar2, 500).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_srv_adv", OracleDbType.Varchar2, 120).Direction = ParameterDirection.Output;

            //new param added as on 21 may 2015
            CMD.Parameters.Add("po_prom_intial_date", OracleDbType.Varchar2, 120).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_prom_intial_time", OracleDbType.Varchar2, 120).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_prom_revd_date", OracleDbType.Varchar2, 120).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_prom_revd_time", OracleDbType.Varchar2, 120).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_tech_circular_desc", OracleDbType.Varchar2, 120).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_est_sch_labor_amt", OracleDbType.Int32, 10).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_est_sch_part_amt", OracleDbType.Int32, 10).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_re_sch_est_labor_amt", OracleDbType.Int32, 10).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_re_sch_est_part_amt", OracleDbType.Int32, 10).Direction = ParameterDirection.Output;

            //these are fields not marked as new  in excel
            CMD.Parameters.Add("po_est_labor_amt", OracleDbType.Int32, 10).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_est_part_amt", OracleDbType.Int32, 10).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_re_est_labor_amt", OracleDbType.Int32, 10).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_re_est_part_amt", OracleDbType.Int32, 10).Direction = ParameterDirection.Output;
            //----

            CMD.Parameters.Add("po_part_ref_cur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_group_cd", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_mech_cd", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;

            //-**************			
            CMD.Parameters.Add("po_created_by", OracleDbType.Varchar2, 100).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_inv_ref_cur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;

            //CMD.Parameters.Add("po_group", OracleDbType.Varchar2, 5).Direction = ParameterDirection.Output;

            // new param added again for history
            CMD.Parameters.Add("po_hist1_jc_no", OracleDbType.Varchar2, 100).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_hist1_jc_dt", OracleDbType.Varchar2, 100).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_hist1_mileage", OracleDbType.Int32, 10).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_hist1_group", OracleDbType.Varchar2, 100).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_hist1_srv_adv", OracleDbType.Varchar2, 100).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_hist1_mechanic", OracleDbType.Varchar2, 100).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_hist1_lbr_amt", OracleDbType.Int32, 10).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_hist1_part_amt", OracleDbType.Int32, 10).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_hist1_srv_type", OracleDbType.Varchar2, 100).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_hist1_psf_stat", OracleDbType.Varchar2, 100).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_hist1_csi_pert", OracleDbType.Int32, 10).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_hist1_remarks", OracleDbType.Varchar2, 100).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_hist1_dtl_ref_cur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;

            // for hist2

            CMD.Parameters.Add("po_hist2_jc_no", OracleDbType.Varchar2, 100).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_hist2_jc_dt", OracleDbType.Varchar2, 100).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_hist2_mileage", OracleDbType.Int32, 10).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_hist2_group", OracleDbType.Varchar2, 100).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_hist2_srv_adv", OracleDbType.Varchar2, 100).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_hist2_mechanic", OracleDbType.Varchar2, 100).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_hist2_lbr_amt", OracleDbType.Int32, 10).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_hist2_part_amt", OracleDbType.Int32, 10).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_hist2_srv_type", OracleDbType.Varchar2, 100).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_hist2_psf_stat", OracleDbType.Varchar2, 100).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_hist2_csi_pert", OracleDbType.Int32, 10).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_hist2_remarks", OracleDbType.Varchar2, 100).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_hist2_dtl_ref_cur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;
            // Added new parameter and ref cursor PO_SUBS_YN, PO_PVO_SUBSCRIBER_DET added by mukesh sinha 15NOV2019
            CMD.Parameters.Add("PO_SUBS_YN", OracleDbType.Varchar2, 1).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("PO_SUBSCRIBER_DET", OracleDbType.RefCursor).Direction = ParameterDirection.Output;

            //start added by gagan sharma 6may2022
            CMD.Parameters.Add("po_ccp_yn", OracleDbType.Varchar2, 1).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_ccp_num", OracleDbType.Varchar2, 12).Direction = ParameterDirection.Output;
            //end by gagan sharma 6may2022

            //PO_FC_OK PO_CATALYTIC_CONV_NUM Added by GAGAN SHARMA 20 FEB 2023
            CMD.Parameters.Add("PO_FC_OK", OracleDbType.Date).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("PO_CATALYTIC_CONV_NUM", OracleDbType.Varchar2, 50).Direction = ParameterDirection.Output;
            //end by gagan sharma 20 FEB 2023

            //PO_CORP_CUST_FLAG  PO_CORP_NAME Added by GAGAN SHARMA 5 JULY 2023
            CMD.Parameters.Add("PO_CORP_CUST_FLAG", OracleDbType.Varchar2, 1).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("PO_CORP_NAME", OracleDbType.Varchar2, 500).Direction = ParameterDirection.Output;
            //end by gagan sharma 5 JULY 2023

            //***************

            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();

            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {
                OracleDataReader dr = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_demand_ref_cur"].Value).GetDataReader();
                javascriptStr1 = "";
                while (dr.Read())
                {
                    javascriptStr1 = javascriptStr1 + Convert.ToString(dr[0]) + "+";
                }

                if (javascriptStr1.Length > 1)
                    javascriptStr1 = javascriptStr1.Substring(0, javascriptStr1.Length - 1);
                //javascriptStr1 = javascriptStr1;

                if (dr != null)
                {
                    dr.Dispose();
                    dr = null;
                }
            }

            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {
                OracleDataReader dr1 = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_inv_ref_cur"].Value).GetDataReader();
                javascriptStr2 = "";
                while (dr1.Read())
                {
                    javascriptStr2 = javascriptStr2 + Convert.ToString(dr1[0]) + "," + Convert.ToString(dr1[1]) + "+";
                }

                if (javascriptStr2.Length > 1)
                    javascriptStr2 = javascriptStr2.Substring(0, javascriptStr2.Length - 1);
                //javascriptStr2 = javascriptStr2;

                if (dr1 != null)
                {
                    dr1.Dispose();
                    dr1 = null;
                }
            }
            //----new cursor string added----

            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {
                OracleDataReader dr2 = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_part_ref_cur"].Value).GetDataReader();
                partrefcurStr = "";
                while (dr2.Read())
                {
                    partrefcurStr = partrefcurStr + Convert.ToString(dr2[0]) + "," + Convert.ToString(dr2[1]) + "," + Convert.ToString(dr2[2]) + "+";
                }

                if (partrefcurStr.Length > 1)
                    partrefcurStr = partrefcurStr.Substring(0, partrefcurStr.Length - 1);
                //partrefcurStr = partrefcurStr;

                if (dr2 != null)
                {
                    dr2.Dispose();
                    dr2 = null;
                }
            }


            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {
                OracleDataReader dr3 = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_hist1_dtl_ref_cur"].Value).GetDataReader();
                Hist1dtlrefcurStr = "";
                while (dr3.Read())
                {
                    Hist1dtlrefcurStr = Hist1dtlrefcurStr + Convert.ToString(dr3[0]) + "," + Convert.ToString(dr3[1]) + "," + Convert.ToString(dr3[2]) + "+";
                }

                if (Hist1dtlrefcurStr.Length > 1)
                    Hist1dtlrefcurStr = Hist1dtlrefcurStr.Substring(0, Hist1dtlrefcurStr.Length - 1);
                //Hist1dtlrefcurStr = Hist1dtlrefcurStr;

                if (dr3 != null)
                {
                    dr3.Dispose();
                    dr3 = null;
                }
            }


            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {
                OracleDataReader dr4 = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_hist2_dtl_ref_cur"].Value).GetDataReader();
                Hist2dtlrefcurStr = "";
                while (dr4.Read())
                {
                    Hist2dtlrefcurStr = Hist2dtlrefcurStr + Convert.ToString(dr4[0]) + "," + Convert.ToString(dr4[1]) + "," + Convert.ToString(dr4[2]) + "+";
                }

                if (Hist2dtlrefcurStr.Length > 1)
                    Hist2dtlrefcurStr = Hist2dtlrefcurStr.Substring(0, Hist2dtlrefcurStr.Length - 1);
                //Hist2dtlrefcurStr = Hist2dtlrefcurStr;

                if (dr4 != null)
                {
                    dr4.Dispose();
                    dr4 = null;
                }
            }
            // Added new ref cursor PO_PVO_SUBSCRIBER_DET added by mukesh sinha 15NOV2019
            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {
                OracleDataReader dr5 = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["PO_SUBSCRIBER_DET"].Value).GetDataReader();
                Subscriber_DetailRefCursor = "";
                while (dr5.Read())
                {
                    Subscriber_DetailRefCursor = Subscriber_DetailRefCursor + Convert.ToString(dr5[0]) + "," + Convert.ToString(dr5[1]) + "," + Convert.ToString(dr5[2]) + "," + Convert.ToString(dr5[3]) + "," + Convert.ToString(dr5[4]) + "," + Convert.ToString(dr5[5]) + "," + Convert.ToString(dr5[6]) + "," + Convert.ToString(dr5[7]) + "," + Convert.ToString(dr5[8]) + "," + Convert.ToString(dr5[9]) + "," + Convert.ToString(dr5[10]) + "," + Convert.ToString(dr5[11]) + "," + Convert.ToString(dr5[12]) + "+";
                }
                if (Subscriber_DetailRefCursor.Length > 1)
                    Subscriber_DetailRefCursor = Subscriber_DetailRefCursor.Substring(0, Subscriber_DetailRefCursor.Length - 1);

                if (dr5 != null)
                {
                    dr5.Dispose();
                    dr5 = null;
                }
            }

            //---------------------

            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {

                javascriptStr = "{";
                javascriptStr = javascriptStr
                   + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + CMD.Parameters["po_err_cd"].Value + "\"" + ","
                   //+ "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + CMD.Parameters["po_err_msg"].Value + "\"" + ","
                   + "\"" + Convert.ToString("M") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_err_msg"].Value)) + ","
                   + "\"" + Convert.ToString("JD") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_jc_date"].Value)) + ","
                   + "\"" + Convert.ToString("ID") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_cust_id"].Value)) + ","
                   + "\"" + Convert.ToString("NM") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_cust_name"].Value)) + ","
                   + "\"" + Convert.ToString("AD") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_cust_add"].Value)) + ","
                   //+ "\"" + Convert.ToString("CP") + "\"" + ":" + "\"" + CMD.Parameters["po_cust_phone"].Value + "\"" + ","
                   + "\"" + Convert.ToString("CP") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_cust_phone"].Value)) + ","
                   + "\"" + Convert.ToString("UN") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_car_user_name"].Value)) + ","
                   + "\"" + Convert.ToString("EM") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_email"].Value)) + ","
                   + "\"" + Convert.ToString("RN") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_reg_num"].Value)) + ","
                   + "\"" + Convert.ToString("CN") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_chassis_num"].Value)) + ","
                   + "\"" + Convert.ToString("EN") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_engine_num"].Value)) + ","
                   + "\"" + Convert.ToString("MD") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_model"].Value)) + ","
                   + "\"" + Convert.ToString("MI") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_milege"].Value)) + ","
                   + "\"" + Convert.ToString("XX") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_sold_by"].Value)) + ","
                   + "\"" + Convert.ToString("JJ") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_sold_date"].Value)) + ","
                   + "\"" + Convert.ToString("KN") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_key_no"].Value)) + ","
                   //+ "\"" + Convert.ToString("RR") + "\"" + ":" + "\"" + CMD.Parameters["po_tv_sale_date"].Value + "\"" + ","
                   + "\"" + Convert.ToString("RR") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_tv_sale_date"].Value)) + ","
                   + "\"" + Convert.ToString("ST") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_service_type"].Value)) + ","

                   //new param added 

                   //+ "\"" + Convert.ToString("SST") + "\"" + ":" + "\"" + CMD.Parameters["po_sub_service_type"].Value + "\"" + ","
                   + "\"" + Convert.ToString("SST") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_sub_service_type"].Value)) + ","

                    //--
                    + "\"" + Convert.ToString("RF") + "\"" + ":" + "\"" + javascriptStr1 + "\"" + ","
                    + "\"" + Convert.ToString("IN") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_instructions"].Value)) + ","
                    + "\"" + Convert.ToString("AC") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_srv_adv"].Value)) + ","
                     // new param added 
                     + "\"" + Convert.ToString("PID") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_prom_intial_date"].Value)) + ","
                     + "\"" + Convert.ToString("PIT") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_prom_intial_time"].Value)) + ","
                     //+ "\"" + Convert.ToString("PRD") + "\"" + ":" + "\"" + CMD.Parameters["po_prom_revd_date"].Value + "\"" + ","
                     + "\"" + Convert.ToString("PRD") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_prom_revd_date"].Value)) + ","
                     //+ "\"" + Convert.ToString("PRT") + "\"" + ":" + "\"" + CMD.Parameters["po_prom_revd_time"].Value + "\"" + ","
                     + "\"" + Convert.ToString("PRT") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_prom_revd_time"].Value)) + ","
                     //+ "\"" + Convert.ToString("TCD") + "\"" + ":" + "\"" + CMD.Parameters["po_tech_circular_desc"].Value + "\"" + ","
                     + "\"" + Convert.ToString("TCD") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_tech_circular_desc"].Value)) + ","
                     //+ "\"" + Convert.ToString("ESLT") + "\"" + ":" + "\"" + CMD.Parameters["po_est_sch_labor_amt"].Value + "\"" + ","
                     + "\"" + Convert.ToString("ESLT") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_est_sch_labor_amt"].Value)) + ","
                     //+ "\"" + Convert.ToString("ESPT") + "\"" + ":" + "\"" + CMD.Parameters["po_est_sch_part_amt"].Value + "\"" + ","
                     + "\"" + Convert.ToString("ESPT") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_est_sch_part_amt"].Value)) + ","
                     //+ "\"" + Convert.ToString("RSELT") + "\"" + ":" + "\"" + CMD.Parameters["po_re_sch_est_labor_amt"].Value + "\"" + ","
                     + "\"" + Convert.ToString("RSELT") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_re_sch_est_labor_amt"].Value)) + ","
                     //+ "\"" + Convert.ToString("RSEPT") + "\"" + ":" + "\"" + CMD.Parameters["po_re_sch_est_part_amt"].Value + "\"" + ","
                     + "\"" + Convert.ToString("RSEPT") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_re_sch_est_part_amt"].Value)) + ","

                  + "\"" + Convert.ToString("ELA") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_est_labor_amt"].Value)) + ","
                  + "\"" + Convert.ToString("EPA") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_est_part_amt"].Value)) + ","
                  //+ "\"" + Convert.ToString("RELA") + "\"" + ":" + "\"" + CMD.Parameters["po_re_est_labor_amt"].Value + "\"" + ","
                  + "\"" + Convert.ToString("RELA") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_re_est_labor_amt"].Value)) + ","
                  //+ "\"" + Convert.ToString("REPA") + "\"" + ":" + "\"" + CMD.Parameters["po_re_est_part_amt"].Value + "\"" + ","
                  + "\"" + Convert.ToString("REPA") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_re_est_part_amt"].Value)) + ","

                  //new cursor po_part_ref_cur(part_Desc,accept_yn,reject_Reason_Cd)
                  + "\"" + Convert.ToString("PRF") + "\"" + ":" + "\"" + partrefcurStr + "\"" + ","
                  //-----
                  + "\"" + Convert.ToString("GCD") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_group_cd"].Value)) + ","
                  //+ "\"" + Convert.ToString("MCD") + "\"" + ":" + "\"" + CMD.Parameters["po_mech_cd"].Value + "\"" + ","
                  + "\"" + Convert.ToString("MCD") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_mech_cd"].Value)) + ","

                  + "\"" + Convert.ToString("CB") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_created_by"].Value)) + ","

                  //cursor po_inv_ref_cur(INVENTORY_DESC,INVENTORY_YN) added here 

                  + "\"" + Convert.ToString("MJ") + "\"" + ":" + "\"" + javascriptStr2 + "\"" + ","

                  //----
                  //  + "\"" + Convert.ToString("GN") + "\"" + ":" + "\"" + CMD.Parameters["po_group"].Value + "\"" + ","

                  //new 26 history param added here 
                  + "\"" + Convert.ToString("H1JN") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_hist1_jc_no"].Value)) + ","
                  //+ "\"" + Convert.ToString("H1JD") + "\"" + ":" + "\"" + CMD.Parameters["po_hist1_jc_dt"].Value + "\"" + ","
                  + "\"" + Convert.ToString("H1JD") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_hist1_jc_dt"].Value)) + ","
                  + "\"" + Convert.ToString("H1MLG") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_hist1_mileage"].Value)) + ","
                  + "\"" + Convert.ToString("H1GRP") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_hist1_group"].Value)) + ","
                  + "\"" + Convert.ToString("H1SA") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_hist1_srv_adv"].Value)) + ","
                  + "\"" + Convert.ToString("H1MCH") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_hist1_mechanic"].Value)) + ","
                  + "\"" + Convert.ToString("H1LA") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_hist1_lbr_amt"].Value)) + ","
                  + "\"" + Convert.ToString("H1PA") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_hist1_part_amt"].Value)) + ","
                  + "\"" + Convert.ToString("H1ST") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_hist1_srv_type"].Value)) + ","
                  + "\"" + Convert.ToString("H1PS") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_hist1_psf_stat"].Value)) + ","
                  //+ "\"" + Convert.ToString("H1CP") + "\"" + ":" + "\"" + CMD.Parameters["po_hist1_csi_pert"].Value + "\"" + ","
                  + "\"" + Convert.ToString("H1CP") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_hist1_csi_pert"].Value)) + ","
                  //+ "\"" + Convert.ToString("H1RM") + "\"" + ":" + "\"" + CMD.Parameters["po_hist1_remarks"].Value + "\"" + ","
                  + "\"" + Convert.ToString("H1RM") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_hist1_remarks"].Value)) + ","

                  // new po_hist1_dtl_ref_cur(Labour Code,Labour Desc,Qty) added
                  + "\"" + Convert.ToString("H1RF") + "\"" + ":" + "\"" + Hist1dtlrefcurStr + "\"" + ","
                 //----

                 + "\"" + Convert.ToString("H2JN") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_hist2_jc_no"].Value)) + ","
                  + "\"" + Convert.ToString("H2JD") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_hist2_jc_dt"].Value)) + ","
                  + "\"" + Convert.ToString("H2MLG") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_hist2_mileage"].Value)) + ","
                  + "\"" + Convert.ToString("H2GRP") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_hist2_group"].Value)) + ","
                  + "\"" + Convert.ToString("H2SA") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_hist2_srv_adv"].Value)) + ","
                  + "\"" + Convert.ToString("H2MCH") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_hist2_mechanic"].Value)) + ","
                  + "\"" + Convert.ToString("H2LA") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_hist2_lbr_amt"].Value)) + ","
                  + "\"" + Convert.ToString("H2PA") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_hist2_part_amt"].Value)) + ","
                  + "\"" + Convert.ToString("H2ST") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_hist2_srv_type"].Value)) + ","
                  + "\"" + Convert.ToString("H2PS") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_hist2_psf_stat"].Value)) + ","
                  //+ "\"" + Convert.ToString("H2CP") + "\"" + ":" + "\"" + CMD.Parameters["po_hist2_csi_pert"].Value + "\"" + ","
                  + "\"" + Convert.ToString("H2CP") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_hist2_csi_pert"].Value)) + ","
                  //+ "\"" + Convert.ToString("H2RM") + "\"" + ":" + "\"" + CMD.Parameters["po_hist2_remarks"].Value + "\"" + ","
                  + "\"" + Convert.ToString("H2RM") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_hist2_remarks"].Value)) + ","
                  // new po_hist2_dtl_ref_cur(Labour Code,Labour Desc,Qty) added
                  + "\"" + Convert.ToString("H2RF") + "\"" + ":" + "\"" + Hist2dtlrefcurStr + "\"" + ","

                  // Added new parameter SUBS_YN and ref cursor PO_PVO_SUBSCRIBER_DET added by mukesh sinha 15NOV2019
                  + "\"" + Convert.ToString("SUBS_YN") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["PO_SUBS_YN"].Value)) + ","
                    + "\"" + Convert.ToString("ccp_yn") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_ccp_yn"].Value)) + ","
                      + "\"" + Convert.ToString("ccp_num") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_ccp_num"].Value)) + ","
                      //PO_FC_OK PO_CATALYTIC_CONV_NUM Added by GAGAN SHARMA 20 FEB 2023
                      + "\"" + Convert.ToString("FC_OK") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["PO_FC_OK"].Value)) + ","
                      + "\"" + Convert.ToString("CATALYTIC_NUM") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["PO_CATALYTIC_CONV_NUM"].Value)) + ","
                      + "\"" + Convert.ToString("CORP_CUST_FLAG") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["PO_CORP_CUST_FLAG"].Value)) + ","
                      + "\"" + Convert.ToString("CORP_NAME") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["PO_CORP_NAME"].Value)) + ","
                  + "\"" + Convert.ToString("SUBSCRIBER_DET") + "\"" + ":" + "\"" + Subscriber_DetailRefCursor + "\"" + "\"";

                //---***

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;

                Logger.SuccessLogPrint("NewBillPrint", "sp_jcbill_print", "'pn_user_id': '" + userID + "','pn_jc_no':'" + JobCardnum, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));

            }
            else
            {
                javascriptStr = "{";
                javascriptStr = javascriptStr
                    + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "1" + "\"" + ","
                    + "\"" + Convert.ToString("DE") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                    //+ "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";
                    + "\"" + Convert.ToString("M") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_err_msg"].Value)) + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;
            }

            //OBJ.Close();

        }
        catch (Exception EX)
        {
            OBJ.Close();

            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("NewBillPrint", "sp_jcbill_print", "'pn_user_id': '" + userID + "','pn_jc_no':'" + JobCardnum, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;
    }

    //--------------------------written new fn as on 12 june 2015

    public string GetJCOpenDetails(string Jcmodule, string UserID, string Parent_group, Int32 Dealer_map_cd, string Loc_Cd, string Comp_fa, string Jcno)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();
            CMD = new OracleCommand("PKG_JCO_1.SP_JCO_GET_JC_OPEN_DTL", OBJ);

            CMD.Parameters.Add("pn_jc_module", OracleDbType.Varchar2, 200, ParameterDirection.Input).Value = Convert.ToString(Jcmodule);
            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 200, ParameterDirection.Input).Value = Convert.ToString(UserID);
            CMD.Parameters.Add("pn_parent_group", OracleDbType.Varchar2, 200, ParameterDirection.Input).Value = Convert.ToString(Parent_group);
            CMD.Parameters.Add("pn_dealer_map_cd", OracleDbType.Int32, 20, ParameterDirection.Input).Value = Dealer_map_cd;
            CMD.Parameters.Add("pn_loc_Cd", OracleDbType.Varchar2, 200, ParameterDirection.Input).Value = Convert.ToString(Loc_Cd);
            CMD.Parameters.Add("pn_comp_fa", OracleDbType.Varchar2, 200, ParameterDirection.Input).Value = Convert.ToString(Comp_fa);
            CMD.Parameters.Add("pn_jc_no", OracleDbType.Varchar2, 200, ParameterDirection.Input).Value = Convert.ToString(Jcno);
            CMD.Parameters.Add("po_jc_status", OracleDbType.Varchar2, 500).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_jc_status_desc", OracleDbType.Varchar2, 1000).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_omr", OracleDbType.Int32, 20).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_srv_type_cd", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_srv_type_desc", OracleDbType.Varchar2, 1000).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_sub_srv_cd", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_sub_srv_desc", OracleDbType.Varchar2, 1000).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_bay_cd", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_bay_desc", OracleDbType.Varchar2, 1000).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_srv_adv_cd", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_srv_adv_desc", OracleDbType.Varchar2, 1000).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_group_cd", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_group_desc", OracleDbType.Varchar2, 1000).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_tech_cd", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_tech_desc", OracleDbType.Varchar2, 1000).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_tech_adv_Cd", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_tech_adv_desc", OracleDbType.Varchar2, 1000).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_ceo_approval", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_lastflwup_date", OracleDbType.Varchar2, 500).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_lastflwup_csi", OracleDbType.Int32, 30).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_lastflwup_by", OracleDbType.Varchar2, 500).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_pickup_type", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_pickup_type_desc", OracleDbType.Varchar2, 1000).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_pickup_date", OracleDbType.Varchar2, 500).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_pickup_loc", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_pickup_loc_desc", OracleDbType.Varchar2, 500).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_driver", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_driver_desc", OracleDbType.Varchar2, 500).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_pickup_remarks", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_free_pickup_yn", OracleDbType.Varchar2, 1).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_mms_num", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_intial_prom_date", OracleDbType.Varchar2, 500).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_revised_prom_date", OracleDbType.Varchar2, 500).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_jc_close_date", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_jc_open_date", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_cust_corp_status", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_rdtest_st_time", OracleDbType.Double, 30).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_rdtest_st_km", OracleDbType.Double, 30).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_rdtest_end_time", OracleDbType.Double, 30).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_rdtest_end_km", OracleDbType.Double, 30).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_est_sch_labor_amt", OracleDbType.Double, 30).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_est_sch_part_amt", OracleDbType.Double, 30).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_est_labor_amt", OracleDbType.Double, 30).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_est_part_amt", OracleDbType.Double, 30).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_re_est_labor_amt", OracleDbType.Double, 30).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_re_est_part_amt", OracleDbType.Double, 30).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_amc_yn", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_amc_num", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_amc_date", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_recall_yn", OracleDbType.Varchar2, 1).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_delay_reas_cd", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_delay_reas_desc", OracleDbType.Varchar2, 1000).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_delay_reas_remarks", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_csi_reas_cd", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_csi_reas_desc", OracleDbType.Varchar2, 1000).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_csi_reas_remarks", OracleDbType.Varchar2, 4000).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_part_disc_perc", OracleDbType.Double, 30).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_labour_disc_perc", OracleDbType.Double, 30).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_disc_auth_by_cd", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_disc_auth_by_desc", OracleDbType.Varchar2, 1000).Direction = ParameterDirection.Output;

            //following are the cursors in o/p
            CMD.Parameters.Add("po_demand_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_part_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_labor_Refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_inv_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_smcard_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_unapprfit_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_tech_camp_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_repair_act_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;
            //added these two parameters on 18 jun 2015 from excel got on 18/06
            CMD.Parameters.Add("po_vts_card_num", OracleDbType.Int32, 30).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_checkin_date", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;

            //added these three parameters on 25 aug 2015 from maruti  got on 24/08
            CMD.Parameters.Add("po_cus_out_amt", OracleDbType.Double, 30).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_pref_followup_time", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_comply_dtl_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;
            //new param added on 27 nov 2015
            CMD.Parameters.Add("po_prob_str", OracleDbType.Varchar2, 500).Direction = ParameterDirection.Output;
            //new param added on 20 mar 2017
            CMD.Parameters.Add("po_channel", OracleDbType.Varchar2, 500).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_wash_type", OracleDbType.Varchar2, 500).Direction = ParameterDirection.Output;

            //start new param added on 13 JUNE 2019
            CMD.Parameters.Add("po_mms_address", OracleDbType.Varchar2, 100).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_mms_city", OracleDbType.Varchar2, 50).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_mms_district", OracleDbType.Varchar2, 50).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_mms_state", OracleDbType.Varchar2, 50).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_mms_pin", OracleDbType.Varchar2, 6).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("PO_AUDIO_COUNT", OracleDbType.Int32, 25).Direction = ParameterDirection.Output;
            //end new param added on 13 JUNE 2019

            //start new param added on 23 SEPT 2019
            CMD.Parameters.Add("PO_VIN", OracleDbType.Varchar2, 22).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("PO_DLR_REFCUR", OracleDbType.RefCursor).Direction = ParameterDirection.Output;
            //End new param added on 23 SEPT 2019

            //start new param added on 07 Aug 2020
            CMD.Parameters.Add("po_ocas_cnt", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_save_cnt", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_sent_cnt", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            //End new param added on 07 Aug 2020

            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;

            //Start new param added on 21SEPT2020
            CMD.Parameters.Add("PO_FINAL_INSPECTION", OracleDbType.Varchar2, 1).Direction = ParameterDirection.Output;
            //End new param added on 21SEPT2020

            //Start new param added on 10SEPT2021
            CMD.Parameters.Add("PO_ADD_CHK", OracleDbType.Varchar2, 1).Direction = ParameterDirection.Output;
            //Start new param added on 10SEPT2021

            //Added by gagan sharma 6MAY2022
            CMD.Parameters.Add("po_ccp_claim_yn", OracleDbType.Varchar2, 1).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_ccp_num", OracleDbType.Varchar2, 12).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_ccp_type", OracleDbType.Varchar2, 100).Direction = ParameterDirection.Output;

            //PO_CORP_CUST_FLAG  PO_CORP_NAME Added by GAGAN SHARMA 5 JULY 2023
            CMD.Parameters.Add("PO_CORP_CUST_FLAG", OracleDbType.Varchar2, 1).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("PO_CORP_NAME", OracleDbType.Varchar2, 500).Direction = ParameterDirection.Output;
            //end by gagan sharma 5 JULY 2023


            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();

            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {

                int cnter1 = 0;

                string javascriptStr = "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "0" + "\"" + ","
                //+ "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + CMD.Parameters["po_err_msg"].Value + "\"" + ","
                + "\"" + Convert.ToString("M") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_err_msg"].Value)) + ","
                + "\"" + "K" + "\"" + ":" + "[{";

                javascriptStr = javascriptStr

                + "\"" + Convert.ToString("JS") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_jc_status"].Value)) + ","
                + "\"" + Convert.ToString("JSD") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_jc_status_desc"].Value)) + ","
                //+ "\"" + Convert.ToString("OMR") + "\"" + ":" + "\"" + ((CMD.Parameters["po_omr"].Value != null && !(CMD.Parameters["po_omr"].Value is DBNull)) ? CMD.Parameters["po_omr"].Value : "") + "\"" + ","
                + "\"" + Convert.ToString("OMR") + "\"" + ":" + "\"" + ((CMD.Parameters["po_omr"].Value != null && !(CMD.Parameters["po_omr"].Value is DBNull)) ? Convert.ToString(CMD.Parameters["po_omr"].Value) == "null" ? "" : CMD.Parameters["po_omr"].Value : "") + "\"" + ","
                + "\"" + Convert.ToString("STC") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_srv_type_cd"].Value)) + ","
                + "\"" + Convert.ToString("STD") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_srv_type_desc"].Value)) + ","
                //+ "\"" + Convert.ToString("SSC") + "\"" + ":" + "\"" + CMD.Parameters["po_sub_srv_cd"].Value + "\"" + ","
                + "\"" + Convert.ToString("SSC") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_sub_srv_cd"].Value)) + ","
                //+ "\"" + Convert.ToString("SSD") + "\"" + ":" + "\"" + CMD.Parameters["po_sub_srv_desc"].Value + "\"" + ","
                 + "\"" + Convert.ToString("SSD") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_sub_srv_desc"].Value)) + ","
                + "\"" + Convert.ToString("BC") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_bay_cd"].Value)) + ","
                + "\"" + Convert.ToString("BD") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_bay_desc"].Value)) + ","

                + "\"" + Convert.ToString("SAC") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_srv_adv_cd"].Value)) + ","
                + "\"" + Convert.ToString("SAD") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_srv_adv_desc"].Value)) + ","
                + "\"" + Convert.ToString("GC") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_group_cd"].Value)) + ","
                + "\"" + Convert.ToString("GD") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_group_desc"].Value)) + ","
                + "\"" + Convert.ToString("TC") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_tech_cd"].Value)) + ","
                + "\"" + Convert.ToString("TD") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_tech_desc"].Value)) + ","
                //+ "\"" + Convert.ToString("TAC") + "\"" + ":" + "\"" + CMD.Parameters["po_tech_adv_Cd"].Value + "\"" + ","
                + "\"" + Convert.ToString("TAC") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_tech_adv_Cd"].Value)) + ","
                //+ "\"" + Convert.ToString("TAD") + "\"" + ":" + "\"" + CMD.Parameters["po_tech_adv_desc"].Value + "\"" + ","
                + "\"" + Convert.ToString("TAD") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_tech_adv_desc"].Value)) + ","

                + "\"" + Convert.ToString("CEOA") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_ceo_approval"].Value)) + ","
                + "\"" + Convert.ToString("LFDT") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_lastflwup_date"].Value)) + ","
                //+ "\"" + Convert.ToString("LFC") + "\"" + ":" + "\"" + ((CMD.Parameters["po_lastflwup_csi"].Value != null && !(CMD.Parameters["po_lastflwup_csi"].Value is DBNull)) ? CMD.Parameters["po_lastflwup_csi"].Value : "") + "\"" + ","
                  + "\"" + Convert.ToString("LFC") + "\"" + ":" + "\"" + ((CMD.Parameters["po_lastflwup_csi"].Value != null && !(CMD.Parameters["po_lastflwup_csi"].Value is DBNull)) ? Convert.ToString(CMD.Parameters["po_lastflwup_csi"].Value) == "null" ? "" : CMD.Parameters["po_lastflwup_csi"].Value : "") + "\"" + ","
                + "\"" + Convert.ToString("LFB") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_lastflwup_by"].Value)) + ","
                //+ "\"" + Convert.ToString("PT") + "\"" + ":" + "\"" + CMD.Parameters["po_pickup_type"].Value + "\"" + ","
                + "\"" + Convert.ToString("PT") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_pickup_type"].Value)) + ","
                //+ "\"" + Convert.ToString("PTD") + "\"" + ":" + "\"" + CMD.Parameters["po_pickup_type_desc"].Value + "\"" + ","
                + "\"" + Convert.ToString("PTD") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_pickup_type_desc"].Value)) + ","
                //+ "\"" + Convert.ToString("PDT") + "\"" + ":" + "\"" + CMD.Parameters["po_pickup_date"].Value + "\"" + ","
                + "\"" + Convert.ToString("PDT") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_pickup_date"].Value)) + ","
                //+ "\"" + Convert.ToString("PL") + "\"" + ":" + "\"" + CMD.Parameters["po_pickup_loc"].Value + "\"" + ","
                + "\"" + Convert.ToString("PL") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_pickup_loc"].Value)) + ","
                //+ "\"" + Convert.ToString("PLD") + "\"" + ":" + "\"" + CMD.Parameters["po_pickup_loc_desc"].Value + "\"" + ","
                + "\"" + Convert.ToString("PLD") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_pickup_loc_desc"].Value)) + ","
                //+ "\"" + Convert.ToString("PDR") + "\"" + ":" + "\"" + CMD.Parameters["po_driver"].Value + "\"" + ","
                + "\"" + Convert.ToString("PDR") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_driver"].Value)) + ","
                //+ "\"" + Convert.ToString("PDD") + "\"" + ":" + "\"" + CMD.Parameters["po_driver_desc"].Value + "\"" + ","
                + "\"" + Convert.ToString("PDD") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_driver_desc"].Value)) + ","
                //+ "\"" + Convert.ToString("PRM") + "\"" + ":" + "\"" + CMD.Parameters["po_pickup_remarks"].Value + "\"" + ","
                + "\"" + Convert.ToString("PRM") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_pickup_remarks"].Value)) + ","
                + "\"" + Convert.ToString("FPYN") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_free_pickup_yn"].Value)) + ","
                //+ "\"" + Convert.ToString("MMSNUM") + "\"" + ":" + "\"" + CMD.Parameters["po_mms_num"].Value + "\"" + ","
                + "\"" + Convert.ToString("MMSNUM") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_mms_num"].Value)) + ","
                + "\"" + Convert.ToString("IPDT") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_intial_prom_date"].Value)) + ","
                + "\"" + Convert.ToString("RPDT") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_revised_prom_date"].Value)) + ","
                + "\"" + Convert.ToString("JCCDT") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_jc_close_date"].Value)) + ","
                + "\"" + Convert.ToString("JCODT") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_jc_open_date"].Value)) + ","
                //+ "\"" + Convert.ToString("CCS") + "\"" + ":" + "\"" + CMD.Parameters["po_cust_corp_status"].Value + "\"" + ","
                + "\"" + Convert.ToString("CCS") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_cust_corp_status"].Value)) + ","

                //+ "\"" + Convert.ToString("RST") + "\"" + ":" + "\"" + ((CMD.Parameters["po_rdtest_st_time"].Value != null && !(CMD.Parameters["po_rdtest_st_time"].Value is DBNull)) ? CMD.Parameters["po_rdtest_st_time"].Value : "") + "\"" + ","
                + "\"" + Convert.ToString("RST") + "\"" + ":" + "\"" + ((CMD.Parameters["po_rdtest_st_time"].Value != null && !(CMD.Parameters["po_rdtest_st_time"].Value is DBNull)) ? Convert.ToString(CMD.Parameters["po_rdtest_st_time"].Value) == "null" ? "" : CMD.Parameters["po_rdtest_st_time"].Value : "") + "\"" + ","
                //+ "\"" + Convert.ToString("RSKM") + "\"" + ":" + "\"" + ((CMD.Parameters["po_rdtest_st_km"].Value != null && !(CMD.Parameters["po_rdtest_st_km"].Value is DBNull)) ? CMD.Parameters["po_rdtest_st_km"].Value : "") + "\"" + ","
                + "\"" + Convert.ToString("RSKM") + "\"" + ":" + "\"" + ((CMD.Parameters["po_rdtest_st_km"].Value != null && !(CMD.Parameters["po_rdtest_st_km"].Value is DBNull)) ? Convert.ToString(CMD.Parameters["po_rdtest_st_km"].Value) == "null" ? "" : CMD.Parameters["po_rdtest_st_km"].Value : "") + "\"" + ","
                //+ "\"" + Convert.ToString("RSET") + "\"" + ":" + "\"" + ((CMD.Parameters["po_rdtest_end_time"].Value != null && !(CMD.Parameters["po_rdtest_end_time"].Value is DBNull)) ? CMD.Parameters["po_rdtest_end_time"].Value : "") + "\"" + ","
                + "\"" + Convert.ToString("RSET") + "\"" + ":" + "\"" + ((CMD.Parameters["po_rdtest_end_time"].Value != null && !(CMD.Parameters["po_rdtest_end_time"].Value is DBNull)) ? Convert.ToString(CMD.Parameters["po_rdtest_end_time"].Value) == "null" ? "" : CMD.Parameters["po_rdtest_end_time"].Value : "") + "\"" + ","
                //+ "\"" + Convert.ToString("RSEK") + "\"" + ":" + "\"" + ((CMD.Parameters["po_rdtest_end_km"].Value != null && !(CMD.Parameters["po_rdtest_end_km"].Value is DBNull)) ? CMD.Parameters["po_rdtest_end_km"].Value : "") + "\"" + ","
                + "\"" + Convert.ToString("RSEK") + "\"" + ":" + "\"" + ((CMD.Parameters["po_rdtest_end_km"].Value != null && !(CMD.Parameters["po_rdtest_end_km"].Value is DBNull)) ? Convert.ToString(CMD.Parameters["po_rdtest_end_km"].Value) == "null" ? "" : CMD.Parameters["po_rdtest_end_km"].Value : "") + "\"" + ","

                //+ "\"" + Convert.ToString("ESLA") + "\"" + ":" + "\"" + ((CMD.Parameters["po_est_sch_labor_amt"].Value != null && !(CMD.Parameters["po_est_sch_labor_amt"].Value is DBNull)) ? CMD.Parameters["po_est_sch_labor_amt"].Value : "") + "\"" + ","
                + "\"" + Convert.ToString("ESLA") + "\"" + ":" + "\"" + ((CMD.Parameters["po_est_sch_labor_amt"].Value != null && !(CMD.Parameters["po_est_sch_labor_amt"].Value is DBNull)) ? Convert.ToString(CMD.Parameters["po_est_sch_labor_amt"].Value) == "null" ? "" : CMD.Parameters["po_est_sch_labor_amt"].Value : "") + "\"" + ","
                //+ "\"" + Convert.ToString("ESPA") + "\"" + ":" + "\"" + ((CMD.Parameters["po_est_sch_part_amt"].Value != null && !(CMD.Parameters["po_est_sch_part_amt"].Value is DBNull)) ? CMD.Parameters["po_est_sch_part_amt"].Value : "") + "\"" + ","
                + "\"" + Convert.ToString("ESPA") + "\"" + ":" + "\"" + ((CMD.Parameters["po_est_sch_part_amt"].Value != null && !(CMD.Parameters["po_est_sch_part_amt"].Value is DBNull)) ? Convert.ToString(CMD.Parameters["po_est_sch_part_amt"].Value) == "null" ? "" : CMD.Parameters["po_est_sch_part_amt"].Value : "") + "\"" + ","

                //+ "\"" + Convert.ToString("ELA") + "\"" + ":" + "\"" + ((CMD.Parameters["po_est_labor_amt"].Value != null && !(CMD.Parameters["po_est_labor_amt"].Value is DBNull)) ? CMD.Parameters["po_est_labor_amt"].Value : "") + "\"" + ","
                + "\"" + Convert.ToString("ELA") + "\"" + ":" + "\"" + ((CMD.Parameters["po_est_labor_amt"].Value != null && !(CMD.Parameters["po_est_labor_amt"].Value is DBNull)) ? Convert.ToString(CMD.Parameters["po_est_labor_amt"].Value) == "null" ? "" : CMD.Parameters["po_est_labor_amt"].Value : "") + "\"" + ","
                //+ "\"" + Convert.ToString("EPA") + "\"" + ":" + "\"" + ((CMD.Parameters["po_est_part_amt"].Value != null && !(CMD.Parameters["po_est_part_amt"].Value is DBNull)) ? CMD.Parameters["po_est_part_amt"].Value : "") + "\"" + ","
                + "\"" + Convert.ToString("EPA") + "\"" + ":" + "\"" + ((CMD.Parameters["po_est_part_amt"].Value != null && !(CMD.Parameters["po_est_part_amt"].Value is DBNull)) ? Convert.ToString(CMD.Parameters["po_est_part_amt"].Value) == "null" ? "" : CMD.Parameters["po_est_part_amt"].Value : "") + "\"" + ","
                //+ "\"" + Convert.ToString("RELA") + "\"" + ":" + "\"" + ((CMD.Parameters["po_re_est_labor_amt"].Value != null && !(CMD.Parameters["po_re_est_labor_amt"].Value is DBNull)) ? CMD.Parameters["po_re_est_labor_amt"].Value : "") + "\"" + ","
                + "\"" + Convert.ToString("RELA") + "\"" + ":" + "\"" + ((CMD.Parameters["po_re_est_labor_amt"].Value != null && !(CMD.Parameters["po_re_est_labor_amt"].Value is DBNull)) ? Convert.ToString(CMD.Parameters["po_re_est_labor_amt"].Value) == "null" ? "" : CMD.Parameters["po_re_est_labor_amt"].Value : "") + "\"" + ","
                //+ "\"" + Convert.ToString("REPA") + "\"" + ":" + "\"" + ((CMD.Parameters["po_re_est_part_amt"].Value != null && !(CMD.Parameters["po_re_est_part_amt"].Value is DBNull)) ? CMD.Parameters["po_re_est_part_amt"].Value : "") + "\"" + ","
                + "\"" + Convert.ToString("REPA") + "\"" + ":" + "\"" + ((CMD.Parameters["po_re_est_part_amt"].Value != null && !(CMD.Parameters["po_re_est_part_amt"].Value is DBNull)) ? Convert.ToString(CMD.Parameters["po_re_est_part_amt"].Value) == "null" ? "" : CMD.Parameters["po_re_est_part_amt"].Value : "") + "\"" + ","

                + "\"" + Convert.ToString("AMCYN") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_amc_yn"].Value)) + ","
                //+ "\"" + Convert.ToString("AMCN") + "\"" + ":" + "\"" + CMD.Parameters["po_amc_num"].Value + "\"" + ","
                + "\"" + Convert.ToString("AMCN") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_amc_num"].Value)) + ","
                //+ "\"" + Convert.ToString("AMCDT") + "\"" + ":" + "\"" + CMD.Parameters["po_amc_date"].Value + "\"" + ","
                + "\"" + Convert.ToString("AMCDT") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_amc_date"].Value)) + ","
                //+ "\"" + Convert.ToString("RCYN") + "\"" + ":" + "\"" + CMD.Parameters["po_recall_yn"].Value + "\"" + ","
                + "\"" + Convert.ToString("RCYN") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_recall_yn"].Value)) + ","
                + "\"" + Convert.ToString("DRC") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_delay_reas_cd"].Value)) + ","
                + "\"" + Convert.ToString("DRD") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_delay_reas_desc"].Value)) + ","
                + "\"" + Convert.ToString("DRR") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_delay_reas_remarks"].Value)) + ","
                + "\"" + Convert.ToString("CRC") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_csi_reas_cd"].Value)) + ","
                + "\"" + Convert.ToString("CRD") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_csi_reas_desc"].Value)) + ","
                + "\"" + Convert.ToString("CRR") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_csi_reas_remarks"].Value)) + ","
                //+ "\"" + Convert.ToString("PDP") + "\"" + ":" + "\"" + ((CMD.Parameters["po_part_disc_perc"].Value != null && !(CMD.Parameters["po_part_disc_perc"].Value is DBNull)) ? CMD.Parameters["po_part_disc_perc"].Value : "") + "\"" + ","
                + "\"" + Convert.ToString("PDP") + "\"" + ":" + "\"" + ((CMD.Parameters["po_part_disc_perc"].Value != null && !(CMD.Parameters["po_part_disc_perc"].Value is DBNull)) ? Convert.ToString(CMD.Parameters["po_part_disc_perc"].Value) == "null" ? "" : CMD.Parameters["po_part_disc_perc"].Value : "") + "\"" + ","
                //+ "\"" + Convert.ToString("LDP") + "\"" + ":" + "\"" + ((CMD.Parameters["po_labour_disc_perc"].Value != null && !(CMD.Parameters["po_labour_disc_perc"].Value is DBNull)) ? CMD.Parameters["po_labour_disc_perc"].Value : "") + "\"" + ","
                + "\"" + Convert.ToString("LDP") + "\"" + ":" + "\"" + ((CMD.Parameters["po_labour_disc_perc"].Value != null && !(CMD.Parameters["po_labour_disc_perc"].Value is DBNull)) ? Convert.ToString(CMD.Parameters["po_part_disc_perc"].Value) == "null" ? "" : CMD.Parameters["po_part_disc_perc"].Value : "") + "\"" + ","
                //+ "\"" + Convert.ToString("DABC") + "\"" + ":" + "\"" + CMD.Parameters["po_disc_auth_by_cd"].Value + "\"" + ","
                + "\"" + Convert.ToString("DABC") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_disc_auth_by_cd"].Value)) + ","
                //+ "\"" + Convert.ToString("DABD") + "\"" + ":" + "\"" + CMD.Parameters["po_disc_auth_by_desc"].Value + "\"" + ","
                + "\"" + Convert.ToString("DABD") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_disc_auth_by_desc"].Value)) + ","

                //+ "\"" + Convert.ToString("VTSN") + "\"" + ":" + "\"" + ((CMD.Parameters["po_vts_card_num"].Value != null && !(CMD.Parameters["po_vts_card_num"].Value is DBNull)) ? CMD.Parameters["po_vts_card_num"].Value : "") + "\"" + ","
                + "\"" + Convert.ToString("VTSN") + "\"" + ":" + "\"" + ((CMD.Parameters["po_vts_card_num"].Value != null && !(CMD.Parameters["po_vts_card_num"].Value is DBNull)) ? Convert.ToString(CMD.Parameters["po_vts_card_num"].Value) == "null" ? "" : CMD.Parameters["po_vts_card_num"].Value : "") + "\"" + ","
                + "\"" + Convert.ToString("CHKDT") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_checkin_date"].Value)) + ","

                //+ "\"" + Convert.ToString("COAMT") + "\"" + ":" + "\"" + ((CMD.Parameters["po_cus_out_amt"].Value != null && !(CMD.Parameters["po_cus_out_amt"].Value is DBNull)) ? CMD.Parameters["po_cus_out_amt"].Value : "") + "\"" + ","
                + "\"" + Convert.ToString("COAMT") + "\"" + ":" + "\"" + ((CMD.Parameters["po_cus_out_amt"].Value != null && !(CMD.Parameters["po_cus_out_amt"].Value is DBNull)) ? Convert.ToString(CMD.Parameters["po_cus_out_amt"].Value) == "null" ? "" : CMD.Parameters["po_cus_out_amt"].Value : "") + "\"" + ","
                //+ "\"" + Convert.ToString("PROB") + "\"" + ":" + "\"" + CMD.Parameters["po_prob_str"].Value + "\"" + ","
                + "\"" + Convert.ToString("PROB") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_prob_str"].Value)) + ","
                + "\"" + Convert.ToString("CHANNEL") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_channel"].Value)) + ","

                //+ "\"" + Convert.ToString("PFLOT") + "\"" + ":" + "\"" + CMD.Parameters["po_pref_followup_time"].Value + "\"" + ","
                + "\"" + Convert.ToString("PFLOT") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_pref_followup_time"].Value)) + ","
                //+ "\"" + Convert.ToString("WASH_TYPE") + "\"" + ":" + "\"" + CMD.Parameters["po_wash_type"].Value + "\"" + ","
                + "\"" + Convert.ToString("WASH_TYPE") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_wash_type"].Value)) + ","

                //+ "\"" + Convert.ToString("MMS_ADDRESS") + "\"" + ":" + "\"" + CMD.Parameters["po_mms_address"].Value + "\"" + ","
                + "\"" + Convert.ToString("MMS_ADDRESS") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_mms_address"].Value)) + ","
                //+ "\"" + Convert.ToString("MMS_CITY") + "\"" + ":" + "\"" + CMD.Parameters["po_mms_city"].Value + "\"" + ","
                + "\"" + Convert.ToString("MMS_CITY") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_mms_city"].Value)) + ","
                //+ "\"" + Convert.ToString("MMS_DISTRICT") + "\"" + ":" + "\"" + CMD.Parameters["po_mms_district"].Value + "\"" + ","
                + "\"" + Convert.ToString("MMS_DISTRICT") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_mms_district"].Value)) + ","
                //+ "\"" + Convert.ToString("MMS_STATE") + "\"" + ":" + "\"" + CMD.Parameters["po_mms_state"].Value + "\"" + ","
                + "\"" + Convert.ToString("MMS_STATE") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_mms_state"].Value)) + ","
                //+ "\"" + Convert.ToString("MMS_PIN") + "\"" + ":" + "\"" + CMD.Parameters["po_mms_pin"].Value + "\"" + ","
                + "\"" + Convert.ToString("MMS_PIN") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_mms_pin"].Value)) + ","
                + "\"" + Convert.ToString("AUDIO_COUNT") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["PO_AUDIO_COUNT"].Value)) + ","
                + "\"" + Convert.ToString("OCAS_CNT") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_ocas_cnt"].Value)) + ","
                + "\"" + Convert.ToString("SAVE_CNT") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_save_cnt"].Value)) + ","
                + "\"" + Convert.ToString("SENT_CNT") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_sent_cnt"].Value)) + ","
                //+ "\"" + Convert.ToString("FINAL_INSPECTION") + "\"" + ":" + "\"" + CMD.Parameters["PO_FINAL_INSPECTION"].Value + "\"" + ","
                + "\"" + Convert.ToString("FINAL_INSPECTION") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["PO_FINAL_INSPECTION"].Value)) + ","
                + "\"" + Convert.ToString("ADD_CHK") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["PO_ADD_CHK"].Value)) + ","
                + "\"" + Convert.ToString("CCP_CLAIM") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_ccp_claim_yn"].Value)) + ","
                + "\"" + Convert.ToString("CCP_NUM") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_ccp_num"].Value)) + ","
                + "\"" + Convert.ToString("CCP_TYPE") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_ccp_type"].Value)) + ","
                + "\"" + Convert.ToString("CORP_CUST_FLAG") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["PO_CORP_CUST_FLAG"].Value)) + ","
                + "\"" + Convert.ToString("CORP_NAME") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["PO_CORP_NAME"].Value)) + ","
                + "\"" + Convert.ToString("VIN") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["PO_VIN"].Value)) + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);

                javascriptStr = javascriptStr + "}]" + ",";

                //Start Added new parameter to get Dealer Details 25SEPT2019 by mukesh sinha
                OracleDataReader dr10 = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["PO_DLR_REFCUR"].Value).GetDataReader();
                javascriptStr += "\"" + "DLR_DETAILS" + "\"" + ":" + "[";
                while (dr10.Read())
                {
                    cnter1 = 11;
                    javascriptStr += "{" + "\"" + Convert.ToString("DEALER_CODE") + "\"" + ":" + "\"" + Convert.ToString(dr10[0]) + "\"" + ","
                    + "\"" + Convert.ToString("DEALER_NAME") + "\"" + ":" + "\"" + Convert.ToString(dr10[1]) + "\"" + ","
                    + "\"" + Convert.ToString("REGION_CD") + "\"" + ":" + "\"" + Convert.ToString(dr10[2]) + "\"" + ","
                     + "\"" + Convert.ToString("REGION_NAME") + "\"" + ":" + "\"" + Convert.ToString(dr10[3]) + "\"" + ","
                      + "\"" + Convert.ToString("ZONE_CD") + "\"" + ":" + "\"" + Convert.ToString(dr10[4]) + "\"" + ","
                     + "\"" + Convert.ToString("ZONE") + "\"" + ":" + "\"" + Convert.ToString(dr10[5]) + "\"" + "\"";
                }
                if (cnter1 == 11)
                {
                    if (javascriptStr.Length > 1)
                        javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                }
                javascriptStr = javascriptStr + "}]" + ",";
                //End Added new parameter to get Dealer Details 25SEPT2019 by mukesh sinha

                //-------------------------------
                OracleDataReader dr1 = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_demand_refcur"].Value).GetDataReader();
                javascriptStr += "\"" + "DRF" + "\"" + ":" + "[";
                while (dr1.Read())
                {
                    javascriptStr += "{" + "\"" + Convert.ToString("SN") + "\"" + ":" + "\"" + Convert.ToString(dr1[0]) + "\"" + ","
                    + "\"" + Convert.ToString("DC") + "\"" + ":" + "\"" + Convert.ToString(dr1[1]) + "\"" + ","
                    + "\"" + Convert.ToString("DD") + "\"" + ":" + "\"" + Convert.ToString(dr1[2]) + "\"" + ","
                     + "\"" + Convert.ToString("RBY") + "\"" + ":" + "\"" + Convert.ToString(dr1[3]) + "\"" + ","
                    + "\"" + Convert.ToString("RBYD") + "\"" + ":" + "\"" + Convert.ToString(dr1[4]) + "\"" + ","
                    + "\"" + Convert.ToString("ATTYN") + "\"" + ":" + "\"" + Convert.ToString(dr1[5]) + "\"" + ","
                    + "\"" + Convert.ToString("CRYYN") + "\"" + ":" + "\"" + Convert.ToString(dr1[6]) + "\"" + ","
                    + "\"" + Convert.ToString("CRYYND") + "\"" + ":" + "\"" + Convert.ToString(dr1[7]) + "\"" + ","
                    + "\"" + Convert.ToString("PRBN") + "\"" + ":" + "\"" + Convert.ToString(dr1[9]) + "\"" + ","
                    + "\"" + Convert.ToString("WYN") + "\"" + ":" + "\"" + Convert.ToString(dr1[8]) + "\"" + "}" + ",";

                    cnter1 = 2;
                }
                if (cnter1 == 2)
                {
                    if (javascriptStr.Length > 1)
                        javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                }
                javascriptStr = javascriptStr + "]" + ",";

                //-------------------------------
                OracleDataReader dr2 = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_part_refcur"].Value).GetDataReader();
                javascriptStr += "\"" + "PRF" + "\"" + ":" + "[";
                while (dr2.Read())
                {
                    javascriptStr += "{" + "\"" + Convert.ToString("SN") + "\"" + ":" + "\"" + Convert.ToString(dr2[0]) + "\"" + ","
                    + "\"" + Convert.ToString("DN") + "\"" + ":" + "\"" + Convert.ToString(dr2[1]) + "\"" + ","
                    + "\"" + Convert.ToString("PN") + "\"" + ":" + "\"" + Convert.ToString(dr2[2]) + "\"" + ","
                    + "\"" + Convert.ToString("PD") + "\"" + ":" + "\"" + Convert.ToString(dr2[3]) + "\"" + ","
                    + "\"" + Convert.ToString("RQ") + "\"" + ":" + "\"" + Convert.ToString(dr2[4]) + "\"" + ","
                    + "\"" + Convert.ToString("IQ") + "\"" + ":" + "\"" + Convert.ToString(dr2[5]) + "\"" + ","
                    + "\"" + Convert.ToString("RTNQ") + "\"" + ":" + "\"" + Convert.ToString(dr2[6]) + "\"" + ","
                    + "\"" + Convert.ToString("BQ") + "\"" + ":" + "\"" + Convert.ToString(dr2[7]) + "\"" + ","
                    + "\"" + Convert.ToString("R") + "\"" + ":" + "\"" + Convert.ToString(dr2[8]) + "\"" + ","
                    + "\"" + Convert.ToString("TA") + "\"" + ":" + "\"" + Convert.ToString(dr2[9]) + "\"" + ","
                    + "\"" + Convert.ToString("BT") + "\"" + ":" + "\"" + Convert.ToString(dr2[10]) + "\"" + ","
                    + "\"" + Convert.ToString("BTD") + "\"" + ":" + "\"" + Convert.ToString(dr2[11]) + "\"" + ","
                    + "\"" + Convert.ToString("AD") + "\"" + ":" + "\"" + Convert.ToString(dr2[12]) + "\"" + ","
                    + "\"" + Convert.ToString("DI") + "\"" + ":" + "\"" + Convert.ToString(dr2[13]) + "\"" + ","
                    + "\"" + Convert.ToString("DID") + "\"" + ":" + "\"" + Convert.ToString(dr2[14]) + "\"" + ","
                    + "\"" + Convert.ToString("DV") + "\"" + ":" + "\"" + Convert.ToString(dr2[15]) + "\"" + ","
                    + "\"" + Convert.ToString("SR") + "\"" + ":" + "\"" + Convert.ToString(dr2[16]) + "\"" + ","
                    + "\"" + Convert.ToString("SDPRF") + "\"" + ":" + "\"" + Convert.ToString(dr2[17]) + "\"" + ","
                    + "\"" + Convert.ToString("CP") + "\"" + ":" + "\"" + Convert.ToString(dr2[18]) + "\"" + ","
                    + "\"" + Convert.ToString("IP") + "\"" + ":" + "\"" + Convert.ToString(dr2[19]) + "\"" + ","
                    + "\"" + Convert.ToString("DP") + "\"" + ":" + "\"" + Convert.ToString(dr2[20]) + "\"" + ","
                    + "\"" + Convert.ToString("OP") + "\"" + ":" + "\"" + Convert.ToString(dr2[21]) + "\"" + ","

                    + "\"" + Convert.ToString("CS") + "\"" + ":" + "\"" + Convert.ToString(dr2[22]) + "\"" + "}" + ",";

                    cnter1 = 3;
                }
                if (cnter1 == 3)
                {
                    if (javascriptStr.Length > 1)
                        javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                }
                javascriptStr = javascriptStr + "]" + ",";

                //-------------------------------
                OracleDataReader dr3 = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_labor_Refcur"].Value).GetDataReader();
                javascriptStr += "\"" + "LRF" + "\"" + ":" + "[";
                while (dr3.Read())
                {
                    javascriptStr += "{" + "\"" + Convert.ToString("LSN") + "\"" + ":" + "\"" + Convert.ToString(dr3[0]) + "\"" + ","
               + "\"" + Convert.ToString("LC") + "\"" + ":" + "\"" + Convert.ToString(dr3[1]) + "\"" + ","
               + "\"" + Convert.ToString("LD") + "\"" + ":" + "\"" + Convert.ToString(dr3[2]) + "\"" + ","
               + "\"" + Convert.ToString("MYN") + "\"" + ":" + "\"" + Convert.ToString(dr3[3]) + "\"" + ","
               + "\"" + Convert.ToString("FAMT") + "\"" + ":" + "\"" + Convert.ToString(dr3[4]) + "\"" + ","
               + "\"" + Convert.ToString("LAMT") + "\"" + ":" + "\"" + Convert.ToString(dr3[5]) + "\"" + ","
               + "\"" + Convert.ToString("FHRS") + "\"" + ":" + "\"" + Convert.ToString(dr3[6]) + "\"" + ","
               + "\"" + Convert.ToString("LBT") + "\"" + ":" + "\"" + Convert.ToString(dr3[7]) + "\"" + ","
               + "\"" + Convert.ToString("LBTD") + "\"" + ":" + "\"" + Convert.ToString(dr3[8]) + "\"" + ","
               + "\"" + Convert.ToString("LDI") + "\"" + ":" + "\"" + Convert.ToString(dr3[9]) + "\"" + ","
               + "\"" + Convert.ToString("LDID") + "\"" + ":" + "\"" + Convert.ToString(dr3[10]) + "\"" + ","
               + "\"" + Convert.ToString("LDV") + "\"" + ":" + "\"" + Convert.ToString(dr3[11]) + "\"" + ","
               + "\"" + Convert.ToString("LSR") + "\"" + ":" + "\"" + Convert.ToString(dr3[12]) + "\"" + ","
               + "\"" + Convert.ToString("LSD") + "\"" + ":" + "\"" + Convert.ToString(dr3[13]) + "\"" + ","
               + "\"" + Convert.ToString("LCP") + "\"" + ":" + "\"" + Convert.ToString(dr3[14]) + "\"" + ","
               + "\"" + Convert.ToString("LIP") + "\"" + ":" + "\"" + Convert.ToString(dr3[15]) + "\"" + ","
               + "\"" + Convert.ToString("LDP") + "\"" + ":" + "\"" + Convert.ToString(dr3[16]) + "\"" + ","
               + "\"" + Convert.ToString("LOP") + "\"" + ":" + "\"" + Convert.ToString(dr3[17]) + "\"" + ","
               + "\"" + Convert.ToString("TCH") + "\"" + ":" + "\"" + Convert.ToString(dr3[18]) + "\"" + ","
               + "\"" + Convert.ToString("TCHD") + "\"" + ":" + "\"" + Convert.ToString(dr3[19]) + "\"" + ","
               + "\"" + Convert.ToString("TCH2") + "\"" + ":" + "\"" + Convert.ToString(dr3[20]) + "\"" + ","
               + "\"" + Convert.ToString("TCH2D") + "\"" + ":" + "\"" + Convert.ToString(dr3[21]) + "\"" + ","
               + "\"" + Convert.ToString("SYN") + "\"" + ":" + "\"" + Convert.ToString(dr3[22]) + "\"" + ","
               + "\"" + Convert.ToString("SAMT") + "\"" + ":" + "\"" + Convert.ToString(dr3[23]) + "\"" + ","
               + "\"" + Convert.ToString("SCC") + "\"" + ":" + "\"" + Convert.ToString(dr3[24]) + "\"" + ","

               + "\"" + Convert.ToString("SCD") + "\"" + ":" + "\"" + Convert.ToString(dr3[25]) + "\"" + "}" + ",";

                    cnter1 = 4;
                }
                if (cnter1 == 4)
                {
                    if (javascriptStr.Length > 1)
                        javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                }
                javascriptStr = javascriptStr + "]" + ",";

                //-------------------------------   
                OracleDataReader dr4 = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_inv_refcur"].Value).GetDataReader();
                javascriptStr += "\"" + "IRF" + "\"" + ":" + "[";
                while (dr4.Read())
                {
                    javascriptStr += "{" + "\"" + Convert.ToString("ICD") + "\"" + ":" + "\"" + Convert.ToString(dr4[0]) + "\"" + ","
                 + "\"" + Convert.ToString("IDSC") + "\"" + ":" + "\"" + Convert.ToString(dr4[1]) + "\"" + ","
                 + "\"" + Convert.ToString("ICNT") + "\"" + ":" + "\"" + Convert.ToString(dr4[2]) + "\"" + ","
                 + "\"" + Convert.ToString("IYN") + "\"" + ":" + "\"" + Convert.ToString(dr4[3]) + "\"" + "}" + ",";

                    cnter1 = 5;
                }
                if (cnter1 == 5)
                {
                    if (javascriptStr.Length > 1)
                        javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                }
                javascriptStr = javascriptStr + "]" + ",";

                //------------------------------- 
                OracleDataReader dr5 = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_smcard_refcur"].Value).GetDataReader();
                javascriptStr += "\"" + "SCRF" + "\"" + ":" + "[";
                while (dr5.Read())
                {
                    cnter1 = 6;
                    javascriptStr += "{" + "\"" + Convert.ToString("SRLN") + "\"" + ":" + "\"" + Convert.ToString(dr5[0]) + "\"" + ","
                 + "\"" + Convert.ToString("ST") + "\"" + ":" + "\"" + Convert.ToString(dr5[1]) + "\"" + ","
                 + "\"" + Convert.ToString("STD1") + "\"" + ":" + "\"" + Convert.ToString(dr5[2]) + "\"" + ","
                 + "\"" + Convert.ToString("SC") + "\"" + ":" + "\"" + Convert.ToString(dr5[3]) + "\"" + ","
                 + "\"" + Convert.ToString("SD") + "\"" + ":" + "\"" + Convert.ToString(dr5[4]) + "\"" + ","
                 + "\"" + Convert.ToString("PN") + "\"" + ":" + "\"" + Convert.ToString(dr5[5]) + "\"" + ","
                 + "\"" + Convert.ToString("PD") + "\"" + ":" + "\"" + Convert.ToString(dr5[6]) + "\"" + ","
                 + "\"" + Convert.ToString("SQ") + "\"" + ":" + "\"" + Convert.ToString(dr5[7]) + "\"" + ","
                 + "\"" + Convert.ToString("AYN") + "\"" + ":" + "\"" + Convert.ToString(dr5[8]) + "\"" + ","
                 + "\"" + Convert.ToString("AYND") + "\"" + ":" + "\"" + Convert.ToString(dr5[9]) + "\"" + ","
                 + "\"" + Convert.ToString("RR") + "\"" + ":" + "\"" + Convert.ToString(dr5[10]) + "\"" + ","
                 + "\"" + Convert.ToString("RRD") + "\"" + ":" + "\"" + Convert.ToString(dr5[11]) + "\"" + ","

                 + "\"" + Convert.ToString("AQTY") + "\"" + ":" + "\"" + Convert.ToString(dr5[12]) + "\"" + "}" + ",";


                }
                if (cnter1 == 6)
                {
                    if (javascriptStr.Length > 1)
                        javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                }
                javascriptStr = javascriptStr + "]" + ",";

                //-------------------------------
                OracleDataReader dr6 = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_unapprfit_refcur"].Value).GetDataReader();
                javascriptStr += "\"" + "UFTRF" + "\"" + ":" + "[";
                while (dr6.Read())
                {
                    cnter1 = 7;
                    javascriptStr += "{" + "\"" + Convert.ToString("USN") + "\"" + ":" + "\"" + Convert.ToString(dr6[0]) + "\"" + ","
                 + "\"" + Convert.ToString("FC") + "\"" + ":" + "\"" + Convert.ToString(dr6[1]) + "\"" + ","
                 + "\"" + Convert.ToString("FD") + "\"" + ":" + "\"" + Convert.ToString(dr6[2]) + "\"" + "}" + ",";


                }
                if (cnter1 == 7)
                {
                    if (javascriptStr.Length > 1)
                        javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                }
                javascriptStr = javascriptStr + "]" + ",";

                //-------------------------------
                OracleDataReader dr7 = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_tech_camp_refcur"].Value).GetDataReader();
                javascriptStr += "\"" + "TCRF" + "\"" + ":" + "[";
                while (dr7.Read())
                {
                    cnter1 = 8;
                    javascriptStr += "{" + "\"" + Convert.ToString("TCSN") + "\"" + ":" + "\"" + Convert.ToString(dr7[0]) + "\"" + ","
                 + "\"" + Convert.ToString("SCN") + "\"" + ":" + "\"" + Convert.ToString(dr7[1]) + "\"" + ","
                 + "\"" + Convert.ToString("SUB") + "\"" + ":" + "\"" + Convert.ToString(dr7[2]) + "\"" + ","
                 + "\"" + Convert.ToString("MSRE") + "\"" + ":" + "\"" + Convert.ToString(dr7[3]) + "\"" + ","
                 + "\"" + Convert.ToString("FDT") + "\"" + ":" + "\"" + Convert.ToString(dr7[4]) + "\"" + ","
                 + "\"" + Convert.ToString("TDT") + "\"" + ":" + "\"" + Convert.ToString(dr7[5]) + "\"" + ","
                 + "\"" + Convert.ToString("RCN") + "\"" + ":" + "\"" + Convert.ToString(dr7[6]) + "\"" + ","
                 + "\"" + Convert.ToString("JCSC") + "\"" + ":" + "\"" + Convert.ToString(dr7[7]) + "\"" + ","
                 + "\"" + Convert.ToString("JCSD") + "\"" + ":" + "\"" + Convert.ToString(dr7[8]) + "\"" + "}" + ",";

                }
                if (cnter1 == 8)
                {
                    if (javascriptStr.Length > 1)
                        javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                }
                javascriptStr = javascriptStr + "]" + ",";

                //----------------------------------------------------

                OracleDataReader dr8 = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_repair_act_refcur"].Value).GetDataReader();
                javascriptStr += "\"" + "RARF" + "\"" + ":" + "[";
                while (dr8.Read())
                {
                    cnter1 = 9;
                    javascriptStr += "{" + "\"" + Convert.ToString("RSN") + "\"" + ":" + "\"" + Convert.ToString(dr8[0]) + "\"" + ","
                 + "\"" + Convert.ToString("RDC") + "\"" + ":" + "\"" + Convert.ToString(dr8[1]) + "\"" + ","
                 + "\"" + Convert.ToString("RDD") + "\"" + ":" + "\"" + Convert.ToString(dr8[2]) + "\"" + ","
                 + "\"" + Convert.ToString("PC") + "\"" + ":" + "\"" + Convert.ToString(dr8[3]) + "\"" + ","
                 + "\"" + Convert.ToString("PRD") + "\"" + ":" + "\"" + Convert.ToString(dr8[4]) + "\"" + ","
                 + "\"" + Convert.ToString("FTC") + "\"" + ":" + "\"" + Convert.ToString(dr8[5]) + "\"" + ","
                 + "\"" + Convert.ToString("FTD") + "\"" + ":" + "\"" + Convert.ToString(dr8[6]) + "\"" + ","
                 + "\"" + Convert.ToString("AC") + "\"" + ":" + "\"" + Convert.ToString(dr8[7]) + "\"" + ","

                 + "\"" + Convert.ToString("AD") + "\"" + ":" + "\"" + Convert.ToString(dr8[8]) + "\"" + "}" + ",";


                }
                if (cnter1 == 9)
                {
                    if (javascriptStr.Length > 1)
                        javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                }

                javascriptStr = javascriptStr + "]" + ",";

                //-------added po_comply_dtl_refcur cursor as on 25 aug 2015
                OracleDataReader dr9 = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_comply_dtl_refcur"].Value).GetDataReader();
                javascriptStr += "\"" + "CMPLY" + "\"" + ":" + "[";

                while (dr9.Read())
                {
                    cnter1 = 10;
                    javascriptStr += "{" + "\"" + Convert.ToString("SLN") + "\"" + ":" + "\"" + Convert.ToString(dr9[0]) + "\"" + ","
                 + "\"" + Convert.ToString("PSFMUM") + "\"" + ":" + "\"" + Convert.ToString(dr9[1]) + "\"" + ","
                 + "\"" + Convert.ToString("COMPDTL") + "\"" + ":" + "\"" + Convert.ToString(dr9[2]) + "\"" + ","
                 + "\"" + Convert.ToString("ATTYN") + "\"" + ":" + "\"" + Convert.ToString(dr9[3]) + "\"" + "}" + ",";
                }

                if (cnter1 == 10)
                {
                    if (javascriptStr.Length > 1)
                        javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                }

                javascriptStr = javascriptStr + "]" + "}";

                Result = javascriptStr;

                if (dr1 != null)
                {
                    dr1.Dispose();
                    dr1 = null;
                }

                if (dr2 != null)
                {
                    dr2.Dispose();
                    dr2 = null;
                }

                if (dr3 != null)
                {
                    dr3.Dispose();
                    dr3 = null;
                }

                if (dr4 != null)
                {
                    dr4.Dispose();
                    dr4 = null;
                }

                if (dr5 != null)
                {
                    dr5.Dispose();
                    dr5 = null;
                }

                if (dr6 != null)
                {
                    dr6.Dispose();
                    dr6 = null;
                }

                if (dr7 != null)
                {
                    dr7.Dispose();
                    dr7 = null;
                }

                if (dr8 != null)
                {
                    dr8.Dispose();
                    dr8 = null;
                }

                if (dr9 != null)
                {
                    dr9.Dispose();
                    dr9 = null;
                }
                if (dr10 != null)
                {
                    dr10.Dispose();
                    dr10 = null;
                }
                Logger.SuccessLogPrint("GetJCOpenDetails", "SP_JCO_GET_JC_OPEN_DTL", "'pn_jc_module': '" + Jcmodule + "','pn_user_id':'" + UserID + "','pn_parent_group':'" + Parent_group + "','pn_dealer_map_cd':'" + Dealer_map_cd + "','pn_loc_Cd':'" + Loc_Cd + "','pn_comp_fa':'" + Comp_fa + "','pn_jc_no':'" + Jcno, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));

            }
            else
            {
                string javascriptStr = "{";
                javascriptStr = javascriptStr + "\"" + Convert.ToString("S") + "\"" + ":"
                                           + "\"" + "1" + "\"" + ","
                                           + "\"" + Convert.ToString("M") + "\""
                                          + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;
            }
            //OBJ.Close();
        }
        catch (Exception EX)
        {
            //Logger.Log(EX);
            OBJ.Close();
            //Response.Write("dddd");
            //Result = ex.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("GetJCOpenDetails", "SP_JCO_GET_JC_OPEN_DTL", "'pn_jc_module': '" + Jcmodule + "','pn_user_id':'" + UserID + "','pn_parent_group':'" + Parent_group + "','pn_dealer_map_cd':'" + Dealer_map_cd + "','pn_loc_Cd':'" + Loc_Cd + "','pn_comp_fa':'" + Comp_fa + "','pn_jc_no':'" + Jcno, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;

    }

    //-----------end of GetJCOpenDetails fn

    public string UpdateJCDetails(string Jcnum_up, string UserIDGst_up, string srv_cat_cd_up, string sub_srv_type_cd_up,
                                       string promised_date_up, string sa_adv_up, string tech_adv_up, string bay_cd_up, string group_cd_up, string tech_cd_up,
                                       string demand_ins_str_up, string part_ins_str_up, string labor_ins_str_up, string unapprv_fit_str,
                                       string Pick_Typ_up, string Pick_Dat_up, string Pick_Flag_up, string Pick_Loc_up, string Pick_Drv_up, string Pick_Rem_up,
                                       string mms_num_up, string prob_str, string cust_Remarks, string dlr_Remarks, string approval_Status,
                                       double partEstAmt, double oprEstAmt, string rejectedPartsOrLabourDetails, string wash_Type, int ocas_cnt, int save_cnt,
                                       int sent_cnt, string final_Inspection, string addChk, string pn_ccp_yn, string pn_ccp_num, string pn_holdup_reasn_cd)
    {


        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["conoracle_PushApi"]));
        try
        {
            OBJ.Open();
            CMD = new OracleCommand("pkg_jco_1.sp_jco_UPDATE_dtl", OBJ);

            CMD.Parameters.Add("pn_jc_num", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(Jcnum_up);
            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(UserIDGst_up);
            CMD.Parameters.Add("pn_srv_cat_cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(srv_cat_cd_up);
            CMD.Parameters.Add("pn_sub_srv_type_cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(sub_srv_type_cd_up);


            if (promised_date_up == "")
                CMD.Parameters.Add("pn_promised_date", OracleDbType.Varchar2, ParameterDirection.Input).Value = DBNull.Value;//Convert.ToDateTime(promised_date_up);
            else
                CMD.Parameters.Add("pn_promised_date", OracleDbType.Varchar2, ParameterDirection.Input).Value = Convert.ToString(promised_date_up);
            //Response.Write("pdate from device="+Convert.ToString(promised_date_up));

            CMD.Parameters.Add("pn_sa_adv", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(sa_adv_up);
            CMD.Parameters.Add("pn_tech_adv", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(tech_adv_up);
            CMD.Parameters.Add("pn_bay_cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(bay_cd_up);
            CMD.Parameters.Add("pn_group_cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(group_cd_up);
            CMD.Parameters.Add("pn_tech_cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(tech_cd_up);

            CMD.Parameters.Add("pn_demand_ins_str", OracleDbType.Varchar2, 3600, ParameterDirection.Input).Value = Convert.ToString(demand_ins_str_up);
            CMD.Parameters.Add("pn_part_ins_str", OracleDbType.Varchar2, 3600, ParameterDirection.Input).Value = Convert.ToString(part_ins_str_up);
            CMD.Parameters.Add("pn_labor_ins_str", OracleDbType.Varchar2, 3600, ParameterDirection.Input).Value = Convert.ToString(labor_ins_str_up);
            CMD.Parameters.Add("pn_unapprv_fit_str", OracleDbType.Varchar2, 3600, ParameterDirection.Input).Value = Convert.ToString(unapprv_fit_str);

            CMD.Parameters.Add("pn_pickup_type", OracleDbType.Varchar2, 25, ParameterDirection.Input).Value = Convert.ToString(Pick_Typ_up);

            if (Pick_Dat_up == "")
                CMD.Parameters.Add("pn_pickup_date", OracleDbType.Date, ParameterDirection.Input).Value = DBNull.Value;//Convert.ToDateTime(Pick_Dat_up);
            else
                CMD.Parameters.Add("pn_pickup_date", OracleDbType.Date, ParameterDirection.Input).Value = Convert.ToDateTime(Pick_Dat_up);

            CMD.Parameters.Add("pn_free_pikcup_flag", OracleDbType.Varchar2, 1, ParameterDirection.Input).Value = Convert.ToString(Pick_Flag_up);
            CMD.Parameters.Add("pn_pickup_loc_cd", OracleDbType.Varchar2, 5, ParameterDirection.Input).Value = Convert.ToString(Pick_Loc_up);
            CMD.Parameters.Add("pn_pickup_driver", OracleDbType.Varchar2, 30, ParameterDirection.Input).Value = Convert.ToString(Pick_Drv_up);
            CMD.Parameters.Add("pn_pikcup_remarks", OracleDbType.Varchar2, 500, ParameterDirection.Input).Value = Convert.ToString(Pick_Rem_up);
            CMD.Parameters.Add("pn_mms_num", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(mms_num_up);
            //new param added on 27 nov 2015
            CMD.Parameters.Add("pn_prob_str", OracleDbType.Varchar2, 500, ParameterDirection.Input).Value = Convert.ToString(prob_str);

            CMD.Parameters.Add("PN_CUST_REMARKS", OracleDbType.Varchar2, 500, ParameterDirection.Input).Value = Convert.ToString(cust_Remarks);
            CMD.Parameters.Add("PN_DLR_REMARKS", OracleDbType.Varchar2, 500, ParameterDirection.Input).Value = Convert.ToString(dlr_Remarks);
            CMD.Parameters.Add("PN_APPRV_STATUS", OracleDbType.Varchar2, 500, ParameterDirection.Input).Value = Convert.ToString(approval_Status);

            CMD.Parameters.Add("PN_PART_EST_AMT", OracleDbType.Double, 500, ParameterDirection.Input).Value = partEstAmt;
            CMD.Parameters.Add("PN_OPR_EST_AMT", OracleDbType.Double, 500, ParameterDirection.Input).Value = oprEstAmt;
            CMD.Parameters.Add("PN_WASH_TYPE", OracleDbType.Varchar2, 500, ParameterDirection.Input).Value = wash_Type;

            //Start Added new three input parameters by mukesh sinha 17APRIL2020
            CMD.Parameters.Add("PN_OCAS_CNT", OracleDbType.Int32, 8, ParameterDirection.Input).Value = ocas_cnt;
            CMD.Parameters.Add("PN_SAVE_CNT", OracleDbType.Int32, 8, ParameterDirection.Input).Value = save_cnt;
            CMD.Parameters.Add("PN_SENT_CNT", OracleDbType.Int32, 8, ParameterDirection.Input).Value = sent_cnt;
            //End Added new three input parameters by mukesh sinha 17APRIL2020         

            // added new input parameter PN_ADD_CHK by mukesh sinha 10SEPT2020
            CMD.Parameters.Add("PN_ADD_CHK", OracleDbType.Varchar2, 4000, ParameterDirection.Input).Value = addChk;

            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 4000).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("PN_REJ_PRT_LAB_INS_STR", OracleDbType.Varchar2, 2000, ParameterDirection.Input).Value = rejectedPartsOrLabourDetails;

            // added Final Inspection input parameter by mukesh sinha 22SEPT2020          
            CMD.Parameters.Add("PN_FINAL_INSPECTION", OracleDbType.Varchar2, 1, ParameterDirection.Input).Value = final_Inspection;

            // added pn_ccp_yn pn_ccp_num input parameter by gagan sharma 6MAY2022 
            CMD.Parameters.Add("pn_ccp_yn", OracleDbType.Varchar2, 1, ParameterDirection.Input).Value = pn_ccp_yn;
            CMD.Parameters.Add("pn_ccp_num", OracleDbType.Varchar2, 12, ParameterDirection.Input).Value = pn_ccp_num;
            //Added pn_holdup_reasn_cd by Nagmani 25NOV2022
            CMD.Parameters.Add("pn_holdup_reasn_cd", OracleDbType.Varchar2, 200, ParameterDirection.Input).Value = pn_holdup_reasn_cd;


            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();

            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {
                string javascriptStr = "{";
                javascriptStr = javascriptStr + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                                              //+ "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";
                                              + "\"" + Convert.ToString("M") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_err_msg"].Value)) + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;

                Logger.SuccessLogPrint("UpdateJCDetails", "sp_jco_UPDATE_dtl", "'pn_jc_num': '" + Jcnum_up + "','pn_user_id':'" + UserIDGst_up + "','pn_srv_cat_cd':'" + srv_cat_cd_up + "','pn_sub_srv_type_cd':'" + sub_srv_type_cd_up + "','pn_promised_date':'"
              + promised_date_up + "','pn_sa_adv':'" + sa_adv_up + "','pn_tech_adv':'" + tech_adv_up + "','pn_bay_cd':'" + bay_cd_up + "','pn_group_cd':'" + group_cd_up + "','pn_tech_cd':'" + tech_cd_up
              + "','pn_demand_ins_str':'" + demand_ins_str_up + "','pn_part_ins_str':'" + part_ins_str_up + "','pn_labor_ins_str':'" + labor_ins_str_up + ",'pn_unapprv_fit_str':'" + unapprv_fit_str + "','pn_pickup_type':'" + Pick_Typ_up
              + "','pn_free_pikcup_flag':'" + Pick_Flag_up + "','pn_pickup_loc_cd':'" + Pick_Loc_up + "','pn_pickup_driver':'" + Pick_Drv_up + "','pn_pikcup_remarks':'" + Pick_Rem_up + "','pn_mms_num':'" + mms_num_up + "','pn_prob_str':'"
              + prob_str + "','PN_CUST_REMARKS':'" + cust_Remarks + "','PN_DLR_REMARKS':'" + dlr_Remarks + "','PN_APPRV_STATUS':'" + approval_Status + "','PN_PART_EST_AMT':'" + partEstAmt + "','PN_OPR_EST_AMT':'" + oprEstAmt + "','PN_WASH_TYPE':'" + wash_Type
              + "','PN_OCAS_CNT':'" + ocas_cnt + "','PN_SAVE_CNT':'" + save_cnt + "','PN_SENT_CNT':'" + sent_cnt + "','final_Inspection':'" + final_Inspection + "','PN_ADD_CHK':'" + addChk + "','pn_ccp_yn':'" + pn_ccp_yn + "','pn_ccp_num':'" + pn_ccp_num + "', 'pn_holdup_reasn_cd':'" + pn_holdup_reasn_cd, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));


            }
            else
            {
                string javascriptStr = "{";
                javascriptStr = javascriptStr + "\"" + Convert.ToString("S") + "\"" + ":"
                                           + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                                           //+ "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";
                                           + "\"" + Convert.ToString("M") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_err_msg"].Value)) + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;
            }
            //OBJ.Close();
        }
        catch (Exception EX)
        {
            OBJ.Close();
            //Result = ex.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("UpdateJCDetails", "sp_jco_UPDATE_dtl", "'pn_jc_num': '" + Jcnum_up + "','pn_user_id':'" + UserIDGst_up + "','pn_srv_cat_cd':'" + srv_cat_cd_up + "','pn_sub_srv_type_cd':'" + sub_srv_type_cd_up + "','pn_promised_date':'"
              + promised_date_up + "','pn_sa_adv':'" + sa_adv_up + "','pn_tech_adv':'" + tech_adv_up + "','pn_bay_cd':'" + bay_cd_up + "','pn_group_cd':'" + group_cd_up + "','pn_tech_cd':'" + tech_cd_up
              + "','pn_demand_ins_str':'" + demand_ins_str_up + "','pn_part_ins_str':'" + part_ins_str_up + "','pn_labor_ins_str':'" + labor_ins_str_up + ",'pn_unapprv_fit_str':'" + unapprv_fit_str + "','pn_pickup_type':'" + Pick_Typ_up
              + "','pn_free_pikcup_flag':'" + Pick_Flag_up + "','pn_pickup_loc_cd':'" + Pick_Loc_up + "','pn_pickup_driver':'" + Pick_Drv_up + "','pn_pikcup_remarks':'" + Pick_Rem_up + "','pn_mms_num':'" + mms_num_up + "','pn_prob_str':'"
              + prob_str + "','PN_CUST_REMARKS':'" + cust_Remarks + "','PN_DLR_REMARKS':'" + dlr_Remarks + "','PN_APPRV_STATUS':'" + approval_Status + "','PN_PART_EST_AMT':'" + partEstAmt + "','PN_OPR_EST_AMT':'" + oprEstAmt + "','PN_WASH_TYPE':'" + wash_Type
              + "','PN_OCAS_CNT':'" + ocas_cnt + "','PN_SAVE_CNT':'" + save_cnt + "','PN_SENT_CNT':'" + sent_cnt + "','final_Inspection':'" + final_Inspection + "','PN_ADD_CHK':'" + addChk + "','pn_ccp_yn':'" + pn_ccp_yn + "','pn_ccp_num':'" + pn_ccp_num + "', 'pn_holdup_reasn_cd':'" + pn_holdup_reasn_cd, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;
    }//end of fn

    //-----------------------------workshop fns starts here-----------------------

    public string GetWStoreDetails(string UserID1, string parent_grp, Int32 dealer_map_cd, string loc_cd, string comp_fa)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();

            CMD = new OracleCommand("PKG_JCB_1.SP_JCB_GET_STORE_DTL", OBJ);
            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(UserID1);
            CMD.Parameters.Add("pn_parent_group", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(parent_grp);
            CMD.Parameters.Add("pn_dealer_map_cd", OracleDbType.Int32, 20, ParameterDirection.Input).Value = Convert.ToInt32(dealer_map_cd);
            CMD.Parameters.Add("pn_loc_Cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(loc_cd);
            CMD.Parameters.Add("pn_comp_fa", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(comp_fa);

            CMD.Parameters.Add("po_store_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 2000).Direction = ParameterDirection.Output;
            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();

            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {
                int cnter = 0;
                OracleDataReader dr = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_store_refcur"].Value).GetDataReader();


                string javascriptStr = "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "0" + "\"" + ","
                 //+ "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + ","
                 + "\"" + Convert.ToString("M") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_err_msg"].Value)) + ","
                 + "\"" + Convert.ToString("STRDTL") + "\"" + ":" + "[";
                while (dr.Read())
                {
                    cnter = 1;
                    javascriptStr = javascriptStr + "{" + "\"" + Convert.ToString(dr[0]) + "\"" + ":" + "\"" + Convert.ToString(dr[1]) + "\"" + "}" + ",";
                }
                if (cnter == 1)
                {
                    if (javascriptStr.Length > 1)
                        javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                }
                javascriptStr = javascriptStr + "]" + "}";

                Result = javascriptStr;
                if (dr != null)
                {
                    dr.Dispose();
                    dr = null;
                }
                Logger.SuccessLogPrint("GetWStoreDetails", "SP_JCB_GET_STORE_DTL", "'pn_user_id': '" + UserID1 + "','pn_parent_group':'" + parent_grp + "','pn_dealer_map_cd':'" + dealer_map_cd + "','pn_loc_Cd':'" + loc_cd + "','pn_comp_fa':'" + comp_fa, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));

            }
            else
            {
                string javascriptStr = "{";
                javascriptStr = javascriptStr
                    + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                    + "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;

                //Result = Convert.ToString(CMD.Parameters["po_err_cd"].Value) + ":" + Convert.ToString(CMD.Parameters["po_err_msg"].Value);
            }
            //OBJ.Close();
        }
        catch (Exception EX)
        {
            OBJ.Close();
            //Result = ex.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("GetWStoreDetails", "SP_JCB_GET_STORE_DTL", "'pn_user_id': '" + UserID1 + "','pn_parent_group':'" + parent_grp + "','pn_dealer_map_cd':'" + dealer_map_cd + "','pn_loc_Cd':'" + loc_cd + "','pn_comp_fa':'" + comp_fa, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;


    }

    public string GetBillableType(string UserID1, string parent_grp, Int32 dealer_map_cd, string loc_cd, string comp_fa)
    {

        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();

            CMD = new OracleCommand("PKG_JCB_1.SP_JCB_GET_BILLABLE_TYPE", OBJ);
            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(UserID1);
            CMD.Parameters.Add("pn_parent_group", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(parent_grp);
            CMD.Parameters.Add("pn_dealer_map_cd", OracleDbType.Int32, 20, ParameterDirection.Input).Value = Convert.ToInt32(dealer_map_cd);
            CMD.Parameters.Add("pn_loc_Cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(loc_cd);
            CMD.Parameters.Add("pn_comp_fa", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(comp_fa);

            CMD.Parameters.Add("po_bill_type", OracleDbType.RefCursor).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 2000).Direction = ParameterDirection.Output;
            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();

            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {
                int cnter = 0;
                OracleDataReader dr = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_bill_type"].Value).GetDataReader();

                string javascriptStr = "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "0" + "\"" + ","
                //+ "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + ","
                + "\"" + Convert.ToString("M") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_err_msg"].Value)) + ","
                + "\"" + Convert.ToString("GBTYPE") + "\"" + ":" + "[";
                while (dr.Read())
                {
                    cnter = 1;
                    javascriptStr = javascriptStr + "{" + "\"" + Convert.ToString(dr[0]) + "\"" + ":" + "\"" + Convert.ToString(dr[1]) + "\"" + "}" + ",";
                }
                if (cnter == 1)
                {
                    if (javascriptStr.Length > 1)
                        javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                }
                javascriptStr = javascriptStr + "]" + "}";

                Result = javascriptStr;
                if (dr != null)
                {
                    dr.Dispose();
                    dr = null;
                }
                Logger.SuccessLogPrint("GetBillableType", "SP_JCB_GET_BILLABLE_TYPE", "'pn_user_id': '" + UserID1 + "','pn_parent_group':'" + parent_grp + "','pn_dealer_map_cd':'" + dealer_map_cd + "','pn_loc_Cd':'" + loc_cd + "','pn_comp_fa':'" + comp_fa, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));

            }
            else
            {
                string javascriptStr = "{";
                javascriptStr = javascriptStr
                    + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                    + "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;


            }
            //OBJ.Close();
        }
        catch (Exception EX)
        {
            OBJ.Close();
            //Result = ex.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("GetBillableType", "SP_JCB_GET_BILLABLE_TYPE", "'pn_user_id': '" + UserID1 + "','pn_parent_group':'" + parent_grp + "','pn_dealer_map_cd':'" + dealer_map_cd + "','pn_loc_Cd':'" + loc_cd + "','pn_comp_fa':'" + comp_fa, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;


    }

    public string GetReqHdrW(string UserID, string parent_grp, Int32 dealer_map_cd, string loc_cd, string comp_fa, string jcno)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();
            CMD = new OracleCommand("PKG_JCB_1.SP_JCB_GET_REQ_HDR", OBJ);

            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(UserID);
            CMD.Parameters.Add("pn_parent_group", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(parent_grp);
            CMD.Parameters.Add("pn_dealer_map_cd", OracleDbType.Int32, 20, ParameterDirection.Input).Value = Convert.ToInt32(dealer_map_cd);
            CMD.Parameters.Add("pn_loc_Cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(loc_cd);
            CMD.Parameters.Add("pn_comp_fa", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(comp_fa);
            CMD.Parameters.Add("pn_jc_no", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(jcno);


            CMD.Parameters.Add("pn_reg_num", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_req_hdr_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();
            string javascriptStr = "";
            int cnt = 0;
            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {

                javascriptStr = "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "0" + "\"" + ","
                                //+ "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + ","
                                + "\"" + Convert.ToString("M") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_err_msg"].Value)) + ","
                               + "\"" + "REGNO" + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["pn_reg_num"].Value) + "\"" + ",";

                OracleDataReader dr = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_req_hdr_refcur"].Value).GetDataReader();
                javascriptStr = javascriptStr + "\"" + "REQHDR" + "\"" + ":" + "[";

                while (dr.Read())
                {
                    cnt = 1;
                    javascriptStr = javascriptStr + "{" + "\"" + Convert.ToString("REGNO1") + "\"" + ":" + "\"" + Convert.ToString(dr[0]) + "\"" + ","
                                     + "\"" + Convert.ToString("JCNO") + "\"" + ":" + "\"" + Convert.ToString(dr[1]) + "\"" + ","
                                     + "\"" + Convert.ToString("CNAME") + "\"" + ":" + "\"" + Convert.ToString(dr[2]) + "\"" + ","
                                     + "\"" + Convert.ToString("REQNO") + "\"" + ":" + "\"" + Convert.ToString(dr[3]) + "\"" + ","
                                     + "\"" + Convert.ToString("REQDATE") + "\"" + ":" + "\"" + Convert.ToString(dr[4]) + "\"" + "}" + ",";
                }
                if (cnt == 1)
                {
                    javascriptStr = javascriptStr.Remove(javascriptStr.Length - 1, 1);
                }

                javascriptStr += "]" + "}";

                Result = javascriptStr;

                if (dr != null)
                {
                    dr.Dispose();
                    dr = null;
                }
                Logger.SuccessLogPrint("GetReqHdrW", "SP_JCB_GET_REQ_HDR", "'pn_user_id': '" + UserID + "','pn_parent_group':'" + parent_grp + "','pn_dealer_map_cd':'" + dealer_map_cd + "','pn_loc_Cd':'" + loc_cd + "','pn_comp_fa':'" + comp_fa + "', 'pn_jc_no':'" + jcno, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));

            }
            else
            {
                javascriptStr = "{";

                javascriptStr = javascriptStr + "\"" + Convert.ToString("S") + "\"" + ":"
                                           + "\"" + "1" + "\"" + ","
                           + "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;

            }
            //OBJ.Close();
        }
        catch (Exception EX)
        {
            OBJ.Close();
            //Result = ex.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";

            Logger.ErrorLogException("GetReqHdrW", "SP_JCB_GET_REQ_HDR", "'pn_user_id': '" + UserID + "','pn_parent_group':'" + parent_grp + "','pn_dealer_map_cd':'" + dealer_map_cd + "','pn_loc_Cd':'" + loc_cd + "','pn_comp_fa':'" + comp_fa + "', 'pn_jc_no':'" + jcno, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;

    }

    public string GetReqDetailsW(string UserID, string parent_grp, Int32 dealer_map_cd, string loc_cd, string comp_fa, string Reqno, string store_cd)
    {

        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();
            CMD = new OracleCommand("PKG_JCB_1.SP_JCB_GET_REQ_DTL", OBJ);

            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(UserID);
            CMD.Parameters.Add("pn_parent_group", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(parent_grp);
            CMD.Parameters.Add("pn_dealer_map_cd", OracleDbType.Int32, 20, ParameterDirection.Input).Value = Convert.ToInt32(dealer_map_cd);
            CMD.Parameters.Add("pn_loc_Cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(loc_cd);
            CMD.Parameters.Add("pn_comp_fa", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(comp_fa);
            CMD.Parameters.Add("pn_req_no", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(Reqno);
            CMD.Parameters.Add("pn_store_cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(store_cd);


            CMD.Parameters.Add("po_req_dtl_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
            CMD.CommandType = CommandType.StoredProcedure;

            CMD.ExecuteNonQuery();

            //Response.Write("err cd="+CMD.Parameters["po_err_cd"].Value);
            string javascriptStr = "";
            int cnt = 0;
            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {

                javascriptStr = "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "0" + "\"" + ","
                 //+ "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + ","
                 + "\"" + Convert.ToString("M") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_err_msg"].Value)) + ","
                  + "\"" + "REQDTL" + "\"" + ":" + "[";

                OracleDataReader dr = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_req_dtl_refcur"].Value).GetDataReader();

                //Response.Write("before while loop");

                while (dr.Read())
                {//Response.Write("inside while");

                    cnt = 2;
                    //Response.Write("inside whilemmmmm");
                    javascriptStr = javascriptStr + "{" + "\"" + Convert.ToString("REQNO") + "\"" + ":" + "\"" + Convert.ToString(dr[0]) + "\"" + ","
                                     + "\"" + Convert.ToString("PN") + "\"" + ":" + "\"" + Convert.ToString(dr[1]) + "\"" + ","
                                     + "\"" + Convert.ToString("PD") + "\"" + ":" + "\"" + Convert.ToString(dr[2]) + "\"" + ","
                                     + "\"" + Convert.ToString("REQQTY") + "\"" + ":" + "\"" + Convert.ToString(dr[3]) + "\"" + ","
                                     + "\"" + Convert.ToString("ISSUEDQTY") + "\"" + ":" + "\"" + Convert.ToString(dr[4]) + "\"" + ","
                                     + "\"" + Convert.ToString("BINLOC") + "\"" + ":" + "\"" + Convert.ToString(dr[5]) + "\"" + ","
                                     + "\"" + Convert.ToString("CSTCK") + "\"" + ":" + "\"" + Convert.ToString(dr[6]) + "\"" + ","
                                     + "\"" + Convert.ToString("FSTCK") + "\"" + ":" + "\"" + Convert.ToString(dr[7]) + "\"" + ","
                                     + "\"" + Convert.ToString("ISSTYP") + "\"" + ":" + "\"" + Convert.ToString(dr[8]) + "\"" + ","
                                     + "\"" + Convert.ToString("ISSTYPDSC") + "\"" + ":" + "\"" + Convert.ToString(dr[9]) + "\"" + ","
                                     + "\"" + Convert.ToString("ISSUEQTY") + "\"" + ":" + "\"" + Convert.ToString(dr[10]) + "\"" + ","
                                     + "\"" + Convert.ToString("MRP") + "\"" + ":" + "\"" + Convert.ToString(dr[11]) + "\"" + "}" + ",";
                }

                if (cnt == 2)
                {
                    javascriptStr = javascriptStr.Remove(javascriptStr.Length - 1, 1);
                }
                //Response.Write("after while loop");
                javascriptStr += "]" + "}";

                Result = javascriptStr;
                //Response.Write("Result="+Result);
                if (dr != null)
                {
                    dr.Dispose();
                    dr = null;
                }
                Logger.SuccessLogPrint("GetReqDetailsW", "SP_JCB_GET_REQ_DTL", "'pn_user_id': '" + UserID + "','pn_parent_group':'" + parent_grp + "','pn_dealer_map_cd':'" + dealer_map_cd + "','pn_loc_Cd':'" + loc_cd + "','pn_comp_fa':'" + comp_fa + "', 'pn_req_no':'" + Reqno + "','pn_store_cd':'" + store_cd, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));

            }
            else
            { //Response.Write("inside else");
                javascriptStr = "{";

                javascriptStr = javascriptStr + "\"" + Convert.ToString("S") + "\"" + ":"
                                           + "\"" + "1" + "\"" + ","
                                           + "\"" + Convert.ToString("M") + "\""
                                          + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;

            }

            //OBJ.Close();

        }
        catch (Exception EX)
        {//Response.Write("inside catch block");
            OBJ.Close();
            //Result = ex.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S2") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("GetReqDetailsW", "SP_JCB_GET_REQ_DTL", "'pn_user_id': '" + UserID + "','pn_parent_group':'" + parent_grp + "','pn_dealer_map_cd':'" + dealer_map_cd + "','pn_loc_Cd':'" + loc_cd + "','pn_comp_fa':'" + comp_fa + "', 'pn_req_no':'" + Reqno + "','pn_store_cd':'" + store_cd, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;

    }

    public string GetAltPartW(string UserID, string parent_grp, Int32 dealer_map_cd, string loc_cd, string comp_fa, string partno)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();
            CMD = new OracleCommand("PKG_JCB_1.SP_JCB_GET_ALTERNATE_PART", OBJ);

            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(UserID);
            CMD.Parameters.Add("pn_parent_group", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(parent_grp);
            CMD.Parameters.Add("pn_dealer_map_cd", OracleDbType.Int32, 20, ParameterDirection.Input).Value = Convert.ToInt32(dealer_map_cd);
            CMD.Parameters.Add("pn_loc_Cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(loc_cd);
            CMD.Parameters.Add("pn_comp_fa", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(comp_fa);
            CMD.Parameters.Add("pn_part_num", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(partno);



            CMD.Parameters.Add("po_alt_part_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();
            string javascriptStr = "";
            int cnt = 0;
            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {


                OracleDataReader dr = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_alt_part_refcur"].Value).GetDataReader();
                javascriptStr = "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "0" + "\"" + ","
                //+ "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + ","
                + "\"" + Convert.ToString("M") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_err_msg"].Value)) + ","
                + "\"" + "GAPRT" + "\"" + ":" + "[";

                while (dr.Read())
                {
                    cnt = 1;
                    javascriptStr = javascriptStr + "{" + "\"" + Convert.ToString("PN") + "\"" + ":" + "\"" + Convert.ToString(dr[0]) + "\"" + ","
                                     + "\"" + Convert.ToString("PD") + "\"" + ":" + "\"" + Convert.ToString(dr[1]) + "\"" + ","
                                     + "\"" + Convert.ToString("BINLOC") + "\"" + ":" + "\"" + Convert.ToString(dr[2]) + "\"" + ","
                                     + "\"" + Convert.ToString("STCK") + "\"" + ":" + "\"" + Convert.ToString(dr[3]) + "\"" + ","
                                     + "\"" + Convert.ToString("FSTCK") + "\"" + ":" + "\"" + Convert.ToString(dr[4]) + "\"" + "}" + ",";
                }
                if (cnt == 1)
                {
                    javascriptStr = javascriptStr.Remove(javascriptStr.Length - 1, 1);
                }

                javascriptStr += "]" + "}";

                Result = javascriptStr;

                if (dr != null)
                {
                    dr.Dispose();
                    dr = null;
                }

                Logger.SuccessLogPrint("GetAltPartW", "SP_JCB_GET_ALTERNATE_PART", "'pn_user_id': '" + UserID + "','pn_parent_group':'" + parent_grp + "','pn_dealer_map_cd':'" + dealer_map_cd + "','pn_loc_Cd':'" + loc_cd + "','pn_comp_fa':'" + comp_fa + "', 'pn_part_num':'" + partno, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));


            }
            else
            {
                javascriptStr = "{";

                javascriptStr = javascriptStr + "\"" + Convert.ToString("S") + "\"" + ":"
                                           + "\"" + "1" + "\"" + ","
                                           + "\"" + Convert.ToString("M") + "\""
                                          + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;


            }
            //OBJ.Close();
        }
        catch (Exception EX)
        {
            OBJ.Close();
            //Result = ex.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";

            Logger.ErrorLogException("GetAltPartW", "SP_JCB_GET_ALTERNATE_PART", "'pn_user_id': '" + UserID + "','pn_parent_group':'" + parent_grp + "','pn_dealer_map_cd':'" + dealer_map_cd + "','pn_loc_Cd':'" + loc_cd + "','pn_comp_fa':'" + comp_fa + "', 'pn_part_num':'" + partno, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;

    }

    public string GetPartBinStockW(string UserID, string parent_grp, Int32 dealer_map_cd, string loc_cd, string comp_fa, string storecd, string partno)
    {

        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();
            CMD = new OracleCommand("PKG_JCB_1.SP_JCB_GET_PART_BIN_STOCK", OBJ);

            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(UserID);
            CMD.Parameters.Add("pn_parent_group", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(parent_grp);
            CMD.Parameters.Add("pn_dealer_map_cd", OracleDbType.Int32, 20, ParameterDirection.Input).Value = Convert.ToInt32(dealer_map_cd);
            CMD.Parameters.Add("pn_loc_Cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(loc_cd);
            CMD.Parameters.Add("pn_comp_fa", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(comp_fa);
            CMD.Parameters.Add("pn_store_Cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(storecd);
            CMD.Parameters.Add("pn_part_num", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(partno);



            CMD.Parameters.Add("po_bin_part_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();
            string javascriptStr = "";
            int cnt = 0;
            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {


                OracleDataReader dr = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_bin_part_refcur"].Value).GetDataReader();
                javascriptStr = "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "0" + "\"" + ","
                 + "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + ","
                + "\"" + "GPBS" + "\"" + ":" + "[";

                while (dr.Read())
                {
                    cnt = 1;
                    javascriptStr = javascriptStr + "{" + "\"" + Convert.ToString("PN") + "\"" + ":" + "\"" + Convert.ToString(dr[0]) + "\"" + ","
                                     + "\"" + Convert.ToString("PD") + "\"" + ":" + "\"" + Convert.ToString(dr[1]) + "\"" + ","
                                     + "\"" + Convert.ToString("BINLOC") + "\"" + ":" + "\"" + Convert.ToString(dr[2]) + "\"" + ","
                                     + "\"" + Convert.ToString("STCK") + "\"" + ":" + "\"" + Convert.ToString(dr[3]) + "\"" + ","
                                     + "\"" + Convert.ToString("FSTCK") + "\"" + ":" + "\"" + Convert.ToString(dr[4]) + "\"" + "}" + ",";
                }
                if (cnt == 1)
                {
                    javascriptStr = javascriptStr.Remove(javascriptStr.Length - 1, 1);
                }

                javascriptStr += "]" + "}";
                //Response.Write("bin loc="+dr[2]);
                Result = javascriptStr;

                if (dr != null)
                {
                    dr.Dispose();
                    dr = null;
                }

                Logger.SuccessLogPrint("GetPartBinStockW", "SP_JCB_GET_PART_BIN_STOCK", "'pn_user_id': '" + UserID + "','pn_parent_group':'" + parent_grp + "','pn_dealer_map_cd':'" + dealer_map_cd + "','pn_loc_Cd':'" + loc_cd + "','pn_comp_fa':'" + comp_fa + "','pn_store_Cd':'" + storecd + "', 'pn_part_num':'" + partno, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));

            }
            else
            {
                javascriptStr = "{";

                javascriptStr = javascriptStr + "\"" + Convert.ToString("S") + "\"" + ":"
                                           + "\"" + "1" + "\"" + ","
                                           + "\"" + Convert.ToString("M") + "\""
                                          + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;

            }
            //OBJ.Close();
        }
        catch (Exception EX)
        {
            OBJ.Close();
            //Result = ex.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";

            Logger.ErrorLogException("GetPartBinStockW", "SP_JCB_GET_PART_BIN_STOCK", "'pn_user_id': '" + UserID + "','pn_parent_group':'" + parent_grp + "','pn_dealer_map_cd':'" + dealer_map_cd + "','pn_loc_Cd':'" + loc_cd + "','pn_comp_fa':'" + comp_fa + "','pn_store_Cd':'" + storecd + "', 'pn_part_num':'" + partno, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;

    }

    public string ValidtateBillTypeW(string UserID1, string parent_grp, Int32 dealer_map_cd, string loc_cd, string comp_fa, string jcno, string partno, string bill_type_cd)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();

            CMD = new OracleCommand("PKG_JCB_1.SP_JCB_VALIDATE_BILL_TYPE", OBJ);
            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(UserID1);
            CMD.Parameters.Add("pn_parent_group", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(parent_grp);
            CMD.Parameters.Add("pn_dealer_map_cd", OracleDbType.Int32, 20, ParameterDirection.Input).Value = Convert.ToInt32(dealer_map_cd);
            CMD.Parameters.Add("pn_loc_Cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(loc_cd);
            CMD.Parameters.Add("pn_comp_fa", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(comp_fa);

            CMD.Parameters.Add("pn_jc_num", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(jcno);
            CMD.Parameters.Add("pn_part_num", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(partno);
            CMD.Parameters.Add("pn_bill_type_Cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(bill_type_cd);

            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 2000).Direction = ParameterDirection.Output;
            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();


            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {
                string javascriptStr = "{";
                javascriptStr = javascriptStr + "\"" + Convert.ToString("S") + "\"" + ":"
                                           + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                                           //+ "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";
                                           + "\"" + Convert.ToString("M") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_err_msg"].Value)) + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;

                Logger.SuccessLogPrint("ValidtateBillTypeW", "SP_JCB_VALIDATE_BILL_TYPE", "'pn_user_id': '" + UserID1 + "','pn_parent_group':'" + parent_grp + "','pn_dealer_map_cd':'" + dealer_map_cd + "','pn_loc_Cd':'" + loc_cd + "','pn_comp_fa':'" + comp_fa + "','pn_jc_num':'" + jcno + "', 'pn_part_num':'" + partno, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));
            }
            else
            {
                string javascriptStr = "{";
                javascriptStr = javascriptStr + "\"" + Convert.ToString("S") + "\"" + ":"
                                           + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                                          //+ "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";
                                          + "\"" + Convert.ToString("M") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_err_msg"].Value)) + "\"";


                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;



            }

            //OBJ.Close();

        }
        catch (Exception EX)
        {
            OBJ.Close();
            //Result = EX.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("ValidtateBillTypeW", "SP_JCB_VALIDATE_BILL_TYPE", "'pn_user_id': '" + UserID1 + "','pn_parent_group':'" + parent_grp + "','pn_dealer_map_cd':'" + dealer_map_cd + "','pn_loc_Cd':'" + loc_cd + "','pn_comp_fa':'" + comp_fa + "','pn_jc_num':'" + jcno + "', 'pn_part_num':'" + partno, EX);


        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;

    }

    public string InsertIssueDetailsW(string UserIDGst_W, string parent_grp_w, Int32 dealer_map_cd_W,
                                      string loc_Cd_W, string comp_fa_W, string jc_num_W, string store_Cd_W, string req_ins_str_W)
    {

        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();
            CMD = new OracleCommand("PKG_JCB_1.SP_JCB_INSERT_ISSUE_DTL", OBJ);

            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(UserIDGst_W);
            CMD.Parameters.Add("pn_parent_group", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(parent_grp_w);
            CMD.Parameters.Add("pn_dealer_map_cd", OracleDbType.Int32, 10, ParameterDirection.Input).Value = Convert.ToString(dealer_map_cd_W);
            CMD.Parameters.Add("pn_loc_Cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(loc_Cd_W);
            CMD.Parameters.Add("pn_comp_fa", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(comp_fa_W);
            CMD.Parameters.Add("pn_jc_num", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(jc_num_W);
            CMD.Parameters.Add("pn_store_cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(store_Cd_W);
            CMD.Parameters.Add("pn_req_ins_str", OracleDbType.Varchar2, 500, ParameterDirection.Input).Value = Convert.ToString(req_ins_str_W);

            CMD.Parameters.Add("po_issue_no", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();

            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {
                string javascriptStr = "{";
                javascriptStr = javascriptStr + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                                            //+ "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_err_msg"].Value)) + ","
                                            + "\"" + Convert.ToString("ISSUENOW") + "\""
                                           + ":" + "\"" + Convert.ToString(CMD.Parameters["po_issue_no"].Value) + "\"" + "\"";


                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;
                Logger.SuccessLogPrint("InsertIssueDetailsW", "SP_JCB_INSERT_ISSUE_DTL", "'pn_user_id': '" + UserIDGst_W + "','pn_parent_group':'" + parent_grp_w + "','pn_dealer_map_cd':'" + dealer_map_cd_W + "','pn_loc_Cd':'" + loc_Cd_W + "','pn_comp_fa':'" + comp_fa_W + "','pn_jc_num':'" + jc_num_W + "', 'pn_store_cd':'" + store_Cd_W + "','pn_req_ins_str':'" + req_ins_str_W, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));


            }
            else
            {
                string javascriptStr = "{";
                javascriptStr = javascriptStr + "\"" + Convert.ToString("S") + "\"" + ":"
                                           + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                                           + "\"" + Convert.ToString("M") + "\""
                                          + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;
            }

            //OBJ.Close();

        }
        catch (Exception EX)
        {
            OBJ.Close();
            //Result = ex.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("InsertIssueDetailsW", "SP_JCB_INSERT_ISSUE_DTL", "'pn_user_id': '" + UserIDGst_W + "','pn_parent_group':'" + parent_grp_w + "','pn_dealer_map_cd':'" + dealer_map_cd_W + "','pn_loc_Cd':'" + loc_Cd_W + "','pn_comp_fa':'" + comp_fa_W + "','pn_jc_num':'" + jc_num_W + "', 'pn_store_cd':'" + store_Cd_W + "','pn_req_ins_str':'" + req_ins_str_W, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;

    }//end of fn  InsertIssueDetailsW


    public string GetWhissDetailsW(string UserID, string Parent_group, Int32 Dealer_map_cd, string Loc_Cd, string Comp_fa, string issno)
    {

        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();
            CMD = new OracleCommand("PKG_JCB_1.SP_JCB_GET_WS_ISS_DTL", OBJ);


            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(UserID);
            CMD.Parameters.Add("pn_parent_group", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(Parent_group);
            CMD.Parameters.Add("pn_dealer_map_cd", OracleDbType.Int32, 10, ParameterDirection.Input).Value = Convert.ToString(Dealer_map_cd);
            CMD.Parameters.Add("pn_loc_Cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(Loc_Cd);
            CMD.Parameters.Add("pn_comp_fa", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(Comp_fa);
            CMD.Parameters.Add("pn_iss_no", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(issno);
            //output params started

            CMD.Parameters.Add("po_iss_date", OracleDbType.Varchar2, 50).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_stores_cd", OracleDbType.Varchar2, 50).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_stores_desc", OracleDbType.Varchar2, 100).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_jc_num", OracleDbType.Varchar2, 50).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_reg_num", OracleDbType.Varchar2, 100).Direction = ParameterDirection.Output;

            //following are the cursors in o/p
            CMD.Parameters.Add("po_iss_hdr_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_iss_dtl_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;

            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();

            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {

                int cnter1 = 0;

                string javascriptStr = "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "0" + "\"" + ","
                //+ "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + CMD.Parameters["po_err_msg"].Value + "\"" + ","
                + "\"" + Convert.ToString("M") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_err_msg"].Value)) + ","
                + "\"" + "K" + "\"" + ":" + "[{";

                javascriptStr = javascriptStr

                + "\"" + Convert.ToString("ISSD") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_iss_date"].Value)) + ","
                + "\"" + Convert.ToString("SC") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_stores_cd"].Value)) + ","
                + "\"" + Convert.ToString("SD") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_stores_desc"].Value)) + ","
                + "\"" + Convert.ToString("JCNO") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_jc_num"].Value)) + ","
                + "\"" + Convert.ToString("REGNUM") + "\"" + ":" + "\"" + CMD.Parameters["po_reg_num"].Value + "\"" + "\"";


                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);

                javascriptStr = javascriptStr + "}]" + ",";
                //-------------------------------
                OracleDataReader dr1 = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_iss_hdr_refcur"].Value).GetDataReader();
                javascriptStr += "\"" + "IHR" + "\"" + ":" + "[";
                while (dr1.Read())
                {
                    javascriptStr += "{" + "\"" + Convert.ToString("RN") + "\"" + ":" + "\"" + Convert.ToString(dr1[0]) + "\"" + ","
                    + "\"" + Convert.ToString("JCN") + "\"" + ":" + "\"" + Convert.ToString(dr1[1]) + "\"" + ","
                    + "\"" + Convert.ToString("CN") + "\"" + ":" + "\"" + Convert.ToString(dr1[2]) + "\"" + ","
                     + "\"" + Convert.ToString("RQN") + "\"" + ":" + "\"" + Convert.ToString(dr1[3]) + "\"" + ","
                    + "\"" + Convert.ToString("RQD") + "\"" + ":" + "\"" + Convert.ToString(dr1[4]) + "\"" + "}" + ",";

                    cnter1 = 2;
                }
                if (cnter1 == 2)
                {
                    if (javascriptStr.Length > 1)
                        javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                }
                javascriptStr = javascriptStr + "]" + ",";



                OracleDataReader dr9 = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_iss_dtl_refcur"].Value).GetDataReader();
                javascriptStr += "\"" + "IDR" + "\"" + ":" + "[";

                while (dr9.Read())
                {
                    cnter1 = 10;
                    javascriptStr += "{" + "\"" + Convert.ToString("SRLN") + "\"" + ":" + "\"" + Convert.ToString(dr9[0]) + "\"" + ","
                 + "\"" + Convert.ToString("REQN") + "\"" + ":" + "\"" + Convert.ToString(dr9[1]) + "\"" + ","
                 + "\"" + Convert.ToString("PN") + "\"" + ":" + "\"" + Convert.ToString(dr9[2]) + "\"" + ","
                             + "\"" + Convert.ToString("PD") + "\"" + ":" + "\"" + Convert.ToString(dr9[3]) + "\"" + ","
                             + "\"" + Convert.ToString("REQT") + "\"" + ":" + "\"" + Convert.ToString(dr9[4]) + "\"" + ","
                             + "\"" + Convert.ToString("ISSDQ") + "\"" + ":" + "\"" + Convert.ToString(dr9[5]) + "\"" + ","
                             + "\"" + Convert.ToString("BINL") + "\"" + ":" + "\"" + Convert.ToString(dr9[6]) + "\"" + ","
                             + "\"" + Convert.ToString("ISST") + "\"" + ":" + "\"" + Convert.ToString(dr9[7]) + "\"" + ","
                             + "\"" + Convert.ToString("ISSTD") + "\"" + ":" + "\"" + Convert.ToString(dr9[8]) + "\"" + ","
                             + "\"" + Convert.ToString("ISSQ") + "\"" + ":" + "\"" + Convert.ToString(dr9[9]) + "\"" + "}" + ",";
                }

                if (cnter1 == 10)
                {
                    if (javascriptStr.Length > 1)
                        javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                }

                javascriptStr = javascriptStr + "]" + "}";

                Result = javascriptStr;

                if (dr1 != null)
                {
                    dr1.Dispose();
                    dr1 = null;
                }

                if (dr9 != null)
                {
                    dr9.Dispose();
                    dr9 = null;
                }
                Logger.SuccessLogPrint("GetWhissDetailsW", "SP_JCB_GET_WS_ISS_DTL", "'pn_user_id': '" + UserID + "','pn_parent_group':'" + Parent_group + "','pn_dealer_map_cd':'" + Dealer_map_cd + "','pn_loc_Cd':'" + Loc_Cd + "','pn_comp_fa':'" + Comp_fa + "','pn_iss_no':'" + issno, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));

            }
            else
            {
                string javascriptStr = "{";
                javascriptStr = javascriptStr + "\"" + Convert.ToString("S") + "\"" + ":"
                                           + "\"" + "1" + "\"" + ","
                                           + "\"" + Convert.ToString("M") + "\""
                                          + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;
            }
            //OBJ.Close();
        }
        catch (Exception EX)
        {
            OBJ.Close();
            //Response.Write("dddd");
            //Result = ex.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("GetWhissDetailsW", "SP_JCB_GET_WS_ISS_DTL", "'pn_user_id': '" + UserID + "','pn_parent_group':'" + Parent_group + "','pn_dealer_map_cd':'" + Dealer_map_cd + "','pn_loc_Cd':'" + Loc_Cd + "','pn_comp_fa':'" + Comp_fa + "','pn_iss_no':'" + issno, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;

    }


    //-----------------------------wokshop fns ends here---------------------------

    public string InsertEstmDetails(string UserIDGst_estm, string Est_type_cd, string Srv_type_cd_estm, string Sale_type_cd,
                                      string Regnum_estm, string omr_estm, string Remarks_estm, string Estm_days, string Estm_hrs,
                                      string Part_disc_estm, string Labor_disc_estm, string Part_refcur_estm, string Labor_refcur_estm,
                                      string pn_insr_name_estm, string pn_insr_branch_estm, string pn_insr_add1_estm, string pn_insr_add2_estm,
                                      string pn_insr_add3_estm, string pn_driver_name_estm, string pn_dl_num_estm, string pn_dl_exp_date_estm,
                                      string pn_policy_num_estm, string policy_exp_date_estm, string surveyor_name_estm, string surv_int_date_estm,
                                      string accident_place_estm, string accident_date_estm, string pn_fir_num_estm, string pn_fir_date_estm)
    {

        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["conoracle_PushApi"]));
        try
        {
            OBJ.Open();
            CMD = new OracleCommand("pkg_jco_1.sp_jco_insert_estim_dtl", OBJ);

            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(UserIDGst_estm);
            CMD.Parameters.Add("pn_estim_type_Cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(Est_type_cd);
            CMD.Parameters.Add("pn_srv_Type_cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(Srv_type_cd_estm);
            CMD.Parameters.Add("pn_sale_type_cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(Sale_type_cd);
            CMD.Parameters.Add("PN_REG_NUM", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(Regnum_estm);
            CMD.Parameters.Add("pn_omr", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(omr_estm);
            CMD.Parameters.Add("PN_remarks", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(Remarks_estm);
            CMD.Parameters.Add("pn_estim_days", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(Estm_days);
            CMD.Parameters.Add("pn_estimated_hrs", OracleDbType.Varchar2, 50, ParameterDirection.Input).Value = Convert.ToString(Estm_hrs);
            CMD.Parameters.Add("pn_part_disc", OracleDbType.Varchar2, 50, ParameterDirection.Input).Value = Convert.ToString(Part_disc_estm);
            CMD.Parameters.Add("pn_labor_disc", OracleDbType.Varchar2, 50, ParameterDirection.Input).Value = Convert.ToString(Labor_disc_estm);

            CMD.Parameters.Add("po_part_refcur", OracleDbType.Varchar2, 500, ParameterDirection.Input).Value = Convert.ToString(Part_refcur_estm);
            CMD.Parameters.Add("po_labor_refcur", OracleDbType.Varchar2, 500, ParameterDirection.Input).Value = Convert.ToString(Labor_refcur_estm);

            //added following 16 new i/p param to these proce on 14 july 2015
            CMD.Parameters.Add("pn_insr_name", OracleDbType.Varchar2, 100, ParameterDirection.Input).Value = Convert.ToString(pn_insr_name_estm);
            CMD.Parameters.Add("pn_insr_branch", OracleDbType.Varchar2, 100, ParameterDirection.Input).Value = Convert.ToString(pn_insr_branch_estm);
            CMD.Parameters.Add("pn_insr_add1", OracleDbType.Varchar2, 100, ParameterDirection.Input).Value = Convert.ToString(pn_insr_add1_estm);
            CMD.Parameters.Add("pn_insr_add2", OracleDbType.Varchar2, 100, ParameterDirection.Input).Value = Convert.ToString(pn_insr_add2_estm);
            CMD.Parameters.Add("pn_insr_add3", OracleDbType.Varchar2, 100, ParameterDirection.Input).Value = Convert.ToString(pn_insr_add3_estm);
            CMD.Parameters.Add("pn_driver_name", OracleDbType.Varchar2, 100, ParameterDirection.Input).Value = Convert.ToString(pn_driver_name_estm);
            CMD.Parameters.Add("pn_dl_num", OracleDbType.Varchar2, 100, ParameterDirection.Input).Value = Convert.ToString(pn_dl_num_estm);
            CMD.Parameters.Add("pn_dl_exp_date", OracleDbType.Varchar2, 100, ParameterDirection.Input).Value = Convert.ToString(pn_dl_exp_date_estm);
            CMD.Parameters.Add("pn_policy_num", OracleDbType.Varchar2, 100, ParameterDirection.Input).Value = Convert.ToString(pn_policy_num_estm);
            CMD.Parameters.Add("pn_policy_exp_date", OracleDbType.Varchar2, 100, ParameterDirection.Input).Value = Convert.ToString(policy_exp_date_estm);
            CMD.Parameters.Add("pn_surveyor_name", OracleDbType.Varchar2, 100, ParameterDirection.Input).Value = Convert.ToString(surveyor_name_estm);
            CMD.Parameters.Add("pn_surv_int_date", OracleDbType.Varchar2, 100, ParameterDirection.Input).Value = Convert.ToString(surv_int_date_estm);
            CMD.Parameters.Add("pn_accident_place", OracleDbType.Varchar2, 100, ParameterDirection.Input).Value = Convert.ToString(accident_place_estm);
            CMD.Parameters.Add("pn_accident_date", OracleDbType.Varchar2, 100, ParameterDirection.Input).Value = Convert.ToString(accident_date_estm);
            CMD.Parameters.Add("pn_fir_num", OracleDbType.Varchar2, 100, ParameterDirection.Input).Value = Convert.ToString(pn_fir_num_estm);
            CMD.Parameters.Add("pn_fir_date", OracleDbType.Varchar2, 100, ParameterDirection.Input).Value = Convert.ToString(pn_fir_date_estm);

            CMD.Parameters.Add("po_estim_no", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();

            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {
                string javascriptStr = "{";
                javascriptStr = javascriptStr + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + ","
                                            + "\"" + Convert.ToString("ESTMNUM") + "\""
                                           + ":" + "\"" + Convert.ToString(CMD.Parameters["po_estim_no"].Value) + "\"" + "\"";


                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;
                Logger.SuccessLogPrint("InsertEstmDetails", "sp_jco_insert_estim_dtl", "'pn_user_id':'" + UserIDGst_estm + "','pn_estim_type_Cd:'" + Est_type_cd + "','pn_srv_Type_cd':'" + Srv_type_cd_estm + "','pn_sale_type_cd':'" + Sale_type_cd + "','PN_REG_NUM':'"
                + Regnum_estm + "','pn_omr':'" + omr_estm + "','PN_remarks':'" + Remarks_estm + "','pn_estim_days':'" + Estm_days + "','pn_estimated_hrs':'" + Estm_hrs + "','pn_part_disc':'" + Part_disc_estm + "','pn_labor_disc':'" + Labor_disc_estm + "','po_part_refcur': '"
                + Part_refcur_estm + "','po_labor_refcur': '" + Labor_refcur_estm + "','pn_insr_name': '" + pn_insr_name_estm + "','pn_insr_branch': '" + pn_insr_branch_estm + "','pn_insr_add1': '" + pn_insr_add1_estm + "','pn_insr_add2': '" + pn_insr_add2_estm + "','pn_insr_add3': '" + pn_insr_add3_estm + "','pn_driver_name': '" + pn_driver_name_estm + "','pn_dl_num': '" + pn_dl_num_estm + "','pn_dl_exp_date': '"
                + pn_dl_exp_date_estm + "','pn_policy_num': '" + pn_policy_num_estm + "','pn_policy_exp_date': '" + policy_exp_date_estm + "','pn_surveyor_name': '" + surveyor_name_estm + "','pn_surv_int_date': '" + surv_int_date_estm + "','pn_accident_place': '"
                + accident_place_estm + "','pn_accident_date': '" + accident_date_estm + "','pn_fir_num': '" + pn_fir_num_estm + "','pn_fir_date': '" + pn_fir_date_estm, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));

            }
            else
            {
                string javascriptStr = "{";
                javascriptStr = javascriptStr + "\"" + Convert.ToString("S") + "\"" + ":"
                                           + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                                           + "\"" + Convert.ToString("M") + "\""
                                          + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;
            }

            //OBJ.Close();

        }
        catch (Exception EX)
        {
            OBJ.Close();
            //Result = ex.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("InsertEstmDetails", "sp_jco_insert_estim_dtl", "'pn_user_id':'" + UserIDGst_estm + "','pn_estim_type_Cd:'" + Est_type_cd + "','pn_srv_Type_cd':'" + Srv_type_cd_estm + "','pn_sale_type_cd':'" + Sale_type_cd + "','PN_REG_NUM':'"
                + Regnum_estm + "','pn_omr':'" + omr_estm + "','PN_remarks':'" + Remarks_estm + "','pn_estim_days':'" + Estm_days + "','pn_estimated_hrs':'" + Estm_hrs + "','pn_part_disc':'" + Part_disc_estm + "','pn_labor_disc':'" + Labor_disc_estm + "','po_part_refcur': '"
                + Part_refcur_estm + "','po_labor_refcur': '" + Labor_refcur_estm + "','pn_insr_name': '" + pn_insr_name_estm + "','pn_insr_branch': '" + pn_insr_branch_estm + "','pn_insr_add1': '" + pn_insr_add1_estm + "','pn_insr_add2': '" + pn_insr_add2_estm + "','pn_insr_add3': '" + pn_insr_add3_estm + "','pn_driver_name': '" + pn_driver_name_estm + "','pn_dl_num': '" + pn_dl_num_estm + "','pn_dl_exp_date': '"
                + pn_dl_exp_date_estm + "','pn_policy_num': '" + pn_policy_num_estm + "','pn_policy_exp_date': '" + policy_exp_date_estm + "','pn_surveyor_name': '" + surveyor_name_estm + "','pn_surv_int_date': '" + surv_int_date_estm + "','pn_accident_place': '"
                + accident_place_estm + "','pn_accident_date': '" + accident_date_estm + "','pn_fir_num': '" + pn_fir_num_estm + "','pn_fir_date': '" + pn_fir_date_estm, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;



    }//end of fn  InsertEstmDetails

    public string GetJCOpenEstmDetails(string UserID, string estm_type, string estm_no, Int32 estm_suppno)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();
            CMD = new OracleCommand("pkg_jco_1.sp_jco_get_open_estim_dtl", OBJ);

            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(UserID);
            CMD.Parameters.Add("pn_estim_type", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(estm_type);
            CMD.Parameters.Add("pn_estim_num", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(estm_no);
            CMD.Parameters.Add("pn_estim_supp_num", OracleDbType.Int32, 10, ParameterDirection.Input).Value = Convert.ToString(estm_suppno);


            CMD.Parameters.Add("po_estim_type_desc", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_estim_date", OracleDbType.Varchar2, 50).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_srv_type_cd", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_srv_type_desc", OracleDbType.Varchar2, 100).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_estim_status", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_sale_type_cd", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_bp_mechanical", OracleDbType.Varchar2, 50).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_reg_num", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_odometer", OracleDbType.Int32, 10).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_remarks", OracleDbType.Varchar2, 50).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_estim_days", OracleDbType.Int32, 10).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_estim_hrs", OracleDbType.Int32, 10).Direction = ParameterDirection.Output;


            CMD.Parameters.Add("po_cust_apprv_yn", OracleDbType.Varchar2, 1).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_part_disc", OracleDbType.Double).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_labour_disc", OracleDbType.Double).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_tot_tax_amt", OracleDbType.Double).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_tot_disc_amt", OracleDbType.Double).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_tot_part_amt", OracleDbType.Double).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_tot_labour_amt", OracleDbType.Double).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_tot_estim_amt", OracleDbType.Double).Direction = ParameterDirection.Output;

            //following are the cursors in o/p
            CMD.Parameters.Add("po_part_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_labor_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;
            //----
            CMD.Parameters.Add("po_insr_name", OracleDbType.Varchar2, 50).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_insr_branch", OracleDbType.Varchar2, 50).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_insr_add1", OracleDbType.Varchar2, 50).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_insr_add2", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_insr_add3", OracleDbType.Varchar2, 50).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_policy_num", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_policy_exp_date", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_surveyor_name", OracleDbType.Varchar2, 50).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_surv_int_date", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_driver_name", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_dl_num", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_dl_exp_date", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_accident_place", OracleDbType.Varchar2, 50).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_accident_date", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_fir_num", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_fir_date", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_surv_apprv_yn", OracleDbType.Varchar2, 1).Direction = ParameterDirection.Output;


            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;

            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();

            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {

                int cnter1 = 0;

                string javascriptStr = "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "0" + "\"" + ","
                //+ "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + ","
                + "\"" + Convert.ToString("M") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_err_msg"].Value)) + ","
                + "\"" + "ESTMDTLS" + "\"" + ":" + "[{";

                javascriptStr = javascriptStr

                + "\"" + Convert.ToString("ET") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["pn_estim_type"].Value)) + ","
                + "\"" + Convert.ToString("ESNO") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["pn_estim_supp_num"].Value)) + ","
                + "\"" + Convert.ToString("ETD") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_estim_type_desc"].Value)) + ","
                + "\"" + Convert.ToString("ESTMDT") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_estim_date"].Value)) + ","
                + "\"" + Convert.ToString("SSC") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_sub_srv_cd"].Value)) + ","
                + "\"" + Convert.ToString("STD") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_srv_type_desc"].Value)) + ","

                + "\"" + Convert.ToString("EMSTS") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_estim_status"].Value)) + ","
                + "\"" + Convert.ToString("STCD") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_sale_type_cd"].Value)) + ","
                + "\"" + Convert.ToString("BPMCHN") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_bp_mechanical"].Value)) + ","

                + "\"" + Convert.ToString("REGNUM") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_reg_num"].Value)) + ","
                + "\"" + Convert.ToString("OMR") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_odometer"].Value)) + ","
                + "\"" + Convert.ToString("REMARKS") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_remarks"].Value)) + ","
                + "\"" + Convert.ToString("EDAYS") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_estim_days"].Value)) + ","
                + "\"" + Convert.ToString("EHRS") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_estim_hrs"].Value)) + ","
                + "\"" + Convert.ToString("CAPPYN") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_cust_apprv_yn"].Value)) + ","
                + "\"" + Convert.ToString("PDISC") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_part_disc"].Value)) + ","
                + "\"" + Convert.ToString("LDISC") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_labour_disc"].Value)) + ","

                + "\"" + Convert.ToString("TTAXAMT") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_tot_tax_amt"].Value)) + ","
                + "\"" + Convert.ToString("TDAMT") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_tot_disc_amt"].Value)) + ","
                + "\"" + Convert.ToString("TPAMT") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_tot_part_amt"].Value)) + ","
                + "\"" + Convert.ToString("TLAMT") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_tot_labour_amt"].Value)) + ","
                + "\"" + Convert.ToString("TEAMT") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_tot_estim_amt"].Value)) + ","
                //after cursor variables 
                + "\"" + Convert.ToString("INSRN") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_insr_name"].Value)) + ","
                + "\"" + Convert.ToString("INSRB") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_insr_branch"].Value)) + ","
                + "\"" + Convert.ToString("INSRA1") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_insr_add1"].Value)) + ","
                + "\"" + Convert.ToString("INSRA3") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_insr_add2"].Value)) + ","
                + "\"" + Convert.ToString("INSRA2") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_insr_add2"].Value)) + ","
                + "\"" + Convert.ToString("POLICYN") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_policy_num"].Value)) + ","

                + "\"" + Convert.ToString("PEXPDT") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_policy_exp_date"].Value)) + ","
                + "\"" + Convert.ToString("SNAME") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_surveyor_name"].Value)) + ","
                + "\"" + Convert.ToString("SID") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_surv_int_date"].Value)) + ","

                + "\"" + Convert.ToString("DRN") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_driver_name"].Value)) + ","
                + "\"" + Convert.ToString("DNUM") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_dl_num"].Value)) + ","
                + "\"" + Convert.ToString("DEXPDT") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_dl_exp_date"].Value)) + ","
                + "\"" + Convert.ToString("ACCP") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_accident_place"].Value)) + ","
                + "\"" + Convert.ToString("ACCDT") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_accident_date"].Value)) + ","
                + "\"" + Convert.ToString("FIRN") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_fir_num"].Value)) + ","
                + "\"" + Convert.ToString("FIRDT") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_fir_date"].Value)) + ","
                + "\"" + Convert.ToString("SAPPYN") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_surv_apprv_yn"].Value)) + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);

                javascriptStr = javascriptStr + "}]" + ",";
                //-------------------------------
                OracleDataReader dr1 = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_part_refcur"].Value).GetDataReader();
                javascriptStr += "\"" + "PRF" + "\"" + ":" + "[";
                while (dr1.Read())
                {
                    cnter1 = 2;
                    javascriptStr += "{" + "\"" + Convert.ToString("PN") + "\"" + ":" + "\"" + Convert.ToString(dr1[0]) + "\"" + ","
                    + "\"" + Convert.ToString("PD") + "\"" + ":" + "\"" + Convert.ToString(dr1[1]) + "\"" + ","
                    + "\"" + Convert.ToString("PQTY") + "\"" + ":" + "\"" + Convert.ToString(dr1[2]) + "\"" + ","
                     + "\"" + Convert.ToString("TAXTY") + "\"" + ":" + "\"" + Convert.ToString(dr1[3]) + "\"" + ","
                    + "\"" + Convert.ToString("TAXTYD") + "\"" + ":" + "\"" + Convert.ToString(dr1[4]) + "\"" + ","
                    + "\"" + Convert.ToString("RATE") + "\"" + ":" + "\"" + Convert.ToString(dr1[5]) + "\"" + ","
                    + "\"" + Convert.ToString("DI") + "\"" + ":" + "\"" + Convert.ToString(dr1[6]) + "\"" + ","
                    + "\"" + Convert.ToString("DID") + "\"" + ":" + "\"" + Convert.ToString(dr1[7]) + "\"" + ","
                    + "\"" + Convert.ToString("DV") + "\"" + ":" + "\"" + Convert.ToString(dr1[8]) + "\"" + ","
                    + "\"" + Convert.ToString("TAXCHRG") + "\"" + ":" + "\"" + Convert.ToString(dr1[9]) + "\"" + ","
                    + "\"" + Convert.ToString("DEPRI") + "\"" + ":" + "\"" + Convert.ToString(dr1[10]) + "\"" + ","
                    + "\"" + Convert.ToString("DEPRID") + "\"" + ":" + "\"" + Convert.ToString(dr1[11]) + "\"" + ","
                    + "\"" + Convert.ToString("DEPRV") + "\"" + ":" + "\"" + Convert.ToString(dr1[12]) + "\"" + ","
                    + "\"" + Convert.ToString("DEPRAMT") + "\"" + ":" + "\"" + Convert.ToString(dr1[13]) + "\"" + ","
                    + "\"" + Convert.ToString("TOTVL") + "\"" + ":" + "\"" + Convert.ToString(dr1[14]) + "\"" + "}" + ",";

                }
                if (cnter1 == 2)
                {
                    if (javascriptStr.Length > 1)
                        javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                }
                javascriptStr = javascriptStr + "]" + ",";

                //-------------------------------
                OracleDataReader dr2 = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_labor_refcur"].Value).GetDataReader();
                javascriptStr += "\"" + "DRF" + "\"" + ":" + "[";
                while (dr2.Read())
                {
                    cnter1 = 3;
                    javascriptStr += "{" + "\"" + Convert.ToString("LC") + "\"" + ":" + "\"" + Convert.ToString(dr2[0]) + "\"" + ","
                    + "\"" + Convert.ToString("LDSC") + "\"" + ":" + "\"" + Convert.ToString(dr2[1]) + "\"" + ","
                    + "\"" + Convert.ToString("FRMHRS") + "\"" + ":" + "\"" + Convert.ToString(dr2[2]) + "\"" + ","
                    + "\"" + Convert.ToString("MODYN") + "\"" + ":" + "\"" + Convert.ToString(dr2[3]) + "\"" + ","
                    + "\"" + Convert.ToString("FLATAMT") + "\"" + ":" + "\"" + Convert.ToString(dr2[4]) + "\"" + ","
                    + "\"" + Convert.ToString("CPER") + "\"" + ":" + "\"" + Convert.ToString(dr2[5]) + "\"" + ","
                    + "\"" + Convert.ToString("NPER") + "\"" + ":" + "\"" + Convert.ToString(dr2[6]) + "\"" + ","
                    + "\"" + Convert.ToString("LDI") + "\"" + ":" + "\"" + Convert.ToString(dr2[7]) + "\"" + ","
                    + "\"" + Convert.ToString("LDID") + "\"" + ":" + "\"" + Convert.ToString(dr2[8]) + "\"" + ","
                    + "\"" + Convert.ToString("LDIV") + "\"" + ":" + "\"" + Convert.ToString(dr2[9]) + "\"" + ","
                    + "\"" + Convert.ToString("LTAXCHRG") + "\"" + ":" + "\"" + Convert.ToString(dr2[10]) + "\"" + ","
                    + "\"" + Convert.ToString("LAMT") + "\"" + ":" + "\"" + Convert.ToString(dr2[11]) + "\"" + "}" + ",";


                }
                if (cnter1 == 3)
                {
                    if (javascriptStr.Length > 1)
                        javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                }
                javascriptStr = javascriptStr + "]" + "}";

                Result = javascriptStr;

                if (dr1 != null)
                {
                    dr1.Dispose();
                    dr1 = null;
                }

                if (dr2 != null)
                {
                    dr2.Dispose();
                    dr2 = null;
                }
                Logger.SuccessLogPrint("GetJCOpenEstmDetails", "sp_jco_get_open_estim_dtl", "'pn_user_id': '" + UserID + "','pn_estim_type':'" + estm_type + "','pn_estim_num':'" + estm_no + "','pn_estim_supp_num':'" + estm_suppno, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));

            }
            else
            {
                string javascriptStr = "{";
                javascriptStr = javascriptStr + "\"" + Convert.ToString("S") + "\"" + ":"
                                           + "\"" + "1" + "\"" + ","
                      + "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;
            }
            //OBJ.Close();
        }
        catch (Exception EX)
        {
            OBJ.Close();
            //Result = ex.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("GetJCOpenEstmDetails", "sp_jco_get_open_estim_dtl", "'pn_user_id': '" + UserID + "','pn_estim_type':'" + estm_type + "','pn_estim_num':'" + estm_no + "','pn_estim_supp_num':'" + estm_suppno, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;

    }
    //----------------------------------------xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx-------------------------------------------------------
    public string CalculateEstmCharges(string UserIDgstestm1, string estm_type_cd, string srv_Type_cd_E, string sale_type_cd_estm,
                                       string reg_num_estm, Int32 part_disc, Int32 labor_disc, string part_ins_str, string labor_ins_str)
    {

        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {

            OBJ.Open();
            CMD = new OracleCommand("pkg_jco_1.sp_jco_calc_estim_charges", OBJ);

            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(UserIDgstestm1);
            CMD.Parameters.Add("pn_estim_type_Cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(estm_type_cd);
            CMD.Parameters.Add("pn_srv_Type_cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(srv_Type_cd_E);
            CMD.Parameters.Add("pn_sale_type_cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(sale_type_cd_estm);
            CMD.Parameters.Add("pn_reg_num", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(reg_num_estm);
            CMD.Parameters.Add("pn_part_disc", OracleDbType.Int32, 20, ParameterDirection.Input).Value = Convert.ToString(part_disc);
            CMD.Parameters.Add("pn_labor_disc", OracleDbType.Int32, 20, ParameterDirection.Input).Value = Convert.ToString(labor_disc);

            CMD.Parameters.Add("pn_part_ins_str", OracleDbType.Varchar2, 500, ParameterDirection.Input).Value = Convert.ToString(part_ins_str);
            CMD.Parameters.Add("pn_labor_ins_str", OracleDbType.Varchar2, 500, ParameterDirection.Input).Value = Convert.ToString(labor_ins_str);

            CMD.Parameters.Add("po_tot_disc_amt", OracleDbType.Double).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_tot_tax_amt", OracleDbType.Double).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_tot_part_amt", OracleDbType.Double).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_tot_labor_amt", OracleDbType.Double).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_tot_estim_amt", OracleDbType.Double).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_part_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_labor_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;


            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;

            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();
            string javascriptStr = "";
            int cnt = 0;

            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {

                javascriptStr = "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "0" + "\"" + ","
                //+ "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + ","
                + "\"" + Convert.ToString("M") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_err_msg"].Value)) + ","
                + "\"" + Convert.ToString("TDIAMT") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_tot_disc_amt"].Value)) + ","
                + "\"" + Convert.ToString("TTXAMT") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_tot_tax_amt"].Value)) + ","
                + "\"" + Convert.ToString("TPAMT") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_tot_part_amt"].Value)) + ","
                + "\"" + Convert.ToString("TLAMT") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_tot_labor_amt"].Value)) + ","
                + "\"" + Convert.ToString("TEAMT") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_tot_estim_amt"].Value)) + ",";

                OracleDataReader dr = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_part_refcur"].Value).GetDataReader();
                javascriptStr = javascriptStr + "\"" + "CHRGPRF" + "\"" + ":" + "[";

                while (dr.Read())
                {
                    cnt = 1;
                    javascriptStr = javascriptStr + "{" + "\"" + Convert.ToString("PN") + "\"" + ":" + "\"" + Convert.ToString(dr[0]) + "\"" + ","
                                     + "\"" + Convert.ToString("PD") + "\"" + ":" + "\"" + Convert.ToString(dr[1]) + "\"" + ","
                                     + "\"" + Convert.ToString("QTY") + "\"" + ":" + "\"" + Convert.ToString(dr[2]) + "\"" + ","
                                     + "\"" + Convert.ToString("TTCD") + "\"" + ":" + "\"" + Convert.ToString(dr[3]) + "\"" + ","
                                     + "\"" + Convert.ToString("TTDSC") + "\"" + ":" + "\"" + Convert.ToString(dr[4]) + "\"" + ","
                                     + "\"" + Convert.ToString("RATE") + "\"" + ":" + "\"" + Convert.ToString(dr[5]) + "\"" + ","
                                     + "\"" + Convert.ToString("DI") + "\"" + ":" + "\"" + Convert.ToString(dr[6]) + "\"" + ","
                                     + "\"" + Convert.ToString("DID") + "\"" + ":" + "\"" + Convert.ToString(dr[7]) + "\"" + ","
                                     + "\"" + Convert.ToString("DV") + "\"" + ":" + "\"" + Convert.ToString(dr[8]) + "\"" + ","
                                     + "\"" + Convert.ToString("TXCHRG") + "\"" + ":" + "\"" + Convert.ToString(dr[9]) + "\"" + ","
                                     + "\"" + Convert.ToString("DPRI") + "\"" + ":" + "\"" + Convert.ToString(dr[10]) + "\"" + ","
                                     + "\"" + Convert.ToString("DPRID") + "\"" + ":" + "\"" + Convert.ToString(dr[11]) + "\"" + ","
                                     + "\"" + Convert.ToString("DPRV") + "\"" + ":" + "\"" + Convert.ToString(dr[12]) + "\"" + ","
                                     + "\"" + Convert.ToString("DPRAMT") + "\"" + ":" + "\"" + Convert.ToString(dr[13]) + "\"" + ","
                                     + "\"" + Convert.ToString("TVAL") + "\"" + ":" + "\"" + Convert.ToString(dr[14]) + "\"" + "}" + ",";

                }

                if (cnt == 1)
                {
                    javascriptStr = javascriptStr.Remove(javascriptStr.Length - 1, 1);
                }

                //-------------
                javascriptStr = javascriptStr + "]" + ",";

                //-------------------------------
                OracleDataReader dr2 = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_labor_refcur"].Value).GetDataReader();
                javascriptStr += "\"" + "CHRGLRF" + "\"" + ":" + "[";
                while (dr2.Read())
                {
                    cnt = 2;
                    javascriptStr += "{" + "\"" + Convert.ToString("LC") + "\"" + ":" + "\"" + Convert.ToString(dr2[0]) + "\"" + ","
                    + "\"" + Convert.ToString("LDSC") + "\"" + ":" + "\"" + Convert.ToString(dr2[1]) + "\"" + ","
                    + "\"" + Convert.ToString("FRMHRS") + "\"" + ":" + "\"" + Convert.ToString(dr2[2]) + "\"" + ","
                    + "\"" + Convert.ToString("MODYN") + "\"" + ":" + "\"" + Convert.ToString(dr2[3]) + "\"" + ","
                    + "\"" + Convert.ToString("FLATAMT") + "\"" + ":" + "\"" + Convert.ToString(dr2[4]) + "\"" + ","
                    + "\"" + Convert.ToString("CPER") + "\"" + ":" + "\"" + Convert.ToString(dr2[5]) + "\"" + ","
                    + "\"" + Convert.ToString("NPER") + "\"" + ":" + "\"" + Convert.ToString(dr2[6]) + "\"" + ","
                    + "\"" + Convert.ToString("LDI") + "\"" + ":" + "\"" + Convert.ToString(dr2[7]) + "\"" + ","
                    + "\"" + Convert.ToString("LDID") + "\"" + ":" + "\"" + Convert.ToString(dr2[8]) + "\"" + ","
                    + "\"" + Convert.ToString("LDIV") + "\"" + ":" + "\"" + Convert.ToString(dr2[9]) + "\"" + ","
                    + "\"" + Convert.ToString("LTAXCHRG") + "\"" + ":" + "\"" + Convert.ToString(dr2[10]) + "\"" + ","
                    + "\"" + Convert.ToString("LAMT") + "\"" + ":" + "\"" + Convert.ToString(dr2[11]) + "\"" + "}" + ",";


                }
                if (cnt == 2)
                {
                    if (javascriptStr.Length > 1)
                        javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                }
                javascriptStr = javascriptStr + "]" + "}";

                Result = javascriptStr;
                //------------

                if (dr != null)
                {
                    dr.Dispose();
                    dr = null;
                }

                if (dr2 != null)
                {
                    dr2.Dispose();
                    dr2 = null;
                }
                Logger.SuccessLogPrint("CalculateEstmCharges", "sp_jco_calc_estim_charges", "'pn_user_id':'" + UserIDgstestm1 + "','pn_estim_type_Cd':'" + estm_type_cd + "','pn_srv_Type_cd':'" + srv_Type_cd_E + "','pn_sale_type_cd':'" + sale_type_cd_estm + "','pn_reg_num':'"
                    + reg_num_estm + "','pn_part_disc':'" + part_disc + "','pn_labor_disc':'" + labor_disc + "','pn_part_ins_str':'" + part_ins_str + "','pn_labor_ins_str':'" + labor_ins_str
                    , "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));

            }
            else
            {

                javascriptStr = "{";

                javascriptStr = javascriptStr + "\"" + Convert.ToString("S") + "\"" + ":"
                                           + "\"" + "1" + "\"" + ","
                                           + "\"" + Convert.ToString("M") + "\""
                                          + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;

            }
            //OBJ.Close();
        }
        catch (Exception EX)
        {
            OBJ.Close();

            //Result = ex.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("CalculateEstmCharges", "sp_jco_calc_estim_charges", "'pn_user_id':'" + UserIDgstestm1 + "','pn_estim_type_Cd':'" + estm_type_cd + "','pn_srv_Type_cd':'" + srv_Type_cd_E + "','pn_sale_type_cd':'" + sale_type_cd_estm + "','pn_reg_num':'"
                   + reg_num_estm + "','pn_part_disc':'" + part_disc + "','pn_labor_disc':'" + labor_disc + "','pn_part_ins_str':'" + part_ins_str + "','pn_labor_ins_str':'" + labor_ins_str, EX);
        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;

    }

    //---jco_close module fns added as on 4 aug 2015
    public string GetDelayReasonJC(string UserID1, string parent_grp, Int32 dealer_map_cd, string loc_cd, string comp_fa)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();

            CMD = new OracleCommand("PKG_JCB_1.SP_JCB_GET_DELAY_REASON", OBJ);
            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(UserID1);
            CMD.Parameters.Add("pn_parent_group", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(parent_grp);
            CMD.Parameters.Add("pn_dealer_map_cd", OracleDbType.Int32, 20, ParameterDirection.Input).Value = Convert.ToInt32(dealer_map_cd);
            CMD.Parameters.Add("pn_loc_Cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(loc_cd);
            CMD.Parameters.Add("pn_comp_fa", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(comp_fa);

            CMD.Parameters.Add("po_delay_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 2000).Direction = ParameterDirection.Output;
            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();

            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {
                int cnter = 0;
                OracleDataReader dr = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_delay_refcur"].Value).GetDataReader();

                string javascriptStr = "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "0" + "\"" + ","
                // + "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + ","
                 + "\"" + Convert.ToString("M") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_err_msg"].Value)) + ","
                + "\"" + Convert.ToString("DLYR") + "\"" + ":" + "[";
                while (dr.Read())
                {
                    cnter = 1;
                    javascriptStr = javascriptStr + "{" + "\"" + Convert.ToString(dr[0]) + "\"" + ":" + "\"" + Convert.ToString(dr[1]) + "\"" + "}" + ",";
                }
                if (cnter == 1)
                {
                    if (javascriptStr.Length > 1)
                        javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                }
                javascriptStr = javascriptStr + "]" + "}";

                Result = javascriptStr;

                if (dr != null)
                {
                    dr.Dispose();
                    dr = null;
                }
                Logger.SuccessLogPrint("GetDelayReasonJC", "SP_JCB_GET_DELAY_REASON", "'pn_user_id':'" + UserID1 + "','pn_parent_group':'" + parent_grp + "','pn_dealer_map_cd':'" + dealer_map_cd + "','pn_loc_Cd':'" + loc_cd + "','pn_comp_fa':'" + comp_fa
                   , "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));
            }
            else
            {
                string javascriptStr = "{";
                javascriptStr = javascriptStr
                    + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                    + "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;


            }
            //OBJ.Close();
        }
        catch (Exception EX)
        {
            OBJ.Close();
            //Result = ex.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("GetDelayReasonJC", "SP_JCB_GET_DELAY_REASON", "'pn_user_id':'" + UserID1 + "','pn_parent_group':'" + parent_grp + "','pn_dealer_map_cd':'" + dealer_map_cd + "','pn_loc_Cd':'" + loc_cd + "','pn_comp_fa':'" + comp_fa, EX);
        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;


    }

    public string GetCsiReasonJC(string UserID1, string parent_grp, Int32 dealer_map_cd, string loc_cd, string comp_fa)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();

            CMD = new OracleCommand("PKG_JCB_1.SP_JCB_GET_CSI_REASON", OBJ);
            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(UserID1);
            CMD.Parameters.Add("pn_parent_group", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(parent_grp);
            CMD.Parameters.Add("pn_dealer_map_cd", OracleDbType.Int32, 20, ParameterDirection.Input).Value = Convert.ToInt32(dealer_map_cd);
            CMD.Parameters.Add("pn_loc_Cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(loc_cd);
            CMD.Parameters.Add("pn_comp_fa", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(comp_fa);

            CMD.Parameters.Add("po_csi_reas_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 2000).Direction = ParameterDirection.Output;
            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();

            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {
                int cnter = 0;
                OracleDataReader dr = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_csi_reas_refcur"].Value).GetDataReader();

                string javascriptStr = "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "0" + "\"" + ","
                //+ "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + ","
                + "\"" + Convert.ToString("M") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_err_msg"].Value)) + ","
                + "\"" + Convert.ToString("CSIR") + "\"" + ":" + "[";
                while (dr.Read())
                {
                    cnter = 1;
                    javascriptStr = javascriptStr + "{" + "\"" + Convert.ToString(dr[0]) + "\"" + ":" + "\"" + dbHelper.EscapSpecialCharacters(Convert.ToString(dr[1])) + "\"" + "}" + ",";
                }
                if (cnter == 1)
                {
                    if (javascriptStr.Length > 1)
                        javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                }
                javascriptStr = javascriptStr + "]" + "}";

                Result = javascriptStr;

                if (dr != null)
                {
                    dr.Dispose();
                    dr = null;
                }
                Logger.SuccessLogPrint("GetCsiReasonJC", "SP_JCB_GET_CSI_REASON", "'pn_user_id':'" + UserID1 + "','pn_parent_group':'" + parent_grp + "','pn_dealer_map_cd':'" + dealer_map_cd + "','pn_loc_Cd':'" + loc_cd + "','pn_comp_fa':'" + comp_fa, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));
            }
            else
            {
                string javascriptStr = "{";
                javascriptStr = javascriptStr
                    + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                    + "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;

                //Result = Convert.ToString(CMD.Parameters["po_err_cd"].Value) + ":" + Convert.ToString(CMD.Parameters["po_err_msg"].Value);
            }
            //OBJ.Close();
        }
        catch (Exception EX)
        {
            OBJ.Close();
            //Result = ex.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("GetCsiReasonJC", "SP_JCB_GET_CSI_REASON", "'pn_user_id':'" + UserID1 + "','pn_parent_group':'" + parent_grp + "','pn_dealer_map_cd':'" + dealer_map_cd + "','pn_loc_Cd':'" + loc_cd + "','pn_comp_fa':'" + comp_fa, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;


    }

    public string GetDiscAuthJC(string UserID1, string parent_grp, Int32 dealer_map_cd, string loc_cd, string comp_fa)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();

            CMD = new OracleCommand("PKG_JCB_1.SP_JCB_GET_DISC_AUTH_BY", OBJ);
            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(UserID1);
            CMD.Parameters.Add("pn_parent_group", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(parent_grp);
            CMD.Parameters.Add("pn_dealer_map_cd", OracleDbType.Int32, 20, ParameterDirection.Input).Value = Convert.ToInt32(dealer_map_cd);
            CMD.Parameters.Add("pn_loc_Cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(loc_cd);
            CMD.Parameters.Add("pn_comp_fa", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(comp_fa);

            CMD.Parameters.Add("po_disc_auth_by_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 2000).Direction = ParameterDirection.Output;
            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();

            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {
                int cnter = 0;
                OracleDataReader dr = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_disc_auth_by_refcur"].Value).GetDataReader();

                string javascriptStr = "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "0" + "\"" + ","
                //+ "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + ","
                + "\"" + Convert.ToString("M") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_err_msg"].Value)) + ","
                + "\"" + Convert.ToString("DABY") + "\"" + ":" + "[";
                while (dr.Read())
                {
                    cnter = 1;
                    javascriptStr = javascriptStr + "{" + "\"" + Convert.ToString(dr[0]) + "\"" + ":" + "\"" + Convert.ToString(dr[1]) + "\"" + "}" + ",";
                }
                if (cnter == 1)
                {
                    if (javascriptStr.Length > 1)
                        javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                }
                javascriptStr = javascriptStr + "]" + "}";

                Result = javascriptStr;
                if (dr != null)
                {
                    dr.Dispose();
                    dr = null;
                }
                Logger.SuccessLogPrint("GetDiscAuthJC", "SP_JCB_GET_DISC_AUTH_BY", "'pn_user_id':'" + UserID1 + "','pn_parent_group':'" + parent_grp + "','pn_dealer_map_cd':'" + dealer_map_cd + "','pn_loc_Cd':'" + loc_cd + "','pn_comp_fa':'" + comp_fa, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));

            }
            else
            {
                string javascriptStr = "{";
                javascriptStr = javascriptStr
                    + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                    + "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;


            }
            //OBJ.Close();
        }
        catch (Exception EX)
        {
            OBJ.Close();
            //Result = ex.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("GetDiscAuthJC", "SP_JCB_GET_DISC_AUTH_BY", "'pn_user_id':'" + UserID1 + "','pn_parent_group':'" + parent_grp + "','pn_dealer_map_cd':'" + dealer_map_cd + "','pn_loc_Cd':'" + loc_cd + "','pn_comp_fa':'" + comp_fa, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;


    }

    public string GetDemandLovJC(string UserID1, string parent_grp, Int32 dealer_map_cd, string loc_cd, string comp_fa, string jcno)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();

            CMD = new OracleCommand("PKG_JCB_1.SP_JCB_GET_DEMAND_LOV", OBJ);
            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(UserID1);
            CMD.Parameters.Add("pn_parent_group", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(parent_grp);
            CMD.Parameters.Add("pn_dealer_map_cd", OracleDbType.Int32, 20, ParameterDirection.Input).Value = Convert.ToInt32(dealer_map_cd);
            CMD.Parameters.Add("pn_loc_Cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(loc_cd);
            CMD.Parameters.Add("pn_comp_fa", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(comp_fa);
            CMD.Parameters.Add("pn_jc_no", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(jcno);

            CMD.Parameters.Add("po_demand_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 2000).Direction = ParameterDirection.Output;
            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();

            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {
                int cnter = 0;
                OracleDataReader dr = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_demand_refcur"].Value).GetDataReader();

                string javascriptStr = "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "0" + "\"" + ","
                //+ "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + ","
                + "\"" + Convert.ToString("M") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_err_msg"].Value)) + ","
                + "\"" + Convert.ToString("DMNLOV") + "\"" + ":" + "[";
                while (dr.Read())
                {
                    cnter = 1;
                    javascriptStr = javascriptStr + "{" + "\"" + Convert.ToString(dr[0]) + "\"" + ":" + "\"" + Convert.ToString(dr[1]) + "\"" + "}" + ",";
                }
                if (cnter == 1)
                {
                    if (javascriptStr.Length > 1)
                        javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                }
                javascriptStr = javascriptStr + "]" + "}";

                Result = javascriptStr;
                if (dr != null)
                {
                    dr.Dispose();
                    dr = null;
                }
                Logger.SuccessLogPrint("GetDemandLovJC", "SP_JCB_GET_DEMAND_LOV", "'pn_user_id':'" + UserID1 + "','pn_parent_group':'" + parent_grp + "','pn_dealer_map_cd':'" + dealer_map_cd + "','pn_loc_Cd':'" + loc_cd + "','pn_comp_fa':'" + comp_fa + "','pn_jc_no':'" + jcno, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));

            }
            else
            {
                string javascriptStr = "{";
                javascriptStr = javascriptStr
                    + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                    + "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;


            }
            //OBJ.Close();
        }
        catch (Exception EX)
        {
            OBJ.Close();
            //Result = ex.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("GetDemandLovJC", "SP_JCB_GET_DEMAND_LOV", "'pn_user_id':'" + UserID1 + "','pn_parent_group':'" + parent_grp + "','pn_dealer_map_cd':'" + dealer_map_cd + "','pn_loc_Cd':'" + loc_cd + "','pn_comp_fa':'" + comp_fa + "','pn_jc_no':'" + jcno, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;


    }


    public string GetProblemLovJC(string UserID1, string parent_grp, Int32 dealer_map_cd, string loc_cd, string comp_fa)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();

            CMD = new OracleCommand("PKG_JCB_1.SP_JCB_GET_PROBLEM_LOV", OBJ);
            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(UserID1);
            CMD.Parameters.Add("pn_parent_group", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(parent_grp);
            CMD.Parameters.Add("pn_dealer_map_cd", OracleDbType.Int32, 20, ParameterDirection.Input).Value = Convert.ToInt32(dealer_map_cd);
            CMD.Parameters.Add("pn_loc_Cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(loc_cd);
            CMD.Parameters.Add("pn_comp_fa", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(comp_fa);


            CMD.Parameters.Add("po_problem_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 2000).Direction = ParameterDirection.Output;
            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();

            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {
                int cnter = 0;
                OracleDataReader dr = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_problem_refcur"].Value).GetDataReader();

                string javascriptStr = "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "0" + "\"" + ","
                + "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + ","
                + "\"" + Convert.ToString("PROBLOV") + "\"" + ":" + "[";
                while (dr.Read())
                {
                    cnter = 1;
                    javascriptStr = javascriptStr + "{" + "\"" + Convert.ToString(dr[0]) + "\"" + ":" + "\"" + Convert.ToString(dr[1]) + "\"" + "}" + ",";
                }
                if (cnter == 1)
                {
                    if (javascriptStr.Length > 1)
                        javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                }
                javascriptStr = javascriptStr + "]" + "}";

                Result = javascriptStr;
                if (dr != null)
                {
                    dr.Dispose();
                    dr = null;
                }
                Logger.SuccessLogPrint("GetProblemLovJC", "SP_JCB_GET_PROBLEM_LOV", "'pn_user_id':'" + UserID1 + "','pn_parent_group':'" + parent_grp + "','pn_dealer_map_cd':'" + dealer_map_cd + "','pn_loc_Cd':'" + loc_cd + "','pn_comp_fa':'" + comp_fa, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));

            }
            else
            {
                string javascriptStr = "{";
                javascriptStr = javascriptStr
                    + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                    + "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;

                //Result = Convert.ToString(CMD.Parameters["po_err_cd"].Value) + ":" + Convert.ToString(CMD.Parameters["po_err_msg"].Value);
            }
            //OBJ.Close();
        }
        catch (Exception EX)
        {
            OBJ.Close();
            //Result = ex.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("GetProblemLovJC", "SP_JCB_GET_PROBLEM_LOV", "'pn_user_id':'" + UserID1 + "','pn_parent_group':'" + parent_grp + "','pn_dealer_map_cd':'" + dealer_map_cd + "','pn_loc_Cd':'" + loc_cd + "','pn_comp_fa':'" + comp_fa, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;


    }

    public string GetFaultLovJC(string UserID1, string parent_grp, Int32 dealer_map_cd, string loc_cd, string comp_fa, string prob_cd)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();

            CMD = new OracleCommand("PKG_JCB_1.SP_JCB_GET_FAULT_LOV", OBJ);
            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(UserID1);
            CMD.Parameters.Add("pn_parent_group", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(parent_grp);
            CMD.Parameters.Add("pn_dealer_map_cd", OracleDbType.Int32, 20, ParameterDirection.Input).Value = Convert.ToInt32(dealer_map_cd);
            CMD.Parameters.Add("pn_loc_Cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(loc_cd);
            CMD.Parameters.Add("pn_comp_fa", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(comp_fa);
            CMD.Parameters.Add("pn_problem_cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(prob_cd);

            CMD.Parameters.Add("po_fault_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 2000).Direction = ParameterDirection.Output;
            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();

            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {
                int cnter = 0;
                OracleDataReader dr = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_fault_refcur"].Value).GetDataReader();

                string javascriptStr = "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "0" + "\"" + ","
                //+ "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + ","
                + "\"" + Convert.ToString("M") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_err_msg"].Value)) + ","
                + "\"" + Convert.ToString("FALTLOV") + "\"" + ":" + "[";
                while (dr.Read())
                {
                    cnter = 1;
                    javascriptStr = javascriptStr + "{" + "\"" + Convert.ToString(dr[0]) + "\"" + ":" + "\"" + Convert.ToString(dr[1]) + "\"" + "}" + ",";
                }
                if (cnter == 1)
                {
                    if (javascriptStr.Length > 1)
                        javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                }
                javascriptStr = javascriptStr + "]" + "}";

                Result = javascriptStr;

                if (dr != null)
                {
                    dr.Dispose();
                    dr = null;
                }
                Logger.SuccessLogPrint("GetFaultLovJC", "SP_JCB_GET_FAULT_LOV", "'pn_user_id':'" + UserID1 + "','pn_parent_group':'" + parent_grp + "','pn_dealer_map_cd':'" + dealer_map_cd + "','pn_loc_Cd':'" + loc_cd + "','pn_comp_fa':'" + comp_fa + "','pn_problem_cd':'" + prob_cd, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));

            }
            else
            {
                string javascriptStr = "{";
                javascriptStr = javascriptStr
                    + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                    + "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;

            }
            //OBJ.Close();
        }
        catch (Exception EX)
        {
            OBJ.Close();
            //Result = ex.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("GetFaultLovJC", "SP_JCB_GET_FAULT_LOV", "'pn_user_id':'" + UserID1 + "','pn_parent_group':'" + parent_grp + "','pn_dealer_map_cd':'" + dealer_map_cd + "','pn_loc_Cd':'" + loc_cd + "','pn_comp_fa':'" + comp_fa + "','pn_problem_cd':'" + prob_cd, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;


    }

    public string GetActionLovJC(string UserID1, string parent_grp, Int32 dealer_map_cd, string loc_cd, string comp_fa, string prob_cd, string fault_cd)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();

            CMD = new OracleCommand("PKG_JCB_1.SP_JCB_GET_ACTION_LOV", OBJ);
            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(UserID1);
            CMD.Parameters.Add("pn_parent_group", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(parent_grp);
            CMD.Parameters.Add("pn_dealer_map_cd", OracleDbType.Int32, 20, ParameterDirection.Input).Value = Convert.ToInt32(dealer_map_cd);
            CMD.Parameters.Add("pn_loc_Cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(loc_cd);
            CMD.Parameters.Add("pn_comp_fa", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(comp_fa);
            CMD.Parameters.Add("pn_problem_cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(prob_cd);
            CMD.Parameters.Add("pn_fault_cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(fault_cd);

            CMD.Parameters.Add("po_action_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 2000).Direction = ParameterDirection.Output;
            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();

            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {
                int cnter = 0;
                OracleDataReader dr = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_action_refcur"].Value).GetDataReader();

                string javascriptStr = "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "0" + "\"" + ","
                //+ "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + ","
                + "\"" + Convert.ToString("M") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_err_msg"].Value)) + ","
                + "\"" + Convert.ToString("ACTLOV") + "\"" + ":" + "[";
                while (dr.Read())
                {
                    cnter = 1;
                    javascriptStr = javascriptStr + "{" + "\"" + Convert.ToString(dr[0]) + "\"" + ":" + "\"" + Convert.ToString(dr[1]) + "\"" + "}" + ",";
                }
                if (cnter == 1)
                {
                    if (javascriptStr.Length > 1)
                        javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                }
                javascriptStr = javascriptStr + "]" + "}";

                Result = javascriptStr;

                if (dr != null)
                {
                    dr.Dispose();
                    dr = null;
                }
                Logger.SuccessLogPrint("GetActionLovJC", "SP_JCB_GET_ACTION_LOV", "'pn_user_id':'" + UserID1 + "','pn_parent_group':'" + parent_grp + "','pn_dealer_map_cd':'" + dealer_map_cd + "','pn_loc_Cd':'" + loc_cd + "','pn_comp_fa':'" + comp_fa + "','pn_problem_cd':'" + prob_cd + "','pn_fault_cd':'" + fault_cd, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));

            }
            else
            {
                string javascriptStr = "{";
                javascriptStr = javascriptStr
                    + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                    + "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;
            }
            //OBJ.Close();
        }
        catch (Exception EX)
        {
            OBJ.Close();
            //Result = ex.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("GetActionLovJC", "SP_JCB_GET_ACTION_LOV", "'pn_user_id':'" + UserID1 + "','pn_parent_group':'" + parent_grp + "','pn_dealer_map_cd':'" + dealer_map_cd + "','pn_loc_Cd':'" + loc_cd + "','pn_comp_fa':'" + comp_fa + "','pn_problem_cd':'" + prob_cd + "','pn_fault_cd':'" + fault_cd, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;
    }

    public string GetDiscIndJC()
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();

            CMD = new OracleCommand("PKG_JCB_1.SP_JCB_GET_DISC_IND", OBJ);

            CMD.Parameters.Add("po_disc_ind_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 2000).Direction = ParameterDirection.Output;
            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();

            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {

                int cnter = 0;
                OracleDataReader dr = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_disc_ind_refcur"].Value).GetDataReader();

                string javascriptStr = "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "0" + "\"" + ","
                //+ "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + ","
                + "\"" + Convert.ToString("M") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_err_msg"].Value)) + ","
                + "\"" + Convert.ToString("DISCIND") + "\"" + ":" + "[";
                while (dr.Read())
                {
                    cnter = 1;
                    javascriptStr = javascriptStr + "{" + "\"" + Convert.ToString(dr[0]) + "\"" + ":" + "\"" + Convert.ToString(dr[1]) + "\"" + "}" + ",";
                }
                if (cnter == 1)
                {
                    if (javascriptStr.Length > 1)
                        javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                }
                javascriptStr = javascriptStr + "]" + "}";

                Result = javascriptStr;

                if (dr != null)
                {
                    dr.Dispose();
                    dr = null;
                }
                Logger.SuccessLogPrint("GetDiscIndJC", "SP_JCB_GET_DISC_IND", null, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));

            }
            else
            {

                string javascriptStr = "{";
                javascriptStr = javascriptStr
                    + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                    + "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;

            }
            //OBJ.Close();
        }
        catch (Exception EX)
        {
            OBJ.Close();
            //Result = ex.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("GetDiscIndJC", "SP_JCB_GET_DISC_IND", null, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;


    }

    //added some new fn on 17 aug 2015

    public string GetTechCampRsJC(string UserID1, string parent_grp, Int32 dealer_map_cd, string loc_cd, string comp_fa, string jcno, string mul_ref_num)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();

            CMD = new OracleCommand("PKG_JCB_1.SP_JCB_GET_TECHCAMP_REASON", OBJ);
            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(UserID1);
            CMD.Parameters.Add("pn_parent_group", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(parent_grp);
            CMD.Parameters.Add("pn_dealer_map_cd", OracleDbType.Int32, 20, ParameterDirection.Input).Value = Convert.ToInt32(dealer_map_cd);
            CMD.Parameters.Add("pn_loc_Cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(loc_cd);
            CMD.Parameters.Add("pn_comp_fa", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(comp_fa);
            CMD.Parameters.Add("pn_jc_no", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(jcno);
            CMD.Parameters.Add("pn_mul_ref_num", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(mul_ref_num);

            CMD.Parameters.Add("po_tech_status_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 2000).Direction = ParameterDirection.Output;
            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();

            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {
                int cnter = 0;
                OracleDataReader dr = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_tech_status_refcur"].Value).GetDataReader();

                string javascriptStr = "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "0" + "\"" + ","
               + "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + ","
                + "\"" + Convert.ToString("TCMPRS") + "\"" + ":" + "[";
                while (dr.Read())
                {
                    cnter = 1;
                    javascriptStr = javascriptStr + "{" + "\"" + Convert.ToString(dr[0]) + "\"" + ":" + "\"" + Convert.ToString(dr[1]) + "\"" + "}" + ",";
                }
                if (cnter == 1)
                {
                    if (javascriptStr.Length > 1)
                        javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                }
                javascriptStr = javascriptStr + "]" + "}";

                Result = javascriptStr;

                if (dr != null)
                {
                    dr.Dispose();
                    dr = null;
                }
                Logger.SuccessLogPrint("GetTechCampRsJC", "SP_JCB_GET_TECHCAMP_REASON", "'pn_user_id':'" + UserID1 + "','pn_parent_group':'" + parent_grp + "','pn_dealer_map_cd':'" + dealer_map_cd + "','pn_loc_Cd':'" + loc_cd + "','pn_comp_fa':'" + comp_fa + "','pn_jc_no':'" + jcno + "','pn_mul_ref_num':'" + mul_ref_num, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));

            }
            else
            {
                string javascriptStr = "{";
                javascriptStr = javascriptStr
                    + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                    + "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;

                //Result = Convert.ToString(CMD.Parameters["po_err_cd"].Value) + ":" + Convert.ToString(CMD.Parameters["po_err_msg"].Value);
            }
            //OBJ.Close();
        }
        catch (Exception EX)
        {
            OBJ.Close();
            //Result = ex.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("GetTechCampRsJC", "SP_JCB_GET_TECHCAMP_REASON", "'pn_user_id':'" + UserID1 + "','pn_parent_group':'" + parent_grp + "','pn_dealer_map_cd':'" + dealer_map_cd + "','pn_loc_Cd':'" + loc_cd + "','pn_comp_fa':'" + comp_fa + "','pn_jc_no':'" + jcno + "','pn_mul_ref_num':'" + mul_ref_num, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;
    }

    public string ValidateBillTypeLabourJC(string UserID1, string parent_grp, Int32 dealer_map_cd, string loc_cd, string comp_fa, string jcno, string lbr_cd, string bill_ty_cd)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();

            CMD = new OracleCommand("PKG_JCB_1.SP_JCB_VALID_BILL_TYPE_LABOUR", OBJ);

            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(UserID1);
            CMD.Parameters.Add("pn_parent_group", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(parent_grp);
            CMD.Parameters.Add("pn_dealer_map_cd", OracleDbType.Int32, 20, ParameterDirection.Input).Value = Convert.ToInt32(dealer_map_cd);
            CMD.Parameters.Add("pn_loc_Cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(loc_cd);
            CMD.Parameters.Add("pn_comp_fa", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(comp_fa);
            CMD.Parameters.Add("pn_jc_num", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(jcno);
            CMD.Parameters.Add("pn_labor_Cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(lbr_cd);
            CMD.Parameters.Add("pn_bill_type_Cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(bill_ty_cd);

            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 2000).Direction = ParameterDirection.Output;
            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();


            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {
                string javascriptStr = "{";
                javascriptStr = javascriptStr + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                                             //+ "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";  
                                             + "\"" + Convert.ToString("M") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_err_msg"].Value)) + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;
                Logger.SuccessLogPrint("ValidateBillTypeLabourJC", "SP_JCB_VALID_BILL_TYPE_LABOUR", "'pn_user_id':'" + UserID1 + "','pn_parent_group':'" + parent_grp + "','pn_dealer_map_cd':'" + dealer_map_cd + "','pn_loc_Cd':'" + loc_cd + "','pn_comp_fa':'" + comp_fa + "','pn_jc_no':'" + jcno + "','pn_labor_Cd':'" + lbr_cd + "','pn_bill_type_Cd':'" + bill_ty_cd, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));

            }
            else
            {
                string javascriptStr = "{";
                javascriptStr = javascriptStr + "\"" + Convert.ToString("S") + "\"" + ":"
                                           + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                                          //+ "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";
                                          + "\"" + Convert.ToString("M") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_err_msg"].Value)) + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;
            }
            //OBJ.Close();
        }
        catch (Exception EX)
        {
            OBJ.Close();
            //Result = EX.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("ValidateBillTypeLabourJC", "SP_JCB_VALID_BILL_TYPE_LABOUR", "'pn_user_id':'" + UserID1 + "','pn_parent_group':'" + parent_grp + "','pn_dealer_map_cd':'" + dealer_map_cd + "','pn_loc_Cd':'" + loc_cd + "','pn_comp_fa':'" + comp_fa + "','pn_jc_no':'" + jcno + "','pn_labor_Cd':'" + lbr_cd + "','pn_bill_type_Cd':'" + bill_ty_cd, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;

    }

    public string GetSplitRatioJC(string UserID1, string parent_grp, Int32 dealer_map_cd, string loc_cd, string comp_fa, string bill_ty_cd, string source)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();
            CMD = new OracleCommand("PKG_JCB_1.SP_JCB_GET_SPLIT_RATIO", OBJ);

            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(UserID1);
            CMD.Parameters.Add("pn_parent_group", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(parent_grp);
            CMD.Parameters.Add("pn_dealer_map_cd", OracleDbType.Int32, 20, ParameterDirection.Input).Value = Convert.ToInt32(dealer_map_cd);
            CMD.Parameters.Add("pn_loc_Cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(loc_cd);
            CMD.Parameters.Add("pn_comp_fa", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(comp_fa);
            CMD.Parameters.Add("pn_bill_type_Cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(bill_ty_cd);
            CMD.Parameters.Add("pn_source", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(source);

            CMD.Parameters.Add("po_split_ratio_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();

            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {
                OracleDataReader dr = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_split_ratio_refcur"].Value).GetDataReader();
                string javascriptStr = "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "0" + "\"" + ","
                //+ "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + ","
                + "\"" + Convert.ToString("M") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_err_msg"].Value)) + ","
                + "\"" + "SPLTR" + "\"" + ":" + "[";
                int cnter = 0;
                while (dr.Read())
                {

                    cnter = 1;
                    javascriptStr = javascriptStr
                                    + "{" + "\"" + Convert.ToString("SC") + "\"" + ":" + "\"" + Convert.ToString(dr[0]) + "\"" + ","
                                    + "\"" + Convert.ToString("SD") + "\"" + ":" + "\"" + Convert.ToString(dr[1]) + "\"" + ","
                                    + "\"" + Convert.ToString("CUSTPR") + "\"" + ":" + "\"" + Convert.ToString(dr[2]) + "\"" + ","
                                    + "\"" + Convert.ToString("INSPR") + "\"" + ":" + "\"" + Convert.ToString(dr[3]) + "\"" + ","
                                    + "\"" + Convert.ToString("DLRPR") + "\"" + ":" + "\"" + Convert.ToString(dr[4]) + "\"" + ","
                                    + "\"" + Convert.ToString("OEMPR") + "\"" + ":" + "\"" + Convert.ToString(dr[5]) + "\"" + "},";


                }
                if (cnter == 1)
                {
                    if (javascriptStr.Length > 1)
                        javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                }
                javascriptStr = javascriptStr + "]" + "}";

                Result = javascriptStr;

                if (dr != null)
                {
                    dr.Dispose();
                    dr = null;
                }
                Logger.SuccessLogPrint("GetSplitRatioJC", "SP_JCB_GET_SPLIT_RATIO", "'pn_user_id':'" + UserID1 + "','pn_parent_group':'" + parent_grp + "','pn_dealer_map_cd':'" + dealer_map_cd + "','pn_loc_Cd':'" + loc_cd + "','pn_comp_fa':'" + comp_fa + "','pn_bill_type_Cd':'" + bill_ty_cd + "','pn_source':'" + source, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));
            }
            else
            {

                string javascriptStr = "{";

                javascriptStr = javascriptStr
                                              + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                                              + "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;

            }
            //OBJ.Close();
        }
        catch (Exception EX)
        {
            OBJ.Close();
            //Result = ex.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("GetSplitRatioJC", "SP_JCB_GET_SPLIT_RATIO", "'pn_user_id':'" + UserID1 + "','pn_parent_group':'" + parent_grp + "','pn_dealer_map_cd':'" + dealer_map_cd + "','pn_loc_Cd':'" + loc_cd + "','pn_comp_fa':'" + comp_fa + "','pn_bill_type_Cd':'" + bill_ty_cd + "','pn_source':'" + source, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;
    }

    //added following fn on 19 aug 2015
    public string GetTechLabourJC(string UserID1, string parent_grp, Int32 dealer_map_cd, string loc_cd, string comp_fa)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();

            CMD = new OracleCommand("PKG_JCB_1.SP_JCB_GET_TECHNICIAN_LABOUR", OBJ);
            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(UserID1);
            CMD.Parameters.Add("pn_parent_group", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(parent_grp);
            CMD.Parameters.Add("pn_dealer_map_cd", OracleDbType.Int32, 20, ParameterDirection.Input).Value = Convert.ToInt32(dealer_map_cd);
            CMD.Parameters.Add("pn_loc_Cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(loc_cd);
            CMD.Parameters.Add("pn_comp_fa", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(comp_fa);

            CMD.Parameters.Add("po_tech_labour_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 2000).Direction = ParameterDirection.Output;
            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();

            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {
                int cnter = 0;
                OracleDataReader dr = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_tech_labour_refcur"].Value).GetDataReader();

                string javascriptStr = "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "0" + "\"" + ","
                + "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + ","
                + "\"" + Convert.ToString("GTCHLBR") + "\"" + ":" + "[";
                while (dr.Read())
                {
                    cnter = 1;
                    javascriptStr = javascriptStr + "{" + "\"" + Convert.ToString(dr[0]) + "\"" + ":" + "\"" + Convert.ToString(dr[1]) + "\"" + "}" + ",";
                }
                if (cnter == 1)
                {
                    if (javascriptStr.Length > 1)
                        javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                }
                javascriptStr = javascriptStr + "]" + "}";

                Result = javascriptStr;

                if (dr != null)
                {
                    dr.Dispose();
                    dr = null;
                }
                Logger.SuccessLogPrint("GetTechLabourJC", "SP_JCB_GET_TECHNICIAN_LABOUR", "'pn_user_id':'" + UserID1 + "','pn_parent_group':'" + parent_grp + "','pn_dealer_map_cd':'" + dealer_map_cd + "','pn_loc_Cd':'" + loc_cd + "','pn_comp_fa':'" + comp_fa, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));

            }
            else
            {
                string javascriptStr = "{";
                javascriptStr = javascriptStr
                    + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                    + "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;


            }
            //OBJ.Close();
        }
        catch (Exception EX)
        {
            OBJ.Close();

            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("GetTechLabourJC", "SP_JCB_GET_TECHNICIAN_LABOUR", "'pn_user_id':'" + UserID1 + "','pn_parent_group':'" + parent_grp + "','pn_dealer_map_cd':'" + dealer_map_cd + "','pn_loc_Cd':'" + loc_cd + "','pn_comp_fa':'" + comp_fa, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;
    }

    public string ValidateTchCmpRsJC(string UserID1, string parent_grp, Int32 dealer_map_cd, string loc_cd, string comp_fa, string jcno, string mul_ref_num, string reason_cd)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();

            CMD = new OracleCommand("PKG_JCB_1.SP_JCB_VALID_TECHCAMP_REASON", OBJ);

            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(UserID1);
            CMD.Parameters.Add("pn_parent_group", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(parent_grp);
            CMD.Parameters.Add("pn_dealer_map_cd", OracleDbType.Int32, 20, ParameterDirection.Input).Value = Convert.ToInt32(dealer_map_cd);
            CMD.Parameters.Add("pn_loc_Cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(loc_cd);
            CMD.Parameters.Add("pn_comp_fa", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(comp_fa);
            CMD.Parameters.Add("pn_jc_no", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(jcno);
            CMD.Parameters.Add("pn_mul_ref_num", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(mul_ref_num);
            CMD.Parameters.Add("pn_reason_Cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(reason_cd);

            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 2000).Direction = ParameterDirection.Output;
            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();


            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {
                string javascriptStr = "{";
                javascriptStr = javascriptStr + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                                          + "\"" + Convert.ToString("M") + "\""
                                          + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;
                Logger.SuccessLogPrint("ValidateTchCmpRsJC", "SP_JCB_VALID_TECHCAMP_REASON", "'pn_user_id':'" + UserID1 + "','pn_parent_group':'" + parent_grp + "','pn_dealer_map_cd':'" + dealer_map_cd + "','pn_loc_Cd':'" + loc_cd + "','pn_comp_fa':'" + comp_fa + "','pn_jc_no':'" + jcno + "','pn_mul_ref_num':'" + mul_ref_num + "','pn_reason_Cd':'" + reason_cd, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));

            }
            else
            {
                string javascriptStr = "{";
                javascriptStr = javascriptStr + "\"" + Convert.ToString("S") + "\"" + ":"
                                           + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                                          + "\"" + Convert.ToString("M") + "\""
                                          + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;



            }

            //OBJ.Close();

        }
        catch (Exception EX)
        {
            OBJ.Close();
            //Result = EX.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("ValidateTchCmpRsJC", "SP_JCB_VALID_TECHCAMP_REASON", "'pn_user_id':'" + UserID1 + "','pn_parent_group':'" + parent_grp + "','pn_dealer_map_cd':'" + dealer_map_cd + "','pn_loc_Cd':'" + loc_cd + "','pn_comp_fa':'" + comp_fa + "','pn_jc_no':'" + jcno + "','pn_mul_ref_num':'" + mul_ref_num + "','pn_reason_Cd':'" + reason_cd, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;

    }

    public string GetTchCampLbrJC(string UserID1, string parent_grp, Int32 dealer_map_cd, string loc_cd, string comp_fa, string jcno)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();
            CMD = new OracleCommand("PKG_JCB_1.SP_JCB_GET_TECHCAMP_LABOUR", OBJ);

            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(UserID1);
            CMD.Parameters.Add("pn_parent_group", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(parent_grp);
            CMD.Parameters.Add("pn_dealer_map_cd", OracleDbType.Int32, 20, ParameterDirection.Input).Value = Convert.ToInt32(dealer_map_cd);
            CMD.Parameters.Add("pn_loc_Cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(loc_cd);
            CMD.Parameters.Add("pn_comp_fa", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(comp_fa);
            CMD.Parameters.Add("pn_jc_no", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(jcno);

            CMD.Parameters.Add("po_tech_lbr_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();

            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {
                OracleDataReader dr = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_tech_lbr_refcur"].Value).GetDataReader();
                string javascriptStr = "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "0" + "\"" + ","
                + "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + ","
                + "\"" + "TCHCMPLBR" + "\"" + ":" + "[";
                int cnter = 0;
                while (dr.Read())
                {

                    cnter = 1;
                    javascriptStr = javascriptStr
                                    + "{" + "\"" + Convert.ToString("OPRCD") + "\"" + ":" + "\"" + Convert.ToString(dr[0]) + "\"" + ","
                                    + "\"" + Convert.ToString("OPRNAME") + "\"" + ":" + "\"" + Convert.ToString(dr[1]) + "\"" + ","
                                    + "\"" + Convert.ToString("FLATAMT") + "\"" + ":" + "\"" + Convert.ToString(dr[2]) + "\"" + ","
                                    + "\"" + Convert.ToString("FLATRHRS") + "\"" + ":" + "\"" + Convert.ToString(dr[3]) + "\"" + ","
                                    + "\"" + Convert.ToString("LMYN") + "\"" + ":" + "\"" + Convert.ToString(dr[4]) + "\"" + ","
                                    + "\"" + Convert.ToString("OPRAMT") + "\"" + ":" + "\"" + Convert.ToString(dr[5]) + "\"" + ","
                                    + "\"" + Convert.ToString("OPRTYPE") + "\"" + ":" + "\"" + Convert.ToString(dr[6]) + "\"" + ","
                                    + "\"" + Convert.ToString("MULRFNM") + "\"" + ":" + "\"" + Convert.ToString(dr[7]) + "\"" + "},";


                }
                if (cnter == 1)
                {
                    if (javascriptStr.Length > 1)
                        javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                }
                javascriptStr = javascriptStr + "]" + "}";

                Result = javascriptStr;

                if (dr != null)
                {
                    dr.Dispose();
                    dr = null;
                }
                Logger.SuccessLogPrint("GetTchCampLbrJC", "SP_JCB_GET_TECHCAMP_LABOUR", "'pn_user_id':'" + UserID1 + "','pn_parent_group':'" + parent_grp + "','pn_dealer_map_cd':'" + dealer_map_cd + "','pn_loc_Cd':'" + loc_cd + "','pn_comp_fa':'" + comp_fa + "','pn_jc_no':'" + jcno, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));


            }
            else
            {

                string javascriptStr = "{";

                javascriptStr = javascriptStr
                + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                + "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;

            }
            //OBJ.Close();
        }
        catch (Exception EX)
        {
            OBJ.Close();
            //Result = ex.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("GetTchCampLbrJC", "SP_JCB_GET_TECHCAMP_LABOUR", "'pn_user_id':'" + UserID1 + "','pn_parent_group':'" + parent_grp + "','pn_dealer_map_cd':'" + dealer_map_cd + "','pn_loc_Cd':'" + loc_cd + "','pn_comp_fa':'" + comp_fa + "','pn_jc_no':'" + jcno, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;
    }

    public string UpdateJobCardClose(string UserID1, string parent_grp, Int32 dealer_map_cd, string loc_cd, string comp_fa, string jcno,
                                  string srv_cat_cd, string sub_srv_type_cd, string sa_adv, string tech_adv, string bay_cd, string group_cd, string tech_cd,
                    string demand_ins_str, string repair_ins_str, string part_ins_str, string labor_ins_str, string mcard_ins_str, string tcamp_ins_str,
                    string pickup_type, string pickup_date, string free_pikcup_flag, string pickup_loc_cd, string pickup_driver, string pikcup_remarks, string mms_num,
                    Double rtest_startime, Double rtest_startkm, Double rtest_endtime, Double rtest_endkm)
    {

        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();

            CMD = new OracleCommand("PKG_JCB_1.SP_JCB_UPDATE_CLOSING_DTL", OBJ);

            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(UserID1);
            CMD.Parameters.Add("pn_parent_group", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(parent_grp);
            CMD.Parameters.Add("pn_dealer_map_cd", OracleDbType.Int32, 20, ParameterDirection.Input).Value = Convert.ToInt32(dealer_map_cd);
            CMD.Parameters.Add("pn_loc_Cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(loc_cd);
            CMD.Parameters.Add("pn_comp_fa", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(comp_fa);
            CMD.Parameters.Add("pn_jc_num", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(jcno);

            CMD.Parameters.Add("pn_srv_cat_cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(srv_cat_cd);
            CMD.Parameters.Add("pn_sub_srv_type_cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(sub_srv_type_cd);
            CMD.Parameters.Add("pn_sa_adv", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(sa_adv);
            CMD.Parameters.Add("pn_tech_adv", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(tech_adv);
            CMD.Parameters.Add("pn_bay_cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(bay_cd);
            CMD.Parameters.Add("pn_group_cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(group_cd);
            CMD.Parameters.Add("pn_tech_cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(tech_cd);
            //cursor variables seperated by $
            CMD.Parameters.Add("pn_demand_ins_str", OracleDbType.Varchar2, 500, ParameterDirection.Input).Value = Convert.ToString(demand_ins_str);
            CMD.Parameters.Add("pn_repair_ins_str", OracleDbType.Varchar2, 500, ParameterDirection.Input).Value = Convert.ToString(repair_ins_str);
            CMD.Parameters.Add("pn_part_ins_str", OracleDbType.Varchar2, 500, ParameterDirection.Input).Value = Convert.ToString(part_ins_str);
            CMD.Parameters.Add("pn_labor_ins_str", OracleDbType.Varchar2, 500, ParameterDirection.Input).Value = Convert.ToString(labor_ins_str);
            CMD.Parameters.Add("pn_mcard_ins_str", OracleDbType.Varchar2, 500, ParameterDirection.Input).Value = Convert.ToString(mcard_ins_str);
            CMD.Parameters.Add("pn_tcamp_ins_str", OracleDbType.Varchar2, 500, ParameterDirection.Input).Value = Convert.ToString(tcamp_ins_str);
            //------
            CMD.Parameters.Add("pn_pickup_type", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(pickup_type);
            CMD.Parameters.Add("pn_pickup_date", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(pickup_date);
            CMD.Parameters.Add("pn_free_pikcup_flag", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(free_pikcup_flag);
            CMD.Parameters.Add("pn_pickup_loc_cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(pickup_loc_cd);
            CMD.Parameters.Add("pn_pickup_driver", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(pickup_driver);
            CMD.Parameters.Add("pn_pikcup_remarks", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(pikcup_remarks);
            CMD.Parameters.Add("pn_mms_num", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(mms_num);

            CMD.Parameters.Add("pn_rtest_startime", OracleDbType.Double, ParameterDirection.Input).Value = Convert.ToString(rtest_startime);
            CMD.Parameters.Add("pn_rtest_startkm", OracleDbType.Double, ParameterDirection.Input).Value = Convert.ToString(rtest_startkm);
            CMD.Parameters.Add("pn_rtest_endtime", OracleDbType.Double, ParameterDirection.Input).Value = Convert.ToString(rtest_endtime);
            CMD.Parameters.Add("pn_rtest_endkm", OracleDbType.Double, ParameterDirection.Input).Value = Convert.ToString(rtest_endkm);

            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 2000).Direction = ParameterDirection.Output;
            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();


            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {
                string javascriptStr = "{";
                javascriptStr = javascriptStr + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                                          + "\"" + Convert.ToString("M") + "\""
                                          + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;

                Logger.SuccessLogPrint("UpdateJobCardClose", "SP_JCB_UPDATE_CLOSING_DTL", "'pn_user_id':'" + UserID1 + "','pn_parent_group':'" + parent_grp + "','pn_dealer_map_cd':'" + dealer_map_cd + "','pn_loc_Cd':'" + loc_cd + "','pn_comp_fa':'" + comp_fa + "','pn_jc_num':'"
                    + jcno + "','pn_srv_cat_cd':'" + srv_cat_cd + "','pn_sub_srv_type_cd':'" + sub_srv_type_cd + "','pn_sa_adv':'" + sa_adv + "','pn_tech_adv':'" + tech_adv + "','pn_bay_cd':'" + bay_cd + "','pn_group_cd':'" + group_cd + "','pn_tech_cd':'" + tech_cd
                    + "','pn_demand_ins_str':'" + demand_ins_str + "','pn_repair_ins_str':'" + repair_ins_str + "','pn_part_ins_str':'" + part_ins_str + "','pn_labor_ins_str':'" + labor_ins_str + "','pn_mcard_ins_str':'" + mcard_ins_str + "','pn_tcamp_ins_str':'"
                    + tcamp_ins_str + "','pn_pickup_type':'" + pickup_type + "','pn_pickup_date':'" + pickup_date + "','pn_free_pikcup_flag':'" + free_pikcup_flag + "','pn_pickup_loc_cd':'" + pickup_loc_cd + "','pn_pickup_driver':'" + pickup_driver + "','pn_pikcup_remarks':'"
                    + pikcup_remarks + "','pn_mms_num':'" + mms_num + "','pn_rtest_startime':'" + rtest_startime + "','pn_rtest_startkm':'" + rtest_startkm + "','pn_rtest_endtime':'" + rtest_endtime + "','pn_rtest_endkm':'" + rtest_endkm, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value)
                    + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));

            }
            else
            {
                string javascriptStr = "{";
                javascriptStr = javascriptStr + "\"" + Convert.ToString("S") + "\"" + ":"
                                           + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                                          + "\"" + Convert.ToString("M") + "\""
                                          + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";


                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;

            }

            //OBJ.Close();

        }
        catch (Exception EX)
        {
            OBJ.Close();
            //Result = EX.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("UpdateJobCardClose", "SP_JCB_UPDATE_CLOSING_DTL", "'pn_user_id':'" + UserID1 + "','pn_parent_group':'" + parent_grp + "','pn_dealer_map_cd':'" + dealer_map_cd + "','pn_loc_Cd':'" + loc_cd + "','pn_comp_fa':'" + comp_fa + "','pn_jc_num':'"
                   + jcno + "','pn_srv_cat_cd':'" + srv_cat_cd + "','pn_sub_srv_type_cd':'" + sub_srv_type_cd + "','pn_sa_adv':'" + sa_adv + "','pn_tech_adv':'" + tech_adv + "','pn_bay_cd':'" + bay_cd + "','pn_group_cd':'" + group_cd + "','pn_tech_cd':'" + tech_cd
                   + "','pn_demand_ins_str':'" + demand_ins_str + "','pn_repair_ins_str':'" + repair_ins_str + "','pn_part_ins_str':'" + part_ins_str + "','pn_labor_ins_str':'" + labor_ins_str + "','pn_mcard_ins_str':'" + mcard_ins_str + "','pn_tcamp_ins_str':'"
                   + tcamp_ins_str + "','pn_pickup_type':'" + pickup_type + "','pn_pickup_date':'" + pickup_date + "','pn_free_pikcup_flag':'" + free_pikcup_flag + "','pn_pickup_loc_cd':'" + pickup_loc_cd + "','pn_pickup_driver':'" + pickup_driver + "','pn_pikcup_remarks':'"
                   + pikcup_remarks + "','pn_mms_num':'" + mms_num + "','pn_rtest_startime':'" + rtest_startime + "','pn_rtest_startkm':'" + rtest_startkm + "','pn_rtest_endtime':'" + rtest_endtime + "','pn_rtest_endkm':'" + rtest_endkm, EX);
        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;

    }


    public string GetJobCardClose(string UserID1, string parent_grp, Int32 dealer_map_cd, string loc_cd, string comp_fa, string jcno,
                                  string srv_cat_cd, string sub_srv_type_cd, string sa_adv, string tech_adv, string bay_cd, string group_cd, string tech_cd,
                    string demand_ins_str, string repair_ins_str, string part_ins_str, string labor_ins_str, string mcard_ins_str, string tcamp_ins_str,
                    string pickup_type, string pickup_date, string free_pikcup_flag, string pickup_loc_cd, string pickup_driver, string pikcup_remarks, string mms_num,
                    Double rtest_startime, Double rtest_startkm, Double rtest_endtime, Double rtest_endkm,
                    string delay_reas_cd, string delay_reas_rem, string csi_reas_cd, string csi_reas_rem)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();

            CMD = new OracleCommand("PKG_JCB_1.SP_JCB_CLOSE_JOBCARD", OBJ);

            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(UserID1);
            CMD.Parameters.Add("pn_parent_group", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(parent_grp);
            CMD.Parameters.Add("pn_dealer_map_cd", OracleDbType.Int32, 20, ParameterDirection.Input).Value = Convert.ToInt32(dealer_map_cd);
            CMD.Parameters.Add("pn_loc_Cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(loc_cd);
            CMD.Parameters.Add("pn_comp_fa", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(comp_fa);
            CMD.Parameters.Add("pn_jc_num", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(jcno);

            CMD.Parameters.Add("pn_srv_cat_cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(srv_cat_cd);
            CMD.Parameters.Add("pn_sub_srv_type_cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(sub_srv_type_cd);
            CMD.Parameters.Add("pn_sa_adv", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(sa_adv);
            CMD.Parameters.Add("pn_tech_adv", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(tech_adv);
            CMD.Parameters.Add("pn_bay_cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(bay_cd);
            CMD.Parameters.Add("pn_group_cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(group_cd);
            CMD.Parameters.Add("pn_tech_cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(tech_cd);
            //cursor variables seperated by $
            CMD.Parameters.Add("pn_demand_ins_str", OracleDbType.Varchar2, 500, ParameterDirection.Input).Value = Convert.ToString(demand_ins_str);
            CMD.Parameters.Add("pn_repair_ins_str", OracleDbType.Varchar2, 500, ParameterDirection.Input).Value = Convert.ToString(repair_ins_str);
            CMD.Parameters.Add("pn_part_ins_str", OracleDbType.Varchar2, 500, ParameterDirection.Input).Value = Convert.ToString(part_ins_str);
            CMD.Parameters.Add("pn_labor_ins_str", OracleDbType.Varchar2, 500, ParameterDirection.Input).Value = Convert.ToString(labor_ins_str);
            CMD.Parameters.Add("pn_mcard_ins_str", OracleDbType.Varchar2, 500, ParameterDirection.Input).Value = Convert.ToString(mcard_ins_str);
            CMD.Parameters.Add("pn_tcamp_ins_str", OracleDbType.Varchar2, 500, ParameterDirection.Input).Value = Convert.ToString(tcamp_ins_str);
            //------
            CMD.Parameters.Add("pn_pickup_type", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(pickup_type);
            CMD.Parameters.Add("pn_pickup_date", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(pickup_date);
            CMD.Parameters.Add("pn_free_pikcup_flag", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(free_pikcup_flag);
            CMD.Parameters.Add("pn_pickup_loc_cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(pickup_loc_cd);
            CMD.Parameters.Add("pn_pickup_driver", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(pickup_driver);
            CMD.Parameters.Add("pn_pikcup_remarks", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(pikcup_remarks);
            CMD.Parameters.Add("pn_mms_num", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(mms_num);

            CMD.Parameters.Add("pn_rtest_startime", OracleDbType.Double, ParameterDirection.Input).Value = Convert.ToString(rtest_startime);
            CMD.Parameters.Add("pn_rtest_startkm", OracleDbType.Double, ParameterDirection.Input).Value = Convert.ToString(rtest_startkm);
            CMD.Parameters.Add("pn_rtest_endtime", OracleDbType.Double, ParameterDirection.Input).Value = Convert.ToString(rtest_endtime);
            CMD.Parameters.Add("pn_rtest_endkm", OracleDbType.Double, ParameterDirection.Input).Value = Convert.ToString(rtest_endkm);

            CMD.Parameters.Add("pn_delay_reas_cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(delay_reas_cd);
            CMD.Parameters.Add("pn_delay_reas_rem", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(delay_reas_rem);
            CMD.Parameters.Add("pn_csi_reas_cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(csi_reas_cd);
            CMD.Parameters.Add("pn_csi_reas_rem", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(csi_reas_rem);

            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 2000).Direction = ParameterDirection.Output;
            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();


            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {
                string javascriptStr = "{";
                javascriptStr = javascriptStr + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                                          + "\"" + Convert.ToString("M") + "\""
                                          + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;
                Logger.SuccessLogPrint("GetJobCardClose", "SP_JCB_CLOSE_JOBCARD", "'pn_user_id':'" + UserID1 + "','pn_parent_group':'" + parent_grp + "','pn_dealer_map_cd':'" + dealer_map_cd + "','pn_loc_Cd':'" + loc_cd + "','pn_comp_fa':'"
                    + comp_fa + "','pn_jc_num':'" + jcno + "','pn_srv_cat_cd':'" + srv_cat_cd + "','pn_sub_srv_type_cd':'" + sub_srv_type_cd + "','pn_sa_adv':'" + sa_adv + "','pn_tech_adv':'" + tech_adv + "','pn_bay_cd':'" + bay_cd
                    + "','pn_group_cd':'" + group_cd + "','pn_tech_cd':'" + tech_cd + "','pn_demand_ins_str':'" + demand_ins_str + "','pn_repair_ins_str':'" + repair_ins_str + "','pn_part_ins_str':'" + part_ins_str + "','pn_labor_ins_str':'"
                    + labor_ins_str + "','pn_mcard_ins_str':'" + mcard_ins_str + "','pn_tcamp_ins_str':'" + tcamp_ins_str + "','pn_pickup_type':'" + pickup_type + "','pn_pickup_date':'" + pickup_date + "','pn_free_pikcup_flag':'" + free_pikcup_flag + "','pn_pickup_loc_cd':'"
                    + pickup_loc_cd + "','pn_pickup_driver':'" + pickup_driver + "','pn_pikcup_remarks':'" + pikcup_remarks + "','pn_mms_num':'" + mms_num + "','pn_rtest_startime':'" + rtest_startime + "','pn_rtest_startkm':'" + rtest_startkm + "','pn_rtest_endtime':'" + rtest_endtime
                    + "','pn_rtest_endkm':'" + rtest_endkm + "','pn_delay_reas_cd':'" + delay_reas_cd + "','pn_delay_reas_rem':'" + delay_reas_rem + "','pn_csi_reas_cd':'" + csi_reas_cd + "','pn_csi_reas_rem':'" + csi_reas_rem, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value)
                   + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));

            }
            else
            {
                string javascriptStr = "{";
                javascriptStr = javascriptStr + "\"" + Convert.ToString("S") + "\"" + ":"
                                           + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                                          + "\"" + Convert.ToString("M") + "\""
                                          + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";


                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;

            }

            //OBJ.Close();

        }
        catch (Exception EX)
        {
            OBJ.Close();
            //Result = EX.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("GetJobCardClose", "SP_JCB_CLOSE_JOBCARD", "'pn_user_id':'" + UserID1 + "','pn_parent_group':'" + parent_grp + "','pn_dealer_map_cd':'" + dealer_map_cd + "','pn_loc_Cd':'" + loc_cd + "','pn_comp_fa':'"
                  + comp_fa + "','pn_jc_num':'" + jcno + "','pn_srv_cat_cd':'" + srv_cat_cd + "','pn_sub_srv_type_cd':'" + sub_srv_type_cd + "','pn_sa_adv':'" + sa_adv + "','pn_tech_adv':'" + tech_adv + "','pn_bay_cd':'" + bay_cd
                  + "','pn_group_cd':'" + group_cd + "','pn_tech_cd':'" + tech_cd + "','pn_demand_ins_str':'" + demand_ins_str + "','pn_repair_ins_str':'" + repair_ins_str + "','pn_part_ins_str':'" + part_ins_str + "','pn_labor_ins_str':'"
                  + labor_ins_str + "','pn_mcard_ins_str':'" + mcard_ins_str + "','pn_tcamp_ins_str':'" + tcamp_ins_str + "','pn_pickup_type':'" + pickup_type + "','pn_pickup_date':'" + pickup_date + "','pn_free_pikcup_flag':'" + free_pikcup_flag + "','pn_pickup_loc_cd':'"
                  + pickup_loc_cd + "','pn_pickup_driver':'" + pickup_driver + "','pn_pikcup_remarks':'" + pikcup_remarks + "','pn_mms_num':'" + mms_num + "','pn_rtest_startime':'" + rtest_startime + "','pn_rtest_startkm':'" + rtest_startkm + "','pn_rtest_endtime':'" + rtest_endtime
                  + "','pn_rtest_endkm':'" + rtest_endkm + "','pn_delay_reas_cd':'" + delay_reas_cd + "','pn_delay_reas_rem':'" + delay_reas_rem + "','pn_csi_reas_cd':'" + csi_reas_cd + "','pn_csi_reas_rem':'" + csi_reas_rem, EX);
        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;

    }

    //added following fn on 3 sep 2015
    public string GetPreinVoiceDetails(string UserID, string Jcno, string Parent_group, Int32 Dealer_map_cd, string Loc_Cd, string comp_fa)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();
            CMD = new OracleCommand("pkg_jcb_1.sp_jcb_preinv_print", OBJ);

            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(UserID);
            CMD.Parameters.Add("pn_jc_num", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(Jcno);
            CMD.Parameters.Add("pn_parent_group", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(Parent_group);
            CMD.Parameters.Add("pn_dealer_map_cd", OracleDbType.Int32, 10, ParameterDirection.Input).Value = Convert.ToString(Dealer_map_cd);
            CMD.Parameters.Add("pn_loc_cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(Loc_Cd);
            CMD.Parameters.Add("pn_comp_fa", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(comp_fa);

            CMD.Parameters.Add("po_reg_num", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_jc_date", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_cust_id", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_cust_name", OracleDbType.Varchar2, 50).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_cust_add", OracleDbType.Varchar2, 100).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_cust_res_phone", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_cust_off_phone", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_cust_mobile", OracleDbType.Varchar2, 15).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_car_user_name", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_email", OracleDbType.Varchar2, 50).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_chassis_num", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_model", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_mileage", OracleDbType.Double).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_sold_by", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_sold_date", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_ready_date", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_ew", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_service_type", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_next_srv_due", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_last_srv", OracleDbType.Varchar2, 50).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_sa_name", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            //--------------------

            //following are the cursors in o/p
            CMD.Parameters.Add("po_demand_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_part_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_labor_Refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;
            //----------------
            CMD.Parameters.Add("po_recomendations", OracleDbType.Varchar2, 50).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_dealer_name", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            //cursor in o/p
            CMD.Parameters.Add("po_bill_dtl_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;
            //------
            CMD.Parameters.Add("po_amc_diff_amt", OracleDbType.Double).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_bill_amt", OracleDbType.Double).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_bill_amt_in_word", OracleDbType.Varchar2, 100).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_unapproved_fit", OracleDbType.Varchar2, 800).Direction = ParameterDirection.Output;


            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;

            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();

            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {

                int cnter1 = 0;

                string javascriptStr = "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "0" + "\"" + "," + "\"" + "K" + "\"" + ":" + "[{";

                javascriptStr = javascriptStr

                //+ "\"" + Convert.ToString("RN") + "\"" + ":" + "\"" + CMD.Parameters["po_reg_num"].Value + "\"" + ","
                + "\"" + Convert.ToString("RN") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_reg_num"].Value)) + ","
                + "\"" + Convert.ToString("JD") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_jc_date"].Value)) + ","
                + "\"" + Convert.ToString("CID") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_cust_id"].Value)) + ","
                + "\"" + Convert.ToString("CNAME") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_cust_name"].Value)) + ","
                + "\"" + Convert.ToString("CADD") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_cust_add"].Value)) + ","
                + "\"" + Convert.ToString("CRP") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_cust_res_phone"].Value)) + ","
                + "\"" + Convert.ToString("COFP") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_cust_off_phone"].Value)) + ","
                + "\"" + Convert.ToString("CMP") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_cust_mobile"].Value)) + ","
                + "\"" + Convert.ToString("CUNAME") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_car_user_name"].Value)) + ","
                + "\"" + Convert.ToString("EMAIL") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_email"].Value)) + ","

                + "\"" + Convert.ToString("CHNUM") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_chassis_num"].Value)) + ","
                + "\"" + Convert.ToString("MODEL") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_model"].Value)) + ","
                + "\"" + Convert.ToString("MLG") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_mileage"].Value)) + ","
                + "\"" + Convert.ToString("SOLDBY") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_sold_by"].Value)) + ","
                + "\"" + Convert.ToString("SOLDT") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_sold_date"].Value)) + ","
                + "\"" + Convert.ToString("RDT") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_ready_date"].Value)) + ","
                + "\"" + Convert.ToString("EW") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_ew"].Value)) + ","
                + "\"" + Convert.ToString("SRVTP") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_service_type"].Value)) + ","
                + "\"" + Convert.ToString("NSRVD") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_next_srv_due"].Value)) + ","
                + "\"" + Convert.ToString("LASTSRV") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_last_srv"].Value)) + ","
                + "\"" + Convert.ToString("SANAME") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_sa_name"].Value)) + ","

                + "\"" + Convert.ToString("RCMND") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_recomendations"].Value)) + ","
                + "\"" + Convert.ToString("DNAME") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_dealer_name"].Value)) + ","
               + "\"" + Convert.ToString("ADA") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_amc_diff_amt"].Value)) + ","
               + "\"" + Convert.ToString("BAMT") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_bill_amt"].Value)) + ","
               + "\"" + Convert.ToString("BAMTW") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_bill_amt_in_word"].Value)) + ","
               + "\"" + Convert.ToString("UAFT") + "\"" + ":" + "\"" + CMD.Parameters["po_unapproved_fit"].Value + "\"" + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);

                javascriptStr = javascriptStr + "}]" + ",";
                //-------------------------------
                OracleDataReader dr1 = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_demand_refcur"].Value).GetDataReader();
                javascriptStr += "\"" + "DRF" + "\"" + ":" + "[";
                while (dr1.Read())
                {
                    javascriptStr += "{" + "\"" + Convert.ToString("SN") + "\"" + ":" + "\"" + Convert.ToString(dr1[0]) + "\"" + ","
                    + "\"" + Convert.ToString("DD") + "\"" + ":" + "\"" + Convert.ToString(dr1[1]) + "\"" + ","
                    + "\"" + Convert.ToString("FD") + "\"" + ":" + "\"" + Convert.ToString(dr1[2]) + "\"" + ","
                    + "\"" + Convert.ToString("AD") + "\"" + ":" + "\"" + Convert.ToString(dr1[3]) + "\"" + "}" + ",";

                    cnter1 = 2;
                }
                if (cnter1 == 2)
                {
                    if (javascriptStr.Length > 1)
                        javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                }
                javascriptStr = javascriptStr + "]" + ",";

                //-------------------------------
                OracleDataReader dr2 = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_part_refcur"].Value).GetDataReader();
                javascriptStr += "\"" + "PRF" + "\"" + ":" + "[";
                while (dr2.Read())
                {
                    javascriptStr += "{" + "\"" + Convert.ToString("SN") + "\"" + ":" + "\"" + Convert.ToString(dr2[0]) + "\"" + ","
                    + "\"" + Convert.ToString("PN") + "\"" + ":" + "\"" + Convert.ToString(dr2[1]) + "\"" + ","
                    + "\"" + Convert.ToString("PD") + "\"" + ":" + "\"" + Convert.ToString(dr2[2]) + "\"" + ","
                    + "\"" + Convert.ToString("QTY") + "\"" + ":" + "\"" + Convert.ToString(dr2[3]) + "\"" + ","
                    + "\"" + Convert.ToString("RATE") + "\"" + ":" + "\"" + Convert.ToString(dr2[4]) + "\"" + ","
                    + "\"" + Convert.ToString("TAXAMT") + "\"" + ":" + "\"" + Convert.ToString(dr2[5]) + "\"" + ","
                    + "\"" + Convert.ToString("TAXPAMT") + "\"" + ":" + "\"" + Convert.ToString(dr2[6]) + "\"" + ","
                    + "\"" + Convert.ToString("BT") + "\"" + ":" + "\"" + Convert.ToString(dr2[7]) + "\"" + ","
                    + "\"" + Convert.ToString("SCHFLG") + "\"" + ":" + "\"" + Convert.ToString(dr2[8]) + "\"" + ","
                    + "\"" + Convert.ToString("SCHFLGDSC") + "\"" + ":" + "\"" + Convert.ToString(dr2[9]) + "\"" + "}" + ",";

                    cnter1 = 3;
                }
                if (cnter1 == 3)
                {
                    if (javascriptStr.Length > 1)
                        javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                }
                javascriptStr = javascriptStr + "]" + ",";

                //-------------------------------
                OracleDataReader dr3 = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_labor_Refcur"].Value).GetDataReader();
                javascriptStr += "\"" + "LRF" + "\"" + ":" + "[";
                while (dr3.Read())
                {
                    javascriptStr += "{" + "\"" + Convert.ToString("SN") + "\"" + ":" + "\"" + Convert.ToString(dr3[0]) + "\"" + ","
                    + "\"" + Convert.ToString("LC") + "\"" + ":" + "\"" + Convert.ToString(dr3[1]) + "\"" + ","
                    + "\"" + Convert.ToString("LD") + "\"" + ":" + "\"" + Convert.ToString(dr3[2]) + "\"" + ","
                    + "\"" + Convert.ToString("LBT") + "\"" + ":" + "\"" + Convert.ToString(dr3[3]) + "\"" + ","
                     + "\"" + Convert.ToString("LCHRGS") + "\"" + ":" + "\"" + Convert.ToString(dr3[4]) + "\"" + ","
                      + "\"" + Convert.ToString("LSF") + "\"" + ":" + "\"" + Convert.ToString(dr3[5]) + "\"" + ","
                    + "\"" + Convert.ToString("LSD") + "\"" + ":" + "\"" + Convert.ToString(dr3[6]) + "\"" + "}" + ",";

                    cnter1 = 4;
                }
                if (cnter1 == 4)
                {
                    if (javascriptStr.Length > 1)
                        javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                }
                javascriptStr = javascriptStr + "]" + ",";

                //--------------------------------------------------			
                OracleDataReader dr4 = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_bill_dtl_refcur"].Value).GetDataReader();
                javascriptStr += "\"" + "BRF" + "\"" + ":" + "[";
                while (dr4.Read())
                {
                    javascriptStr += "{" + "\"" + Convert.ToString("HDR") + "\"" + ":" + "\"" + Convert.ToString(dr4[0]) + "\"" + ","
                    + "\"" + Convert.ToString("BTA") + "\"" + ":" + "\"" + Convert.ToString(dr4[1]) + "\"" + ","
                    + "\"" + Convert.ToString("BTPA") + "\"" + ":" + "\"" + Convert.ToString(dr4[2]) + "\"" + ","
                    + "\"" + Convert.ToString("BLCHR") + "\"" + ":" + "\"" + Convert.ToString(dr4[3]) + "\"" + "}" + ",";

                    cnter1 = 5;
                }
                if (cnter1 == 5)
                {
                    if (javascriptStr.Length > 1)
                        javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                }
                javascriptStr = javascriptStr + "]" + "}";

                Result = javascriptStr;

                if (dr1 != null)
                {
                    dr1.Dispose();
                    dr1 = null;
                }

                if (dr2 != null)
                {
                    dr2.Dispose();
                    dr2 = null;
                }

                if (dr3 != null)
                {
                    dr3.Dispose();
                    dr3 = null;
                }

                if (dr4 != null)
                {
                    dr4.Dispose();
                    dr4 = null;
                }
                Logger.SuccessLogPrint("GetPreinVoiceDetails", "sp_jcb_preinv_print", "'pn_user_id':'" + UserID + "','pn_jc_num':'" + Jcno + "','pn_parent_group':'" + Parent_group + "','pn_dealer_map_cd':'" + Dealer_map_cd + "','pn_comp_fa':'" + comp_fa + "','pn_loc_cd':'" + Loc_Cd, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));

            }
            else
            {
                string javascriptStr = "{";
                javascriptStr = javascriptStr + "\"" + Convert.ToString("S") + "\"" + ":"
                                           + "\"" + "1" + "\"" + ","
                                           + "\"" + Convert.ToString("M") + "\""
                                          + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;
            }
            //OBJ.Close();
        }
        catch (Exception EX)
        {
            OBJ.Close();
            //Result = ex.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("GetPreinVoiceDetails", "sp_jcb_preinv_print", "'pn_user_id':'" + UserID + "','pn_jc_num':'" + Jcno + "','pn_parent_group':'" + Parent_group + "','pn_dealer_map_cd':'" + Dealer_map_cd + "','pn_comp_fa':'" + comp_fa + "','pn_loc_cd':'" + Loc_Cd, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;

    }//-----------end of GetPreinVoiceDetails fn

    //------------------------------------------jco_close module fns ended here----------------

    //----------------jco_billing fns starts here 31 aug 2015-----------------------------------
    public string GetVehDelDtlJB(string UserID1, string parent_grp, Int32 dealer_map_cd, string loc_cd, string comp_fa)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();

            CMD = new OracleCommand("pkg_jcb_1.sp_jcb_get_veh_delivery_dtl", OBJ);
            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(UserID1);
            CMD.Parameters.Add("pn_parent_group", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(parent_grp);
            CMD.Parameters.Add("pn_dealer_map_cd", OracleDbType.Int32, 20, ParameterDirection.Input).Value = Convert.ToInt32(dealer_map_cd);
            CMD.Parameters.Add("pn_loc_Cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(loc_cd);
            CMD.Parameters.Add("pn_comp_fa", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(comp_fa);

            CMD.Parameters.Add("po_vehdel_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 2000).Direction = ParameterDirection.Output;
            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();

            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {
                int cnter = 0;
                OracleDataReader dr = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_vehdel_refcur"].Value).GetDataReader();

                string javascriptStr = "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "0" + "\"" + ","
                //+ "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + ","
                + "\"" + Convert.ToString("M") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_err_msg"].Value)) + ","
                + "\"" + Convert.ToString("VDDTL") + "\"" + ":" + "[";
                while (dr.Read())
                {
                    cnter = 1;
                    javascriptStr = javascriptStr + "{" + "\"" + Convert.ToString(dr[0]) + "\"" + ":" + "\"" + Convert.ToString(dr[1]) + "\"" + "}" + ",";
                }
                if (cnter == 1)
                {
                    if (javascriptStr.Length > 1)
                        javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                }
                javascriptStr = javascriptStr + "]" + "}";

                Result = javascriptStr;

                if (dr != null)
                {
                    dr.Dispose();
                    dr = null;
                }
                Logger.SuccessLogPrint("GetVehDelDtlJB", "sp_jcb_get_veh_delivery_dtl", "'pn_user_id':'" + UserID1 + "','pn_parent_group':'" + parent_grp + "','pn_dealer_map_cd':'" + dealer_map_cd
               + "','pn_loc_Cd':'" + loc_cd + "','pn_comp_fa':'" + comp_fa, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));

            }
            else
            {
                string javascriptStr = "{";
                javascriptStr = javascriptStr
                    + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                    + "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;

            }
            //OBJ.Close();
        }
        catch (Exception EX)
        {
            OBJ.Close();
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                                + "\"" + "1" + "\"" + ","
                                                + "\"" + Convert.ToString("M") + "\""
                                               + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("GetVehDelDtlJB", "sp_jcb_get_veh_delivery_dtl", "'pn_user_id':'" + UserID1 + "','pn_parent_group':'" + parent_grp + "','pn_dealer_map_cd':'" + dealer_map_cd
               + "','pn_loc_Cd':'" + loc_cd + "','pn_comp_fa':'" + comp_fa, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;

    }

    public string GetCashcreditJB()
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();

            CMD = new OracleCommand("pkg_jcb_1.SP_JCB_GET_CASH_CREDIT", OBJ);

            CMD.Parameters.Add("po_cash_crd_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 2000).Direction = ParameterDirection.Output;
            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();

            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {

                int cnter = 0;
                OracleDataReader dr = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_cash_crd_refcur"].Value).GetDataReader();

                string javascriptStr = "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "0" + "\"" + ","
                 //+ "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + ","
                 + "\"" + Convert.ToString("M") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_err_msg"].Value)) + ","
                + "\"" + Convert.ToString("CASHCREDIT") + "\"" + ":" + "[";
                while (dr.Read())
                {
                    cnter = 1;
                    javascriptStr = javascriptStr + "{" + "\"" + Convert.ToString(dr[0]) + "\"" + ":" + "\"" + Convert.ToString(dr[1]) + "\"" + "}" + ",";
                }
                if (cnter == 1)
                {
                    if (javascriptStr.Length > 1)
                        javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                }
                javascriptStr = javascriptStr + "]" + "}";

                Result = javascriptStr;

                if (dr != null)
                {
                    dr.Dispose();
                    dr = null;
                }
                Logger.SuccessLogPrint("GetCashcreditJB", "SP_JCB_GET_CASH_CREDIT", null, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));

            }
            else
            {

                string javascriptStr = "{";
                javascriptStr = javascriptStr
                    + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                    + "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;

            }
            //OBJ.Close();
        }
        catch (Exception EX)
        {
            OBJ.Close();

            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("GetCashcreditJB", "SP_JCB_GET_CASH_CREDIT", null, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;

    }

    public string GetEstVarRsnJB(string UserID1, string parent_grp, Int32 dealer_map_cd, string loc_cd, string comp_fa)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();

            CMD = new OracleCommand("pkg_jcb_1.SP_JCB_GET_EST_VAR_REASON", OBJ);
            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(UserID1);
            CMD.Parameters.Add("pn_parent_group", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(parent_grp);
            CMD.Parameters.Add("pn_dealer_map_cd", OracleDbType.Int32, 20, ParameterDirection.Input).Value = Convert.ToInt32(dealer_map_cd);
            CMD.Parameters.Add("pn_loc_Cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(loc_cd);
            CMD.Parameters.Add("pn_comp_fa", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(comp_fa);


            CMD.Parameters.Add("po_var_reas_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 2000).Direction = ParameterDirection.Output;
            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();


            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {
                int cnter = 0;
                OracleDataReader dr = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_var_reas_refcur"].Value).GetDataReader();

                string javascriptStr = "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "0" + "\"" + ","
                 //+ "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + ","
                 + "\"" + Convert.ToString("M") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_err_msg"].Value)) + ","
                + "\"" + Convert.ToString("VAREASRF") + "\"" + ":" + "[";
                while (dr.Read())
                {
                    cnter = 1;
                    javascriptStr = javascriptStr + "{" + "\"" + Convert.ToString(dr[0]) + "\"" + ":" + "\"" + Convert.ToString(dr[1]) + "\"" + "}" + ",";
                }
                if (cnter == 1)
                {
                    if (javascriptStr.Length > 1)
                        javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                }
                javascriptStr = javascriptStr + "]" + "}";

                Result = javascriptStr;

                if (dr != null)
                {
                    dr.Dispose();
                    dr = null;
                }
                Logger.SuccessLogPrint("GetEstVarRsnJB", "SP_JCB_GET_EST_VAR_REASON", "'pn_user_id':'" + UserID1 + "','pn_parent_group':'" + parent_grp + "','pn_dealer_map_cd':'" + dealer_map_cd + "','pn_loc_Cd':'" + loc_cd + "','pn_comp_fa':'" + comp_fa + "','pn_comp_fa':'" + comp_fa, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));

            }
            else
            {
                string javascriptStr = "{";
                javascriptStr = javascriptStr
                    + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                    + "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;

            }
            //OBJ.Close();
        }
        catch (Exception EX)
        {
            OBJ.Close();

            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                                + "\"" + "1" + "\"" + ","
                                                + "\"" + Convert.ToString("M") + "\""
                                               + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("GetEstVarRsnJB", "SP_JCB_GET_EST_VAR_REASON", "'pn_user_id':'" + UserID1 + "','pn_parent_group':'" + parent_grp + "','pn_dealer_map_cd':'" + dealer_map_cd + "','pn_loc_Cd':'" + loc_cd + "','pn_comp_fa':'" + comp_fa + "','pn_comp_fa':'" + comp_fa, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;

    }

    public string GetBillDlyRsJB(string UserID1, string parent_grp, Int32 dealer_map_cd, string loc_cd, string comp_fa)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();

            CMD = new OracleCommand("pkg_jcb_1.SP_JCB_GET_BILL_DELAY_REASON", OBJ);
            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(UserID1);
            CMD.Parameters.Add("pn_parent_group", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(parent_grp);
            CMD.Parameters.Add("pn_dealer_map_cd", OracleDbType.Int32, 20, ParameterDirection.Input).Value = Convert.ToInt32(dealer_map_cd);
            CMD.Parameters.Add("pn_loc_Cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(loc_cd);
            CMD.Parameters.Add("pn_comp_fa", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(comp_fa);

            CMD.Parameters.Add("po_del_reas_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 2000).Direction = ParameterDirection.Output;
            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();

            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {
                int cnter = 0;
                OracleDataReader dr = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_del_reas_refcur"].Value).GetDataReader();

                string javascriptStr = "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "0" + "\"" + ","
                //+ "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + ","
                + "\"" + Convert.ToString("M") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_err_msg"].Value)) + ","
                + "\"" + Convert.ToString("BDLYRS") + "\"" + ":" + "[";
                while (dr.Read())
                {
                    cnter = 1;
                    javascriptStr = javascriptStr + "{" + "\"" + Convert.ToString(dr[0]) + "\"" + ":" + "\"" + Convert.ToString(dr[1]) + "\"" + "}" + ",";
                }
                if (cnter == 1)
                {
                    if (javascriptStr.Length > 1)
                        javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                }
                javascriptStr = javascriptStr + "]" + "}";

                Result = javascriptStr;

                if (dr != null)
                {
                    dr.Dispose();
                    dr = null;
                }
                Logger.SuccessLogPrint("GetBillDlyRsJB", "SP_JCB_GET_BILL_DELAY_REASON", "'pn_user_id':'" + UserID1 + "','pn_parent_group':'" + parent_grp + "','pn_dealer_map_cd':'" + dealer_map_cd + "','pn_loc_Cd':'" + loc_cd + "','pn_comp_fa':'" + comp_fa, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));

            }
            else
            {
                string javascriptStr = "{";
                javascriptStr = javascriptStr
                    + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                    + "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;

            }
            //OBJ.Close();
        }
        catch (Exception EX)
        {
            OBJ.Close();

            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                                + "\"" + "1" + "\"" + ","
                                                + "\"" + Convert.ToString("M") + "\""
                                               + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("GetBillDlyRsJB", "SP_JCB_GET_BILL_DELAY_REASON", "'pn_user_id':'" + UserID1 + "','pn_parent_group':'" + parent_grp + "','pn_dealer_map_cd':'" + dealer_map_cd + "','pn_loc_Cd':'" + loc_cd + "','pn_comp_fa':'" + comp_fa, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;

    }

    public string GetSaleTypeJB(string UserID1, string parent_grp, Int32 dealer_map_cd, string loc_cd, string comp_fa)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();

            CMD = new OracleCommand("pkg_jcb_1.sp_jcb_get_saletype", OBJ);
            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(UserID1);
            CMD.Parameters.Add("pn_parent_group", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(parent_grp);
            CMD.Parameters.Add("pn_dealer_map_cd", OracleDbType.Int32, 20, ParameterDirection.Input).Value = Convert.ToInt32(dealer_map_cd);
            CMD.Parameters.Add("pn_loc_Cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(loc_cd);
            CMD.Parameters.Add("pn_comp_fa", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(comp_fa);

            CMD.Parameters.Add("po_saletype_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 2000).Direction = ParameterDirection.Output;
            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();

            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {
                int cnter = 0;
                OracleDataReader dr = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_saletype_refcur"].Value).GetDataReader();

                string javascriptStr = "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "0" + "\"" + ","
                // + "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + ","
                 + "\"" + Convert.ToString("M") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_err_msg"].Value)) + ","
                + "\"" + Convert.ToString("GSTYBLL") + "\"" + ":" + "[";
                while (dr.Read())
                {
                    cnter = 1;
                    javascriptStr = javascriptStr + "{" + "\"" + Convert.ToString(dr[0]) + "\"" + ":" + "\"" + Convert.ToString(dr[1]) + "\"" + "}" + ",";
                }
                if (cnter == 1)
                {
                    if (javascriptStr.Length > 1)
                        javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                }
                javascriptStr = javascriptStr + "]" + "}";

                Result = javascriptStr;
                if (dr != null)
                {
                    dr.Dispose();
                    dr = null;
                }
                Logger.SuccessLogPrint("GetSaleTypeJB", "sp_jcb_get_saletype", "'pn_user_id':'" + UserID1 + "','pn_parent_group':'" + parent_grp + "','pn_dealer_map_cd':'" + dealer_map_cd + "','pn_loc_Cd':'" + loc_cd + "','pn_comp_fa':'" + comp_fa, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));

            }
            else
            {
                string javascriptStr = "{";
                javascriptStr = javascriptStr
                    + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                    + "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;

            }
            //OBJ.Close();
        }
        catch (Exception EX)
        {
            OBJ.Close();

            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                                + "\"" + "1" + "\"" + ","
                                                + "\"" + Convert.ToString("M") + "\""
                                               + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("GetSaleTypeJB", "sp_jcb_get_saletype", "'pn_user_id':'" + UserID1 + "','pn_parent_group':'" + parent_grp + "','pn_dealer_map_cd':'" + dealer_map_cd + "','pn_loc_Cd':'" + loc_cd + "','pn_comp_fa':'" + comp_fa, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;

    }

    //added below fns on 2 sep 2015
    public string GetJcBillDtlJB(string UserID, string Parent_group, Int32 Dealer_map_cd, string Loc_Cd, string Comp_fa, string Jcno)
    {

        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();
            CMD = new OracleCommand("pkg_jcb_1.SP_JCB_GET_JC_BILL_DTL", OBJ);


            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(UserID);
            CMD.Parameters.Add("pn_parent_group", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(Parent_group);
            CMD.Parameters.Add("pn_dealer_map_cd", OracleDbType.Int32, 10, ParameterDirection.Input).Value = Convert.ToString(Dealer_map_cd);
            CMD.Parameters.Add("pn_loc_Cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(Loc_Cd);
            CMD.Parameters.Add("pn_comp_fa", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(Comp_fa);
            CMD.Parameters.Add("pn_jc_no", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(Jcno);


            //-------------------
            CMD.Parameters.Add("po_jc_close_date", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_sale_type", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_cash_credit", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_vin", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_reg_num", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;


            CMD.Parameters.Add("po_svar_cd", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_svar_desc", OracleDbType.Varchar2, 100).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_unappr_accs_yn", OracleDbType.Varchar2, 2).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_unauth_cnf_lpg_yn", OracleDbType.Varchar2, 50).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_cust_legal_status", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_cust_type", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_cust_cd", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_cust_name", OracleDbType.Varchar2, 50).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_inv_cust_cd", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_inv_cust_name", OracleDbType.Varchar2, 50).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_category", OracleDbType.Varchar2, 50).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_car_user_name", OracleDbType.Varchar2, 50).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_remarks", OracleDbType.Varchar2, 500).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_out_amt", OracleDbType.Double).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_pickup_type", OracleDbType.Varchar2, 50).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_pickup_type_desc", OracleDbType.Varchar2, 50).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_pickup_date", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_part_disc_per", OracleDbType.Double).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_labr_disc_per", OracleDbType.Double).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_disc_auth_by", OracleDbType.Varchar2, 50).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_disc_auth_desc", OracleDbType.Varchar2, 100).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_est_part_amt", OracleDbType.Double).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_est_labor_amt", OracleDbType.Double).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_est_tot_amt", OracleDbType.Double).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_est_sch_part_amt", OracleDbType.Double).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_est_sch_labor_amt", OracleDbType.Double).Direction = ParameterDirection.Output;
            //Response.Write("*************");
            //following are the cursors in o/p
            CMD.Parameters.Add("po_part_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_labor_Refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;

            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();

            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {

                int cnter1 = 0;

                string javascriptStr = "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "0" + "\"" + ","
                //+ "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + CMD.Parameters["po_err_msg"].Value + "\"" + ","
                + "\"" + Convert.ToString("M") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_err_msg"].Value)) + ","
                + "\"" + "K" + "\"" + ":" + "[{";

                javascriptStr = javascriptStr

                //+ "\"" + Convert.ToString("JCDT") + "\"" + ":" + "\"" + CMD.Parameters["po_jc_close_date"].Value + "\"" + ","
                + "\"" + Convert.ToString("JCDT") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_jc_close_date"].Value)) + ","
                + "\"" + Convert.ToString("STP") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_sale_type"].Value)) + ","
                + "\"" + Convert.ToString("CSCR") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_cash_credit"].Value)) + ","
                + "\"" + Convert.ToString("VIN") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_vin"].Value)) + ","
                + "\"" + Convert.ToString("REGN") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_reg_num"].Value)) + ","
                + "\"" + Convert.ToString("SVARCD") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_svar_cd"].Value)) + ","
                + "\"" + Convert.ToString("SVARD") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_svar_desc"].Value)) + ","
                + "\"" + Convert.ToString("UAYN") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_unappr_accs_yn"].Value)) + ","
                + "\"" + Convert.ToString("UCLY") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_unauth_cnf_lpg_yn"].Value)) + ","

                + "\"" + Convert.ToString("CLS") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_cust_legal_status"].Value)) + ","
                + "\"" + Convert.ToString("CT") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_cust_type"].Value)) + ","
                + "\"" + Convert.ToString("CD") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_cust_cd"].Value)) + ","
                + "\"" + Convert.ToString("CN") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_cust_name"].Value)) + ","

                + "\"" + Convert.ToString("ICD") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_inv_cust_cd"].Value)) + ","
                + "\"" + Convert.ToString("ICN") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_inv_cust_name"].Value)) + ","

                + "\"" + Convert.ToString("CTG") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_category"].Value)) + ","
                + "\"" + Convert.ToString("CUN") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_car_user_name"].Value)) + ","
                + "\"" + Convert.ToString("RM") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_remarks"].Value)) + ","

                + "\"" + Convert.ToString("OAMT") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_out_amt"].Value)) + ","
                + "\"" + Convert.ToString("PT") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_pickup_type"].Value)) + ","
                + "\"" + Convert.ToString("PTD") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_pickup_type_desc"].Value)) + ","
                + "\"" + Convert.ToString("PDT") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_pickup_date"].Value)) + ","

                + "\"" + Convert.ToString("PDP") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_part_disc_per"].Value)) + ","
                + "\"" + Convert.ToString("LDP") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_labr_disc_per"].Value)) + ","

                + "\"" + Convert.ToString("DAB") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_disc_auth_by"].Value)) + ","
                + "\"" + Convert.ToString("DAD") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_disc_auth_desc"].Value)) + ","

                + "\"" + Convert.ToString("EPA") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_est_part_amt"].Value)) + ","
                + "\"" + Convert.ToString("ELA") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_est_labor_amt"].Value)) + ","
                + "\"" + Convert.ToString("ETA") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_est_tot_amt"].Value)) + ","
                + "\"" + Convert.ToString("ESPA") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_est_sch_part_amt"].Value)) + ","
                + "\"" + Convert.ToString("ESLA") + "\"" + ":" + "\"" + CMD.Parameters["po_est_sch_labor_amt"].Value + "\"" + "\"";


                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);

                javascriptStr = javascriptStr + "}]" + ",";

                //-------------------------------
                OracleDataReader dr2 = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_part_refcur"].Value).GetDataReader();
                javascriptStr += "\"" + "PRF" + "\"" + ":" + "[";
                while (dr2.Read())
                {
                    javascriptStr += "{" + "\"" + Convert.ToString("PN") + "\"" + ":" + "\"" + Convert.ToString(dr2[0]) + "\"" + ","
                    + "\"" + Convert.ToString("PD") + "\"" + ":" + "\"" + Convert.ToString(dr2[1]) + "\"" + ","
                    + "\"" + Convert.ToString("QTY") + "\"" + ":" + "\"" + Convert.ToString(dr2[2]) + "\"" + ","
                    + "\"" + Convert.ToString("RATE") + "\"" + ":" + "\"" + Convert.ToString(dr2[3]) + "\"" + ","
                    + "\"" + Convert.ToString("IV") + "\"" + ":" + "\"" + Convert.ToString(dr2[4]) + "\"" + ","
                    + "\"" + Convert.ToString("TYP") + "\"" + ":" + "\"" + Convert.ToString(dr2[5]) + "\"" + ","
                    + "\"" + Convert.ToString("PER") + "\"" + ":" + "\"" + Convert.ToString(dr2[6]) + "\"" + ","
                    + "\"" + Convert.ToString("BSC") + "\"" + ":" + "\"" + Convert.ToString(dr2[7]) + "\"" + ","
                    + "\"" + Convert.ToString("DP") + "\"" + ":" + "\"" + Convert.ToString(dr2[8]) + "\"" + ","
                    + "\"" + Convert.ToString("DV") + "\"" + ":" + "\"" + Convert.ToString(dr2[9]) + "\"" + ","
                    + "\"" + Convert.ToString("DA") + "\"" + ":" + "\"" + Convert.ToString(dr2[10]) + "\"" + ","
                    + "\"" + Convert.ToString("DTC") + "\"" + ":" + "\"" + Convert.ToString(dr2[11]) + "\"" + ","
                    + "\"" + Convert.ToString("TA") + "\"" + ":" + "\"" + Convert.ToString(dr2[12]) + "\"" + ","
                    + "\"" + Convert.ToString("SETNO") + "\"" + ":" + "\"" + Convert.ToString(dr2[13]) + "\"" + ","
                    + "\"" + Convert.ToString("TCD") + "\"" + ":" + "\"" + Convert.ToString(dr2[14]) + "\"" + ","
                    + "\"" + Convert.ToString("TCDSC") + "\"" + ":" + "\"" + Convert.ToString(dr2[15]) + "\"" + "}" + ",";

                    cnter1 = 3;
                }
                if (cnter1 == 3)
                {
                    if (javascriptStr.Length > 1)
                        javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                }
                javascriptStr = javascriptStr + "]" + ",";

                //-------------------------------
                OracleDataReader dr3 = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_labor_refcur"].Value).GetDataReader();
                javascriptStr += "\"" + "LRF" + "\"" + ":" + "[";

                while (dr3.Read())
                {
                    cnter1 = 10;
                    javascriptStr += "{" + "\"" + Convert.ToString("LCD") + "\"" + ":" + "\"" + Convert.ToString(dr3[0]) + "\"" + ","
                 + "\"" + Convert.ToString("LDSC") + "\"" + ":" + "\"" + Convert.ToString(dr3[1]) + "\"" + ","
                 + "\"" + Convert.ToString("FHRS") + "\"" + ":" + "\"" + Convert.ToString(dr3[2]) + "\"" + ","
                 + "\"" + Convert.ToString("COMPER") + "\"" + ":" + "\"" + Convert.ToString(dr3[3]) + "\"" + ","
                 + "\"" + Convert.ToString("NP") + "\"" + ":" + "\"" + Convert.ToString(dr3[4]) + "\"" + ","
                 + "\"" + Convert.ToString("LAMT") + "\"" + ":" + "\"" + Convert.ToString(dr3[5]) + "\"" + ","
                 + "\"" + Convert.ToString("LTYP") + "\"" + ":" + "\"" + Convert.ToString(dr3[6]) + "\"" + ","
                 + "\"" + Convert.ToString("LPER") + "\"" + ":" + "\"" + Convert.ToString(dr3[7]) + "\"" + ","
                 + "\"" + Convert.ToString("LBSC") + "\"" + ":" + "\"" + Convert.ToString(dr3[8]) + "\"" + ","
                 + "\"" + Convert.ToString("LDSCP") + "\"" + ":" + "\"" + Convert.ToString(dr3[9]) + "\"" + ","
                 + "\"" + Convert.ToString("LDSCV") + "\"" + ":" + "\"" + Convert.ToString(dr3[10]) + "\"" + ","
                 + "\"" + Convert.ToString("LDSCA") + "\"" + ":" + "\"" + Convert.ToString(dr3[11]) + "\"" + ","
                 + "\"" + Convert.ToString("LDSCHG") + "\"" + ":" + "\"" + Convert.ToString(dr3[12]) + "\"" + ","
                 + "\"" + Convert.ToString("LTA") + "\"" + ":" + "\"" + Convert.ToString(dr3[13]) + "\"" + ","
                 + "\"" + Convert.ToString("LSETNO") + "\"" + ":" + "\"" + Convert.ToString(dr3[14]) + "\"" + ","
                 + "\"" + Convert.ToString("LTCD") + "\"" + ":" + "\"" + Convert.ToString(dr3[15]) + "\"" + ","
                 + "\"" + Convert.ToString("LTCDSC") + "\"" + ":" + "\"" + Convert.ToString(dr3[16]) + "\"" + "}" + ",";

                }

                if (cnter1 == 10)
                {
                    if (javascriptStr.Length > 1)
                        javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                }

                javascriptStr = javascriptStr + "]" + "}";

                Result = javascriptStr;

                if (dr3 != null)
                {
                    dr3.Dispose();
                    dr3 = null;
                }

                if (dr2 != null)
                {
                    dr2.Dispose();
                    dr2 = null;
                }
                Logger.SuccessLogPrint("GetJcBillDtlJB", "SP_JCB_GET_JC_BILL_DTL", "'pn_user_id':'" + UserID + "','pn_parent_group':'" + Parent_group + "','pn_dealer_map_cd':'" + Dealer_map_cd + "','pn_loc_Cd':'" + Loc_Cd + "','pn_comp_fa':'" + Comp_fa + "','pn_jc_no':'" + Jcno, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));


            }
            else
            {
                string javascriptStr = "{";
                javascriptStr = javascriptStr + "\"" + Convert.ToString("S") + "\"" + ":"
                                           + "\"" + "1" + "\"" + ","
                                           + "\"" + Convert.ToString("M") + "\""
                                          + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;
            }
            //OBJ.Close();


        }
        catch (Exception EX)
        {
            OBJ.Close();

            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("GetJcBillDtlJB", "SP_JCB_GET_JC_BILL_DTL", "'pn_user_id':'" + UserID + "','pn_parent_group':'" + Parent_group + "','pn_dealer_map_cd':'" + Dealer_map_cd + "','pn_loc_Cd':'" + Loc_Cd + "','pn_comp_fa':'" + Comp_fa + "','pn_jc_no':'" + Jcno, EX);


        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;

    }//-----------end of GetJcBillDtlJB fn


    public string CalculateBillJB(string UserID, string Parent_group, Int32 Dealer_map_cd, string Loc_Cd, string Comp_fa, string Jcno,
                                  string cashcr, string saletyp, string inv_cust_cd, string ins_name, string ins_party_cd, Int32 cus_part_disc,
                                  Int32 cus_lab_disc, string credit_card, string credit_card_num, string disc_auth_by,
                                  string part_ins_str, string labor_ins_str
                                  )
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();
            CMD = new OracleCommand("pkg_jcb_1.SP_JCB_CALCULATE_BILL", OBJ);


            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(UserID);
            CMD.Parameters.Add("pn_parent_group", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(Parent_group);
            CMD.Parameters.Add("pn_dealer_map_cd", OracleDbType.Int32, 10, ParameterDirection.Input).Value = Convert.ToString(Dealer_map_cd);
            CMD.Parameters.Add("pn_loc_Cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(Loc_Cd);
            CMD.Parameters.Add("pn_comp_fa", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(Comp_fa);
            CMD.Parameters.Add("pn_jc_no", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(Jcno);
            CMD.Parameters.Add("pn_cash_credit", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(cashcr);
            CMD.Parameters.Add("pn_sale_type", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(saletyp);
            CMD.Parameters.Add("pn_inv_cust_cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(inv_cust_cd);
            CMD.Parameters.Add("pn_ins_name", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(ins_name);
            CMD.Parameters.Add("pn_ins_party_cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(ins_party_cd);
            CMD.Parameters.Add("pn_cus_part_disc", OracleDbType.Int32, 10, ParameterDirection.Input).Value = Convert.ToString(cus_part_disc);
            CMD.Parameters.Add("pn_cus_lab_disc", OracleDbType.Int32, 10, ParameterDirection.Input).Value = Convert.ToString(cus_lab_disc);

            CMD.Parameters.Add("pn_credit_card", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(credit_card);
            CMD.Parameters.Add("pn_credit_card_num", OracleDbType.Varchar2, 50, ParameterDirection.Input).Value = Convert.ToString(credit_card_num);
            CMD.Parameters.Add("pn_disc_auth_by", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(disc_auth_by);
            CMD.Parameters.Add("pn_part_ins_str", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(part_ins_str);
            CMD.Parameters.Add("pn_labor_ins_str", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(labor_ins_str);

            //-------------------
            CMD.Parameters.Add("po_act_part_amt", OracleDbType.Double).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_act_labor_amt", OracleDbType.Double).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_act_tot_amt", OracleDbType.Double).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_round_off", OracleDbType.Double).Direction = ParameterDirection.Output;

            //following are the cursors in o/p
            CMD.Parameters.Add("po_bill_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_part_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_labor_Refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;

            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();

            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {

                int cnter1 = 0;

                string javascriptStr = "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "0" + "\"" + ","
                //+ "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + CMD.Parameters["po_err_msg"].Value + "\"" + ","
                + "\"" + Convert.ToString("M") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_err_msg"].Value)) + ","
                + "\"" + "K" + "\"" + ":" + "[{";

                javascriptStr = javascriptStr

                + "\"" + Convert.ToString("APAMT") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_act_part_amt"].Value)) + ","
                + "\"" + Convert.ToString("ALAMT") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_act_labor_amt"].Value)) + ","
                + "\"" + Convert.ToString("ATAMT") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_act_tot_amt"].Value)) + ","
                + "\"" + Convert.ToString("RNDOFF") + "\"" + ":" + "\"" + CMD.Parameters["po_round_off"].Value + "\"" + "\"";


                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);

                javascriptStr = javascriptStr + "}]" + ",";
                //-------------------------------
                OracleDataReader dr1 = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_bill_refcur"].Value).GetDataReader();
                javascriptStr += "\"" + "BRF" + "\"" + ":" + "[";
                while (dr1.Read())
                {
                    javascriptStr += "{" + "\"" + Convert.ToString("RIT") + "\"" + ":" + "\"" + Convert.ToString(dr1[0]) + "\"" + ","
                    + "\"" + Convert.ToString("PBA") + "\"" + ":" + "\"" + Convert.ToString(dr1[1]) + "\"" + ","
                    + "\"" + Convert.ToString("PTD") + "\"" + ":" + "\"" + Convert.ToString(dr1[2]) + "\"" + ","
                     + "\"" + Convert.ToString("PTC") + "\"" + ":" + "\"" + Convert.ToString(dr1[3]) + "\"" + ","
                    + "\"" + Convert.ToString("PTA") + "\"" + ":" + "\"" + Convert.ToString(dr1[4]) + "\"" + ","
                    + "\"" + Convert.ToString("LBA") + "\"" + ":" + "\"" + Convert.ToString(dr1[5]) + "\"" + ","
                    + "\"" + Convert.ToString("LTD") + "\"" + ":" + "\"" + Convert.ToString(dr1[6]) + "\"" + ","
                    + "\"" + Convert.ToString("LTC") + "\"" + ":" + "\"" + Convert.ToString(dr1[7]) + "\"" + ","
                    + "\"" + Convert.ToString("LTA") + "\"" + ":" + "\"" + Convert.ToString(dr1[8]) + "\"" + ","
                    + "\"" + Convert.ToString("SETNO") + "\"" + ":" + "\"" + Convert.ToString(dr1[9]) + "\"" + "}" + ",";

                    cnter1 = 2;
                }
                if (cnter1 == 2)
                {
                    if (javascriptStr.Length > 1)
                        javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                }
                javascriptStr = javascriptStr + "]" + ",";

                //-------------------------------
                OracleDataReader dr2 = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_part_refcur"].Value).GetDataReader();
                javascriptStr += "\"" + "PRF" + "\"" + ":" + "[";
                while (dr2.Read())
                {
                    javascriptStr += "{" + "\"" + Convert.ToString("SRL") + "\"" + ":" + "\"" + Convert.ToString(dr2[0]) + "\"" + ","
                    + "\"" + Convert.ToString("PN") + "\"" + ":" + "\"" + Convert.ToString(dr2[1]) + "\"" + ","
                    + "\"" + Convert.ToString("PD") + "\"" + ":" + "\"" + Convert.ToString(dr2[2]) + "\"" + ","
                    + "\"" + Convert.ToString("QTY") + "\"" + ":" + "\"" + Convert.ToString(dr2[3]) + "\"" + ","
                    + "\"" + Convert.ToString("RATE") + "\"" + ":" + "\"" + Convert.ToString(dr2[4]) + "\"" + ","
                    + "\"" + Convert.ToString("IV") + "\"" + ":" + "\"" + Convert.ToString(dr2[5]) + "\"" + ","
                    + "\"" + Convert.ToString("BT") + "\"" + ":" + "\"" + Convert.ToString(dr2[6]) + "\"" + ","
                    + "\"" + Convert.ToString("BP") + "\"" + ":" + "\"" + Convert.ToString(dr2[7]) + "\"" + ","
                    + "\"" + Convert.ToString("BB") + "\"" + ":" + "\"" + Convert.ToString(dr2[8]) + "\"" + ","
                    + "\"" + Convert.ToString("DI") + "\"" + ":" + "\"" + Convert.ToString(dr2[9]) + "\"" + "}" + ",";

                    cnter1 = 3;
                }
                if (cnter1 == 3)
                {
                    if (javascriptStr.Length > 1)
                        javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                }
                javascriptStr = javascriptStr + "]" + ",";

                //-------------------------------
                OracleDataReader dr3 = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_labor_refcur"].Value).GetDataReader();
                javascriptStr += "\"" + "LRF" + "\"" + ":" + "[";

                while (dr3.Read())
                {
                    cnter1 = 10;
                    javascriptStr += "{" + "\"" + Convert.ToString("SRL") + "\"" + ":" + "\"" + Convert.ToString(dr3[0]) + "\"" + ","
                 + "\"" + Convert.ToString("LCD") + "\"" + ":" + "\"" + Convert.ToString(dr3[1]) + "\"" + ","
                 + "\"" + Convert.ToString("LDSC") + "\"" + ":" + "\"" + Convert.ToString(dr3[2]) + "\"" + ","
                 + "\"" + Convert.ToString("FHRS") + "\"" + ":" + "\"" + Convert.ToString(dr3[3]) + "\"" + ","
                 + "\"" + Convert.ToString("COMPER") + "\"" + ":" + "\"" + Convert.ToString(dr3[4]) + "\"" + ","
                 + "\"" + Convert.ToString("NP") + "\"" + ":" + "\"" + Convert.ToString(dr3[5]) + "\"" + ","
                 + "\"" + Convert.ToString("LAMT") + "\"" + ":" + "\"" + Convert.ToString(dr3[6]) + "\"" + ","
                 + "\"" + Convert.ToString("BT") + "\"" + ":" + "\"" + Convert.ToString(dr3[7]) + "\"" + ","
                 + "\"" + Convert.ToString("BP") + "\"" + ":" + "\"" + Convert.ToString(dr3[8]) + "\"" + ","
                 + "\"" + Convert.ToString("BB") + "\"" + ":" + "\"" + Convert.ToString(dr3[9]) + "\"" + ","
                 + "\"" + Convert.ToString("DI") + "\"" + ":" + "\"" + Convert.ToString(dr3[10]) + "\"" + ","
                 + "\"" + Convert.ToString("DID") + "\"" + ":" + "\"" + Convert.ToString(dr3[11]) + "\"" + ","
                 + "\"" + Convert.ToString("DV") + "\"" + ":" + "\"" + Convert.ToString(dr3[12]) + "\"" + ","
                 + "\"" + Convert.ToString("DAMT") + "\"" + ":" + "\"" + Convert.ToString(dr3[13]) + "\"" + ","
                 + "\"" + Convert.ToString("TAXCH") + "\"" + ":" + "\"" + Convert.ToString(dr3[14]) + "\"" + ","
                 + "\"" + Convert.ToString("TAXAMT") + "\"" + ":" + "\"" + Convert.ToString(dr3[15]) + "\"" + ","
                 + "\"" + Convert.ToString("TAXCAT") + "\"" + ":" + "\"" + Convert.ToString(dr3[16]) + "\"" + ","

                 + "\"" + Convert.ToString("SETNO") + "\"" + ":" + "\"" + Convert.ToString(dr3[17]) + "\"" + "}" + ",";
                }

                if (cnter1 == 10)
                {
                    if (javascriptStr.Length > 1)
                        javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                }

                javascriptStr = javascriptStr + "]" + "}";

                Result = javascriptStr;

                if (dr1 != null)
                {
                    dr1.Dispose();
                    dr1 = null;
                }

                if (dr2 != null)
                {
                    dr2.Dispose();
                    dr2 = null;
                }

                if (dr3 != null)
                {
                    dr3.Dispose();
                    dr3 = null;
                }
                Logger.SuccessLogPrint("CalculateBillJB", "SP_JCB_CALCULATE_BILL", "'pn_user_id':'" + UserID + "','pn_parent_group':'" + Parent_group + "','pn_dealer_map_cd':'" + Dealer_map_cd + "','pn_loc_Cd':'" + Loc_Cd + "','pn_comp_fa':'" + Comp_fa + "','pn_jc_no':'" + Jcno + "','pn_cash_credit':'" + cashcr + "','pn_sale_type':'"
                    + saletyp + "','pn_inv_cust_cd':'" + inv_cust_cd + "','pn_ins_name':'" + ins_name + "','pn_ins_party_cd':'" + ins_party_cd + "','pn_cus_part_disc':'" + cus_part_disc + "','pn_cus_lab_disc':'" + cus_lab_disc + "','pn_credit_card':'" + credit_card + "','pn_credit_card_num':'" + credit_card_num + "','pn_disc_auth_by':'"
                    + disc_auth_by + "','pn_part_ins_str':'" + part_ins_str + "','pn_labor_ins_str':'" + labor_ins_str, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));


            }
            else
            {
                string javascriptStr = "{";
                javascriptStr = javascriptStr + "\"" + Convert.ToString("S") + "\"" + ":"
                                           + "\"" + "1" + "\"" + ","
                                           + "\"" + Convert.ToString("M") + "\""
                                          + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;
            }
            //OBJ.Close();
        }
        catch (Exception EX)
        {
            OBJ.Close();

            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("CalculateBillJB", "SP_JCB_CALCULATE_BILL", "'pn_user_id':'" + UserID + "','pn_parent_group':'" + Parent_group + "','pn_dealer_map_cd':'" + Dealer_map_cd + "','pn_loc_Cd':'" + Loc_Cd + "','pn_comp_fa':'" + Comp_fa + "','pn_jc_no':'" + Jcno + "','pn_cash_credit':'" + cashcr + "','pn_sale_type':'"
                    + saletyp + "','pn_inv_cust_cd':'" + inv_cust_cd + "','pn_ins_name':'" + ins_name + "','pn_ins_party_cd':'" + ins_party_cd + "','pn_cus_part_disc':'" + cus_part_disc + "','pn_cus_lab_disc':'" + cus_lab_disc + "','pn_credit_card':'" + credit_card + "','pn_credit_card_num':'" + credit_card_num + "','pn_disc_auth_by':'"
                    + disc_auth_by + "','pn_part_ins_str':'" + part_ins_str + "','pn_labor_ins_str':'" + labor_ins_str, EX);
        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;

    }//-----------end of CalculateBillJB fn

    //added these fn on 4 sep 2015

    public string GenerateBillJB(string UserID, string Parent_group, Int32 Dealer_map_cd, string Loc_Cd, string Comp_fa, string Jcno,
                                  string cashcr, string saletyp, string inv_cust_cd, string ins_name, string ins_party_cd, Int32 cus_part_disc,
                                  Int32 cus_lab_disc, string credit_card, string credit_card_num, string disc_auth_by,
                                  string pickup_type, string pickup_date, string veh_delvd_by, string est_var_reas_cd,
                                  string bill_delay_reas_cd, string bill_delay_remarks, string bill_remarks,
                                  string part_ins_str, string labor_ins_str)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();
            CMD = new OracleCommand("pkg_jcb_1.SP_JCB_GENERATE_BILL", OBJ);

            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(UserID);
            CMD.Parameters.Add("pn_parent_group", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(Parent_group);
            CMD.Parameters.Add("pn_dealer_map_cd", OracleDbType.Int32, 10, ParameterDirection.Input).Value = Convert.ToString(Dealer_map_cd);
            CMD.Parameters.Add("pn_loc_Cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(Loc_Cd);
            CMD.Parameters.Add("pn_comp_fa", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(Comp_fa);
            CMD.Parameters.Add("pn_jc_no", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(Jcno);
            CMD.Parameters.Add("pn_cash_credit", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(cashcr);
            CMD.Parameters.Add("pn_sale_type", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(saletyp);
            CMD.Parameters.Add("pn_inv_cust_cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(inv_cust_cd);
            CMD.Parameters.Add("pn_ins_name", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(ins_name);
            CMD.Parameters.Add("pn_ins_party_cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(ins_party_cd);
            CMD.Parameters.Add("pn_cus_part_disc", OracleDbType.Int32, 10, ParameterDirection.Input).Value = Convert.ToString(cus_part_disc);
            CMD.Parameters.Add("pn_cus_lab_disc", OracleDbType.Int32, 10, ParameterDirection.Input).Value = Convert.ToString(cus_lab_disc);

            CMD.Parameters.Add("pn_credit_card", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(credit_card);
            CMD.Parameters.Add("pn_credit_card_num", OracleDbType.Varchar2, 50, ParameterDirection.Input).Value = Convert.ToString(credit_card_num);
            CMD.Parameters.Add("pn_disc_auth_by", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(disc_auth_by);

            CMD.Parameters.Add("pn_pickup_type", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(pickup_type);
            CMD.Parameters.Add("pn_pickup_date", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(pickup_date);
            CMD.Parameters.Add("pn_veh_delvd_by", OracleDbType.Varchar2, 50, ParameterDirection.Input).Value = Convert.ToString(veh_delvd_by);
            CMD.Parameters.Add("pn_est_var_reas_cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(est_var_reas_cd);
            CMD.Parameters.Add("pn_bill_delay_reas_cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(bill_delay_reas_cd);
            CMD.Parameters.Add("pn_bill_delay_remarks", OracleDbType.Varchar2, 100, ParameterDirection.Input).Value = Convert.ToString(bill_delay_remarks);
            CMD.Parameters.Add("pn_bill_remarks", OracleDbType.Varchar2, 100, ParameterDirection.Input).Value = Convert.ToString(bill_remarks);
            CMD.Parameters.Add("pn_part_ins_str", OracleDbType.Varchar2, 500, ParameterDirection.Input).Value = Convert.ToString(part_ins_str);
            CMD.Parameters.Add("pn_labor_ins_str", OracleDbType.Varchar2, 500, ParameterDirection.Input).Value = Convert.ToString(labor_ins_str);

            //following are the cursors in o/p
            CMD.Parameters.Add("po_bill_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;
            //-----
            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;

            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();

            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {

                int cnter1 = 0;

                string javascriptStr = "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "0" + "\"" + ","
                                     + "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + CMD.Parameters["po_err_msg"].Value + "\"";

                //-------------------------------
                OracleDataReader dr1 = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_bill_refcur"].Value).GetDataReader();
                javascriptStr += "\"" + "BRF" + "\"" + ":" + "[";
                while (dr1.Read())
                {
                    javascriptStr += "{" + "\"" + Convert.ToString("RIT") + "\"" + ":" + "\"" + Convert.ToString(dr1[0]) + "\"" + ","
                    + "\"" + Convert.ToString("PBA") + "\"" + ":" + "\"" + Convert.ToString(dr1[1]) + "\"" + ","
                    + "\"" + Convert.ToString("PTD") + "\"" + ":" + "\"" + Convert.ToString(dr1[2]) + "\"" + ","
                     + "\"" + Convert.ToString("PTC") + "\"" + ":" + "\"" + Convert.ToString(dr1[3]) + "\"" + ","
                    + "\"" + Convert.ToString("PTA") + "\"" + ":" + "\"" + Convert.ToString(dr1[4]) + "\"" + ","
                    + "\"" + Convert.ToString("LBA") + "\"" + ":" + "\"" + Convert.ToString(dr1[5]) + "\"" + ","
                    + "\"" + Convert.ToString("LTD") + "\"" + ":" + "\"" + Convert.ToString(dr1[6]) + "\"" + ","
                    + "\"" + Convert.ToString("LTC") + "\"" + ":" + "\"" + Convert.ToString(dr1[7]) + "\"" + ","
                    + "\"" + Convert.ToString("LTA") + "\"" + ":" + "\"" + Convert.ToString(dr1[8]) + "\"" + ","
                    + "\"" + Convert.ToString("SETNO") + "\"" + ":" + "\"" + Convert.ToString(dr1[9]) + "\"" + "}" + ",";

                    cnter1 = 2;
                }
                if (cnter1 == 2)
                {
                    if (javascriptStr.Length > 1)
                        javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                }

                javascriptStr = javascriptStr + "]" + "}";

                Result = javascriptStr;
                if (dr1 != null)
                {
                    dr1.Dispose();
                    dr1 = null;
                }
                Logger.SuccessLogPrint("GenerateBillJB", "SP_JCB_GENERATE_BILL", "'pn_user_id':'" + UserID + "','pn_parent_group':'" + Parent_group + "','pn_dealer_map_cd':'" + Dealer_map_cd + "','pn_loc_Cd':'" + Loc_Cd + "','pn_comp_fa':'" + Comp_fa + "','pn_jc_no':'" + Jcno + "', 'pn_cash_credit':'" + cashcr + "', 'pn_sale_type':'" + saletyp + "', 'pn_inv_cust_cd':'" + inv_cust_cd + "', 'pn_ins_name':'" + ins_name
                    + "','pn_ins_party_cd':'" + ins_party_cd + "', 'pn_cus_part_disc':'" + cus_part_disc + "', 'pn_cus_lab_disc':'" + cus_lab_disc + "', 'pn_credit_card':'"
                    + credit_card + "', 'pn_credit_card_num':'" + credit_card_num + "', 'pn_disc_auth_by':'" + disc_auth_by + "','pn_pickup_type':'" + pickup_type + "', 'pn_pickup_date':'"
                    + pickup_date + "', 'pn_veh_delvd_by':'" + veh_delvd_by + "', 'pn_est_var_reas_cd':'" + est_var_reas_cd + "', 'pn_bill_delay_reas_cd':'" + bill_delay_reas_cd + "', 'pn_bill_delay_remarks':'"
                    + bill_delay_remarks + "', 'pn_bill_remarks':'" + bill_remarks + "', 'pn_part_ins_str':'" + part_ins_str + "', 'pn_labor_ins_str':'" + labor_ins_str, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));

            }
            else
            {
                string javascriptStr = "{";
                javascriptStr = javascriptStr + "\"" + Convert.ToString("S") + "\"" + ":"
                                           + "\"" + "1" + "\"" + ","
                                           //+ "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";
                                           + "\"" + Convert.ToString("M") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_err_msg"].Value)) + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;
            }
            //OBJ.Close();
        }
        catch (Exception EX)
        {
            OBJ.Close();

            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("GenerateBillJB", "SP_JCB_GENERATE_BILL", "'pn_user_id':'" + UserID + "','pn_parent_group':'" + Parent_group + "','pn_dealer_map_cd':'" + Dealer_map_cd + "','pn_loc_Cd':'" + Loc_Cd + "','pn_comp_fa':'" + Comp_fa + "','pn_jc_no':'" + Jcno + "', 'pn_cash_credit':'" + cashcr + "', 'pn_sale_type':'" + saletyp + "', 'pn_inv_cust_cd':'" + inv_cust_cd + "', 'pn_ins_name':'" + ins_name
                    + "','pn_ins_party_cd':'" + ins_party_cd + "', 'pn_cus_part_disc':'" + cus_part_disc + "', 'pn_cus_lab_disc':'" + cus_lab_disc + "', 'pn_credit_card':'"
                    + credit_card + "', 'pn_credit_card_num':'" + credit_card_num + "', 'pn_disc_auth_by':'" + disc_auth_by + "','pn_pickup_type':'" + pickup_type + "', 'pn_pickup_date':'"
                    + pickup_date + "', 'pn_veh_delvd_by':'" + veh_delvd_by + "', 'pn_est_var_reas_cd':'" + est_var_reas_cd + "', 'pn_bill_delay_reas_cd':'" + bill_delay_reas_cd + "', 'pn_bill_delay_remarks':'"
                    + bill_delay_remarks + "', 'pn_bill_remarks':'" + bill_remarks + "', 'pn_part_ins_str':'" + part_ins_str + "', 'pn_labor_ins_str':'" + labor_ins_str, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;

    }//-----------end of GenerateBillJB fn 
     //--------------------------------------------------------jco_billing fns ends here -----------------------------------

    //---------------------xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxEND OF GST NEW FNS xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx-----------------------


    public string MCP(string parentGroup, string dealerCd, string locCd, string regNum, string milage)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        OracleDataReader dr = null;
        try
        {
            OBJ.Open();
            CMD = new OracleCommand("PKG_NJCO.SP_GET_NJCO_MCP", OBJ);

            CMD.Parameters.Add("pn_parent", OracleDbType.Varchar2, 100, ParameterDirection.Input).Value = Convert.ToString(parentGroup);
            CMD.Parameters.Add("pn_dealer_cd", OracleDbType.Int16, 10, ParameterDirection.Input).Value = Convert.ToInt16(dealerCd);
            CMD.Parameters.Add("pn_loc_cd", OracleDbType.Varchar2, 100, ParameterDirection.Input).Value = Convert.ToString(locCd);
            CMD.Parameters.Add("pn_reg_num", OracleDbType.Varchar2, 100, ParameterDirection.Input).Value = Convert.ToString(regNum);
            CMD.Parameters.Add("pn_omr", OracleDbType.Int32, 10, ParameterDirection.Input).Value = Convert.ToInt32(milage);

            CMD.Parameters.Add("po_mcp_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();

            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {
                dr = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_mcp_refcur"].Value).GetDataReader();

                string javascriptStr = "[ ";
                while (dr.Read())
                {
                    javascriptStr = javascriptStr
                                        + "{\"" + Convert.ToString("code") + "\"" + ":" + "\"" + Convert.ToString(dr["pkg_code"]) + "\"" + ","
                                        + "\"" + Convert.ToString("desc") + "\"" + ":" + "\"" + Convert.ToString(dr["pkg_desc"]) + "\"" + ","
                                        + "\"" + Convert.ToString("startDate1") + "\"" + ":" + "\"" + Convert.ToString(dr["mcp_start_date"]) + "\"" + ","
                                        + "\"" + Convert.ToString("expiryDate1") + "\"" + ":" + "\"" + Convert.ToString(dr["mcp_expiry_date"]) + "\"" + ","
                                        + "\"" + Convert.ToString("startDate") + "\"" + ":" + "\"" + (dr["mcp_start_date"] != DBNull.Value ? Convert.ToDateTime(dr["mcp_start_date"]).ToString("dd-MMM-yyyy") : "") + "\"" + ","
                                        + "\"" + Convert.ToString("expiryDate") + "\"" + ":" + "\"" + (dr["mcp_expiry_date"] != DBNull.Value ? Convert.ToDateTime(dr["mcp_expiry_date"]).ToString("dd-MMM-yyyy") : "") + "\"" + ","
                                        + "\"" + Convert.ToString("price") + "\"" + ":" + "\"" + Convert.ToString(dr["price"]) + "\""
                                        + "},";

                }
                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "]";
                Result = javascriptStr;
                Logger.SuccessLogPrint("MCP", "SP_GET_NJCO_MCP", "'pn_parent':'" + parentGroup + "','pn_dealer_cd':'" + dealerCd + "','pn_dealer_map_cd':'" + locCd + "','pn_reg_num':'" + regNum + "','pn_omr':'" + milage, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));

            }

            else
            {
                string javascriptStr = "{";
                javascriptStr = javascriptStr + "\"" + Convert.ToString("S") + "\"" + ":"
                                           + "\"" + "1" + "\"" + ","
                                           + "\"" + Convert.ToString("M") + "\""
                                          + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;
            }
        }
        catch (Exception EX)
        {
            OBJ.Close();
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("MCP", "SP_GET_NJCO_MCP", "'pn_parent':'" + parentGroup + "','pn_dealer_cd':'" + dealerCd + "','pn_dealer_map_cd':'" + locCd + "','pn_reg_num':'" + regNum + "','pn_omr':'" + milage, EX);

        }
        finally
        {

            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (dr != null)
            {
                dr.Dispose();
                dr = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;
    }

    public string WashTypes()
    {
        StringBuilder log = new StringBuilder();
        log.AppendLine("Wash Types Service");
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        OracleDataReader dr = null;
        try
        {
            log.AppendLine("OBJ.Open");
            OBJ.Open();
            CMD = new OracleCommand("pkg_jco_1.sp_jco_get_wash_type", OBJ);

            //CMD.Parameters.Add("pn_pmc", OracleDbType.Int16, 20, ParameterDirection.Input).Value = 1;

            CMD.Parameters.Add("po_wash_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 2000).Direction = ParameterDirection.Output;
            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();
            log.AppendLine("Execute Non Query");
            //string errCd = Convert.ToString(CMD.Parameters["po_err_cd"].Value);
            string errCd = Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "null" ? string.Empty : Convert.ToString(CMD.Parameters["po_err_cd"].Value);
            //if (errCd.Equals(string.Empty, StringComparison.InvariantCultureIgnoreCase) || errCd.Equals("0", StringComparison.InvariantCultureIgnoreCase))
            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0" || Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "null")
            {
                log.AppendLine("No Error");
                dr = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_wash_refcur"].Value).GetDataReader();

                string javascriptStr = "[ ";
                while (dr.Read())
                {
                    javascriptStr = javascriptStr
                                        + "{\"" + Convert.ToString("LIST_CODE") + "\"" + ":" + "\"" + Convert.ToString(dr["LIST_CODE"]) + "\"" + ","
                                        + "\"" + Convert.ToString("LIST_DESC") + "\"" + ":" + "\"" + Convert.ToString(dr["LIST_DESC"]) + "\""
                                        + "},";

                }
                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "]";
                Result = javascriptStr;
                Logger.SuccessLogPrint("WashTypes", "sp_jco_get_wash_type", null, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));

            }
            else
            {
                log.Append("Executed: Error Code::::");
                log.AppendLine(Convert.ToString(CMD.Parameters["po_err_cd"].Value) != "null" ? Convert.ToString(CMD.Parameters["po_err_cd"].Value) : Convert.ToString(CMD.Parameters["po_err_cd"].Value));
                log.Append("Error Message::::");
                log.AppendLine(Convert.ToString(CMD.Parameters["po_err_msg"].Value) != "null" ? Convert.ToString(CMD.Parameters["po_err_msg"].Value) : string.Empty);

                string javascriptStr = "{";
                javascriptStr = javascriptStr + "\"" + Convert.ToString("S") + "\"" + ":"
                                           + "\"" + "1" + "\"" + ","
                                           + "\"" + Convert.ToString("M") + "\""
                                          //+ ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + ","
                                          + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_err_msg"].Value)) + ","
                                          + "\"" + Convert.ToString("L") + "\"" + ":" + "\"" + log.ToString() + "\"" + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;
            }
        }
        catch (Exception EX)
        {
            log.AppendLine("Exception: Raised...");
            log.AppendLine(EX.Message);
            OBJ.Close();
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + ","
                                           + "\"" + Convert.ToString("L") + "\"" + ":" + "\"" + log.ToString() + "\"" + "}";
            Logger.ErrorLogException("WashTypes", "sp_jco_get_wash_type", null, EX);

        }
        finally
        {

            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (dr != null)
            {
                dr.Dispose();
                dr = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }

            if (log != null)
            {
                log = null;
            }
        }
        return Result;
    }

    public string EW(string vin)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        OracleDataReader dr = null;
        try
        {
            OBJ.Open();
            CMD = new OracleCommand("PKG_NJCO.SP_GET_NJCO_EWAR", OBJ);

            CMD.Parameters.Add("pn_pmc", OracleDbType.Int16, 20, ParameterDirection.Input).Value = 1;
            CMD.Parameters.Add("pn_vin", OracleDbType.Varchar2, 22, ParameterDirection.Input).Value = Convert.ToString(vin);

            CMD.Parameters.Add("po_ewar_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 2000).Direction = ParameterDirection.Output;
            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();

            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {
                dr = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_ewar_refcur"].Value).GetDataReader();

                string javascriptStr = "[ ";
                while (dr.Read())
                {
                    javascriptStr = javascriptStr
                                        + "{\"" + Convert.ToString("ewtype") + "\"" + ":" + "\"" + Convert.ToString(dr["ew_type"]) + "\"" + ","
                                        + "\"" + Convert.ToString("ewtypedesc") + "\"" + ":" + "\"" + Convert.ToString(dr["ew_type_desc"]) + "\"" + ","
                                        + "\"" + Convert.ToString("ewrprice") + "\"" + ":" + "\"" + Convert.ToString(dr["ewr_price"]) + "\"" + ","
                                        + "\"" + Convert.ToString("ewrexpirydate") + "\"" + ":" + "\"" + Convert.ToString(dr["ewr_expiry_date"]) + "\"" + ","
                                        + "\"" + Convert.ToString("ewrexpirydate1") + "\"" + ":" + "\"" + (dr["ewr_expiry_date"] != DBNull.Value ? Convert.ToDateTime(dr["ewr_expiry_date"]).ToString("dd-MMM-yyyy") : "") + "\"" + ","
                                        + "\"" + Convert.ToString("ewrexpirymileage") + "\"" + ":" + "\"" + Convert.ToString(dr["ewr_expiry_mileage"]) + "\""
                                        + "},";

                }
                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "]";
                Result = javascriptStr;
                Logger.SuccessLogPrint("EW", "SP_GET_NJCO_EWAR", "'pn_vin':'" + vin, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));

            }
            else
            {
                string javascriptStr = "{";
                javascriptStr = javascriptStr + "\"" + Convert.ToString("S") + "\"" + ":"
                                           + "\"" + "1" + "\"" + ","
                                           + "\"" + Convert.ToString("M") + "\""
                                          + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;
            }
        }
        catch (Exception EX)
        {
            OBJ.Close();
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("EW", "SP_GET_NJCO_EWAR", "'pn_vin':'" + vin, EX);

        }
        finally
        {

            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (dr != null)
            {
                dr.Dispose();
                dr = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;
    }
    public string UserAuth(string UserName, string Password)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();
            CMD = new OracleCommand("PKG_JCO.sp_jco_user_validate", OBJ);

            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(UserName);
            CMD.Parameters.Add("pn_pwd", OracleDbType.Varchar2, 50, ParameterDirection.Input).Value = Convert.ToString(Password);

            CMD.Parameters.Add("po_dealer_name", OracleDbType.Varchar2, 70).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_loc_desc", OracleDbType.Varchar2, 50).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();


            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {

                string javascriptStr = "{";
                javascriptStr = javascriptStr + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                                            + "\"" + Convert.ToString("DN") + "\""
                                           + ":" + "\"" + Convert.ToString(CMD.Parameters["po_dealer_name"].Value) + "\"" + "\"";

                //javascriptStr += ;
                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;
                Logger.SuccessLogPrint("UserAuth", "sp_jco_user_validate", "'pn_user_id':'" + UserName + "','pn_pwd':'" + Password, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));

            }
            else
            {
                string javascriptStr = "{";


                javascriptStr = javascriptStr + "\"" + Convert.ToString("S") + "\"" + ":"
                                           + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                                           + "\"" + Convert.ToString("M") + "\""
                                          + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";




                // javascriptStr = javascriptStr + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";
                //javascriptStr += ;
                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;
            }



            //OBJ.Close();

        }
        catch (Exception EX)
        {
            OBJ.Close();
            //Result = EX.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("UserAuth", "sp_jco_user_validate", "'pn_user_id':'" + UserName + "','pn_pwd':'" + Password, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;
    }

    public string DealereInfo(string userID)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();
            CMD = new OracleCommand("sp_get_user_global_param", OBJ);
            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(userID);
            CMD.Parameters.Add("po_parent_group", OracleDbType.Varchar2, 5).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_dealer_map_cd", OracleDbType.Int32, 5).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_loc_cd", OracleDbType.Varchar2, 5).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_comp_fa", OracleDbType.Varchar2, 4).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_dealer_name", OracleDbType.Varchar2, 70).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_loc_desc", OracleDbType.Varchar2, 50).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();

            string javascriptStr = "{";
            javascriptStr = javascriptStr + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_dealer_name"].Value) + "\"";
            if (javascriptStr.Length > 1)
                javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
            javascriptStr = javascriptStr + "}";
            //OBJ.Close();
            Logger.SuccessLogPrint("DealereInfo", "sp_get_user_global_param", "'pn_user_id':'" + userID, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));



        }
        catch (Exception EX)
        {
            OBJ.Close();

            //Result = EX.Message;
            //Response.Write(Result);
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("DealereInfo", "sp_get_user_global_param", "'pn_user_id':'" + userID, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;
    }

    public string UserCustomerVehicle(string RegNum, string userID)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {

            OBJ.Open();
            CMD = new OracleCommand("PKG_JCO.sp_jco_get_cust_veh_dtl", OBJ);
            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(userID);
            CMD.Parameters.Add("pn_reg_num", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(RegNum);
            CMD.Parameters.Add("pco_cust_id", OracleDbType.Varchar2, 10).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("pco_cust_name ", OracleDbType.Varchar2, 30).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("pco_cust_add1", OracleDbType.Varchar2, 50).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("pco_cust_add2", OracleDbType.Varchar2, 50).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("pco_cust_add3", OracleDbType.Varchar2, 50).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("pco_city_cd", OracleDbType.Varchar2, 3).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("pco_city_desc", OracleDbType.Varchar2, 50).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("pco_email", OracleDbType.Varchar2, 100).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("pco_phone", OracleDbType.Varchar2, 50).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("pco_work_phone", OracleDbType.Varchar2, 50).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("pco_mobile", OracleDbType.Varchar2, 50).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("pco_dob", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("pco_doa", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("pvo_model_cd", OracleDbType.Varchar2, 7).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("pvo_model_desc", OracleDbType.Varchar2, 50).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("pvo_variant_cd", OracleDbType.Varchar2, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("pvo_variant_desc", OracleDbType.Varchar2, 50).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("pvo_color_cd", OracleDbType.Varchar2, 4).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("pvo_color_desc", OracleDbType.Varchar2, 30).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("pvo_vin", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("pvo_engine_num", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("pvo_sale_date", OracleDbType.Date).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("pvo_tech_campaign", OracleDbType.Varchar2, 1).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("pvo_cust_cat", OracleDbType.Varchar2, 5).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("pvo_serv_emp_cd", OracleDbType.Varchar2, 120).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("pvo_tv_flag", OracleDbType.Varchar2, 1).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("pvo_tv_contract_no", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("pvo_tv_sale_date", OracleDbType.Date).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("pvo_tv_expiry_date", OracleDbType.Date).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("pvo_n2n_flag", OracleDbType.Varchar2, 1).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("pvo_n2n_contract_no", OracleDbType.Varchar2, 50).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("pvo_n2n_expiry_date", OracleDbType.Date).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("pvo_ew_type", OracleDbType.Varchar2, 5).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("pvo_ew_contract_no", OracleDbType.Varchar2, 12).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("pvo_ew_expiry_date", OracleDbType.Date).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("pvo_mi_flag", OracleDbType.Varchar2, 1).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("pvo_mi_policy_no", OracleDbType.Varchar2, 25).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("pvo_mi_validity_date", OracleDbType.Date).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("pvo_chassis_num", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("pvo_car_user_name", OracleDbType.Varchar2, 100).Direction = ParameterDirection.Output;



            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();


            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {
                string javascriptStr = "{";
                javascriptStr = javascriptStr
                    + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "0" + "\"" + ","
                    + "\"" + Convert.ToString("ID") + "\"" + ":" + "\"" + CMD.Parameters["pco_cust_id"].Value + "\"" + ","
                    + "\"" + Convert.ToString("CK") + "\"" + ":" + "\"" + CMD.Parameters["pco_cust_name "].Value + "\"" + ","
                    + "\"" + Convert.ToString("MM") + "\"" + ":" + "\"" + CMD.Parameters["pvo_car_user_name"].Value + "\"" + ","
                    + "\"" + Convert.ToString("A1") + "\"" + ":" + "\"" + CMD.Parameters["pco_cust_add1"].Value + "\"" + ","
                    + "\"" + Convert.ToString("A2") + "\"" + ":" + "\"" + CMD.Parameters["pco_cust_add2"].Value + "\"" + ","
                    + "\"" + Convert.ToString("A3") + "\"" + ":" + "\"" + CMD.Parameters["pco_cust_add3"].Value + "\"" + ","
                    + "\"" + Convert.ToString("CC") + "\"" + ":" + "\"" + CMD.Parameters["pco_city_cd"].Value + "\"" + ","
                    + "\"" + Convert.ToString("CD") + "\"" + ":" + "\"" + CMD.Parameters["pco_city_desc"].Value + "\"" + ","
                    + "\"" + Convert.ToString("EM") + "\"" + ":" + "\"" + CMD.Parameters["pco_email"].Value + "\"" + ","
                    + "\"" + Convert.ToString("PH") + "\"" + ":" + "\"" + CMD.Parameters["pco_phone"].Value + "\"" + ","
                    + "\"" + Convert.ToString("WP") + "\"" + ":" + "\"" + CMD.Parameters["pco_work_phone"].Value + "\"" + ","
                    + "\"" + Convert.ToString("MO") + "\"" + ":" + "\"" + CMD.Parameters["pco_mobile"].Value + "\"" + ","
                    + "\"" + Convert.ToString("DB") + "\"" + ":" + "\"" + CMD.Parameters["pco_dob"].Value + "\"" + ","
                    + "\"" + Convert.ToString("PD") + "\"" + ":" + "\"" + CMD.Parameters["pco_doa"].Value + "\"" + ","

                    + "\"" + Convert.ToString("MC") + "\"" + ":" + "\"" + CMD.Parameters["pvo_model_cd"].Value + "\"" + ","
                    + "\"" + Convert.ToString("MD") + "\"" + ":" + "\"" + CMD.Parameters["pvo_model_desc"].Value + "\"" + ","
                    + "\"" + Convert.ToString("VC") + "\"" + ":" + "\"" + CMD.Parameters["pvo_variant_cd"].Value + "\"" + ","
                    + "\"" + Convert.ToString("VD") + "\"" + ":" + "\"" + CMD.Parameters["pvo_variant_desc"].Value + "\"" + ","
                    + "\"" + Convert.ToString("CO") + "\"" + ":" + "\"" + CMD.Parameters["pvo_color_cd"].Value + "\"" + ","
                    + "\"" + Convert.ToString("DE") + "\"" + ":" + "\"" + CMD.Parameters["pvo_color_desc"].Value + "\"" + ","
                    + "\"" + Convert.ToString("VI") + "\"" + ":" + "\"" + CMD.Parameters["pvo_vin"].Value + "\"" + ","
                    + "\"" + Convert.ToString("EN") + "\"" + ":" + "\"" + CMD.Parameters["pvo_engine_num"].Value + "\"" + ","
                    + "\"" + Convert.ToString("SD") + "\"" + ":" + "\"" + CMD.Parameters["pvo_sale_date"].Value + "\"" + ","
                    + "\"" + Convert.ToString("TC") + "\"" + ":" + "\"" + CMD.Parameters["pvo_tech_campaign"].Value + "\"" + ","
                    + "\"" + Convert.ToString("CA") + "\"" + ":" + "\"" + CMD.Parameters["pvo_cust_cat"].Value + "\"" + ","
                    + "\"" + Convert.ToString("FU") + "\"" + ":" + "\"" + CMD.Parameters["pvo_serv_emp_cd"].Value + "\"" + ","
                    + "\"" + Convert.ToString("FG") + "\"" + ":" + "\"" + CMD.Parameters["pvo_tv_flag"].Value + "\"" + ","

                    + "\"" + Convert.ToString("CN") + "\"" + ":" + "\"" + CMD.Parameters["pvo_tv_contract_no"].Value + "\"" + ","
                    + "\"" + Convert.ToString("TS") + "\"" + ":" + "\"" + CMD.Parameters["pvo_tv_sale_date"].Value + "\"" + ","
                    + "\"" + Convert.ToString("ED") + "\"" + ":" + "\"" + CMD.Parameters["pvo_tv_expiry_date"].Value + "\"" + ","

                    + "\"" + Convert.ToString("PF") + "\"" + ":" + "\"" + CMD.Parameters["pvo_n2n_flag"].Value + "\"" + ","
                    + "\"" + Convert.ToString("PN") + "\"" + ":" + "\"" + CMD.Parameters["pvo_n2n_contract_no"].Value + "\"" + ","
                    + "\"" + Convert.ToString("PE") + "\"" + ":" + "\"" + CMD.Parameters["pvo_n2n_expiry_date"].Value + "\"" + ","
                    + "\"" + Convert.ToString("WT") + "\"" + ":" + "\"" + CMD.Parameters["pvo_ew_type"].Value + "\"" + ","
                    + "\"" + Convert.ToString("WC") + "\"" + ":" + "\"" + CMD.Parameters["pvo_ew_contract_no"].Value + "\"" + ","
                    + "\"" + Convert.ToString("EE") + "\"" + ":" + "\"" + CMD.Parameters["pvo_ew_expiry_date"].Value + "\"" + ","

                    + "\"" + Convert.ToString("MF") + "\"" + ":" + "\"" + CMD.Parameters["pvo_mi_flag"].Value + "\"" + ","
                    + "\"" + Convert.ToString("PM") + "\"" + ":" + "\"" + CMD.Parameters["pvo_mi_policy_no"].Value + "\"" + ","
                    + "\"" + Convert.ToString("TA") + "\"" + ":" + "\"" + CMD.Parameters["pvo_mi_validity_date"].Value + "\"" + ","
                    + "\"" + Convert.ToString("SN") + "\"" + ":" + "\"" + CMD.Parameters["pvo_chassis_num"].Value + "\"" + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;
                Logger.SuccessLogPrint("UserCustomerVehicle", "sp_jco_get_cust_veh_dtl", "'pn_user_id':'" + userID + "', 'pn_reg_num':'" + RegNum, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));

            }
            else
            {
                string javascriptStr = "{";
                javascriptStr = javascriptStr
                    + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "1" + "\"" + ","
                    + "\"" + Convert.ToString("DE") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                    + "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";
                // javascriptStr = javascriptStr + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";
                //javascriptStr += ;
                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;
            }


            // Result = "OK";

            //OBJ.Close();

        }
        catch (Exception EX)
        {
            OBJ.Close();
            //Result = EX.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("UserCustomerVehicle", "sp_jco_get_cust_veh_dtl", "'pn_user_id':'" + userID + "', 'pn_reg_num':'" + RegNum, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;
    }

    public string CityDetails()
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();
            CMD = new OracleCommand("PKG_JCO.sp_jco_get_city_dtl", OBJ);
            CMD.Parameters.Add("po_city_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;

            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();


            OracleDataReader dr = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_city_refcur"].Value).GetDataReader();
            // string javascriptStr = "{";
            // while (dr.Read())
            // {
            //     javascriptStr += "\"" + Convert.ToString(dr[0]) + "\"" + ":" + "\"" + Convert.ToString(dr[1]) +  ""+"\"" + ",";
            // }
            // if (javascriptStr.Length > 1)
            //     javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
            // javascriptStr = javascriptStr  + "}";
            // OBJ.Close();
            //Result=javascriptStr;
            string javascriptStr = "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "0" + "\"" + "," + "\"" + Convert.ToString("K") + "\"" + ":" + "[";
            while (dr.Read())
            {
                javascriptStr = javascriptStr + "{" + "\"" + Convert.ToString(dr[0]) + "\"" + ":" + "\"" + Convert.ToString(dr[1]) + "\"" + "}" + ",";
            }
            if (javascriptStr.Length > 1)
                javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
            javascriptStr = javascriptStr + "]" + "}";
            //OBJ.Close();
            Result = javascriptStr;

            if (dr != null)
            {
                dr.Dispose();
                dr = null;
            }
        }
        catch (Exception EX)
        {
            OBJ.Close();
            //Result = ex.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("CityDetails", "sp_jco_get_city_dtl", null, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;

    }

    public string ServiceCategoryDetails()
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();
            CMD = new OracleCommand("PKG_JCO.sp_jco_get_srv_cat_dtl", OBJ);
            CMD.Parameters.Add("po_srv_cat_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;

            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();


            OracleDataReader dr = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_srv_cat_refcur"].Value).GetDataReader();
            //string javascriptStr = "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "0" + "\"" + "," + "\"" + Convert.ToString("K") + "\"" + ":"+"[";
            //while (dr.Read())
            //{
            //    javascriptStr = javascriptStr +"{"+ "\"" + Convert.ToString(dr[0]) + "\"" + ":" + "\"" + Convert.ToString(dr[1]) + "\""+"}" + ",";
            //}
            //if (javascriptStr.Length > 1)
            //    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
            //javascriptStr = javascriptStr + "]" + "}";
            //OBJ.Close();
            //Result = javascriptStr;
            string javascriptStr = "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "0" + "\"" + "," + "\"" + Convert.ToString("K") + "\"" + ":" + "[";
            while (dr.Read())
            {
                javascriptStr = javascriptStr + "{" + "\"" + Convert.ToString(dr[0]) + "\"" + ":" + "\"" + Convert.ToString(dr[1]) + "\"" + "}" + ",";
            }
            if (javascriptStr.Length > 1)
                javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
            javascriptStr = javascriptStr + "]" + "}";
            //OBJ.Close();
            Result = javascriptStr;

            if (dr != null)
            {
                dr.Dispose();
                dr = null;
            }
            Logger.SuccessLogPrint("ServiceCategoryDetails", "sp_jco_get_srv_cat_dtl", null, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));

        }
        catch (Exception EX)
        {
            OBJ.Close();
            //Result = ex.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("ServiceCategoryDetails", "sp_jco_get_srv_cat_dtl", null, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;
    }

    public string TechnicalAdvancedetails(string Username, string RegNum)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();
            CMD = new OracleCommand("PKG_JCO.sp_jco_get_tech_adv_dtl", OBJ);
            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(Username);
            CMD.Parameters.Add("pn_reg_num", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(RegNum);

            CMD.Parameters.Add("po_tech_adv_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();

            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {

                OracleDataReader dr = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_tech_adv_refcur"].Value).GetDataReader();
                //string javascriptStr = "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\""+ "0" +"\""+"," + "";
                //while (dr.Read())
                //{
                //    javascriptStr = javascriptStr + "\"" + Convert.ToString(dr[0]) + "\"" + ":" + "\"" + Convert.ToString(dr[1]) + "\"" + ",";
                //}                               

                //if (javascriptStr.Length > 1)
                //    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                //javascriptStr = javascriptStr + "}";
                //OBJ.Close();
                //Result = javascriptStr;
                string javascriptStr = "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "0" + "\"" + "," + "\"" + Convert.ToString("K") + "\"" + ":" + "[";
                while (dr.Read())
                {
                    javascriptStr = javascriptStr + "{" + "\"" + Convert.ToString(dr[0]) + "\"" + ":" + "\"" + Convert.ToString(dr[1]) + "\"" + "}" + ",";
                }
                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "]" + "}";
                //OBJ.Close();
                Result = javascriptStr;

                if (dr != null)
                {
                    dr.Dispose();
                    dr = null;
                }
            }
            else
            {
                string javascriptStr = "{";
                javascriptStr = javascriptStr
                    + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                    + "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";
                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;

                //Result = Convert.ToString(CMD.Parameters["po_err_cd"].Value) + ":" + Convert.ToString(CMD.Parameters["po_err_msg"].Value);
            }
            Logger.SuccessLogPrint("TechnicalAdvancedetails", "sp_jco_get_tech_adv_dtl", "'pn_user_id':'" + Username + "','pn_reg_num':'" + RegNum, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));

            //OBJ.Close();
        }
        catch (Exception EX)
        {
            OBJ.Close();
            //Result = ex.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("TechnicalAdvancedetails", "sp_jco_get_tech_adv_dtl", "'pn_user_id':'" + Username + "','pn_reg_num':'" + RegNum, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;
    }

    //--------
    public string GetMenuDetails(string UserID, string RegNum, string MenuDescp)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();
            CMD = new OracleCommand("PKG_JCO.sp_jco_get_menu_dtl", OBJ);
            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(UserID);
            CMD.Parameters.Add("pn_reg_num", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(RegNum);
            CMD.Parameters.Add("pn_menu_desc", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(MenuDescp);


            CMD.Parameters.Add("po_menu_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();
            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {

                OracleDataReader dr = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_menu_refcur"].Value).GetDataReader();
                int Cnter = 0;
                string javascriptStr = "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "0" + "\"" + "," + "\"" + Convert.ToString("K") + "\"" + ":" + "[";
                while (dr.Read())
                {
                    javascriptStr = javascriptStr + "{" + "\"" + Convert.ToString(dr[0]) + "\"" + ":" + "\"" + Convert.ToString(dr[1]) + "\"" + "}" + ",";
                    Cnter = 1;
                }
                if (Cnter == 1)
                {
                    if (javascriptStr.Length > 1)
                        javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                }
                javascriptStr = javascriptStr + "]" + "}";
                //OBJ.Close();
                Result = javascriptStr;

                if (dr != null)
                {
                    dr.Dispose();
                    dr = null;
                }
                Logger.SuccessLogPrint("GetMenuDetails", "sp_jco_get_menu_dtl", "'pn_user_id':'" + UserID + "','pn_reg_num':'" + RegNum + "','pn_menu_desc':'" + MenuDescp, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));

            }
            else
            {
                string javascriptStr = "{";
                javascriptStr = javascriptStr + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "1" + "\"" + ","
                                                + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                                                + "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";
                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;
            }
            //OBJ.Close();
        }
        catch (Exception EX)
        {
            OBJ.Close();
            //Result = ex.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("GetMenuDetails", "sp_jco_get_menu_dtl", "'pn_user_id':'" + UserID + "','pn_reg_num':'" + RegNum + "','pn_menu_desc':'" + MenuDescp, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;
    }

    //--------




    public string VtsValidation(string Userid, Int32 VTS_NUM)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();
            CMD = new OracleCommand("PKG_JCO.sp_jco_vts_num_validate", OBJ);
            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(Userid);
            CMD.Parameters.Add("pn_vts_card_num", OracleDbType.Int32, 4, ParameterDirection.Input).Value = Convert.ToInt32(VTS_NUM);
            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteReader();


            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {
                string javascriptStr = "{";
                javascriptStr = javascriptStr + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;
                Logger.SuccessLogPrint("VtsValidation", "sp_jco_vts_num_validate", "'pn_user_id':'" + Userid + "','pn_vts_card_num':'" + VTS_NUM, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));


            }
            else
            {

                string javascriptStr = "{";
                javascriptStr = javascriptStr
                    + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "1" + "\"" + ","
                    + "\"" + Convert.ToString("DE") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                    + "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;
            }
            //OBJ.Close();
        }
        catch (Exception EX)
        {
            OBJ.Close();
            //Result = ex.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("VtsValidation", "sp_jco_vts_num_validate", "'pn_user_id':'" + Userid + "','pn_vts_card_num':'" + VTS_NUM, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;
    }




    public string GetTechCampDetails(string RegNum)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {

            OBJ.Open();
            CMD = new OracleCommand("PKG_JCO.sp_jco_get_techcamp_dtl", OBJ);
            CMD.Parameters.Add("pn_reg_num", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(RegNum);

            CMD.Parameters.Add("po_tech_camp_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();
            OracleDataReader dr = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_tech_camp_refcur"].Value).GetDataReader();

            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {

                //string javascriptStr ="hi123";
                string javascriptStr = "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "0" + "\"" + ",";
                //Response.Write(dr.HasRows);
                while (dr.Read())
                {
                    //javascriptStr ="h123";
                    javascriptStr = javascriptStr
                                    + "\"" + Convert.ToString("K1") + "\"" + ":" + "\"" + Convert.ToString(dr[0]) + "\"" + ","
                                    + "\"" + Convert.ToString("K2") + "\"" + ":" + "\"" + Convert.ToString(dr[1]) + "\"" + ","
                                    + "\"" + Convert.ToString("K3") + "\"" + ":" + "\"" + Convert.ToString(dr[2]) + "\"" + ","
                                    + "\"" + Convert.ToString("K4") + "\"" + ":" + "\"" + Convert.ToString(dr[3]) + "\"" + ","
                                    + "\"" + Convert.ToString("K5") + "\"" + ":" + "\"" + Convert.ToString(dr[4]) + "\"" + ","
                                    + "\"" + Convert.ToString("K6") + "\"" + ":" + "\"" + Convert.ToString(dr[5]) + "\"" + ",";

                }
                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                //OBJ.Close();
                Result = javascriptStr;
                if (dr != null)
                {
                    dr.Dispose();
                    dr = null;
                }
                Logger.SuccessLogPrint("GetTechCampDetails", "sp_jco_get_techcamp_dtl", "'pn_reg_num':'" + RegNum, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));

            }
            else
            {

                string javascriptStr = "{";

                javascriptStr = javascriptStr
                                              + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                                              + "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;

            }
            //OBJ.Close();
        }
        catch (Exception EX)
        {
            OBJ.Close();
            //Result = ex.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("GetTechCampDetails", "sp_jco_get_techcamp_dtl", "'pn_reg_num':'" + RegNum, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;
    }

    public string GetDemandDetails(string userID, string RegNum, string DemadDescp, string Serviecatcode)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();
            CMD = new OracleCommand("PKG_JCO.sp_jco_get_demand_dtl", OBJ);
            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(userID);
            CMD.Parameters.Add("pn_reg_num", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(RegNum);
            CMD.Parameters.Add("pn_srv_cat_cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(Serviecatcode);
            CMD.Parameters.Add("pn_demand_desc", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(DemadDescp);


            CMD.Parameters.Add("po_demand_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();
            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {
                int Cnt = 0;
                OracleDataReader dr = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_demand_refcur"].Value).GetDataReader();
                string javascriptStr = "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "0" + "\"" + "," + "\"" + Convert.ToString("K") + "\"" + ":" + "[";
                while (dr.Read())
                {
                    javascriptStr = javascriptStr + "{" + "\"" + Convert.ToString(dr[0]) + "\"" + ":" + "\"" + Convert.ToString(dr[1]) + "\"" + "}" + ",";
                    Cnt = 1;
                }
                if (Cnt == 1)
                {
                    if (javascriptStr.Length > 1)
                        javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                }
                javascriptStr = javascriptStr + "]" + "}";
                //OBJ.Close();
                Result = javascriptStr;
                if (dr != null)
                {
                    dr.Dispose();
                    dr = null;
                }
                Logger.SuccessLogPrint("GetDemandDetails", "sp_jco_get_demand_dtl", "'pn_user_id':'" + userID + "','pn_reg_num':'" + RegNum + "','pn_srv_cat_cd':'" + Serviecatcode + "', ,'pn_demand_desc':'" + DemadDescp, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));

            }
            else
            {
                string javascriptStr = "{";
                javascriptStr = javascriptStr + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";
                //javascriptStr += ;
                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;

            }
            //OBJ.Close();
        }
        catch (Exception EX)
        {
            OBJ.Close();
            //Result = ex.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("GetDemandDetails", "sp_jco_get_demand_dtl", "'pn_user_id':'" + userID + "','pn_reg_num':'" + RegNum + "','pn_srv_cat_cd':'" + Serviecatcode + "', ,'pn_demand_desc':'" + DemadDescp, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;
    }

    public string GetPartDetails(string userID, string RegNum, string partnumber)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();
            CMD = new OracleCommand("PKG_JCO.sp_jco_get_part_dtl", OBJ);
            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(userID);
            CMD.Parameters.Add("pn_reg_num", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(RegNum);
            CMD.Parameters.Add("pn_part_num", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(partnumber);


            CMD.Parameters.Add("po_part_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();
            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {

                OracleDataReader dr = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_part_refcur"].Value).GetDataReader();

                string javascriptStr = "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "0" + "\"" + "," + "\"" + "P" + "\"" + ":" + "[";
                while (dr.Read())
                {
                    javascriptStr += "{" + "\"" + Convert.ToString("k1") + "\"" + ":" + "\"" + Convert.ToString(dr[0]) + "\"" + "," +
                                           "\"" + Convert.ToString("k2") + "\"" + ":" + "\"" + Convert.ToString(dr[1]) + "\"" + "," +
                                           "\"" + Convert.ToString("k3") + "\"" + ":" + "\"" + Convert.ToString(dr[2]) + "\"" + "}" + ",";

                }
                javascriptStr = javascriptStr.Remove(javascriptStr.Length - 1, 1);


                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr += "}]" + "}";
                //OBJ.Close();
                Result = javascriptStr;

                if (dr != null)
                {
                    dr.Dispose();
                    dr = null;
                }
                Logger.SuccessLogPrint("GetPartDetails", "sp_jco_get_part_dtl", "'pn_user_id':'" + userID + "','pn_reg_num':'" + RegNum + "','pn_part_num':'" + partnumber, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));

            }
            else
            {
                string javascriptStr = "{";


                javascriptStr = javascriptStr + "\"" + Convert.ToString("S") + "\"" + ":"
                                           + "\"" + "1" + "\"" + ","
                                           + "\"" + Convert.ToString("M") + "\""
                                          + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";
                //javascriptStr += ;
                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;

            }
            //OBJ.Close();
        }
        catch (Exception EX)
        {
            OBJ.Close();
            //Result = ex.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("GetPartDetails", "sp_jco_get_part_dtl", "'pn_user_id':'" + userID + "','pn_reg_num':'" + RegNum + "','pn_part_num':'" + partnumber, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;
    }

    public string GetInventoryDetails(string userID)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();
            CMD = new OracleCommand("PKG_JCO.sp_jco_get_inventory_dtl", OBJ);
            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(userID);
            CMD.Parameters.Add("po_inv_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();

            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {

                OracleDataReader dr = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_inv_refcur"].Value).GetDataReader();
                int Cnter = 0;
                string javascriptStr = "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "0" + "\"" + "," + "\"" + Convert.ToString("K") + "\"" + ":" + "[";
                while (dr.Read())
                {
                    javascriptStr = javascriptStr + "{" + "\"" + Convert.ToString(dr[0]) + "\"" + ":" + "\"" + Convert.ToString(dr[1]) + "\"" + "}" + ",";
                    Cnter = 1;
                }
                if (Cnter == 1)
                {
                    if (javascriptStr.Length > 1)
                        javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                }
                javascriptStr = javascriptStr + "]" + "}";
                //OBJ.Close();
                Result = javascriptStr;
                if (dr != null)
                {
                    dr.Dispose();
                    dr = null;
                }
                Logger.SuccessLogPrint("GetInventoryDetails", "sp_jco_get_inventory_dtl", "'pn_user_id':'" + userID, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));

            }
            else
            {
                string javascriptStr = "{";


                javascriptStr = javascriptStr + "\"" + Convert.ToString("S") + "\"" + ":"
                                           + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                                           + "\"" + Convert.ToString("M") + "\""
                                          + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";
                //javascriptStr += ;
                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;
                // Result = Convert.ToString(CMD.Parameters["po_err_cd"].Value) + ":" + Convert.ToString(CMD.Parameters["po_err_msg"].Value);

            }
            //OBJ.Close();
        }
        catch (Exception EX)
        {
            OBJ.Close();
            //Result = ex.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                         + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("GetInventoryDetails", "sp_jco_get_inventory_dtl", "'pn_user_id':'" + userID, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;
    }

    public string ServiceCategoryValidate(string UserID, string RegNum, string ServiceCatcode, Int32 OMR)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();
            CMD = new OracleCommand("PKG_JCO.sp_jco_srv_cat_validate", OBJ);
            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(UserID);
            CMD.Parameters.Add("pn_reg_num", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(RegNum);
            CMD.Parameters.Add("pn_srv_cat_cd", OracleDbType.Varchar2, 5, ParameterDirection.Input).Value = Convert.ToString(ServiceCatcode);
            CMD.Parameters.Add("pn_omr", OracleDbType.Int32, 5, ParameterDirection.Input).Value = OMR;

            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();


            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {

                string javascriptStr = "{";
                javascriptStr = javascriptStr + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;
                Logger.SuccessLogPrint("ServiceCategoryValidate", "sp_jco_srv_cat_validate", "'pn_user_id':'" + UserID + "','pn_reg_num':'" + RegNum + "','pn_srv_cat_cd':'" + ServiceCatcode + "','pn_omr':'" + OMR, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));


            }
            else
            {
                string javascriptStr = "{";
                javascriptStr = javascriptStr + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "1" + "\"" + ","
                                              + "\"" + Convert.ToString("DE") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                                              + "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";


                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;
            }



            //OBJ.Close();

        }
        catch (Exception EX)
        {
            OBJ.Close();
            //Result = ex.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("ServiceCategoryValidate", "sp_jco_srv_cat_validate", "'pn_user_id':'" + UserID + "','pn_reg_num':'" + RegNum + "','pn_srv_cat_cd':'" + ServiceCatcode + "','pn_omr':'" + OMR, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;
    }

    public string OmrValidate(string RegNum, Int64 Omr)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();
            CMD = new OracleCommand("PKG_JCO.sp_jco_omr_validate", OBJ);
            CMD.Parameters.Add("pn_reg_num", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(RegNum);
            CMD.Parameters.Add("pn_omr", OracleDbType.Int64, ParameterDirection.Input).Value = Convert.ToInt64(Omr);
            //CMD.Parameters.Add("po_req_iss_type", OracleDbType.NVarchar2, 200).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteReader();

            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {




                string javascriptStr = "{";
                javascriptStr = javascriptStr + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;

                Logger.SuccessLogPrint("OmrValidate", "sp_jco_omr_validate", "'pn_reg_num':'" + RegNum + "','pn_omr':'" + Omr, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));

            }
            else
            {

                string javascriptStr = "{";
                javascriptStr = javascriptStr + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "1" + "\"" + ","
                                              + "\"" + Convert.ToString("DE") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                                              + "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";


                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;
            }
            //OBJ.Close();
        }
        catch (Exception EX)
        {
            OBJ.Close();
            //Result = ex.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";

            Logger.ErrorLogException("OmrValidate", "sp_jco_omr_validate", "'pn_reg_num':'" + RegNum + "','pn_omr':'" + Omr, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;
    }

    public string ModifyVehicleDetails(string UserID, string vin, string VehUserName)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();
            CMD = new OracleCommand("PKG_JCO.sp_jco_modify_veh_dtl", OBJ);
            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(UserID);
            CMD.Parameters.Add("pn_reg_num", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(vin);
            CMD.Parameters.Add("pn_veh_user_name", OracleDbType.Varchar2, 100, ParameterDirection.Input).Value = Convert.ToString(VehUserName);
            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;


            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();


            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {


                string javascriptStr = "{";
                javascriptStr = javascriptStr + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                                            + "\"" + Convert.ToString("UN") + "\""
                                           + ":" + "\"" + Convert.ToString(CMD.Parameters["pn_veh_user_name"].Value) + "\"" + ","
                                           + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;
                Logger.SuccessLogPrint("ModifyVehicleDetails", "sp_jco_modify_veh_dtl", "'pn_user_id':'" + UserID + ",''pn_reg_num':'" + vin + "','pn_veh_user_name':'" + VehUserName, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));


            }
            else
            {

                string javascriptStr = "{";


                javascriptStr = javascriptStr + "\"" + Convert.ToString("S") + "\"" + ":"
                                           + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                                           + "\"" + Convert.ToString("M") + "\""
                                          + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";





                //javascriptStr += ;
                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;
            }
            //OBJ.Close();
        }
        catch (Exception EX)
        {
            OBJ.Close();
            //Result = ex.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("ModifyVehicleDetails", "sp_jco_modify_veh_dtl", "'pn_user_id':'" + UserID + ",''pn_reg_num':'" + vin + "','pn_veh_user_name':'" + VehUserName, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;
    }

    public string GetlaborDetails(string UserID, string RegNum, string LaborCode)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();
            CMD = new OracleCommand("PKG_JCO.sp_jco_get_labor_dtl", OBJ);
            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(UserID);
            CMD.Parameters.Add("pn_reg_num", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(RegNum);
            CMD.Parameters.Add("pn_labor_cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(LaborCode);

            CMD.Parameters.Add("po_labor_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;

            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();
            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {

                OracleDataReader dr = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_labor_refcur"].Value).GetDataReader();
                string javascriptStr = "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "0" + "\"" + "," + "\"" + "L" + "\"" + ":" + "[";

                while (dr.Read())
                {
                    javascriptStr += "{" + "\"" + Convert.ToString("k1") + "\"" + ":" + "\"" + Convert.ToString(dr[0]) + "\"" + "," +
                                               "\"" + Convert.ToString("k2") + "\"" + ":" + "\"" + Convert.ToString(dr[1]) + "\"" + "," +
                                               "\"" + Convert.ToString("k3") + "\"" + ":" + "\"" + Convert.ToString(dr[2]) + "\"" + "}" + "\"" + ",";

                }
                javascriptStr = javascriptStr.Remove(javascriptStr.Length - 1, 1);

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "]" + "}";
                //OBJ.Close();
                Result = javascriptStr;
                if (dr != null)
                {
                    dr.Dispose();
                    dr = null;
                }
                Logger.SuccessLogPrint("GetlaborDetails", "sp_jco_get_labor_dtl", "'pn_user_id':'" + UserID + ",''pn_reg_num':'" + RegNum + "','pn_labor_cd':'" + LaborCode, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));

            }
            else
            {
                string javascriptStr = "{";


                javascriptStr = javascriptStr + "\"" + Convert.ToString("S") + "\"" + ":"
                                           + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                                           + "\"" + Convert.ToString("M") + "\""
                                          + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";
                //javascriptStr += ;
                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;
            }
            //OBJ.Close();
        }
        catch (Exception EX)
        {
            OBJ.Close();
            //Result = ex.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("GetlaborDetails", "sp_jco_get_labor_dtl", "'pn_user_id':'" + UserID + ",''pn_reg_num':'" + RegNum + "','pn_labor_cd':'" + LaborCode, EX);


        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;

    }

    public string GetPickupDetails(string UserID)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();
            CMD = new OracleCommand("PKG_JCO.sp_jco_get_pickup_dtl", OBJ);
            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(UserID);

            CMD.Parameters.Add("po_pickup_type_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_pickup_loc_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_driver_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;


            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;

            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();
            int Cnter = 0;
            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {

                OracleDataReader dr = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_pickup_type_refcur"].Value).GetDataReader();
                string javascriptStr = "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "0" + "\"" + "," + "\"" + "PT" + "\"" + ":" + "[";
                while (dr.Read())
                {

                    javascriptStr += "{" + "\"" + Convert.ToString(dr[0]) + "\"" + ":" + "\"" + Convert.ToString(dr[1]) + "\"" + "}" + ",";
                    Cnter = 1;
                }
                if (Cnter == 1)
                {
                    if (javascriptStr.Length > 1)
                        javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                }
                javascriptStr = javascriptStr + "]" + ",";

                OracleDataReader dr1 = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_pickup_loc_refcur"].Value).GetDataReader();
                javascriptStr += "\"" + "PL" + "\"" + ":" + "[";
                while (dr1.Read())
                {
                    javascriptStr += "{" + "\"" + Convert.ToString(dr1[1]) + "\"" + ":" + "\"" + Convert.ToString(dr1[0]) + "\"" + "}" + ",";
                    Cnter = 2;
                }
                if (Cnter == 2)
                {
                    if (javascriptStr.Length > 1)
                        javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                }
                javascriptStr = javascriptStr + "]" + ",";


                OracleDataReader dr2 = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_driver_refcur"].Value).GetDataReader();
                javascriptStr += "\"" + "DN" + "\"" + ":" + "[";
                while (dr2.Read())
                {
                    javascriptStr += "{" + "\"" + Convert.ToString(dr2[0]) + "\"" + ":" + "\"" + Convert.ToString(dr2[1]) + "\"" + "}" + ",";
                    Cnter = 3;
                }
                if (Cnter == 3)
                {
                    if (javascriptStr.Length > 1)
                        javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                }
                javascriptStr = javascriptStr + "]" + "}";

                //OBJ.Close();

                Result = javascriptStr;

                if (dr != null)
                {
                    dr.Dispose();
                    dr = null;
                }

                if (dr1 != null)
                {
                    dr1.Dispose();
                    dr1 = null;
                }

                if (dr2 != null)
                {
                    dr2.Dispose();
                    dr2 = null;
                }
                Logger.SuccessLogPrint("GetPickupDetails", "sp_jco_get_pickup_dtl", "'pn_user_id':'" + UserID, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));


            }
            else
            {
                string javascriptStr = "{";


                javascriptStr = javascriptStr + "\"" + Convert.ToString("S") + "\"" + ":"
                                           + "\"" + "1" + "\"" + ","
                                           + "\"" + Convert.ToString("M") + "\""
                                          + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;
            }
            //OBJ.Close();
        }
        catch (Exception EX)
        {
            OBJ.Close();
            //Result = ex.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("GetPickupDetails", "sp_jco_get_pickup_dtl", "'pn_user_id':'" + UserID, EX);


        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;

    }

    public string GetEstimationDetails(string UserID, string MenuCode, string RegNum, string ServiceCatCode)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();
            CMD = new OracleCommand("PKG_JCO.sp_jco_get_estim_dtl", OBJ);

            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(UserID);
            CMD.Parameters.Add("pn_reg_num", OracleDbType.Varchar2, 10, ParameterDirection.Input).Value = Convert.ToString(RegNum);
            CMD.Parameters.Add("pn_menu_cd", OracleDbType.Varchar2, 10, ParameterDirection.Input).Value = Convert.ToString(MenuCode);
            CMD.Parameters.Add("pn_srv_cat_cd", OracleDbType.Varchar2, 10, ParameterDirection.Input).Value = Convert.ToString(ServiceCatCode);


            CMD.Parameters.Add("po_menu_demand_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_menu_part_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_menu_labor_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;


            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;

            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();
            string javascriptStr = "";
            int cnt = 0;
            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {
                OracleDataReader dr = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_menu_demand_refcur"].Value).GetDataReader();
                javascriptStr += "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "0" + "\"" + "," + "\"" + "D" + "\"" + ":" + "[";
                while (dr.Read())
                {
                    cnt = 1;
                    javascriptStr += "{" + "\"" + Convert.ToString(dr[0]) + "\"" + ":" + "\"" + Convert.ToString(dr[1]) + "\"" + "}" + ",";
                }
                if (cnt == 1)
                {
                    javascriptStr = javascriptStr.Remove(javascriptStr.Length - 1, 1);
                }

                javascriptStr += "],";

                OracleDataReader dr1 = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_menu_part_refcur"].Value).GetDataReader();
                javascriptStr += "\"" + "P" + "\"" + ":" + "[";
                while (dr1.Read())
                {
                    cnt = 2;
                    javascriptStr += "{" + "\"" + Convert.ToString("k1") + "\"" + ":" + "\"" + Convert.ToString(dr1[0]) + "\"" + "," +
                                      "\"" + Convert.ToString("k2") + "\"" + ":" + "\"" + Convert.ToString(dr1[1]) + "\"" + "," +
                                      "\"" + Convert.ToString("k3") + "\"" + ":" + "\"" + Convert.ToString(dr1[2]) + "\"" + "," +
                                      "\"" + Convert.ToString("k4") + "\"" + ":" + "\"" + Convert.ToString(dr1[3]) + "\"" + "}" + ",";

                }
                if (cnt == 2)
                {
                    javascriptStr = javascriptStr.Remove(javascriptStr.Length - 1, 1);
                }

                javascriptStr += "],";


                OracleDataReader dr2 = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_menu_labor_refcur"].Value).GetDataReader();
                javascriptStr += "\"" + "L" + "\"" + ":" + "[";
                while (dr2.Read())
                {
                    cnt = 3;
                    javascriptStr += "{" + "\"" + Convert.ToString("k1") + "\"" + ":" + "\"" + Convert.ToString(dr2[0]) + "\"" + "," +
                                      "\"" + Convert.ToString("k2") + "\"" + ":" + "\"" + Convert.ToString(dr2[1]) + "\"" + "," +
                                      "\"" + Convert.ToString("k3") + "\"" + ":" + "\"" + Convert.ToString(dr2[2]) + "\"" + "}" + ",";
                }
                if (cnt == 3)
                {
                    javascriptStr = javascriptStr.Remove(javascriptStr.Length - 1, 1);
                }

                javascriptStr += "]" + "}";

                if (dr != null)
                {
                    dr.Dispose();
                    dr = null;
                }

                if (dr1 != null)
                {
                    dr1.Dispose();
                    dr1 = null;
                }

                if (dr2 != null)
                {
                    dr2.Dispose();
                    dr2 = null;
                }
                Logger.SuccessLogPrint("GetEstimationDetails", "sp_jco_get_estim_dtl", "'pn_user_id':'" + UserID + "','pn_reg_num':'" + RegNum + "','pn_menu_cd':'" + MenuCode + "','pn_srv_cat_cd':'" + ServiceCatCode, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));
            }
            else
            {
                javascriptStr += "{";


                javascriptStr = javascriptStr + "\"" + Convert.ToString("S") + "\"" + ":"
                                           + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                                           + "\"" + Convert.ToString("M") + "\""
                                          + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";
                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
            }
            //OBJ.Close();
            Result = javascriptStr;
        }
        catch (Exception EX)
        {
            OBJ.Close();
            //Result = ex.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("GetEstimationDetails", "sp_jco_get_estim_dtl", "'pn_user_id':'" + UserID + "','pn_reg_num':'" + RegNum + "','pn_menu_cd':'" + MenuCode + "','pn_srv_cat_cd':'" + ServiceCatCode, EX);
        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;
    }



    public string ModifyCustDetails(string UserName, string CustID, string CustName, string CustAdd1, string CustAdd2, string CustAdd3, string cityCode, string Citydesc, string Email,
                                     string phone, string workingPhone, string mobile, string dob, string doa)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {

            OBJ.Open();
            CMD = new OracleCommand("PKG_JCO.sp_jco_modify_cust_dtl", OBJ);
            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(UserName);
            CMD.Parameters.Add("pn_cust_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(CustID);
            CMD.Parameters.Add("pn_cust_name", OracleDbType.Varchar2, 30, ParameterDirection.Input).Value = Convert.ToString(CustName);
            CMD.Parameters.Add("pn_cust_add1", OracleDbType.Varchar2, 50, ParameterDirection.Input).Value = Convert.ToString(CustAdd1);
            CMD.Parameters.Add("pn_cust_add2", OracleDbType.Varchar2, 50, ParameterDirection.Input).Value = Convert.ToString(CustAdd2);
            CMD.Parameters.Add("pn_cust_add3", OracleDbType.Varchar2, 50, ParameterDirection.Input).Value = Convert.ToString(CustAdd3);
            CMD.Parameters.Add("pn_city_cd", OracleDbType.Varchar2, 3, ParameterDirection.Input).Value = Convert.ToString(cityCode);

            CMD.Parameters.Add("pn_city_desc", OracleDbType.Varchar2, 50, ParameterDirection.Input).Value = Convert.ToString(Citydesc);
            CMD.Parameters.Add("pn_email", OracleDbType.Varchar2, 100, ParameterDirection.Input).Value = Convert.ToString(Email);

            CMD.Parameters.Add("pn_phone", OracleDbType.Varchar2, 50, ParameterDirection.Input).Value = Convert.ToString(phone);
            CMD.Parameters.Add("pn_work_phone", OracleDbType.Varchar2, 50, ParameterDirection.Input).Value = Convert.ToString(workingPhone);
            CMD.Parameters.Add("pn_mobile", OracleDbType.Varchar2, 50, ParameterDirection.Input).Value = Convert.ToString(mobile);
            if (dob == "")
                CMD.Parameters.Add("pn_dob", OracleDbType.Date, ParameterDirection.Input).Value = DBNull.Value;//Convert.ToDateTime(dob);
            else
                CMD.Parameters.Add("pn_dob", OracleDbType.Date, ParameterDirection.Input).Value = Convert.ToDateTime(dob);
            if (doa == "")
                CMD.Parameters.Add("pn_doa", OracleDbType.Date, ParameterDirection.Input).Value = DBNull.Value;//Convert.ToDateTime(doa);
            else
                CMD.Parameters.Add("pn_doa", OracleDbType.Date, ParameterDirection.Input).Value = Convert.ToDateTime(doa);

            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();

            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {


                string javascriptStr = "{";
                javascriptStr = javascriptStr
                    + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "0" + "\"" + ","
                    + "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + ","

                    + "\"" + Convert.ToString("A1") + "\"" + ":" + "\"" + CMD.Parameters["pn_cust_add1"].Value + "\"" + ","
                    + "\"" + Convert.ToString("A2") + "\"" + ":" + "\"" + CMD.Parameters["pn_cust_add2"].Value + "\"" + ","
                    + "\"" + Convert.ToString("A3") + "\"" + ":" + "\"" + CMD.Parameters["pn_cust_add3"].Value + "\"" + ","
                    + "\"" + Convert.ToString("CC") + "\"" + ":" + "\"" + CMD.Parameters["pn_city_cd"].Value + "\"" + ","
                    + "\"" + Convert.ToString("CD") + "\"" + ":" + "\"" + CMD.Parameters["pn_city_desc"].Value + "\"" + ","
                    + "\"" + Convert.ToString("EM") + "\"" + ":" + "\"" + CMD.Parameters["pn_email"].Value + "\"" + ","
                    + "\"" + Convert.ToString("PH") + "\"" + ":" + "\"" + CMD.Parameters["pn_phone"].Value + "\"" + ","
                    + "\"" + Convert.ToString("WP") + "\"" + ":" + "\"" + CMD.Parameters["pn_work_phone"].Value + "\"" + ","
                    + "\"" + Convert.ToString("MO") + "\"" + ":" + "\"" + CMD.Parameters["pn_mobile"].Value + "\"" + ","
                    + "\"" + Convert.ToString("DB") + "\"" + ":" + "\"" + CMD.Parameters["pn_dob"].Value + "\"" + ","
                    + "\"" + Convert.ToString("PD") + "\"" + ":" + "\"" + CMD.Parameters["pn_doa"].Value + "\"" + "\"";


                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;
                Logger.SuccessLogPrint("ModifyCustDetails", "sp_jco_modify_cust_dtl", "'pn_user_id':'" + UserName + "','pn_cust_id':'" + CustID + "','pn_cust_name':'" + CustName + "','pn_cust_add1':'" + CustAdd1 + "','pn_cust_add2':'" + CustAdd2 + "','pn_cust_add3':'" + CustAdd3 + "','pn_city_cd':'" + cityCode + "','pn_city_desc':'" + Citydesc + "','pn_email':'" + Email + "','pn_phone':'" + phone + "','pn_work_phone':'" + workingPhone + "','pn_mobile':'" + mobile + "','pn_dob':'" + dob + "','pn_doa':'" + doa, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));


            }
            else
            {



                string javascriptStr = "{";


                javascriptStr = javascriptStr + "\"" + Convert.ToString("S") + "\"" + ":"
                                           + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                                           + "\"" + Convert.ToString("M") + "\""
                                          + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;
            }

            //OBJ.Close();

        }
        catch (Exception EX)
        {
            OBJ.Close();
            //Result = ex.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("ModifyCustDetails", "sp_jco_modify_cust_dtl", "'pn_user_id':'" + UserName + "','pn_cust_id':'" + CustID + "','pn_cust_name':'" + CustName + "','pn_cust_add1':'" + CustAdd1 + "','pn_cust_add2':'" + CustAdd2 + "','pn_cust_add3':'" + CustAdd3 + "','pn_city_cd':'" + cityCode + "','pn_city_desc':'" + Citydesc + "','pn_email':'" + Email + "','pn_phone':'" + phone + "','pn_work_phone':'" + workingPhone + "','pn_mobile':'" + mobile + "','pn_dob':'" + dob + "','pn_doa':'" + doa, EX);


        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;
    }


    public string GetDemandDetailsMenu(string userID, string RegNum, string Menucd)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();
            CMD = new OracleCommand("PKG_JCO.sp_jco_get_mdemand_dtl", OBJ);
            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(userID);
            CMD.Parameters.Add("pn_reg_num", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(RegNum);
            CMD.Parameters.Add("pn_menu_cd", OracleDbType.Varchar2, 10, ParameterDirection.Input).Value = Convert.ToString(Menucd);


            CMD.Parameters.Add("po_mdemand_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();
            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {

                OracleDataReader dr = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_mdemand_refcur"].Value).GetDataReader();
                //string javascriptStr = "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\""+ "0" +"\""+"," + "";
                //while (dr.Read())
                //{
                //  javascriptStr = javascriptStr + "\"" + dr[0] + "\"" + ":" + "\"" + dr[1] + "\"" + ",";
                //}
                //if (javascriptStr.Length > 1)
                //    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                //javascriptStr = javascriptStr + "}";
                //OBJ.Close();
                //Result = javascriptStr;
                string javascriptStr = "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "0" + "\"" + "," + "\"" + Convert.ToString("K") + "\"" + ":" + "[";
                while (dr.Read())
                {
                    javascriptStr = javascriptStr + "{" + "\"" + Convert.ToString(dr[0]) + "\"" + ":" + "\"" + Convert.ToString(dr[1]) + "\"" + "}" + ",";
                }
                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "]" + "}";
                //OBJ.Close();
                Result = javascriptStr;

                if (dr != null)
                {
                    dr.Dispose();
                    dr = null;
                }
                Logger.SuccessLogPrint("GetDemandDetailsMenu", "sp_jco_get_mdemand_dtl", "'pn_user_id':'" + userID + "','pn_reg_num':'" + RegNum + "','pn_menu_cd':'" + Menucd, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));
            }
            else
            {
                string javascriptStr = "{";
                javascriptStr = javascriptStr + "\"" + Convert.ToString("S") + "\"" + ":"
                                           + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                                           + "\"" + Convert.ToString("M") + "\""
                                          + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";
                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;

            }
            //OBJ.Close();
        }
        catch (Exception EX)
        {
            OBJ.Close();
            //Result = ex.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("GetDemandDetailsMenu", "sp_jco_get_mdemand_dtl", "'pn_user_id':'" + userID + "','pn_reg_num':'" + RegNum + "','pn_menu_cd':'" + Menucd, EX);


        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;
    }






    public string InsertAllDetails(string UserID, string RegNum, string VTS_NUM, string CatCode, Int32 OMR, string date, string ADV_CD, string DtMenu, string DtDemand, string DtPart,
                              string DtLabor, string DtINV, string Pick_Typ, string Pick_Dat, string Pick_Flag, string Pick_Loc, string Pick_Drv, string Pick_Rem, string Tech_Cmp,
                              string Iss_typ, double Part_AMt, double Lbr_AMt)
    {

        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {

            OBJ.Open();
            CMD = new OracleCommand("PKG_JCO.sp_jco_insert_dtl", OBJ);
            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(UserID);
            CMD.Parameters.Add("pn_reg_num", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(RegNum);
            CMD.Parameters.Add("pn_vts_card_num", OracleDbType.Int32, 4, ParameterDirection.Input).Value = Convert.ToInt32(VTS_NUM);
            CMD.Parameters.Add("pn_srv_cat_cd", OracleDbType.Varchar2, 5, ParameterDirection.Input).Value = Convert.ToString(CatCode);
            CMD.Parameters.Add("pn_omr", OracleDbType.Int32, 8, ParameterDirection.Input).Value = Convert.ToInt32(OMR);
            CMD.Parameters.Add("pn_promised_date", OracleDbType.Date, ParameterDirection.Input).Value = Convert.ToDateTime(date);
            CMD.Parameters.Add("pn_tech_adv_cd", OracleDbType.Varchar2, 8, ParameterDirection.Input).Value = Convert.ToString(ADV_CD);

            CMD.Parameters.Add("pn_menu_str", OracleDbType.Varchar2, 500, ParameterDirection.Input).Value = Convert.ToString(DtMenu);
            CMD.Parameters.Add("pn_demand_str", OracleDbType.Varchar2, 500, ParameterDirection.Input).Value = Convert.ToString(DtDemand);
            CMD.Parameters.Add("pn_part_str", OracleDbType.Varchar2, 500, ParameterDirection.Input).Value = Convert.ToString(DtPart);
            CMD.Parameters.Add("pn_opr_str", OracleDbType.Varchar2, 500, ParameterDirection.Input).Value = Convert.ToString(DtLabor);
            CMD.Parameters.Add("pn_inv_str", OracleDbType.Varchar2, 500, ParameterDirection.Input).Value = Convert.ToString(DtINV);

            CMD.Parameters.Add("pn_pickup_type", OracleDbType.Varchar2, 25, ParameterDirection.Input).Value = Convert.ToString(Pick_Typ);

            if (Pick_Dat == "")
                CMD.Parameters.Add("pn_pickup_date", OracleDbType.Date, ParameterDirection.Input).Value = DBNull.Value;//Convert.ToDateTime(Pick_Dat);
            else
                CMD.Parameters.Add("pn_pickup_date", OracleDbType.Date, ParameterDirection.Input).Value = Convert.ToDateTime(Pick_Dat);
            CMD.Parameters.Add("pn_free_pikcup_flag", OracleDbType.Varchar2, 1, ParameterDirection.Input).Value = Convert.ToString(Pick_Flag);
            CMD.Parameters.Add("pn_pickup_loc_cd", OracleDbType.Varchar2, 5, ParameterDirection.Input).Value = Convert.ToString(Pick_Loc);
            CMD.Parameters.Add("pn_pickup_driver", OracleDbType.Varchar2, 30, ParameterDirection.Input).Value = Convert.ToString(Pick_Drv);
            CMD.Parameters.Add("pn_pikcup_remarks", OracleDbType.Varchar2, 500, ParameterDirection.Input).Value = Convert.ToString(Pick_Rem);
            CMD.Parameters.Add("pn_tech_campaign", OracleDbType.Varchar2, 1, ParameterDirection.Input).Value = Convert.ToString(Tech_Cmp);
            CMD.Parameters.Add("pn_req_iss_type", OracleDbType.Varchar2, 5, ParameterDirection.Input).Value = Convert.ToString(Iss_typ);
            CMD.Parameters.Add("pn_part_amt", OracleDbType.Int32, 8, ParameterDirection.Input).Value = Convert.ToDouble(Part_AMt);
            CMD.Parameters.Add("pn_opr_amt", OracleDbType.Int32, 8, ParameterDirection.Input).Value = Convert.ToDouble(Lbr_AMt);


            CMD.Parameters.Add("po_job_card_num", OracleDbType.Varchar2, 12).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();

            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {



                string javascriptStr = "{";
                javascriptStr = javascriptStr + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + ","
                                            + "\"" + Convert.ToString("JB") + "\""
                                           + ":" + "\"" + Convert.ToString(CMD.Parameters["po_job_card_num"].Value) + "\"" + "\"";


                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;
                Logger.SuccessLogPrint("InsertAllDetails", "sp_jco_insert_dtl", "'pn_user_id':'" + UserID + "','pn_reg_num':'" + RegNum + "','pn_vts_card_num':'" + VTS_NUM + "','pn_srv_cat_cd':'" + CatCode + "','pn_omr':'" + OMR + "','pn_promised_date':'" + date + "','pn_tech_adv_cd':'" + ADV_CD + "','pn_menu_str':'" + DtMenu + "','pn_demand_str':'" + DtDemand + "','pn_part_str':'" + DtPart + "','pn_opr_str':'" + DtLabor + "','pn_inv_str':'" + DtINV + "','pn_pickup_type':'" + Pick_Typ + "','pn_pickup_date':'" + Pick_Dat + "','pn_free_pikcup_flag':'" + Pick_Flag + "','pn_pickup_loc_cd':'" + Pick_Loc + "','pn_pickup_driver':'" + Pick_Drv + "','pn_pikcup_remarks':'" + Pick_Rem + "','pn_tech_campaign':'" + Tech_Cmp + "','pn_req_iss_type':'" + Iss_typ + "','pn_part_amt':'" + Part_AMt + "','pn_opr_amt':'" + Lbr_AMt, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));


            }
            else
            {



                string javascriptStr = "{";


                javascriptStr = javascriptStr + "\"" + Convert.ToString("S") + "\"" + ":"
                                           + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                                           + "\"" + Convert.ToString("M") + "\""
                                          + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;
            }

            //OBJ.Close();

        }
        catch (Exception EX)
        {
            OBJ.Close();
            //Result = ex.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("InsertAllDetails", "sp_jco_insert_dtl", "'pn_user_id':'" + UserID + "','pn_reg_num':'" + RegNum + "','pn_vts_card_num':'" + VTS_NUM + "','pn_srv_cat_cd':'" + CatCode + "','pn_omr':'" + OMR + "','pn_promised_date':'" + date + "','pn_tech_adv_cd':'" + ADV_CD + "','pn_menu_str':'" + DtMenu + "','pn_demand_str':'" + DtDemand + "','pn_part_str':'" + DtPart + "','pn_opr_str':'" + DtLabor + "','pn_inv_str':'" + DtINV + "','pn_pickup_type':'" + Pick_Typ + "','pn_pickup_date':'" + Pick_Dat + "','pn_free_pikcup_flag':'" + Pick_Flag + "','pn_pickup_loc_cd':'" + Pick_Loc + "','pn_pickup_driver':'" + Pick_Drv + "','pn_pikcup_remarks':'" + Pick_Rem + "','pn_tech_campaign':'" + Tech_Cmp + "','pn_req_iss_type':'" + Iss_typ + "','pn_part_amt':'" + Part_AMt + "','pn_opr_amt':'" + Lbr_AMt, EX);


        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;
    }
    public string BillPrint(string userID, string JobCardnum)
    {
        string javascriptStr = "";
        string javascriptStr1 = "";
        string javascriptStr2 = "";
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();
            CMD = new OracleCommand("sp_jcbill_print", OBJ);
            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(userID);
            CMD.Parameters.Add("pn_jc_no", OracleDbType.Varchar2, 12, ParameterDirection.Input).Value = Convert.ToString(JobCardnum);
            CMD.Parameters.Add("po_jc_date", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_cust_id", OracleDbType.Varchar2, 10).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_cust_name", OracleDbType.Varchar2, 100).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_cust_add", OracleDbType.Varchar2, 500).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_cust_phone", OracleDbType.Varchar2, 50).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_car_user_name", OracleDbType.Varchar2, 100).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_email", OracleDbType.Varchar2, 100).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_reg_num", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_chassis_num", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_engine_num", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_model", OracleDbType.Varchar2, 50).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_milege", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_sold_by", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_sold_date", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_key_no", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_tv_sale_date", OracleDbType.Date).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_service_type", OracleDbType.Varchar2, 50).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_demand_ref_cur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_instructions", OracleDbType.Varchar2, 500).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_srv_adv", OracleDbType.Varchar2, 120).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_promised_date", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_labor_amt", OracleDbType.Double).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_part_amt", OracleDbType.Double).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_created_by", OracleDbType.Varchar2, 100).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_inv_ref_cur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_group", OracleDbType.Varchar2, 5).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();

            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {
                OracleDataReader dr = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_demand_ref_cur"].Value).GetDataReader();
                javascriptStr1 = "";
                while (dr.Read())
                {
                    javascriptStr1 = javascriptStr1 + Convert.ToString(dr[0]) + "+";
                }

                if (javascriptStr1.Length > 1)
                    javascriptStr1 = javascriptStr1.Substring(0, javascriptStr1.Length - 1);
                javascriptStr1 = javascriptStr1;

                if (dr != null)
                {
                    dr.Dispose();
                    dr = null;
                }
            }

            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {
                OracleDataReader dr1 = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_inv_ref_cur"].Value).GetDataReader();
                javascriptStr2 = "";
                while (dr1.Read())
                {
                    javascriptStr2 = javascriptStr2 + Convert.ToString(dr1[0]) + "," + Convert.ToString(dr1[1]) + "+";
                }

                if (javascriptStr2.Length > 1)
                    javascriptStr2 = javascriptStr2.Substring(0, javascriptStr2.Length - 1);
                javascriptStr2 = javascriptStr2;
            }


            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {

                javascriptStr = "{";
                javascriptStr = javascriptStr
                   + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + CMD.Parameters["po_err_cd"].Value + "\"" + ","
                   + "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + CMD.Parameters["po_err_msg"].Value + "\"" + ","
                   + "\"" + Convert.ToString("JD") + "\"" + ":" + "\"" + CMD.Parameters["po_jc_date"].Value + "\"" + ","
                   + "\"" + Convert.ToString("ID") + "\"" + ":" + "\"" + CMD.Parameters["po_cust_id"].Value + "\"" + ","
                   + "\"" + Convert.ToString("NM") + "\"" + ":" + "\"" + CMD.Parameters["po_cust_name"].Value + "\"" + ","
                   + "\"" + Convert.ToString("AD") + "\"" + ":" + "\"" + CMD.Parameters["po_cust_add"].Value + "\"" + ","
                   + "\"" + Convert.ToString("CP") + "\"" + ":" + "\"" + CMD.Parameters["po_cust_phone"].Value + "\"" + ","
                   + "\"" + Convert.ToString("UN") + "\"" + ":" + "\"" + CMD.Parameters["po_car_user_name"].Value + "\"" + ","
                   + "\"" + Convert.ToString("EM") + "\"" + ":" + "\"" + CMD.Parameters["po_email"].Value + "\"" + ","
                   + "\"" + Convert.ToString("RN") + "\"" + ":" + "\"" + CMD.Parameters["po_reg_num"].Value + "\"" + ","
                   + "\"" + Convert.ToString("CN") + "\"" + ":" + "\"" + CMD.Parameters["po_chassis_num"].Value + "\"" + ","
                   + "\"" + Convert.ToString("EN") + "\"" + ":" + "\"" + CMD.Parameters["po_engine_num"].Value + "\"" + ","
                   + "\"" + Convert.ToString("MD") + "\"" + ":" + "\"" + CMD.Parameters["po_model"].Value + "\"" + ","
                   + "\"" + Convert.ToString("MI") + "\"" + ":" + "\"" + CMD.Parameters["po_milege"].Value + "\"" + ","
                   + "\"" + Convert.ToString("XX") + "\"" + ":" + "\"" + CMD.Parameters["po_sold_by"].Value + "\"" + ","
                   + "\"" + Convert.ToString("JJ") + "\"" + ":" + "\"" + CMD.Parameters["po_sold_date"].Value + "\"" + ","
                   + "\"" + Convert.ToString("KN") + "\"" + ":" + "\"" + CMD.Parameters["po_key_no"].Value + "\"" + ","
                   + "\"" + Convert.ToString("RR") + "\"" + ":" + "\"" + CMD.Parameters["po_tv_sale_date"].Value + "\"" + ","
                   + "\"" + Convert.ToString("ST") + "\"" + ":" + "\"" + CMD.Parameters["po_service_type"].Value + "\"" + ","
                   //+ "\"" + Convert.ToString("MJ") + "\"" + ":" + "\"" + CMD.Parameters["po_inv_ref_cur"].Value + "\"" + "," 
                   + "\"" + Convert.ToString("RF") + "\"" + ":" + "\"" + javascriptStr1 + "\"" + ","
                   + "\"" + Convert.ToString("MJ") + "\"" + ":" + "\"" + javascriptStr2 + "\"" + ","
                   + "\"" + Convert.ToString("GN") + "\"" + ":" + "\"" + CMD.Parameters["po_group"].Value + "\"" + ","
                   + "\"" + Convert.ToString("IN") + "\"" + ":" + "\"" + CMD.Parameters["po_instructions"].Value + "\"" + ","
                   + "\"" + Convert.ToString("AC") + "\"" + ":" + "\"" + CMD.Parameters["po_srv_adv"].Value + "\"" + ","
                   + "\"" + Convert.ToString("PD") + "\"" + ":" + "\"" + CMD.Parameters["po_promised_date"].Value + "\"" + ","
                   + "\"" + Convert.ToString("SD") + "\"" + ":" + "\"" + CMD.Parameters["po_labor_amt"].Value + "\"" + ","
                   + "\"" + Convert.ToString("PA") + "\"" + ":" + "\"" + CMD.Parameters["po_part_amt"].Value + "\"" + ","
                   + "\"" + Convert.ToString("CB") + "\"" + ":" + "\"" + CMD.Parameters["po_created_by"].Value + "\"" + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;
                Logger.SuccessLogPrint("BillPrint", "sp_jcbill_print", "'pn_user_id':'" + userID + "','pn_jc_no':'" + JobCardnum, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));

            }
            else
            {
                javascriptStr = "{";
                javascriptStr = javascriptStr
                    + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "1" + "\"" + ","
                    + "\"" + Convert.ToString("DE") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                    + "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;
            }

            //OBJ.Close();

        }
        catch (Exception EX)
        {
            OBJ.Close();
            //Result = ex.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("BillPrint", "sp_jcbill_print", "'pn_user_id':'" + userID + "','pn_jc_no':'" + JobCardnum, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;
    }
    public string UserAuthMSG(string Regno)
    {

        string Result = "", javascriptStr = "";
        using (OracleConnection connection = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"])))
        {
            connection.Open();

            OracleCommand command = new OracleCommand("PKG_JCO.check_insurance", connection);
            command.CommandType = CommandType.StoredProcedure;

            command.Parameters.Add("ret", OracleDbType.Varchar2, 500).Direction = ParameterDirection.ReturnValue;

            command.Parameters.Add("pn_reg_num", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Input;
            command.Parameters["pn_reg_num"].Value = Convert.ToString(Regno);

            command.ExecuteNonQuery();
            Console.WriteLine(command.Parameters["ret"].Value);

            connection.Close();
            javascriptStr = "{";
            javascriptStr = javascriptStr

                + "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(command.Parameters["ret"].Value) + "\"" + "\"";

            if (javascriptStr.Length > 1)
                javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
            javascriptStr = javascriptStr + "}";
            Result = javascriptStr;
            //Result = Convert.ToString(command.Parameters["ret"].Value);
            return Result;

        }
    }

    public string UserAuthMSG1(string Regno)
    {

        string Result = "", javascriptStr = "";
        using (OracleConnection connection = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"])))
        {
            connection.Open();

            OracleCommand command = new OracleCommand("PKG_JCO.check_ew", connection);
            command.CommandType = CommandType.StoredProcedure;

            command.Parameters.Add("ret", OracleDbType.Varchar2, 500).Direction = ParameterDirection.ReturnValue;

            command.Parameters.Add("pn_reg_num", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Input;
            command.Parameters["pn_reg_num"].Value = Convert.ToString(Regno);

            command.ExecuteNonQuery();
            Console.WriteLine(command.Parameters["ret"].Value);

            connection.Close();
            javascriptStr = "{";
            javascriptStr = javascriptStr

                + "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(command.Parameters["ret"].Value) + "\"" + "\"";

            if (javascriptStr.Length > 1)
                javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
            javascriptStr = javascriptStr + "}";
            Result = javascriptStr;
            //Result =Convert.ToString(command.Parameters["ret"].Value);
            return Result;
        }
    }

    public string HistoryMaster(string RegNum)
    {
        String Result = String.Empty;
        int cnter = 0;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {

            OBJ.Open();
            CMD = new OracleCommand("PKG_JCO.sp_get_history_master", OBJ);
            CMD.Parameters.Add("pn_reg_num", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(RegNum);

            CMD.Parameters.Add("po_jc_hist_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();
            OracleDataReader dr = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_jc_hist_refcur"].Value).GetDataReader();

            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {

                string javascriptStr = "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "0" + "\"" + "," + "\"" + "PS" + "\"" + ":" + "[";
                //string javascriptStr = "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "0" + "\"" + ",";

                while (dr.Read())
                {
                    javascriptStr += "{"
                   + "\"" + Convert.ToString("K1") + "\"" + ":" + "\"" + Convert.ToString(dr[0]) + "\"" + ","
                   + "\"" + Convert.ToString("K2") + "\"" + ":" + "\"" + Convert.ToString(dr[2]) + "\"" + ","
                   + "\"" + Convert.ToString("K3") + "\"" + ":" + "\"" + Convert.ToString(dr[3]) + "\"" + ","
                   + "\"" + Convert.ToString("K4") + "\"" + ":" + "\"" + Convert.ToString(dr[4]) + "\"" + ","
                   + "\"" + Convert.ToString("K5") + "\"" + ":" + "\"" + Convert.ToString(dr[5]) + "\"" + ","
                   + "\"" + Convert.ToString("K6") + "\"" + ":" + "\"" + Convert.ToString(dr[6]) + "\"" + ","
                   + "\"" + Convert.ToString("K7") + "\"" + ":" + "\"" + Convert.ToString(dr[7]) + "\"" + "}" + ",";

                    cnter = 1;

                }
                if (cnter == 1)
                {
                    if (javascriptStr.Length > 1)
                        javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                }
                javascriptStr = javascriptStr + "]" + "}";


                //OBJ.Close();
                Result = javascriptStr;

                if (dr != null)
                {
                    dr.Dispose();
                    dr = null;
                }
            }
            else
            {

                string javascriptStr = "{";

                javascriptStr = javascriptStr
                                              + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                                              + "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;

            }
            //OBJ.Close();
        }
        catch (Exception EX)
        {
            OBJ.Close();
            //Result = ex.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;
    }


    public object CreateBarcode(string data)
    {

        //BARCODEXLib.BarcodeX barCodeGenerator = new BARCODEXLib.BarcodeX();
        //BARCODEXLib.CBarcodeX bcx = new BARCODEXLib.CBarcodeX();
        //object dd = bcx.GetPNGStream((int)BARCODEXLib.bcxTypeEnum.bcxCode39, data, 1, 156, 40, 0, "Arial", 8);


        BarcodeLib.Barcode b = new BarcodeLib.Barcode();
        System.Drawing.Image img = b.Encode(BarcodeLib.TYPE.CODE39, data, Color.Black, Color.White, 156, 40);
        ImageConverter _imageConverter = new ImageConverter();
        byte[] xByte = (byte[])_imageConverter.ConvertTo(img, typeof(byte[]));
        return xByte;

        //return new MemoryStream();
    }

    public string GetHisoryDetails(string UserID, string Regno, string Rownum)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();
            CMD = new OracleCommand("PKG_JCO.sp_get_history_detail", OBJ);
            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(UserID);
            CMD.Parameters.Add("pn_reg_num", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(Regno);
            CMD.Parameters.Add("pn_ro_num", OracleDbType.Varchar2, 12, ParameterDirection.Input).Value = Convert.ToString(Rownum);

            CMD.Parameters.Add("po_sa_name", OracleDbType.Varchar2, 100).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_mech_name", OracleDbType.Varchar2, 100).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_ta_name", OracleDbType.Varchar2, 100).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_group_name", OracleDbType.Varchar2, 5).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_promised_date", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_ready_date", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_psf_status", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_bill_date", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_bill_num", OracleDbType.Varchar2, 12).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_part_amt", OracleDbType.Double).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_opr_amt", OracleDbType.Double).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_tot_amt", OracleDbType.Double).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_est_part_amt", OracleDbType.Double).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_est_opr_amt", OracleDbType.Double).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_est_tot_amt", OracleDbType.Double).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_unfitment_yn", OracleDbType.Varchar2, 1).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_pickup_type", OracleDbType.Varchar2, 100).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_jc_remarks", OracleDbType.Varchar2, 500).Direction = ParameterDirection.Output;


            CMD.Parameters.Add("po_part_hist_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_labor_hist_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_demand_hist_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;

            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();

            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {

                int cnter1 = 0;

                string javascriptStr = "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "0" + "\"" + "," + "\"" + "AD" + "\"" + ":" + "{";

                javascriptStr = javascriptStr

                + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + CMD.Parameters["po_sa_name"].Value + "\"" + ","
                + "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + CMD.Parameters["po_mech_name"].Value + "\"" + ","
                + "\"" + Convert.ToString("JD") + "\"" + ":" + "\"" + CMD.Parameters["po_ta_name"].Value + "\"" + ","
                + "\"" + Convert.ToString("ID") + "\"" + ":" + "\"" + CMD.Parameters["po_group_name"].Value + "\"" + ","
                + "\"" + Convert.ToString("NM") + "\"" + ":" + "\"" + CMD.Parameters["po_promised_date"].Value + "\"" + ","
                + "\"" + Convert.ToString("AM") + "\"" + ":" + "\"" + CMD.Parameters["po_ready_date"].Value + "\"" + ","
                + "\"" + Convert.ToString("CP") + "\"" + ":" + "\"" + CMD.Parameters["po_psf_status"].Value + "\"" + ","
                + "\"" + Convert.ToString("UN") + "\"" + ":" + "\"" + CMD.Parameters["po_bill_date"].Value + "\"" + ","
                + "\"" + Convert.ToString("EM") + "\"" + ":" + "\"" + CMD.Parameters["po_bill_num"].Value + "\"" + ","

                + "\"" + Convert.ToString("RN") + "\"" + ":" + "\"" + CMD.Parameters["po_part_amt"].Value + "\"" + ","
                + "\"" + Convert.ToString("CN") + "\"" + ":" + "\"" + CMD.Parameters["po_opr_amt"].Value + "\"" + ","
                + "\"" + Convert.ToString("EN") + "\"" + ":" + "\"" + CMD.Parameters["po_tot_amt"].Value + "\"" + ","
                + "\"" + Convert.ToString("MD") + "\"" + ":" + "\"" + CMD.Parameters["po_est_part_amt"].Value + "\"" + ","
                + "\"" + Convert.ToString("MI") + "\"" + ":" + "\"" + CMD.Parameters["po_est_opr_amt"].Value + "\"" + ","
                + "\"" + Convert.ToString("XX") + "\"" + ":" + "\"" + CMD.Parameters["po_est_tot_amt"].Value + "\"" + ","
                + "\"" + Convert.ToString("JJ") + "\"" + ":" + "\"" + CMD.Parameters["po_unfitment_yn"].Value + "\"" + ","
                + "\"" + Convert.ToString("RE") + "\"" + ":" + "\"" + CMD.Parameters["po_jc_remarks"].Value + "\"" + ","

                + "\"" + Convert.ToString("CB") + "\"" + ":" + "\"" + CMD.Parameters["po_pickup_type"].Value + "\"" + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);

                javascriptStr = javascriptStr + "}" + ",";

                OracleDataReader dr1 = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_demand_hist_refcur"].Value).GetDataReader();
                javascriptStr += "\"" + "LB" + "\"" + ":" + "[";
                while (dr1.Read())
                {
                    javascriptStr += "{" + "\"" + Convert.ToString("K1") + "\"" + ":" + "\"" + Convert.ToString(dr1[0]) + "\"" + "," + "\"" + Convert.ToString("K2") + "\"" + ":" + "\"" + Convert.ToString(dr1[1]) + "\"" + "," + "\"" + Convert.ToString("K3") + "\"" + ":" + "\"" + Convert.ToString(dr1[2]) + "\"" + "," + "\"" + Convert.ToString("K4") + "\"" + ":" + "\"" + Convert.ToString(dr1[3]) + "\"" + "}" + ",";

                    cnter1 = 2;
                }
                if (cnter1 == 2)
                {
                    if (javascriptStr.Length > 1)
                        javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                }
                javascriptStr = javascriptStr + "]" + ",";


                OracleDataReader dr2 = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_part_hist_refcur"].Value).GetDataReader();
                javascriptStr += "\"" + "DD" + "\"" + ":" + "[";
                while (dr2.Read())
                {
                    javascriptStr += "{" + "\"" + Convert.ToString("K1") + "\"" + ":" + "\"" + Convert.ToString(dr2[0]) + "\"" + "," + "\"" + Convert.ToString("K2") + "\"" + ":" + "\"" + Convert.ToString(dr2[1]) + "\"" + "," + "\"" + Convert.ToString("K3") + "\"" + ":" + "\"" + Convert.ToString(dr2[2]) + "\"" + "}" + ",";

                    cnter1 = 3;
                }
                if (cnter1 == 3)
                {
                    if (javascriptStr.Length > 1)
                        javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                }
                javascriptStr = javascriptStr + "]" + ",";


                OracleDataReader dr3 = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_labor_hist_refcur"].Value).GetDataReader();
                javascriptStr += "\"" + "PD" + "\"" + ":" + "[";
                while (dr3.Read())
                {
                    javascriptStr += "{" + "\"" + Convert.ToString("K1") + "\"" + ":" + "\"" + Convert.ToString(dr3[0]) + "\"" + "," + "\"" + Convert.ToString("K2") + "\"" + ":" + "\"" + Convert.ToString(dr3[1]) + "\"" + "," + "\"" + Convert.ToString("K3") + "\"" + ":" + "\"" + Convert.ToString(dr3[2]) + "\"" + "," + "\"" + Convert.ToString("K4") + "\"" + ":" + "\"" + Convert.ToString(dr3[3]) + "\"" + "," + "\"" + Convert.ToString("K5") + "\"" + ":" + "\"" + Convert.ToString(dr3[4]) + "\"" + "}" + ",";

                    cnter1 = 4;
                }
                if (cnter1 == 4)
                {
                    if (javascriptStr.Length > 1)
                        javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                }
                javascriptStr = javascriptStr + "]" + "}";

                //OBJ.Close();

                Result = javascriptStr;

                if (dr1 != null)
                {
                    dr1.Dispose();
                    dr1 = null;
                }

                if (dr2 != null)
                {
                    dr2.Dispose();
                    dr2 = null;
                }

                if (dr3 != null)
                {
                    dr3.Dispose();
                    dr3 = null;
                }
                Logger.SuccessLogPrint("GetHisoryDetails", "sp_get_history_detail", "'pn_user_id':'" + UserID + "','pn_reg_num':'" + Regno + "','pn_ro_num':'" + Rownum, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));

            }
            else
            {
                string javascriptStr = "{";


                javascriptStr = javascriptStr + "\"" + Convert.ToString("S") + "\"" + ":"
                                           + "\"" + "1" + "\"" + ","
                                           + "\"" + Convert.ToString("M") + "\""
                                          + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;
            }
            //OBJ.Close();
        }
        catch (Exception EX)
        {
            OBJ.Close();
            //Result = ex.Message;
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("GetHisoryDetails", "sp_get_history_detail", "'pn_user_id':'" + UserID + "','pn_reg_num':'" + Regno + "','pn_ro_num':'" + Rownum, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;

    }

    //new fn to get part Appointment Details date :27 Sep 2017
    public string GetAppointmentDetails(string userID, Int32 dealer_cd, string loc_cd, string isTesting = "1")
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();
            CMD = new OracleCommand("pkg_jco_1.sp_get_appointdtl", OBJ);
            if (isTesting == "1")
            {
                CMD.Parameters.Add("pn_dealer_cd", OracleDbType.Int32, 8, ParameterDirection.Input).Value = 10136;
                CMD.Parameters.Add("pn_loc_Cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = "DPB";
                CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = "bansrv.tab1";

            }
            else if (isTesting == "2")
            {
                CMD.Parameters.Add("pn_dealer_cd", OracleDbType.Int32, 8, ParameterDirection.Input).Value = null;
                CMD.Parameters.Add("pn_loc_Cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = "DPB";
                CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = "bansrv.tab1";

            }
            else if (isTesting == "3")
            {
                CMD.Parameters.Add("pn_dealer_cd", OracleDbType.Int32, 8, ParameterDirection.Input).Value = 10136;
                CMD.Parameters.Add("pn_loc_Cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = null;
                CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = "bansrv.tab1";

            }
            else
            {
                CMD.Parameters.Add("pn_dealer_cd", OracleDbType.Int32, 8, ParameterDirection.Input).Value = Convert.ToInt32(dealer_cd);
                CMD.Parameters.Add("pn_loc_Cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(loc_cd);
                CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(userID);
            }


            CMD.Parameters.Add("po_appointdtl_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
            CMD.CommandType = CommandType.StoredProcedure;
            int cntRowsEffected = CMD.ExecuteNonQuery();

            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {
                int cnter = 0;
                string javascriptStr = "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "0" + "\"" + ","
                                        // + "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + ","
                                        + "\"" + Convert.ToString("M") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_err_msg"].Value)) + ","
                                        + "\"" + Convert.ToString("ROWCNT") + "\"" + ":" + "\"" + cntRowsEffected.ToString() + "\"" + ","
                                        + "\"" + "GADTL" + "\"" + ":" + "[";

                OracleDataReader dr = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_appointdtl_refcur"].Value).GetDataReader();
                while (dr.Read())
                {
                    cnter = 1;
                    /*
                     Customer_Name, 
                     reg_num,
                     Contact_No,
                     time_slot,
                     srv_type_desc,
                     pickup_type,
                     booking_remarks,                     
                     vechilemodel,
                     appnt_for_dt
                     */
                    javascriptStr = javascriptStr
                                    + "{"
                                    + "\"" + Convert.ToString("CNAME") + "\"" + ":" + "\"" + Convert.ToString(dr[0]) + "\"" + ","
                                    + "\"" + Convert.ToString("REGNUM") + "\"" + ":" + "\"" + Convert.ToString(dr[1]) + "\"" + ","
                                    + "\"" + Convert.ToString("CONTACTNO") + "\"" + ":" + "\"" + Convert.ToString(dr[2]) + "\"" + ","
                                    + "\"" + Convert.ToString("TIME") + "\"" + ":" + "\"" + Convert.ToString(dr[3]) + "\"" + ","
                                    + "\"" + Convert.ToString("SVRD") + "\"" + ":" + "\"" + Convert.ToString(dr[4]) + "\"" + ","
                                    + "\"" + Convert.ToString("PICKTYPE") + "\"" + ":" + "\"" + Convert.ToString(dr[5]) + "\"" + ","
                                    + "\"" + Convert.ToString("REMARKS") + "\"" + ":" + "\"" + Convert.ToString(dr[6]) + "\"" + ","
                                    + "\"" + Convert.ToString("VMODEL") + "\"" + ":" + "\"" + Convert.ToString(dr[7]) + "\"" + ","
                                    + "\"" + Convert.ToString("APTDT") + "\"" + ":" + "\"" + Convert.ToString(dr[8]) + "\"" + ","
                                    + "\"" + Convert.ToString("RMRK") + "\"" + ":" + "\"" + Convert.ToString(dr[dr.GetOrdinal("booking_remarks")]) + "\"" + ","
                                    + "\"" + Convert.ToString("APPTYPE") + "\"" + ":" + "\"" + Convert.ToString(dr[dr.GetOrdinal("appointment_type")]) + "\""
                                    + "}" + ",";

                    //javascriptStr = javascriptStr
                    //                + "{"
                    //                + "\"" + Convert.ToString("SRNO") + "\"" + ":" + "\"" + Convert.ToString(dr[0]) + "\"" + ","
                    //                + "\"" + Convert.ToString("CNAME") + "\"" + ":" + "\"" + Convert.ToString(dr[1]) + "\"" + ","
                    //                + "\"" + Convert.ToString("REGNUM") + "\"" + ":" + "\"" + Convert.ToString(dr[2]) + "\"" + ","
                    //                + "\"" + Convert.ToString("CONTACTNO") + "\"" + ":" + "\"" + Convert.ToString(dr[3]) + "\"" + ","
                    //                + "\"" + Convert.ToString("SVRD") + "\"" + ":" + "\"" + Convert.ToString(dr[4]) + "\"" + ","
                    //                + "\"" + Convert.ToString("TIME") + "\"" + ":" + "\"" + Convert.ToString(dr[5]) + "\"" + ","
                    //                + "\"" + Convert.ToString("SRVTYPE") + "\"" + ":" + "\"" + Convert.ToString(dr[6]) + "\"" + ","
                    //                + "\"" + Convert.ToString("PICKTYPE") + "\"" + ":" + "\"" + Convert.ToString(dr[7]) + "\"" + ","
                    //                + "\"" + Convert.ToString("REMARKS") + "\"" + ":" + "\"" + Convert.ToString(dr[8]) + "\"" + "}" + ",";
                }
                if (cnter == 1)
                {
                    if (javascriptStr.Length > 1)
                        javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                }
                javascriptStr = javascriptStr + "]" + "}";

                Result = javascriptStr;

                if (dr != null)
                {
                    dr.Dispose();
                    dr = null;
                }
                Logger.SuccessLogPrint("GetAppointmentDetails", "sp_get_appointdtl", "'pn_dealer_cd':'" + dealer_cd + "','pn_loc_Cd':'" + loc_cd + "','pn_user_id':'" + userID, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));

            }
            else
            {
                string javascriptStr = "{";
                javascriptStr = javascriptStr
                                     + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "1" + "\"" + ","
                                     + "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + ","
                                     + "\"" + Convert.ToString("ROWCNT") + "\"" + ":" + "\"" + cntRowsEffected.ToString() + "\"" + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;

            }
            //OBJ.Close();
        }
        catch (Exception EX)
        {
            Logger.Log(EX);
            OBJ.Close();

            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "1" + "\"" + ","
                                  + "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + ","
                                  + "\"" + Convert.ToString("INPUT") + "\"" + ":" + "\"" + string.Format("UserID={0}, dealer_cd={1}, loc_cd={2}", userID, dealer_cd, loc_cd) + "\""
                            + "}";
            Logger.ErrorLogException("GetAppointmentDetails", "sp_get_appointdtl", "'pn_dealer_cd':'" + dealer_cd + "','pn_loc_Cd':'" + loc_cd + "','pn_user_id':'" + userID, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;
    }

    /// <summary>
    /// Created Date : 16-Oct-2017 / Vectorform
    /// New Function to get RFTag Details
    /// 
    /// </summary>
    /// <param name="userID"></param>
    /// <param name="dealer_cd"></param>
    /// <param name="loc_cd"></param>
    /// <returns></returns>
    public string GetRFTagDetails(string parentGroup, Int32 dealerCode, string locationCode, string userId, string vin, string srvCategory)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();
            CMD = new OracleCommand("pkg_jco_1.SP_GET_RFTAGDTL", OBJ);
            CMD.Parameters.Add("pn_parent_group", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(parentGroup);
            CMD.Parameters.Add("pn_dealer_cd", OracleDbType.Int32, 8, ParameterDirection.Input).Value = Convert.ToInt32(dealerCode);
            CMD.Parameters.Add("pn_loc_Cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(locationCode);
            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(userId);
            CMD.Parameters.Add("pn_vin", OracleDbType.Varchar2, 22, ParameterDirection.Input).Value = Convert.ToString(vin);

            CMD.Parameters.Add("po_avts_yn", OracleDbType.Varchar2, 10).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_rftag_no", OracleDbType.Varchar2, 50).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_checkin_datetime", OracleDbType.Varchar2, 100).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("PN_SRV_CAT_CD", OracleDbType.Varchar2, 200, ParameterDirection.Input).Value = srvCategory;

            CMD.CommandType = CommandType.StoredProcedure;
            int cntRowsEffected = CMD.ExecuteNonQuery();

            string javascriptStr = string.Empty;

            javascriptStr = "{"
                                 + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                                 //+ "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + ","
                                 + "\"" + Convert.ToString("M") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_err_msg"].Value)) + ","

                                 + "\"" + Convert.ToString("AVTS") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_avts_yn"].Value) + "\"" + ","
                                  //+ "\"" + Convert.ToString("RFTNO") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_rftag_no"].Value) + "\"" + ","
                                  + "\"" + Convert.ToString("RFTNO") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_rftag_no"].Value)) + ","
                                 //+ "\"" + Convert.ToString("CDATETIME") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_checkin_datetime"].Value) + "\""
                                 + "\"" + Convert.ToString("CDATETIME") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_checkin_datetime"].Value))
                          + "}";


            Result = javascriptStr;
            Logger.SuccessLogPrint("GetRFTagDetails", "SP_GET_RFTAGDTL", "'pn_parent_group':'" + parentGroup + "','pn_dealer_cd':'" + dealerCode + "','pn_loc_Cd':'" + locationCode + "''pn_user_id':'" + userId + "','pn_vin':'" + vin + "','PN_SRV_CAT_CD':'" + srvCategory, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));

        }
        catch (Exception EX)
        {
            OBJ.Close();

            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "1" + "\"" + ","
                                  + "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(EX.Message) + "\""
                            + "}";
            Logger.ErrorLogException("GetRFTagDetails", "SP_GET_RFTAGDTL", "'pn_parent_group':'" + parentGroup + "','pn_dealer_cd':'" + dealerCode + "','pn_loc_Cd':'" + locationCode + "''pn_user_id':'" + userId + "','pn_vin':'" + vin + "','PN_SRV_CAT_CD':'" + srvCategory, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;
    }

    /// <summary>
    /// Created Date : 16-Oct-2017 / Vectorform
    /// New Function to get RFTag Scan Time
    /// 
    /// </summary>
    /// <param name="userID"></param>
    /// <param name="dealer_cd"></param>
    /// <param name="loc_cd"></param>
    /// <returns></returns>
    public string GetRFTagScanTime(Int32 dealerCode, string locationCode, string userId, string rftagNo, string srvCategory)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();
            CMD = new OracleCommand("pkg_jco_1.SP_GET_RFTAG_SCANTIME", OBJ);
            CMD.Parameters.Add("pn_dealer_cd", OracleDbType.Int32, 8, ParameterDirection.Input).Value = Convert.ToInt32(dealerCode);
            CMD.Parameters.Add("pn_loc_Cd", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(locationCode);
            CMD.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(userId);
            CMD.Parameters.Add("pn_rftag_no", OracleDbType.Varchar2, 50, ParameterDirection.Input).Value = Convert.ToString(rftagNo);

            CMD.Parameters.Add("po_checkin_datetime", OracleDbType.Varchar2, 100).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("PN_SRV_CAT_CD", OracleDbType.Varchar2, 200, ParameterDirection.Input).Value = srvCategory;
            CMD.CommandType = CommandType.StoredProcedure;
            int cntRowsEffected = CMD.ExecuteNonQuery();

            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {
                string javascriptStr = "{";
                javascriptStr = javascriptStr
                    + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "0" + "\"" + ","
                    //+ "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + ","
                    + "\"" + Convert.ToString("M") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_err_msg"].Value)) + ","
                    + "\"" + Convert.ToString("ROWCNT") + "\"" + ":" + "\"" + cntRowsEffected.ToString() + "\"" + ","

                    + "\"" + Convert.ToString("CDATETIME") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_checkin_datetime"].Value) + "\"" + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;
                Logger.SuccessLogPrint("GetRFTagScanTime", "SP_GET_RFTAG_SCANTIME", "'pn_dealer_cd':'" + dealerCode + "','pn_loc_Cd':'" + locationCode + "','pn_user_id':'" + userId + "''pn_rftag_no':'" + rftagNo + "','PN_SRV_CAT_CD':'" + srvCategory, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));

            }
            else
            {
                string javascriptStr = "{";
                javascriptStr = javascriptStr
                                     + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "1" + "\"" + ","
                                     + "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + ","
                                     + "\"" + Convert.ToString("ROWCNT") + "\"" + ":" + "\"" + cntRowsEffected.ToString() + "\"" + "\"";
                //+ ","+ "\"" + Convert.ToString("CDATETIME") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_checkin_datetime"].Value) + "\"" + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;

            }
            //OBJ.Close();
        }
        catch (Exception EX)
        {
            OBJ.Close();

            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "1" + "\"" + ","
                                  + "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(EX.Message) + "\""
                            + "}";
            Logger.ErrorLogException("GetRFTagScanTime", "SP_GET_RFTAG_SCANTIME", "'pn_dealer_cd':'" + dealerCode + "','pn_loc_Cd':'" + locationCode + "','pn_user_id':'" + userId + "''pn_rftag_no':'" + rftagNo + "','PN_SRV_CAT_CD':'" + srvCategory, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;
    }
    /*
     SP_PUSH_DMS_MESSAGE(P_TRAN_TYPE    IN VARCHAR2, -- diff trigger point for send SMS
                                                       P_PARENT_GROUP IN VARCHAR2,
                                                       P_DEALER       IN NUMBER,
                                                       P_LOC_CD       IN VARCHAR2,
                                                       P_COMP_FA      IN VARCHAR2,
                                                       P_DOC_TYPE     IN VARCHAR2, -- MTAB
                                                       P_DOCUMENT_NUM IN VARCHAR2, -- JC num
                                                       P_CREATED_BY   IN VARCHAR2)
     */
    public string PushDMSMessage(string transactionType, string parentGroup, Int32 dealerCode, string locationCode, string compFa, string docType, string docNumber, string createdBy)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["conoracle_PushApi"]));
        try
        {
            OBJ.Open();
            //TODO: Under which package it is writtern either "pkg_jco" / "pkg_jco_1"
            CMD = new OracleCommand("SP_PUSH_DMS_MESSAGE", OBJ);
            CMD.Parameters.Add("P_TRAN_TYPE", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(transactionType);
            CMD.Parameters.Add("P_PARENT_GROUP", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(parentGroup);
            CMD.Parameters.Add("P_DEALER", OracleDbType.Int32, 8, ParameterDirection.Input).Value = Convert.ToInt32(dealerCode);
            CMD.Parameters.Add("P_LOC_CD", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(locationCode);
            CMD.Parameters.Add("P_COMP_FA", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(compFa);
            CMD.Parameters.Add("P_DOC_TYPE", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(docType);
            CMD.Parameters.Add("P_DOCUMENT_NUM", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(docNumber);
            CMD.Parameters.Add("P_CREATED_BY", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(createdBy);

            Logger.Log("-------------------------------SP_PUSH_DMS_MESSAGE-----------------------------------------");
            Logger.Log("{");
            Logger.Log(string.Format("P_TRAN_TYPE: {0}", Convert.ToString(transactionType)));
            Logger.Log(string.Format("P_PARENT_GROUP: {0}", Convert.ToString(parentGroup)));
            Logger.Log(string.Format("P_DEALER: {0}", Convert.ToInt32(dealerCode)));
            Logger.Log(string.Format("P_LOC_CD: {0}", Convert.ToString(locationCode)));
            Logger.Log(string.Format("P_COMP_FA: {0}", Convert.ToString(compFa)));
            Logger.Log(string.Format("P_DOC_TYPE: {0}", Convert.ToString(docType)));
            Logger.Log(string.Format("P_DOCUMENT_NUM: {0}", Convert.ToString(docNumber)));
            Logger.Log(string.Format("P_CREATED_BY: {0}", Convert.ToString(createdBy)));
            Logger.Log("}");
            Logger.Log("-------------------------------SP_PUSH_DMS_MESSAGE-----------------------------------------");

            CMD.CommandType = CommandType.StoredProcedure;
            int cntRowsEffected = CMD.ExecuteNonQuery();

            string javascriptStr = string.Empty;

            javascriptStr = "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "0" + "\"" + ","
                                  + "\"" + Convert.ToString("M") + "\"" + ":" + "\"\""
                            + "}";


            Result = javascriptStr;
            Logger.SuccessLogPrint("PushDMSMessage", "SP_PUSH_DMS_MESSAGE", "'P_TRAN_TYPE':'" + transactionType + "','P_PARENT_GROUP':'" + parentGroup + "','P_DEALER':'" + dealerCode + "','P_LOC_CD':'" + locationCode + "','P_COMP_FA':'" + compFa + "','P_DOC_TYPE':'" + docType + "','P_DOCUMENT_NUM':'" + docNumber + "','P_CREATED_BY':'" + createdBy, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));

            //OBJ.Close();
        }
        catch (Exception EX)
        {
            OBJ.Close();

            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "1" + "\"" + ","
                                  + "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(EX.Message) + "\""
                            + "}";
            Logger.ErrorLogException("PushDMSMessage", "SP_PUSH_DMS_MESSAGE", "'P_TRAN_TYPE':'" + transactionType + "','P_PARENT_GROUP':'" + parentGroup + "','P_DEALER':'" + dealerCode + "','P_LOC_CD':'" + locationCode + "','P_COMP_FA':'" + compFa + "','P_DOC_TYPE':'" + docType + "','P_DOCUMENT_NUM':'" + docNumber + "','P_CREATED_BY':'" + createdBy, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;
    }


    /// <summary>
    /// GetDigitalInvoiceDetails
    /// </summary>
    /// <param name="ParentGroup"></param>
    /// <param name="DealerMapCd"></param>
    /// <param name="LocCd"></param>
    /// <param name="CompFa"></param>
    /// <param name="JobCardNo"></param>
    /// <param name="UserID"></param>
    /// <returns></returns>
    /// <Developed>Mukseh Sinha</Developed>
    /// <Date>24/April/2020</Date>
    [WebMethod]
    public static dynamic GetDigitalInvoiceDetails(string ParentGroup, string DealerMapCd, string LocCd, string CompFa, string JobCardNo, string UserID)
    {

        dynamic result = new { Code = "1", Message = "failure" };

        if (string.IsNullOrEmpty(ParentGroup))
            result = new { Code = "1", Message = "ParentGroup input is not supplied." };
        else if (string.IsNullOrEmpty(DealerMapCd))
            result = new { Code = "1", Message = "DealerMapCd input is not supplied." };
        else if (string.IsNullOrEmpty(LocCd))
            result = new { Code = "1", Message = "LocCd input is not supplied." };
        else if (string.IsNullOrEmpty(CompFa))
            result = new { Code = "1", Message = "CompFa input is not supplied." };
        else if (string.IsNullOrEmpty(JobCardNo))
            result = new { Code = "1", Message = "JobCardNo input is not supplied." };
        else if (string.IsNullOrEmpty(UserID))
            result = new { Code = "1", Message = "UserID inputb is not supplied." };
        else
        {

            OracleCommand cmd = null;
            OracleConnection objConnection = null;
            JobCardInvoice objJobCardInvoice = null;

            try
            {
                //create Oracle DB connection
                objConnection = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));

                //Open connection
                objConnection.Open();

                //initialize procedure
                cmd = new OracleCommand("PKG_JCO_1.SP_JCO_INV_PRINT", objConnection);

                //Start Input parameters
                cmd.Parameters.Add("pn_parent_group", OracleDbType.Varchar2, 5, ParameterDirection.Input).Value = Convert.ToString(ParentGroup);
                cmd.Parameters.Add("pn_dealer_map_cd", OracleDbType.Int32, 5, ParameterDirection.Input).Value = Convert.ToInt32(DealerMapCd);
                cmd.Parameters.Add("pn_loc_Cd", OracleDbType.Varchar2, 3, ParameterDirection.Input).Value = Convert.ToString(LocCd);
                cmd.Parameters.Add("pn_comp_fa", OracleDbType.Varchar2, 8, ParameterDirection.Input).Value = Convert.ToString(CompFa);
                cmd.Parameters.Add("pn_jc_num", OracleDbType.Varchar2, 12, ParameterDirection.Input).Value = Convert.ToString(JobCardNo);
                cmd.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(UserID);
                //End Input parameters

                //Start Output parmeters
                cmd.Parameters.Add("po_dealer_name", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
                cmd.Parameters.Add("po_cust_id", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
                cmd.Parameters.Add("po_cust_name", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
                cmd.Parameters.Add("po_cust_add1", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
                cmd.Parameters.Add("po_cust_add2", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
                cmd.Parameters.Add("po_cust_add3", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
                cmd.Parameters.Add("po_cust_city", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
                cmd.Parameters.Add("po_cust_state_desc", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
                cmd.Parameters.Add("po_cust_country", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
                cmd.Parameters.Add("po_cust_pin", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
                cmd.Parameters.Add("po_cust_mobile", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
                cmd.Parameters.Add("po_fuel_trim", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
                cmd.Parameters.Add("po_variant", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
                cmd.Parameters.Add("po_model", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
                cmd.Parameters.Add("po_ew", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
                cmd.Parameters.Add("po_chassis_num", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
                cmd.Parameters.Add("po_mcp_no", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
                cmd.Parameters.Add("po_tv_cert_no", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
                cmd.Parameters.Add("po_insurance_name", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
                cmd.Parameters.Add("po_tech_name", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
                cmd.Parameters.Add("po_recomendations", OracleDbType.Varchar2, 2000).Direction = ParameterDirection.Output;//2000 changes by shailesh ITD 27 April 2020
                cmd.Parameters.Add("po_sez_cust", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
                cmd.Parameters.Add("po_unapproved_fit", OracleDbType.Varchar2, 2000).Direction = ParameterDirection.Output;
                cmd.Parameters.Add("po_bill_amt", OracleDbType.Int32, 25).Direction = ParameterDirection.Output;
                cmd.Parameters.Add("po_bill_amt_in_word", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
                cmd.Parameters.Add("po_amc_diff_amt", OracleDbType.Int32, 25).Direction = ParameterDirection.Output;
                cmd.Parameters.Add("po_ins_deductant", OracleDbType.Int32, 25).Direction = ParameterDirection.Output;
                cmd.Parameters.Add("po_ins_salvage", OracleDbType.Int32, 25).Direction = ParameterDirection.Output;
                cmd.Parameters.Add("po_reg_num", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
                cmd.Parameters.Add("po_jc_num", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
                cmd.Parameters.Add("po_created_by", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
                cmd.Parameters.Add("po_doc_num", OracleDbType.Varchar2, 18).Direction = ParameterDirection.Output;
                cmd.Parameters.Add("po_doc_date", OracleDbType.Varchar2, 50).Direction = ParameterDirection.Output;
                cmd.Parameters.Add("po_jc_date", OracleDbType.Varchar2, 50).Direction = ParameterDirection.Output;
                cmd.Parameters.Add("po_mileage", OracleDbType.Int32, 10).Direction = ParameterDirection.Output;
                cmd.Parameters.Add("po_cust_gstn", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
                cmd.Parameters.Add("po_dlr_gstn", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
                cmd.Parameters.Add("po_pos", OracleDbType.Varchar2, 50).Direction = ParameterDirection.Output;
                cmd.Parameters.Add("po_last_mileage", OracleDbType.Int32, 10).Direction = ParameterDirection.Output;
                cmd.Parameters.Add("po_service_type", OracleDbType.Varchar2, 100).Direction = ParameterDirection.Output;
                cmd.Parameters.Add("po_next_srv_due", OracleDbType.Varchar2, 50).Direction = ParameterDirection.Output;
                cmd.Parameters.Add("po_sa_name", OracleDbType.Varchar2, 150).Direction = ParameterDirection.Output;
                cmd.Parameters.Add("po_sa_mobile", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
                cmd.Parameters.Add("po_loyaltycard", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
                cmd.Parameters.Add("po_last_srv", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
                //End Output parmeters

                //Start ref cursor 
                cmd.Parameters.Add("po_demand_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;
                cmd.Parameters.Add("po_part_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;
                cmd.Parameters.Add("po_labor_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;
                cmd.Parameters.Add("po_bill_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;
                cmd.Parameters.Add("po_rej_prt_lab_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;
                cmd.Parameters.Add("po_gate_pass_refcur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;
                //End ref cursor

                //Start output parmeters 
                cmd.Parameters.Add("po_einv_irn", OracleDbType.Varchar2, 100).Direction = ParameterDirection.Output;
                cmd.Parameters.Add("po_qr_code", OracleDbType.Blob).Direction = ParameterDirection.Output;
                //End output parmeters

                //Start Output parmeters
                cmd.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
                cmd.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
                //End Output parmeters   

                cmd.CommandType = CommandType.StoredProcedure;
                //Execute cmd
                cmd.ExecuteNonQuery();

                if (Convert.ToString(cmd.Parameters["po_err_cd"].Value) == "0")
                {
                    //Start create class object
                    objJobCardInvoice = new JobCardInvoice();
                    //End create class object

                    //Start Binding output parmeters 
                    objJobCardInvoice.Dealer_Name = Convert.ToString(cmd.Parameters["po_dealer_name"].Value) == "null" ? string.Empty : Convert.ToString(cmd.Parameters["po_dealer_name"].Value);
                    objJobCardInvoice.Customer_ID = Convert.ToString(cmd.Parameters["po_cust_id"].Value) == "null" ? string.Empty : Convert.ToString(cmd.Parameters["po_cust_id"].Value);
                    objJobCardInvoice.Customer_Name = Convert.ToString(cmd.Parameters["po_cust_name"].Value) == "null" ? string.Empty : Convert.ToString(cmd.Parameters["po_cust_name"].Value);
                    objJobCardInvoice.Customer_Add1 = Convert.ToString(cmd.Parameters["po_cust_add1"].Value) == "null" ? string.Empty : Convert.ToString(cmd.Parameters["po_cust_add1"].Value);
                    objJobCardInvoice.Customer_Add2 = Convert.ToString(cmd.Parameters["po_cust_add2"].Value) == "null" ? string.Empty : Convert.ToString(cmd.Parameters["po_cust_add2"].Value);
                    objJobCardInvoice.Customer_Add3 = Convert.ToString(cmd.Parameters["po_cust_add3"].Value) == "null" ? string.Empty : Convert.ToString(cmd.Parameters["po_cust_add3"].Value);
                    objJobCardInvoice.Customer_City = Convert.ToString(cmd.Parameters["po_cust_city"].Value) == "null" ? string.Empty : Convert.ToString(cmd.Parameters["po_cust_city"].Value);
                    objJobCardInvoice.Customer_State_Desc = Convert.ToString(cmd.Parameters["po_cust_state_desc"].Value) == "null" ? string.Empty : Convert.ToString(cmd.Parameters["po_cust_state_desc"].Value);
                    objJobCardInvoice.Customer_Country = Convert.ToString(cmd.Parameters["po_cust_country"].Value) == "null" ? string.Empty : Convert.ToString(cmd.Parameters["po_cust_country"].Value);
                    objJobCardInvoice.Pin_Code = Convert.ToString(cmd.Parameters["po_cust_pin"].Value) == "null" ? string.Empty : Convert.ToString(cmd.Parameters["po_cust_pin"].Value);
                    objJobCardInvoice.Customer_Mobile = Convert.ToString(cmd.Parameters["po_cust_mobile"].Value) == "null" ? string.Empty : Convert.ToString(cmd.Parameters["po_cust_mobile"].Value);
                    objJobCardInvoice.Fuel_Trim = Convert.ToString(cmd.Parameters["po_fuel_trim"].Value) == "null" ? string.Empty : Convert.ToString(cmd.Parameters["po_fuel_trim"].Value);
                    objJobCardInvoice.Variant = Convert.ToString(cmd.Parameters["po_variant"].Value) == "null" ? string.Empty : Convert.ToString(cmd.Parameters["po_variant"].Value);
                    objJobCardInvoice.Model = Convert.ToString(cmd.Parameters["po_model"].Value) == "null" ? string.Empty : Convert.ToString(cmd.Parameters["po_model"].Value);
                    objJobCardInvoice.Ew_Type = Convert.ToString(cmd.Parameters["po_ew"].Value) == "null" ? string.Empty : Convert.ToString(cmd.Parameters["po_ew"].Value);
                    objJobCardInvoice.Chassis_No = Convert.ToString(cmd.Parameters["po_chassis_num"].Value) == "null" ? string.Empty : Convert.ToString(cmd.Parameters["po_chassis_num"].Value);
                    objJobCardInvoice.Mcp_No = Convert.ToString(cmd.Parameters["po_mcp_no"].Value) == "null" ? string.Empty : Convert.ToString(cmd.Parameters["po_mcp_no"].Value);
                    objJobCardInvoice.Tv_Cert_No = Convert.ToString(cmd.Parameters["po_tv_cert_no"].Value) == "null" ? string.Empty : Convert.ToString(cmd.Parameters["po_tv_cert_no"].Value);
                    objJobCardInvoice.Insurance_Name = Convert.ToString(cmd.Parameters["po_insurance_name"].Value) == "null" ? string.Empty : Convert.ToString(cmd.Parameters["po_insurance_name"].Value);
                    objJobCardInvoice.Tech_Name = Convert.ToString(cmd.Parameters["po_tech_name"].Value) == "null" ? string.Empty : Convert.ToString(cmd.Parameters["po_tech_name"].Value);
                    objJobCardInvoice.Recomendations = Convert.ToString(cmd.Parameters["po_recomendations"].Value) == "null" ? string.Empty : Convert.ToString(cmd.Parameters["po_recomendations"].Value);
                    objJobCardInvoice.Sez_Cust = Convert.ToString(cmd.Parameters["po_sez_cust"].Value) == "null" ? string.Empty : Convert.ToString(cmd.Parameters["po_sez_cust"].Value);
                    objJobCardInvoice.Unapproved_Fit = Convert.ToString(cmd.Parameters["po_unapproved_fit"].Value) == "null" ? string.Empty : Convert.ToString(cmd.Parameters["po_unapproved_fit"].Value);
                    objJobCardInvoice.Bill_Amt = Convert.ToString(cmd.Parameters["po_bill_amt"].Value) == "null" ? string.Empty : Convert.ToString(cmd.Parameters["po_bill_amt"].Value);
                    objJobCardInvoice.Bill_Amt_In_Word = Convert.ToString(cmd.Parameters["po_bill_amt_in_word"].Value) == "null" ? string.Empty : Convert.ToString(cmd.Parameters["po_bill_amt_in_word"].Value);
                    objJobCardInvoice.Amc_Diff_Amt = Convert.ToString(cmd.Parameters["po_amc_diff_amt"].Value) == "null" ? string.Empty : Convert.ToString(cmd.Parameters["po_amc_diff_amt"].Value);
                    objJobCardInvoice.Ins_Deductant = Convert.ToString(cmd.Parameters["po_ins_deductant"].Value) == "null" ? string.Empty : Convert.ToString(cmd.Parameters["po_ins_deductant"].Value);
                    objJobCardInvoice.Ins_Salvage = Convert.ToString(cmd.Parameters["po_ins_salvage"].Value) == "null" ? string.Empty : Convert.ToString(cmd.Parameters["po_ins_salvage"].Value);
                    objJobCardInvoice.RegNo = Convert.ToString(cmd.Parameters["po_reg_num"].Value) == "null" ? string.Empty : Convert.ToString(cmd.Parameters["po_reg_num"].Value);
                    objJobCardInvoice.JobCardNo = Convert.ToString(cmd.Parameters["po_jc_num"].Value) == "null" ? string.Empty : Convert.ToString(cmd.Parameters["po_jc_num"].Value);
                    objJobCardInvoice.Created_By = Convert.ToString(cmd.Parameters["po_created_by"].Value) == "null" ? string.Empty : Convert.ToString(cmd.Parameters["po_created_by"].Value);
                    objJobCardInvoice.Doc_Num = Convert.ToString(cmd.Parameters["po_doc_num"].Value) == "null" ? string.Empty : Convert.ToString(cmd.Parameters["po_doc_num"].Value);
                    objJobCardInvoice.Doc_Date = Convert.ToString(cmd.Parameters["po_doc_date"].Value) == "null" ? string.Empty : Convert.ToString(cmd.Parameters["po_doc_date"].Value);
                    objJobCardInvoice.JC_Date = Convert.ToString(cmd.Parameters["po_jc_date"].Value) == "null" ? string.Empty : Convert.ToString(cmd.Parameters["po_jc_date"].Value);
                    objJobCardInvoice.Mileage = Convert.ToString(cmd.Parameters["po_mileage"].Value) == "null" ? string.Empty : Convert.ToString(cmd.Parameters["po_mileage"].Value);
                    objJobCardInvoice.Cust_Gstn = Convert.ToString(cmd.Parameters["po_cust_gstn"].Value) == "null" ? string.Empty : Convert.ToString(cmd.Parameters["po_cust_gstn"].Value);
                    objJobCardInvoice.Dealer_Gstn = Convert.ToString(cmd.Parameters["po_dlr_gstn"].Value) == "null" ? string.Empty : Convert.ToString(cmd.Parameters["po_dlr_gstn"].Value);
                    objJobCardInvoice.Pos = Convert.ToString(cmd.Parameters["po_pos"].Value) == "null" ? string.Empty : Convert.ToString(cmd.Parameters["po_pos"].Value);
                    objJobCardInvoice.Last_Mileage = Convert.ToString(cmd.Parameters["po_last_mileage"].Value) == "null" ? string.Empty : Convert.ToString(cmd.Parameters["po_last_mileage"].Value);
                    objJobCardInvoice.Service_Type = Convert.ToString(cmd.Parameters["po_service_type"].Value) == "null" ? string.Empty : Convert.ToString(cmd.Parameters["po_service_type"].Value);
                    objJobCardInvoice.Next_Srv_Due = Convert.ToString(cmd.Parameters["po_next_srv_due"].Value) == "null" ? string.Empty : Convert.ToString(cmd.Parameters["po_next_srv_due"].Value);
                    objJobCardInvoice.SA_Name = Convert.ToString(cmd.Parameters["po_sa_name"].Value) == "null" ? string.Empty : Convert.ToString(cmd.Parameters["po_sa_name"].Value);
                    objJobCardInvoice.SA_Mobile = Convert.ToString(cmd.Parameters["po_sa_mobile"].Value) == "null" ? string.Empty : Convert.ToString(cmd.Parameters["po_sa_mobile"].Value);
                    objJobCardInvoice.Loyalty_Card = Convert.ToString(cmd.Parameters["po_loyaltycard"].Value) == "null" ? string.Empty : Convert.ToString(cmd.Parameters["po_loyaltycard"].Value);
                    objJobCardInvoice.Last_Srv = Convert.ToString(cmd.Parameters["po_last_srv"].Value) == "null" ? string.Empty : Convert.ToString(cmd.Parameters["po_last_srv"].Value);

                    objJobCardInvoice.Einv_Irn = string.IsNullOrEmpty(Convert.ToString(cmd.Parameters["po_einv_irn"].Value)) ? string.Empty : Convert.ToString(cmd.Parameters["po_einv_irn"].Value);
                    if (!Convert.IsDBNull(cmd.Parameters["po_qr_code"].Value))
                    {
                        OracleBlob blob = (OracleBlob)cmd.Parameters["po_qr_code"].Value;
                        Byte[] byteArr = new Byte[blob.Length];
                        int i = blob.Read(byteArr, 0, System.Convert.ToInt32(blob.Length));
                        objJobCardInvoice.QRByteCode = byteArr;
                    }

                    //End Binding output parmeters 

                    //Demand ref cursor
                    Demand objDemand = null;
                    OracleDataReader drDemand = ((Oracle.DataAccess.Types.OracleRefCursor)cmd.Parameters["po_demand_refcur"].Value).GetDataReader();
                    //create object lstDemand
                    objJobCardInvoice.lstDemand = new System.Collections.Generic.List<Demand>();
                    if (drDemand.HasRows)
                    {

                        while (drDemand.Read())
                        {
                            objDemand = new Demand();
                            objDemand.Demand_CD = Convert.ToString(drDemand["demand_cd"]);
                            objDemand.Demand_Desc = Convert.ToString(drDemand["demand_desc"]);
                            objDemand.Demand_Type = Convert.ToString(drDemand["demand_type"]);
                            objDemand.Problem_Narr = Convert.ToString(drDemand["problem_narr"]);
                            objDemand.Problem_CD = Convert.ToString(drDemand["problem_Cd"]);
                            objDemand.Problem_Desc = Convert.ToString(drDemand["problem_desc"]);
                            objDemand.Fault_CD = Convert.ToString(drDemand["fault_Cd"]);
                            objDemand.Fault_Desc = Convert.ToString(drDemand["fault_desc"]);
                            objDemand.Action_Code = Convert.ToString(drDemand["action_code"]);
                            objDemand.Action_Desc = Convert.ToString(drDemand["action_Desc"]);
                            objJobCardInvoice.lstDemand.Add(objDemand);
                        }
                        //check and clr obj
                        drDemand = null;
                    }

                    //Part ref cursor
                    Part objPart = null;
                    OracleDataReader drPart = ((Oracle.DataAccess.Types.OracleRefCursor)cmd.Parameters["po_part_refcur"].Value).GetDataReader();
                    //create object lstPart
                    objJobCardInvoice.lstPart = new System.Collections.Generic.List<Part>();
                    if (drPart.HasRows)
                    {
                        while (drPart.Read())
                        {
                            objPart = new Part();
                            objPart.Part_Num = Convert.ToString(drPart["part_num"]);
                            objPart.Part_Desc = Convert.ToString(drPart["part_desc"]);
                            objPart.Iss_Qty = Convert.ToString(drPart["iss_qty"]);
                            objPart.Rate = Convert.ToString(drPart["rate"]);
                            objPart.Taxable_Amt = Convert.ToString(drPart["taxable_amt"]);
                            objPart.Tax_Paid_Amt = Convert.ToString(drPart["taxpaid_amt"]);
                            objPart.Hs_Code = Convert.ToString(drPart["HS_CODE"]);
                            objPart.Tax = Convert.ToString(drPart["TAX"]);//Tax_per_new to TAX changes by shailesh 27/April/2020
                            objPart.Batch = Convert.ToString(drPart["Batch"]);
                            objPart.Req_Iss_Type = Convert.ToString(drPart["Req_iss_type"]);
                            objJobCardInvoice.lstPart.Add(objPart);
                        }
                        //check and clr obj
                        drPart = null;
                    }

                    //Labor ref cursor
                    Labor objLabor = null;
                    OracleDataReader drLabor = ((Oracle.DataAccess.Types.OracleRefCursor)cmd.Parameters["po_labor_refcur"].Value).GetDataReader();
                    //create object lstLabor                       
                    objJobCardInvoice.lstLabor = new System.Collections.Generic.List<Labor>();
                    if (drLabor.HasRows)
                    {
                        while (drLabor.Read())
                        {
                            objLabor = new Labor();
                            objLabor.Labor_CD = Convert.ToString(drLabor["labor_cd"]);
                            objLabor.Labor_Desc = Convert.ToString(drLabor["labor_desc"]);
                            objLabor.Labor_Charges = Convert.ToString(drLabor["labor_charges"]);
                            objLabor.Sac_Code = Convert.ToString(drLabor["SAC_CODE"]);
                            objLabor.Opr_Type = Convert.ToString(drLabor["OPR_TYPE"]);
                            objJobCardInvoice.lstLabor.Add(objLabor);
                        }
                        //check and clr obj
                        drLabor = null;
                    }

                    //Bill ref cursor
                    Bill objBill = null;
                    OracleDataReader drBill = ((Oracle.DataAccess.Types.OracleRefCursor)cmd.Parameters["po_bill_refcur"].Value).GetDataReader();
                    //create object lstBill                    
                    objJobCardInvoice.lstBill = new System.Collections.Generic.List<Bill>();

                    if (drBill.HasRows)
                    {
                        while (drBill.Read())
                        {
                            objBill = new Bill();
                            objBill.Header = Convert.ToString(drBill["header"]);
                            objBill.Part_Charges = Convert.ToString(drBill["part_charges"]);
                            objBill.Tax_Paid_Amt = Convert.ToString(drBill["tax_paid_amt"]);
                            objBill.Labour_Charges = Convert.ToString(drBill["labour_charges"]);
                            objJobCardInvoice.lstBill.Add(objBill);
                        }
                        //check and clr obj
                        drBill = null;
                    }

                    //Rejected Part and Labor ref cursor
                    RejectedPartLab objRejectedPartLab = null;
                    OracleDataReader drRejPartLabor = ((Oracle.DataAccess.Types.OracleRefCursor)cmd.Parameters["po_rej_prt_lab_refcur"].Value).GetDataReader();
                    //create object lstRejectedPartLab                                      
                    objJobCardInvoice.lstRejectedPartLab = new System.Collections.Generic.List<RejectedPartLab>();
                    if (drRejPartLabor.HasRows)
                    {
                        while (drRejPartLabor.Read())
                        {
                            objRejectedPartLab = new RejectedPartLab();
                            objRejectedPartLab.Srv_Code = Convert.ToString(drRejPartLabor["SRV_CODE"]);
                            objRejectedPartLab.Srv_Desc = Convert.ToString(drRejPartLabor["SRV_DESC"]);
                            objRejectedPartLab.Srv_Qty = Convert.ToString(drRejPartLabor["SRV_QTY"]);
                            objRejectedPartLab.Srv_Amt = Convert.ToString(drRejPartLabor["SRV_AMT"]);
                            objRejectedPartLab.Srv_Type = Convert.ToString(drRejPartLabor["SRV_TYPE"]);
                            objJobCardInvoice.lstRejectedPartLab.Add(objRejectedPartLab);
                        }
                        //check and clr obj
                        drRejPartLabor = null;
                    }

                    //Gate Pass ref cursor
                    GatePass objGatePass = null;
                    OracleDataReader drGatePass = ((Oracle.DataAccess.Types.OracleRefCursor)cmd.Parameters["po_gate_pass_refcur"].Value).GetDataReader();
                    //create object lstGatePass                 
                    objJobCardInvoice.lstGatePass = new System.Collections.Generic.List<GatePass>();
                    if (drGatePass.HasRows)
                    {
                        while (drGatePass.Read())
                        {
                            objGatePass = new GatePass();
                            objGatePass.Doc_Num = Convert.ToString(drGatePass["DOC_NUM"]);
                            objGatePass.Doc_Date = Convert.ToString(drGatePass["DOC_DATE"]);
                            objGatePass.Ro_Num = Convert.ToString(drGatePass["RO_NUM"]);
                            objGatePass.Doc_Amount = Convert.ToString(drGatePass["DOC_AMOUNT"]);
                            objGatePass.Gp_Num = Convert.ToString(drGatePass["GP_NUM"]);
                            objJobCardInvoice.lstGatePass.Add(objGatePass);
                        }
                        //check and clr obj
                        drGatePass = null;
                    }

                    //generate response 
                    result = new
                    {
                        Code = "0",
                        Message = "Success",
                        DigitalInvoiceDetails = objJobCardInvoice
                    };
                    Logger.SuccessLogPrint("BaseReturnType", "sp_jcbill_print", "'pn_parent_group':'" + ParentGroup + "','pn_dealer_map_cd':'" + DealerMapCd + "','pn_loc_Cd':'" + LocCd + "','pn_comp_fa':'" + CompFa + "','pn_jc_num':'" + JobCardNo + "','pn_user_id':'" + UserID, "Success Code': '" + Convert.ToString(cmd.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(cmd.Parameters["PO_ERR_MSG"].Value));

                }
                else
                {
                    result = new
                    {
                        Code = Convert.ToString(cmd.Parameters["po_err_cd"].Value),
                        Message = Convert.ToString(cmd.Parameters["po_err_msg"].Value),
                        DigitalInvoiceDetails = objJobCardInvoice
                    };
                }
            }
            catch (Exception ex)
            {
                if (objConnection != null && (objConnection.State == ConnectionState.Open))
                {
                    objConnection.Dispose();
                    objConnection = null;
                }
                result = new
                {
                    Code = "100",
                    Message = ex.Message
                };
                Logger.ErrorLogException("BaseReturnType", "sp_jcbill_print", "'pn_parent_group':'" + ParentGroup + "','pn_dealer_map_cd':'" + DealerMapCd + "','pn_loc_Cd':'" + LocCd + "','pn_comp_fa':'" + CompFa + "','pn_jc_num':'" + JobCardNo + "','pn_user_id':'" + UserID, ex);

            }
            finally
            {
                if (cmd != null)
                {
                    cmd.Dispose();
                    cmd = null;
                }
                if (objConnection != null && (objConnection.State == ConnectionState.Open))
                {
                    objConnection.Dispose();
                    objConnection = null;
                }
            }
        }
        return result;
    }

    /// <summary>
    /// GetNewBillPrint For MTAB Invoice Data
    /// </summary>
    /// <param name="userID"></param>
    /// <param name="JobCardnum"></param>
    /// <returns></returns>
    [WebMethod]
    public static BaseReturnType<NewBillPrintModel> GetNewBillPrint(string userID, string JobCardnum)
    {
        NewBillPrintModel objNewBillPrintModel = null;
        BaseReturnType<NewBillPrintModel> response = null;

        OracleCommand cmd = null;
        OracleConnection objConnection = null;

        try
        {
            response = new BaseReturnType<NewBillPrintModel>();
            objConnection = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));

            objConnection.Open();
            cmd = new OracleCommand("pkg_jco_1.sp_jcbill_print", objConnection);
            //Input parameter
            cmd.Parameters.Add("pn_user_id", OracleDbType.Varchar2, 20, ParameterDirection.Input).Value = Convert.ToString(userID);
            cmd.Parameters.Add("pn_jc_no", OracleDbType.Varchar2, 12, ParameterDirection.Input).Value = Convert.ToString(JobCardnum);

            //Out parameter
            cmd.Parameters.Add("po_jc_date", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            cmd.Parameters.Add("po_cust_id", OracleDbType.Varchar2, 10).Direction = ParameterDirection.Output;
            cmd.Parameters.Add("po_cust_name", OracleDbType.Varchar2, 100).Direction = ParameterDirection.Output;
            cmd.Parameters.Add("po_cust_add", OracleDbType.Varchar2, 500).Direction = ParameterDirection.Output;
            cmd.Parameters.Add("po_cust_phone", OracleDbType.Varchar2, 50).Direction = ParameterDirection.Output;
            cmd.Parameters.Add("po_car_user_name", OracleDbType.Varchar2, 100).Direction = ParameterDirection.Output;
            cmd.Parameters.Add("po_email", OracleDbType.Varchar2, 100).Direction = ParameterDirection.Output;
            cmd.Parameters.Add("po_reg_num", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            cmd.Parameters.Add("po_chassis_num", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            cmd.Parameters.Add("po_engine_num", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            cmd.Parameters.Add("po_model", OracleDbType.Varchar2, 50).Direction = ParameterDirection.Output;
            cmd.Parameters.Add("po_milege", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            cmd.Parameters.Add("po_sold_by", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            cmd.Parameters.Add("po_sold_date", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            cmd.Parameters.Add("po_key_no", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            cmd.Parameters.Add("po_tv_sale_date", OracleDbType.Varchar2, 100).Direction = ParameterDirection.Output;
            cmd.Parameters.Add("po_service_type", OracleDbType.Varchar2, 50).Direction = ParameterDirection.Output;
            cmd.Parameters.Add("po_sub_service_type", OracleDbType.Varchar2, 50).Direction = ParameterDirection.Output;
            cmd.Parameters.Add("po_demand_ref_cur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;
            cmd.Parameters.Add("po_instructions", OracleDbType.Varchar2, 500).Direction = ParameterDirection.Output;
            cmd.Parameters.Add("po_srv_adv", OracleDbType.Varchar2, 120).Direction = ParameterDirection.Output;
            cmd.Parameters.Add("po_prom_intial_date", OracleDbType.Varchar2, 120).Direction = ParameterDirection.Output;
            cmd.Parameters.Add("po_prom_intial_time", OracleDbType.Varchar2, 120).Direction = ParameterDirection.Output;
            cmd.Parameters.Add("po_prom_revd_date", OracleDbType.Varchar2, 120).Direction = ParameterDirection.Output;
            cmd.Parameters.Add("po_prom_revd_time", OracleDbType.Varchar2, 120).Direction = ParameterDirection.Output;
            cmd.Parameters.Add("po_tech_circular_desc", OracleDbType.Varchar2, 120).Direction = ParameterDirection.Output;
            cmd.Parameters.Add("po_est_sch_labor_amt", OracleDbType.Int32, 10).Direction = ParameterDirection.Output;
            cmd.Parameters.Add("po_est_sch_part_amt", OracleDbType.Int32, 10).Direction = ParameterDirection.Output;
            cmd.Parameters.Add("po_re_sch_est_labor_amt", OracleDbType.Int32, 10).Direction = ParameterDirection.Output;
            cmd.Parameters.Add("po_re_sch_est_part_amt", OracleDbType.Int32, 10).Direction = ParameterDirection.Output;
            cmd.Parameters.Add("po_est_labor_amt", OracleDbType.Int32, 10).Direction = ParameterDirection.Output;
            cmd.Parameters.Add("po_est_part_amt", OracleDbType.Int32, 10).Direction = ParameterDirection.Output;
            cmd.Parameters.Add("po_re_est_labor_amt", OracleDbType.Int32, 10).Direction = ParameterDirection.Output;
            cmd.Parameters.Add("po_re_est_part_amt", OracleDbType.Int32, 10).Direction = ParameterDirection.Output;
            cmd.Parameters.Add("po_part_ref_cur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;
            cmd.Parameters.Add("po_group_cd", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            cmd.Parameters.Add("po_mech_cd", OracleDbType.Varchar2, 20).Direction = ParameterDirection.Output;
            cmd.Parameters.Add("po_created_by", OracleDbType.Varchar2, 100).Direction = ParameterDirection.Output;
            cmd.Parameters.Add("po_inv_ref_cur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;
            cmd.Parameters.Add("po_hist1_jc_no", OracleDbType.Varchar2, 100).Direction = ParameterDirection.Output;
            cmd.Parameters.Add("po_hist1_jc_dt", OracleDbType.Varchar2, 100).Direction = ParameterDirection.Output;
            cmd.Parameters.Add("po_hist1_mileage", OracleDbType.Int32, 10).Direction = ParameterDirection.Output;
            cmd.Parameters.Add("po_hist1_group", OracleDbType.Varchar2, 100).Direction = ParameterDirection.Output;
            cmd.Parameters.Add("po_hist1_srv_adv", OracleDbType.Varchar2, 100).Direction = ParameterDirection.Output;
            cmd.Parameters.Add("po_hist1_mechanic", OracleDbType.Varchar2, 100).Direction = ParameterDirection.Output;
            cmd.Parameters.Add("po_hist1_lbr_amt", OracleDbType.Int32, 10).Direction = ParameterDirection.Output;
            cmd.Parameters.Add("po_hist1_part_amt", OracleDbType.Int32, 10).Direction = ParameterDirection.Output;
            cmd.Parameters.Add("po_hist1_srv_type", OracleDbType.Varchar2, 100).Direction = ParameterDirection.Output;
            cmd.Parameters.Add("po_hist1_psf_stat", OracleDbType.Varchar2, 100).Direction = ParameterDirection.Output;
            cmd.Parameters.Add("po_hist1_csi_pert", OracleDbType.Int32, 10).Direction = ParameterDirection.Output;
            cmd.Parameters.Add("po_hist1_remarks", OracleDbType.Varchar2, 100).Direction = ParameterDirection.Output;
            cmd.Parameters.Add("po_hist1_dtl_ref_cur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;
            cmd.Parameters.Add("po_hist2_jc_no", OracleDbType.Varchar2, 100).Direction = ParameterDirection.Output;
            cmd.Parameters.Add("po_hist2_jc_dt", OracleDbType.Varchar2, 100).Direction = ParameterDirection.Output;
            cmd.Parameters.Add("po_hist2_mileage", OracleDbType.Int32, 10).Direction = ParameterDirection.Output;
            cmd.Parameters.Add("po_hist2_group", OracleDbType.Varchar2, 100).Direction = ParameterDirection.Output;
            cmd.Parameters.Add("po_hist2_srv_adv", OracleDbType.Varchar2, 100).Direction = ParameterDirection.Output;
            cmd.Parameters.Add("po_hist2_mechanic", OracleDbType.Varchar2, 100).Direction = ParameterDirection.Output;
            cmd.Parameters.Add("po_hist2_lbr_amt", OracleDbType.Int32, 10).Direction = ParameterDirection.Output;
            cmd.Parameters.Add("po_hist2_part_amt", OracleDbType.Int32, 10).Direction = ParameterDirection.Output;
            cmd.Parameters.Add("po_hist2_srv_type", OracleDbType.Varchar2, 100).Direction = ParameterDirection.Output;
            cmd.Parameters.Add("po_hist2_psf_stat", OracleDbType.Varchar2, 100).Direction = ParameterDirection.Output;
            cmd.Parameters.Add("po_hist2_csi_pert", OracleDbType.Int32, 10).Direction = ParameterDirection.Output;
            cmd.Parameters.Add("po_hist2_remarks", OracleDbType.Varchar2, 100).Direction = ParameterDirection.Output;
            cmd.Parameters.Add("po_hist2_dtl_ref_cur", OracleDbType.RefCursor).Direction = ParameterDirection.Output;
            // Added new parameter and ref cursor PO_SUBS_YN, PO_PVO_SUBSCRIBER_DET added by mukesh sinha 15NOV2019
            cmd.Parameters.Add("PO_SUBS_YN", OracleDbType.Varchar2, 1).Direction = ParameterDirection.Output;
            cmd.Parameters.Add("PO_SUBSCRIBER_DET", OracleDbType.RefCursor).Direction = ParameterDirection.Output;
            //start added by gagan sharma 6may2022
            cmd.Parameters.Add("po_ccp_yn", OracleDbType.Varchar2, 1).Direction = ParameterDirection.Output;
            cmd.Parameters.Add("po_ccp_num", OracleDbType.Varchar2, 12).Direction = ParameterDirection.Output;
            //end by gagan sharma 6may2022
            cmd.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            cmd.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
            cmd.CommandType = CommandType.StoredProcedure;
            cmd.ExecuteNonQuery();

            if (Convert.ToString(cmd.Parameters["po_err_cd"].Value) == "0")
            {
                objNewBillPrintModel = new NewBillPrintModel();
                objNewBillPrintModel.JC_DATE = Convert.ToString(cmd.Parameters["po_jc_date"].Value);
                objNewBillPrintModel.CUST_ID = Convert.ToString(cmd.Parameters["po_cust_id"].Value);
                objNewBillPrintModel.CUST_NAME = Convert.ToString(cmd.Parameters["po_cust_name"].Value);
                objNewBillPrintModel.CUST_ADD = Convert.ToString(cmd.Parameters["po_cust_add"].Value);
                objNewBillPrintModel.CUST_PHONE = Convert.ToString(cmd.Parameters["po_cust_phone"].Value);
                objNewBillPrintModel.CAR_USER_NAME = Convert.ToString(cmd.Parameters["po_car_user_name"].Value);
                objNewBillPrintModel.EMAIL = Convert.ToString(cmd.Parameters["po_email"].Value);
                objNewBillPrintModel.REG_NUM = Convert.ToString(cmd.Parameters["po_reg_num"].Value);
                objNewBillPrintModel.CHASSIS_NUM = Convert.ToString(cmd.Parameters["po_chassis_num"].Value);
                objNewBillPrintModel.ENGINE_NUM = Convert.ToString(cmd.Parameters["po_engine_num"].Value);
                objNewBillPrintModel.MODEL = Convert.ToString(cmd.Parameters["po_model"].Value);
                objNewBillPrintModel.MILEAGE = Convert.ToString(cmd.Parameters["po_milege"].Value);
                objNewBillPrintModel.SOLD_BY = Convert.ToString(cmd.Parameters["po_sold_by"].Value);
                objNewBillPrintModel.SOLD_DATE = Convert.ToString(cmd.Parameters["po_sold_date"].Value);
                objNewBillPrintModel.KEY_NO = Convert.ToString(cmd.Parameters["po_key_no"].Value);
                objNewBillPrintModel.TV_SALE_DATE = Convert.ToString(cmd.Parameters["po_tv_sale_date"].Value);
                objNewBillPrintModel.SERVICE_TYPE = Convert.ToString(cmd.Parameters["po_service_type"].Value);
                objNewBillPrintModel.SUB_SERVICE_TYPE = Convert.ToString(cmd.Parameters["po_sub_service_type"].Value);
                objNewBillPrintModel.SUB_SERVICE_TYPE = Convert.ToString(cmd.Parameters["po_sub_service_type"].Value);
                objNewBillPrintModel.INSTRUCTIONS = Convert.ToString(cmd.Parameters["po_instructions"].Value);
                objNewBillPrintModel.SRV_ADV = Convert.ToString(cmd.Parameters["po_srv_adv"].Value);
                objNewBillPrintModel.PROM_INTIAL_DATE = Convert.ToString(cmd.Parameters["po_prom_intial_date"].Value);
                objNewBillPrintModel.PROM_INTIAL_TIME = Convert.ToString(cmd.Parameters["po_prom_intial_time"].Value);
                objNewBillPrintModel.PROM_REVD_DATE = Convert.ToString(cmd.Parameters["po_prom_revd_date"].Value);
                objNewBillPrintModel.PROM_REVD_TIME = Convert.ToString(cmd.Parameters["po_prom_revd_time"].Value);
                objNewBillPrintModel.TECH_CIRCULAR_DESC = Convert.ToString(cmd.Parameters["po_tech_circular_desc"].Value);
                objNewBillPrintModel.EST_SCH_LABOR_AMT = Convert.ToString(cmd.Parameters["po_est_sch_labor_amt"].Value);
                objNewBillPrintModel.EST_SCH_PART_AMT = Convert.ToString(cmd.Parameters["po_est_sch_part_amt"].Value);
                objNewBillPrintModel.RE_SCH_EST_LABOR_AMT = Convert.ToString(cmd.Parameters["po_re_sch_est_labor_amt"].Value);
                objNewBillPrintModel.RE_SCH_EST_PART_AMT = Convert.ToString(cmd.Parameters["po_re_sch_est_part_amt"].Value);
                objNewBillPrintModel.EST_LABOR_AMT = Convert.ToString(cmd.Parameters["po_est_labor_amt"].Value);
                objNewBillPrintModel.EST_PART_AMT = Convert.ToString(cmd.Parameters["po_est_part_amt"].Value);
                objNewBillPrintModel.RE_EST_LABOR_AMT = Convert.ToString(cmd.Parameters["po_re_est_labor_amt"].Value);
                objNewBillPrintModel.RE_EST_PART_AMT = Convert.ToString(cmd.Parameters["po_re_est_part_amt"].Value);
                objNewBillPrintModel.GROUP_CD = Convert.ToString(cmd.Parameters["po_group_cd"].Value);
                objNewBillPrintModel.MECH_CD = Convert.ToString(cmd.Parameters["po_mech_cd"].Value);
                objNewBillPrintModel.CREATED_BY = Convert.ToString(cmd.Parameters["po_created_by"].Value);
                objNewBillPrintModel.CREATED_BY = Convert.ToString(cmd.Parameters["po_created_by"].Value);
                objNewBillPrintModel.HIST1_JC_NO = Convert.ToString(cmd.Parameters["po_hist1_jc_no"].Value);
                objNewBillPrintModel.HIST1_JC_DT = Convert.ToString(cmd.Parameters["po_hist1_jc_dt"].Value);
                objNewBillPrintModel.HIST1_MILEAGE = Convert.ToString(cmd.Parameters["po_hist1_mileage"].Value);
                objNewBillPrintModel.HIST1_GROUP = Convert.ToString(cmd.Parameters["po_hist1_group"].Value);
                objNewBillPrintModel.HIST1_SRV_ADV = Convert.ToString(cmd.Parameters["po_hist1_srv_adv"].Value);
                objNewBillPrintModel.HIST1_MECHANIC = Convert.ToString(cmd.Parameters["po_hist1_mechanic"].Value);
                objNewBillPrintModel.HIST1_LBR_AMT = Convert.ToString(cmd.Parameters["po_hist1_lbr_amt"].Value);
                objNewBillPrintModel.HIST1_PART_AMT = Convert.ToString(cmd.Parameters["po_hist1_part_amt"].Value);
                objNewBillPrintModel.HIST1_SRV_TYPE = Convert.ToString(cmd.Parameters["po_hist1_srv_type"].Value);
                objNewBillPrintModel.HIST1_PSF_STAT = Convert.ToString(cmd.Parameters["po_hist1_psf_stat"].Value);
                objNewBillPrintModel.HIST1_CSI_PERT = Convert.ToString(cmd.Parameters["po_hist1_csi_pert"].Value);
                objNewBillPrintModel.HIST1_REMARKS = Convert.ToString(cmd.Parameters["po_hist1_remarks"].Value);
                objNewBillPrintModel.HIST2_JC_NO = Convert.ToString(cmd.Parameters["po_hist2_jc_no"].Value);
                objNewBillPrintModel.HIST2_JC_DT = Convert.ToString(cmd.Parameters["po_hist2_jc_dt"].Value);
                objNewBillPrintModel.HIST2_MILEAGE = Convert.ToString(cmd.Parameters["po_hist2_mileage"].Value);
                objNewBillPrintModel.HIST2_GROUP = Convert.ToString(cmd.Parameters["po_hist2_group"].Value);
                objNewBillPrintModel.HIST2_SRV_ADV = Convert.ToString(cmd.Parameters["po_hist2_srv_adv"].Value);
                objNewBillPrintModel.HIST2_MECHANIC = Convert.ToString(cmd.Parameters["po_hist2_mechanic"].Value);
                objNewBillPrintModel.HIST2_LBR_AMT = Convert.ToString(cmd.Parameters["po_hist2_lbr_amt"].Value);
                objNewBillPrintModel.HIST2_PART_AMT = Convert.ToString(cmd.Parameters["po_hist2_part_amt"].Value);
                objNewBillPrintModel.HIST2_SRV_TYPE = Convert.ToString(cmd.Parameters["po_hist2_srv_type"].Value);
                objNewBillPrintModel.HIST2_PSF_STAT = Convert.ToString(cmd.Parameters["po_hist2_psf_stat"].Value);
                objNewBillPrintModel.HIST2_CSI_PERT = Convert.ToString(cmd.Parameters["po_hist2_csi_pert"].Value);
                objNewBillPrintModel.HIST2_REMARKS = Convert.ToString(cmd.Parameters["po_hist2_remarks"].Value);
                objNewBillPrintModel.SUBS_YN = Convert.ToString(cmd.Parameters["PO_SUBS_YN"].Value);
                objNewBillPrintModel.po_ccp_yn = Convert.ToString(cmd.Parameters["po_ccp_yn"].Value);
                objNewBillPrintModel.po_ccp_num = Convert.ToString(cmd.Parameters["po_ccp_num"].Value);

                //Demand ref cursor
                OracleDataReader drDemand = ((Oracle.DataAccess.Types.OracleRefCursor)cmd.Parameters["po_demand_ref_cur"].Value).GetDataReader();
                if (drDemand.HasRows)
                {
                    objNewBillPrintModel.lstDemand = new System.Collections.Generic.List<DemandRefCursor>();
                    DemandRefCursor objDemand = null;
                    while (drDemand.Read())
                    {
                        objDemand = new DemandRefCursor();
                        objDemand.DEMAND_DESC = Convert.ToString(drDemand[0]);
                        objNewBillPrintModel.lstDemand.Add(objDemand);
                    }
                    if (drDemand != null)
                    {
                        drDemand.Dispose();
                        drDemand = null;
                    }
                }

                //Inventory ref cursor
                OracleDataReader drInventory = ((Oracle.DataAccess.Types.OracleRefCursor)cmd.Parameters["po_inv_ref_cur"].Value).GetDataReader();
                if (drInventory.HasRows)
                {
                    objNewBillPrintModel.lstInventory = new System.Collections.Generic.List<InvRefCursor>();
                    InvRefCursor objInvRefCursor = null;
                    while (drInventory.Read())
                    {
                        objInvRefCursor = new InvRefCursor();
                        objInvRefCursor.INVENTORY_DESC = Convert.ToString(drInventory[0]);
                        objInvRefCursor.INV_REMARKS = Convert.ToString(drInventory[1]);
                        objNewBillPrintModel.lstInventory.Add(objInvRefCursor);
                    }
                    if (drInventory != null)
                    {
                        drInventory.Dispose();
                        drInventory = null;
                    }
                }

                //Part ref cursor
                OracleDataReader drPart = ((Oracle.DataAccess.Types.OracleRefCursor)cmd.Parameters["po_part_ref_cur"].Value).GetDataReader();
                if (drPart.HasRows)
                {
                    objNewBillPrintModel.lstPart = new System.Collections.Generic.List<PartRefCursor>();
                    PartRefCursor objPartRefCursor = null;
                    while (drPart.Read())
                    {
                        objPartRefCursor = new PartRefCursor();
                        objPartRefCursor.PART_DESC = Convert.ToString(drPart[0]);
                        objPartRefCursor.ACCEPT_YN = Convert.ToString(drPart[1]);
                        objPartRefCursor.REJECT_REASON = Convert.ToString(drPart[2]);
                        objNewBillPrintModel.lstPart.Add(objPartRefCursor);
                    }

                    if (drPart != null)
                    {
                        drPart.Dispose();
                        drPart = null;
                    }
                }

                //History1Dtl ref cursor
                OracleDataReader drHistory1Dtl = ((Oracle.DataAccess.Types.OracleRefCursor)cmd.Parameters["po_hist1_dtl_ref_cur"].Value).GetDataReader();
                if (drHistory1Dtl.HasRows)
                {
                    objNewBillPrintModel.lstHistory1Dtl = new System.Collections.Generic.List<HIST1_DTL_RefCursor>();
                    HIST1_DTL_RefCursor objHIST1 = null;
                    while (drHistory1Dtl.Read())
                    {
                        objHIST1 = new HIST1_DTL_RefCursor();
                        objHIST1.OPR_CD = Convert.ToString(drHistory1Dtl[0]);
                        objHIST1.OPR_DESC = Convert.ToString(drHistory1Dtl[1]);
                        objHIST1.QTY = Convert.ToString(drHistory1Dtl[2]);
                        objNewBillPrintModel.lstHistory1Dtl.Add(objHIST1);
                    }

                    if (drHistory1Dtl != null)
                    {
                        drHistory1Dtl.Dispose();
                        drHistory1Dtl = null;
                    }
                }

                //History2Dtl ref cursor
                OracleDataReader drHistory2Dtl = ((Oracle.DataAccess.Types.OracleRefCursor)cmd.Parameters["po_hist2_dtl_ref_cur"].Value).GetDataReader();
                if (drHistory2Dtl.HasRows)
                {
                    objNewBillPrintModel.lstHistory2Dtl = new System.Collections.Generic.List<HIST2_DTL_RefCursor>();
                    HIST2_DTL_RefCursor objHIST2 = null;
                    while (drHistory2Dtl.Read())
                    {
                        objHIST2 = new HIST2_DTL_RefCursor();
                        objHIST2.OPR_CD = Convert.ToString(drHistory2Dtl[0]);
                        objHIST2.OPR_DESC = Convert.ToString(drHistory2Dtl[1]);
                        objHIST2.QTY = Convert.ToString(drHistory2Dtl[2]);
                        objNewBillPrintModel.lstHistory2Dtl.Add(objHIST2);
                    }
                    if (drHistory2Dtl != null)
                    {
                        drHistory2Dtl.Dispose();
                        drHistory2Dtl = null;
                    }
                }

                //SubscripberDtl ref cursor
                OracleDataReader drSubDtl = ((Oracle.DataAccess.Types.OracleRefCursor)cmd.Parameters["PO_SUBSCRIBER_DET"].Value).GetDataReader();
                if (drSubDtl.HasRows)
                {
                    SUBSCRIBER_DET objSub = null;
                    objNewBillPrintModel.lstSubscriberDtl = new System.Collections.Generic.List<SUBSCRIBER_DET>();
                    while (drSubDtl.Read())
                    {
                        objSub = new SUBSCRIBER_DET();
                        objSub.DMS_SUBSCRIBER_ID = Convert.ToString(drSubDtl[0]);
                        objSub.SUBS_NAME = Convert.ToString(drSubDtl[1]);
                        objSub.SUBS_EMAIL = Convert.ToString(drSubDtl[2]);
                        objSub.SUBS_DOB = Convert.ToString(drSubDtl[3]);
                        objSub.SUBS_ADD1 = Convert.ToString(drSubDtl[4]);
                        objSub.SUBS_ADD2 = Convert.ToString(drSubDtl[5]);
                        objSub.SUBS_ADD3 = Convert.ToString(drSubDtl[6]);
                        objSub.SUBS_PIN = Convert.ToString(drSubDtl[7]);
                        objSub.SUBS_CITY_CD = Convert.ToString(drSubDtl[8]);
                        objSub.SUBS_CITY_DESC = Convert.ToString(drSubDtl[9]);
                        objSub.SUBS_STATE_CD = Convert.ToString(drSubDtl[10]);
                        objSub.SUBS_STATE_DESC = Convert.ToString(drSubDtl[11]);
                        objSub.SUBS_MOBILE = Convert.ToString(drSubDtl[12]);
                        objNewBillPrintModel.lstSubscriberDtl.Add(objSub);
                    }
                    if (drSubDtl != null)
                    {
                        drSubDtl.Dispose();
                        drSubDtl = null;
                    }
                }
                response.code = (int)ServiceMassageCode.SUCCESS;
                response.message = Convert.ToString(ServiceMassageCode.SUCCESS);
                response.result = objNewBillPrintModel;
                Logger.SuccessLogPrint("BaseReturnType", "sp_jcbill_print", "'pn_user_id':'" + userID + "','pn_jc_no':'" + JobCardnum, "Success Code': '" + Convert.ToString(cmd.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(cmd.Parameters["PO_ERR_MSG"].Value));

            }
            else
            {
                response.code = Convert.ToInt32(cmd.Parameters["po_err_cd"].Value);
                response.message = Convert.ToString(cmd.Parameters["po_err_msg"].Value);
                response.result = null;
            }
        }
        catch (Exception EX)
        {
            objConnection.Close();
            cmd.Dispose();
            response.code = 100;
            response.message = EX.Message;
            response.result = null;
            Logger.ErrorLogException("BaseReturnType", "sp_jcbill_print", "'pn_user_id':'" + userID + "','pn_jc_no':'" + JobCardnum, EX);

        }
        finally
        {
            if (cmd != null)
            {
                cmd.Dispose();
                cmd = null;
            }
            if (objConnection != null && (objConnection.State == ConnectionState.Open))
            {
                objConnection.Dispose();
                objConnection = null;
            }
        }
        return response;
    }

    /// <summary>
    /// Null Validator
    /// </summary>
    /// <param name="parameter"></param>
    /// <returns></returns>
    protected string NullValidator(string parameter)
    {
        string OutputParameter = string.Empty;
        if (parameter == "null")
            OutputParameter = "\"\"";
        else
            OutputParameter = "\"" + parameter + "\"";
        return OutputParameter;
    }

    /// <summary>
    /// GetCounterMeasureDtl
    /// Function is used for Get Counter Measure Dtl
    /// Created on 14JAN2020
    /// </summary>
    /// <param name="vin"></param>
    /// <returns></returns>
    public string GetCounterMeasureDtl(string vin)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {

            OBJ.Open();
            CMD = new OracleCommand("pkg_jco_1.SP_GET_Counter_Measure_DTL", OBJ);

            CMD.Parameters.Add("PN_VIN", OracleDbType.Varchar2, 22, ParameterDirection.Input).Value = Convert.ToString(vin);

            CMD.Parameters.Add("po_Counter_Dtl", OracleDbType.RefCursor).Direction = ParameterDirection.Output;

            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();
            OracleDataReader dr = ((Oracle.DataAccess.Types.OracleRefCursor)CMD.Parameters["po_Counter_Dtl"].Value).GetDataReader();

            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {

                string javascriptStr = "{" + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + "0" + "\"" + ","
                                        + "\"" + Convert.ToString("M") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_err_msg"].Value)) + ","
                                        + "\"" + "CounterMeasureDtl" + "\"" + ":" + "[";
                int cntr = 0;

                while (dr.Read())
                {
                    cntr = 1;
                    javascriptStr = javascriptStr
                                    + "{" + "\"" + Convert.ToString("model_cd") + "\"" + ":" + "\"" + Convert.ToString(dr["model_cd"]) + "\"" + ","
                                    + "\"" + Convert.ToString("model_desc") + "\"" + ":" + "\"" + Convert.ToString(dr["model_desc"]) + "\"" + ","
                                    + "\"" + Convert.ToString("chassis_num") + "\"" + ":" + "\"" + Convert.ToString(dr["chassis_num"]) + "\"" + ","
                                    + "\"" + Convert.ToString("vin") + "\"" + ":" + "\"" + Convert.ToString(dr["vin"]) + "\"" + ","
                                    + "\"" + Convert.ToString("part_num") + "\"" + ":" + "\"" + Convert.ToString(dr["part_num"]) + "\"" + ","
                                    + "\"" + Convert.ToString("remarks") + "\"" + ":" + "\"" + Convert.ToString(dr["remarks"]) + "\"" + ","
                                    + "\"" + Convert.ToString("active_date") + "\"" + ":" + "\"" + Convert.ToString(dr["active_date"]) + "\"" + ","
                                    + "\"" + Convert.ToString("active_flag") + "\"" + ":" + "\"" + Convert.ToString(dr["active_flag"]) + "\"" + ","
                                    + "\"" + Convert.ToString("deactive_date") + "\"" + ":" + "\"" + Convert.ToString(dr["deactive_date"]) + "\"" + ","
                                    + "\"" + Convert.ToString("created_date") + "\"" + ":" + "\"" + Convert.ToString(dr["created_date"]) + "\"" + ","
                                    + "\"" + Convert.ToString("created_by") + "\"" + ":" + "\"" + Convert.ToString(dr["created_by"]) + "\"" + ","
                                    + "\"" + Convert.ToString("modified_date") + "\"" + ":" + "\"" + Convert.ToString(dr["modified_date"]) + "\"" + ","
                                    + "\"" + Convert.ToString("modified_by") + "\"" + ":" + "\"" + Convert.ToString(dr["modified_by"]) + "\"" + ","
                                    + "\"" + Convert.ToString("checking_points") + "\"" + ":" + "\"" + Convert.ToString(dr["checking_points"]) + "\"" + ","
                                    + "\"" + Convert.ToString("reference_no") + "\"" + ":" + "\"" + Convert.ToString(dr["reference_no"]) + "\"" + ","
                                    + "\"" + Convert.ToString("demanded_repair") + "\"" + ":" + "\"" + Convert.ToString(dr["demanded_repair"]) + "\"" + ","
                                    + "\"" + Convert.ToString("user_remarks") + "\"" + ":" + "\"" + Convert.ToString(dr["user_remarks"]) + "\"" + ","
                                    + "\"" + Convert.ToString("user_flag") + "\"" + ":" + "\"" + Convert.ToString(dr["user_flag"]) + "\"" + "},";
                }
                if (cntr == 1)
                {
                    if (javascriptStr.Length > 1)
                        javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                }
                javascriptStr = javascriptStr + "]" + "}";
                Result = javascriptStr;

                if (dr != null)
                {
                    dr.Dispose();
                    dr = null;
                }
                Logger.SuccessLogPrint("GetCounterMeasureDtl", "SP_GET_Counter_Measure_DTL", "'PN_VIN':'" + vin, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));

            }
            else
            {

                string javascriptStr = "{";

                javascriptStr = javascriptStr
                                              + "\"" + Convert.ToString("S") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_cd"].Value) + "\"" + ","
                                              + "\"" + Convert.ToString("M") + "\"" + ":" + "\"" + Convert.ToString(CMD.Parameters["po_err_msg"].Value) + "\"" + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;
            }
        }
        catch (Exception EX)
        {
            OBJ.Close();
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("GetCounterMeasureDtl", "SP_GET_Counter_Measure_DTL", "'PN_VIN':'" + vin, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;
    }

    /// <summary>
    /// GetSuggestedPromiseDate
    /// </summary>
    /// <param name="BILLABLE_TYPE"></param>
    /// <param name="PN_MI_NMI"></param>
    /// <param name="PN_PANEL"></param>
    /// <param name="PN_CUTTING_WELDING_YN"></param>
    /// <param name="PN_PART_REPLACE_YN"></param>
    /// <param name="PN_ENGINE_TRANSMISSION_YN"></param>
    /// <param name="PN_FOR_CD"></param>
    /// <returns></returns>
    public string GetSuggestedPromiseDate(string PN_BILLABLE_TYPE, string PN_MI_NMI, string PN_PANEL, string PN_CUTTING_WELDING_YN, string PN_PART_REPLACE_YN, string PN_ENGINE_TRANSMISSION_YN, string PN_FOR_CD)
    {
        String Result = String.Empty;
        OBJ = new OracleConnection(Convert.ToString(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionStrings"]));
        try
        {
            OBJ.Open();
            CMD = new OracleCommand("pkg_jco_1.SP_SUGGEST_PROMISE_DATE", OBJ);

            //Input Parameters
            CMD.Parameters.Add("PN_BILLABLE_TYPE", OracleDbType.Varchar2, 1, ParameterDirection.Input).Value = Convert.ToString(PN_BILLABLE_TYPE);
            CMD.Parameters.Add("PN_MI_NMI", OracleDbType.Varchar2, 3, ParameterDirection.Input).Value = Convert.ToString(PN_MI_NMI);
            CMD.Parameters.Add("PN_PANEL", OracleDbType.Int32, 2, ParameterDirection.Input).Value = Convert.ToInt32(PN_PANEL);
            CMD.Parameters.Add("PN_CUTTING_WELDING_YN", OracleDbType.Varchar2, 1, ParameterDirection.Input).Value = Convert.ToString(PN_CUTTING_WELDING_YN);
            CMD.Parameters.Add("PN_PART_REPLACE_YN", OracleDbType.Varchar2, 1, ParameterDirection.Input).Value = Convert.ToString(PN_PART_REPLACE_YN);
            CMD.Parameters.Add("PN_ENGINE_TRANSMISSION_YN", OracleDbType.Varchar2, 1, ParameterDirection.Input).Value = Convert.ToString(PN_ENGINE_TRANSMISSION_YN);
            CMD.Parameters.Add("PN_FOR_CD", OracleDbType.Varchar2, 3, ParameterDirection.Input).Value = Convert.ToString(PN_FOR_CD);

            //Output Parameters
            CMD.Parameters.Add("PO_PROMISE_DATE", OracleDbType.Date).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_cd", OracleDbType.Int32, 8).Direction = ParameterDirection.Output;
            CMD.Parameters.Add("po_err_msg", OracleDbType.Varchar2, 200).Direction = ParameterDirection.Output;
            CMD.CommandType = CommandType.StoredProcedure;
            CMD.ExecuteNonQuery();

            if (Convert.ToString(CMD.Parameters["po_err_cd"].Value) == "0")
            {
                string javascriptStr = "{";
                javascriptStr = javascriptStr + "\"" + Convert.ToString("S") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_err_cd"].Value)) + ","
                                              + "\"" + Convert.ToString("M") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_err_msg"].Value)) + ","
                                              + "\"" + Convert.ToString("PROMISE_DATE") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["PO_PROMISE_DATE"].Value)) + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;
                Logger.SuccessLogPrint("GetSuggestedPromiseDate", "SP_SUGGEST_PROMISE_DATE", "'PN_BILLABLE_TYPE':'" + PN_BILLABLE_TYPE + "','PN_MI_NMI':'" + PN_MI_NMI + "','PN_PANEL':'" + PN_PANEL + "','PN_CUTTING_WELDING_YN':'" + PN_CUTTING_WELDING_YN + "','PN_PART_REPLACE_YN':'" + PN_PART_REPLACE_YN + "','PN_ENGINE_TRANSMISSION_YN':'" + PN_ENGINE_TRANSMISSION_YN + "','PN_FOR_CD':'" + PN_FOR_CD, "Success Code': '" + Convert.ToString(CMD.Parameters["PO_ERR_CD"].Value) + "', 'Success Message': '" + Convert.ToString(CMD.Parameters["PO_ERR_MSG"].Value));

            }
            else
            {
                string javascriptStr = "{";
                javascriptStr = javascriptStr + "\"" + Convert.ToString("S") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_err_cd"].Value)) + ","
                                              + "\"" + Convert.ToString("M") + "\"" + ":" + NullValidator(Convert.ToString(CMD.Parameters["po_err_msg"].Value)) + "\"";

                if (javascriptStr.Length > 1)
                    javascriptStr = javascriptStr.Substring(0, javascriptStr.Length - 1);
                javascriptStr = javascriptStr + "}";
                Result = javascriptStr;
            }

        }
        catch (Exception EX)
        {
            OBJ.Close();
            Result = Result + "{" + "\"" + Convert.ToString("S") + "\"" + ":"
                                            + "\"" + "1" + "\"" + ","
                                            + "\"" + Convert.ToString("M") + "\""
                                           + ":" + "\"" + Convert.ToString(EX.Message) + "\"" + "}";
            Logger.ErrorLogException("GetSuggestedPromiseDate", "SP_SUGGEST_PROMISE_DATE", "'PN_BILLABLE_TYPE':'" + PN_BILLABLE_TYPE + "','PN_MI_NMI':'" + PN_MI_NMI + "','PN_PANEL':'" + PN_PANEL + "','PN_CUTTING_WELDING_YN':'" + PN_CUTTING_WELDING_YN + "','PN_PART_REPLACE_YN':'" + PN_PART_REPLACE_YN + "','PN_ENGINE_TRANSMISSION_YN':'" + PN_ENGINE_TRANSMISSION_YN + "','PN_FOR_CD':'" + PN_FOR_CD, EX);

        }
        finally
        {
            if (CMD != null)
            {
                CMD.Dispose();
                CMD = null;
            }
            if (OBJ != null && (OBJ.State == ConnectionState.Open))
            {
                OBJ.Dispose();
                OBJ = null;
            }
        }
        return Result;
    }
}